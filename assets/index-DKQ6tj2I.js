function hT(n,t){for(var r=0;r<t.length;r++){const l=t[r];if(typeof l!="string"&&!Array.isArray(l)){for(const d in l)if(d!=="default"&&!(d in n)){const m=Object.getOwnPropertyDescriptor(l,d);m&&Object.defineProperty(n,d,m.get?m:{enumerable:!0,get:()=>l[d]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))l(d);new MutationObserver(d=>{for(const m of d)if(m.type==="childList")for(const x of m.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&l(x)}).observe(document,{childList:!0,subtree:!0});function r(d){const m={};return d.integrity&&(m.integrity=d.integrity),d.referrerPolicy&&(m.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?m.credentials="include":d.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function l(d){if(d.ep)return;d.ep=!0;const m=r(d);fetch(d.href,m)}})();function cu(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function dT(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var t=n.default;if(typeof t=="function"){var r=function l(){var d=!1;try{d=this instanceof l}catch{}return d?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(n).forEach(function(l){var d=Object.getOwnPropertyDescriptor(n,l);Object.defineProperty(r,l,d.get?d:{enumerable:!0,get:function(){return n[l]}})}),r}var yv={exports:{}},qg={},vv={exports:{}},li={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X3;function gk(){if(X3)return li;X3=1;var n=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),x=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),a=Symbol.for("react.suspense"),M=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),j=Symbol.iterator;function F(je){return je===null||typeof je!="object"?null:(je=j&&je[j]||je["@@iterator"],typeof je=="function"?je:null)}var Z={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Y=Object.assign,ne={};function se(je,At,sn){this.props=je,this.context=At,this.refs=ne,this.updater=sn||Z}se.prototype.isReactComponent={},se.prototype.setState=function(je,At){if(typeof je!="object"&&typeof je!="function"&&je!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,je,At,"setState")},se.prototype.forceUpdate=function(je){this.updater.enqueueForceUpdate(this,je,"forceUpdate")};function xe(){}xe.prototype=se.prototype;function Se(je,At,sn){this.props=je,this.context=At,this.refs=ne,this.updater=sn||Z}var _e=Se.prototype=new xe;_e.constructor=Se,Y(_e,se.prototype),_e.isPureReactComponent=!0;var Ie=Array.isArray,Me=Object.prototype.hasOwnProperty,Ve={current:null},Ke={key:!0,ref:!0,__self:!0,__source:!0};function et(je,At,sn){var zn,vn={},Mn=null,Yn=null;if(At!=null)for(zn in At.ref!==void 0&&(Yn=At.ref),At.key!==void 0&&(Mn=""+At.key),At)Me.call(At,zn)&&!Ke.hasOwnProperty(zn)&&(vn[zn]=At[zn]);var ir=arguments.length-2;if(ir===1)vn.children=sn;else if(1<ir){for(var mt=Array(ir),bt=0;bt<ir;bt++)mt[bt]=arguments[bt+2];vn.children=mt}if(je&&je.defaultProps)for(zn in ir=je.defaultProps,ir)vn[zn]===void 0&&(vn[zn]=ir[zn]);return{$$typeof:n,type:je,key:Mn,ref:Yn,props:vn,_owner:Ve.current}}function qe(je,At){return{$$typeof:n,type:je.type,key:At,ref:je.ref,props:je.props,_owner:je._owner}}function ge(je){return typeof je=="object"&&je!==null&&je.$$typeof===n}function We(je){var At={"=":"=0",":":"=2"};return"$"+je.replace(/[=:]/g,function(sn){return At[sn]})}var Ue=/\/+/g;function lt(je,At){return typeof je=="object"&&je!==null&&je.key!=null?We(""+je.key):At.toString(36)}function ht(je,At,sn,zn,vn){var Mn=typeof je;(Mn==="undefined"||Mn==="boolean")&&(je=null);var Yn=!1;if(je===null)Yn=!0;else switch(Mn){case"string":case"number":Yn=!0;break;case"object":switch(je.$$typeof){case n:case t:Yn=!0}}if(Yn)return Yn=je,vn=vn(Yn),je=zn===""?"."+lt(Yn,0):zn,Ie(vn)?(sn="",je!=null&&(sn=je.replace(Ue,"$&/")+"/"),ht(vn,At,sn,"",function(bt){return bt})):vn!=null&&(ge(vn)&&(vn=qe(vn,sn+(!vn.key||Yn&&Yn.key===vn.key?"":(""+vn.key).replace(Ue,"$&/")+"/")+je)),At.push(vn)),1;if(Yn=0,zn=zn===""?".":zn+":",Ie(je))for(var ir=0;ir<je.length;ir++){Mn=je[ir];var mt=zn+lt(Mn,ir);Yn+=ht(Mn,At,sn,mt,vn)}else if(mt=F(je),typeof mt=="function")for(je=mt.call(je),ir=0;!(Mn=je.next()).done;)Mn=Mn.value,mt=zn+lt(Mn,ir++),Yn+=ht(Mn,At,sn,mt,vn);else if(Mn==="object")throw At=String(je),Error("Objects are not valid as a React child (found: "+(At==="[object Object]"?"object with keys {"+Object.keys(je).join(", ")+"}":At)+"). If you meant to render a collection of children, use an array instead.");return Yn}function Wt(je,At,sn){if(je==null)return je;var zn=[],vn=0;return ht(je,zn,"","",function(Mn){return At.call(sn,Mn,vn++)}),zn}function In(je){if(je._status===-1){var At=je._result;At=At(),At.then(function(sn){(je._status===0||je._status===-1)&&(je._status=1,je._result=sn)},function(sn){(je._status===0||je._status===-1)&&(je._status=2,je._result=sn)}),je._status===-1&&(je._status=0,je._result=At)}if(je._status===1)return je._result.default;throw je._result}var Sn={current:null},qt={transition:null},Bt={ReactCurrentDispatcher:Sn,ReactCurrentBatchConfig:qt,ReactCurrentOwner:Ve};return li.Children={map:Wt,forEach:function(je,At,sn){Wt(je,function(){At.apply(this,arguments)},sn)},count:function(je){var At=0;return Wt(je,function(){At++}),At},toArray:function(je){return Wt(je,function(At){return At})||[]},only:function(je){if(!ge(je))throw Error("React.Children.only expected to receive a single React element child.");return je}},li.Component=se,li.Fragment=r,li.Profiler=d,li.PureComponent=Se,li.StrictMode=l,li.Suspense=a,li.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bt,li.cloneElement=function(je,At,sn){if(je==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+je+".");var zn=Y({},je.props),vn=je.key,Mn=je.ref,Yn=je._owner;if(At!=null){if(At.ref!==void 0&&(Mn=At.ref,Yn=Ve.current),At.key!==void 0&&(vn=""+At.key),je.type&&je.type.defaultProps)var ir=je.type.defaultProps;for(mt in At)Me.call(At,mt)&&!Ke.hasOwnProperty(mt)&&(zn[mt]=At[mt]===void 0&&ir!==void 0?ir[mt]:At[mt])}var mt=arguments.length-2;if(mt===1)zn.children=sn;else if(1<mt){ir=Array(mt);for(var bt=0;bt<mt;bt++)ir[bt]=arguments[bt+2];zn.children=ir}return{$$typeof:n,type:je.type,key:vn,ref:Mn,props:zn,_owner:Yn}},li.createContext=function(je){return je={$$typeof:x,_currentValue:je,_currentValue2:je,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},je.Provider={$$typeof:m,_context:je},je.Consumer=je},li.createElement=et,li.createFactory=function(je){var At=et.bind(null,je);return At.type=je,At},li.createRef=function(){return{current:null}},li.forwardRef=function(je){return{$$typeof:C,render:je}},li.isValidElement=ge,li.lazy=function(je){return{$$typeof:R,_payload:{_status:-1,_result:je},_init:In}},li.memo=function(je,At){return{$$typeof:M,type:je,compare:At===void 0?null:At}},li.startTransition=function(je){var At=qt.transition;qt.transition={};try{je()}finally{qt.transition=At}},li.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},li.useCallback=function(je,At){return Sn.current.useCallback(je,At)},li.useContext=function(je){return Sn.current.useContext(je)},li.useDebugValue=function(){},li.useDeferredValue=function(je){return Sn.current.useDeferredValue(je)},li.useEffect=function(je,At){return Sn.current.useEffect(je,At)},li.useId=function(){return Sn.current.useId()},li.useImperativeHandle=function(je,At,sn){return Sn.current.useImperativeHandle(je,At,sn)},li.useInsertionEffect=function(je,At){return Sn.current.useInsertionEffect(je,At)},li.useLayoutEffect=function(je,At){return Sn.current.useLayoutEffect(je,At)},li.useMemo=function(je,At){return Sn.current.useMemo(je,At)},li.useReducer=function(je,At,sn){return Sn.current.useReducer(je,At,sn)},li.useRef=function(je){return Sn.current.useRef(je)},li.useState=function(je){return Sn.current.useState(je)},li.useSyncExternalStore=function(je,At,sn){return Sn.current.useSyncExternalStore(je,At,sn)},li.useTransition=function(){return Sn.current.useTransition()},li.version="18.2.0",li}var Y3;function aw(){return Y3||(Y3=1,vv.exports=gk()),vv.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J3;function _k(){if(J3)return qg;J3=1;var n=aw(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,d=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,m={key:!0,ref:!0,__self:!0,__source:!0};function x(C,a,M){var R,j={},F=null,Z=null;M!==void 0&&(F=""+M),a.key!==void 0&&(F=""+a.key),a.ref!==void 0&&(Z=a.ref);for(R in a)l.call(a,R)&&!m.hasOwnProperty(R)&&(j[R]=a[R]);if(C&&C.defaultProps)for(R in a=C.defaultProps,a)j[R]===void 0&&(j[R]=a[R]);return{$$typeof:t,type:C,key:F,ref:Z,props:j,_owner:d.current}}return qg.Fragment=r,qg.jsx=x,qg.jsxs=x,qg}var Q3;function yk(){return Q3||(Q3=1,yv.exports=_k()),yv.exports}var we=yk(),Z1={},xv={exports:{}},Sa={},wv={exports:{}},bv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e5;function vk(){return e5||(e5=1,function(n){function t(qt,Bt){var je=qt.length;qt.push(Bt);e:for(;0<je;){var At=je-1>>>1,sn=qt[At];if(0<d(sn,Bt))qt[At]=Bt,qt[je]=sn,je=At;else break e}}function r(qt){return qt.length===0?null:qt[0]}function l(qt){if(qt.length===0)return null;var Bt=qt[0],je=qt.pop();if(je!==Bt){qt[0]=je;e:for(var At=0,sn=qt.length,zn=sn>>>1;At<zn;){var vn=2*(At+1)-1,Mn=qt[vn],Yn=vn+1,ir=qt[Yn];if(0>d(Mn,je))Yn<sn&&0>d(ir,Mn)?(qt[At]=ir,qt[Yn]=je,At=Yn):(qt[At]=Mn,qt[vn]=je,At=vn);else if(Yn<sn&&0>d(ir,je))qt[At]=ir,qt[Yn]=je,At=Yn;else break e}}return Bt}function d(qt,Bt){var je=qt.sortIndex-Bt.sortIndex;return je!==0?je:qt.id-Bt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var m=performance;n.unstable_now=function(){return m.now()}}else{var x=Date,C=x.now();n.unstable_now=function(){return x.now()-C}}var a=[],M=[],R=1,j=null,F=3,Z=!1,Y=!1,ne=!1,se=typeof setTimeout=="function"?setTimeout:null,xe=typeof clearTimeout=="function"?clearTimeout:null,Se=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _e(qt){for(var Bt=r(M);Bt!==null;){if(Bt.callback===null)l(M);else if(Bt.startTime<=qt)l(M),Bt.sortIndex=Bt.expirationTime,t(a,Bt);else break;Bt=r(M)}}function Ie(qt){if(ne=!1,_e(qt),!Y)if(r(a)!==null)Y=!0,In(Me);else{var Bt=r(M);Bt!==null&&Sn(Ie,Bt.startTime-qt)}}function Me(qt,Bt){Y=!1,ne&&(ne=!1,xe(et),et=-1),Z=!0;var je=F;try{for(_e(Bt),j=r(a);j!==null&&(!(j.expirationTime>Bt)||qt&&!We());){var At=j.callback;if(typeof At=="function"){j.callback=null,F=j.priorityLevel;var sn=At(j.expirationTime<=Bt);Bt=n.unstable_now(),typeof sn=="function"?j.callback=sn:j===r(a)&&l(a),_e(Bt)}else l(a);j=r(a)}if(j!==null)var zn=!0;else{var vn=r(M);vn!==null&&Sn(Ie,vn.startTime-Bt),zn=!1}return zn}finally{j=null,F=je,Z=!1}}var Ve=!1,Ke=null,et=-1,qe=5,ge=-1;function We(){return!(n.unstable_now()-ge<qe)}function Ue(){if(Ke!==null){var qt=n.unstable_now();ge=qt;var Bt=!0;try{Bt=Ke(!0,qt)}finally{Bt?lt():(Ve=!1,Ke=null)}}else Ve=!1}var lt;if(typeof Se=="function")lt=function(){Se(Ue)};else if(typeof MessageChannel<"u"){var ht=new MessageChannel,Wt=ht.port2;ht.port1.onmessage=Ue,lt=function(){Wt.postMessage(null)}}else lt=function(){se(Ue,0)};function In(qt){Ke=qt,Ve||(Ve=!0,lt())}function Sn(qt,Bt){et=se(function(){qt(n.unstable_now())},Bt)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(qt){qt.callback=null},n.unstable_continueExecution=function(){Y||Z||(Y=!0,In(Me))},n.unstable_forceFrameRate=function(qt){0>qt||125<qt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):qe=0<qt?Math.floor(1e3/qt):5},n.unstable_getCurrentPriorityLevel=function(){return F},n.unstable_getFirstCallbackNode=function(){return r(a)},n.unstable_next=function(qt){switch(F){case 1:case 2:case 3:var Bt=3;break;default:Bt=F}var je=F;F=Bt;try{return qt()}finally{F=je}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(qt,Bt){switch(qt){case 1:case 2:case 3:case 4:case 5:break;default:qt=3}var je=F;F=qt;try{return Bt()}finally{F=je}},n.unstable_scheduleCallback=function(qt,Bt,je){var At=n.unstable_now();switch(typeof je=="object"&&je!==null?(je=je.delay,je=typeof je=="number"&&0<je?At+je:At):je=At,qt){case 1:var sn=-1;break;case 2:sn=250;break;case 5:sn=1073741823;break;case 4:sn=1e4;break;default:sn=5e3}return sn=je+sn,qt={id:R++,callback:Bt,priorityLevel:qt,startTime:je,expirationTime:sn,sortIndex:-1},je>At?(qt.sortIndex=je,t(M,qt),r(a)===null&&qt===r(M)&&(ne?(xe(et),et=-1):ne=!0,Sn(Ie,je-At))):(qt.sortIndex=sn,t(a,qt),Y||Z||(Y=!0,In(Me))),qt},n.unstable_shouldYield=We,n.unstable_wrapCallback=function(qt){var Bt=F;return function(){var je=F;F=Bt;try{return qt.apply(this,arguments)}finally{F=je}}}}(bv)),bv}var t5;function xk(){return t5||(t5=1,wv.exports=vk()),wv.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n5;function wk(){if(n5)return Sa;n5=1;var n=aw(),t=xk();function r(u){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+u,b=1;b<arguments.length;b++)p+="&args[]="+encodeURIComponent(arguments[b]);return"Minified React error #"+u+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=new Set,d={};function m(u,p){x(u,p),x(u+"Capture",p)}function x(u,p){for(d[u]=p,u=0;u<p.length;u++)l.add(p[u])}var C=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),a=Object.prototype.hasOwnProperty,M=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,R={},j={};function F(u){return a.call(j,u)?!0:a.call(R,u)?!1:M.test(u)?j[u]=!0:(R[u]=!0,!1)}function Z(u,p,b,A){if(b!==null&&b.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return A?!1:b!==null?!b.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function Y(u,p,b,A){if(p===null||typeof p>"u"||Z(u,p,b,A))return!0;if(A)return!1;if(b!==null)switch(b.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function ne(u,p,b,A,D,V,re){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=A,this.attributeNamespace=D,this.mustUseProperty=b,this.propertyName=u,this.type=p,this.sanitizeURL=V,this.removeEmptyString=re}var se={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){se[u]=new ne(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var p=u[0];se[p]=new ne(p,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){se[u]=new ne(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){se[u]=new ne(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){se[u]=new ne(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){se[u]=new ne(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){se[u]=new ne(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){se[u]=new ne(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){se[u]=new ne(u,5,!1,u.toLowerCase(),null,!1,!1)});var xe=/[\-:]([a-z])/g;function Se(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var p=u.replace(xe,Se);se[p]=new ne(p,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var p=u.replace(xe,Se);se[p]=new ne(p,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var p=u.replace(xe,Se);se[p]=new ne(p,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){se[u]=new ne(u,1,!1,u.toLowerCase(),null,!1,!1)}),se.xlinkHref=new ne("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){se[u]=new ne(u,1,!1,u.toLowerCase(),null,!0,!0)});function _e(u,p,b,A){var D=se.hasOwnProperty(p)?se[p]:null;(D!==null?D.type!==0:A||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(Y(p,b,D,A)&&(b=null),A||D===null?F(p)&&(b===null?u.removeAttribute(p):u.setAttribute(p,""+b)):D.mustUseProperty?u[D.propertyName]=b===null?D.type===3?!1:"":b:(p=D.attributeName,A=D.attributeNamespace,b===null?u.removeAttribute(p):(D=D.type,b=D===3||D===4&&b===!0?"":""+b,A?u.setAttributeNS(A,p,b):u.setAttribute(p,b))))}var Ie=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Me=Symbol.for("react.element"),Ve=Symbol.for("react.portal"),Ke=Symbol.for("react.fragment"),et=Symbol.for("react.strict_mode"),qe=Symbol.for("react.profiler"),ge=Symbol.for("react.provider"),We=Symbol.for("react.context"),Ue=Symbol.for("react.forward_ref"),lt=Symbol.for("react.suspense"),ht=Symbol.for("react.suspense_list"),Wt=Symbol.for("react.memo"),In=Symbol.for("react.lazy"),Sn=Symbol.for("react.offscreen"),qt=Symbol.iterator;function Bt(u){return u===null||typeof u!="object"?null:(u=qt&&u[qt]||u["@@iterator"],typeof u=="function"?u:null)}var je=Object.assign,At;function sn(u){if(At===void 0)try{throw Error()}catch(b){var p=b.stack.trim().match(/\n( *(at )?)/);At=p&&p[1]||""}return`
`+At+u}var zn=!1;function vn(u,p){if(!u||zn)return"";zn=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(Ct){var A=Ct}Reflect.construct(u,[],p)}else{try{p.call()}catch(Ct){A=Ct}u.call(p.prototype)}else{try{throw Error()}catch(Ct){A=Ct}u()}}catch(Ct){if(Ct&&A&&typeof Ct.stack=="string"){for(var D=Ct.stack.split(`
`),V=A.stack.split(`
`),re=D.length-1,De=V.length-1;1<=re&&0<=De&&D[re]!==V[De];)De--;for(;1<=re&&0<=De;re--,De--)if(D[re]!==V[De]){if(re!==1||De!==1)do if(re--,De--,0>De||D[re]!==V[De]){var Xe=`
`+D[re].replace(" at new "," at ");return u.displayName&&Xe.includes("<anonymous>")&&(Xe=Xe.replace("<anonymous>",u.displayName)),Xe}while(1<=re&&0<=De);break}}}finally{zn=!1,Error.prepareStackTrace=b}return(u=u?u.displayName||u.name:"")?sn(u):""}function Mn(u){switch(u.tag){case 5:return sn(u.type);case 16:return sn("Lazy");case 13:return sn("Suspense");case 19:return sn("SuspenseList");case 0:case 2:case 15:return u=vn(u.type,!1),u;case 11:return u=vn(u.type.render,!1),u;case 1:return u=vn(u.type,!0),u;default:return""}}function Yn(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case Ke:return"Fragment";case Ve:return"Portal";case qe:return"Profiler";case et:return"StrictMode";case lt:return"Suspense";case ht:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case We:return(u.displayName||"Context")+".Consumer";case ge:return(u._context.displayName||"Context")+".Provider";case Ue:var p=u.render;return u=u.displayName,u||(u=p.displayName||p.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case Wt:return p=u.displayName||null,p!==null?p:Yn(u.type)||"Memo";case In:p=u._payload,u=u._init;try{return Yn(u(p))}catch{}}return null}function ir(u){var p=u.type;switch(u.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=p.render,u=u.displayName||u.name||"",p.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Yn(p);case 8:return p===et?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function mt(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function bt(u){var p=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function xt(u){var p=bt(u)?"checked":"value",b=Object.getOwnPropertyDescriptor(u.constructor.prototype,p),A=""+u[p];if(!u.hasOwnProperty(p)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var D=b.get,V=b.set;return Object.defineProperty(u,p,{configurable:!0,get:function(){return D.call(this)},set:function(re){A=""+re,V.call(this,re)}}),Object.defineProperty(u,p,{enumerable:b.enumerable}),{getValue:function(){return A},setValue:function(re){A=""+re},stopTracking:function(){u._valueTracker=null,delete u[p]}}}}function Nt(u){u._valueTracker||(u._valueTracker=xt(u))}function wt(u){if(!u)return!1;var p=u._valueTracker;if(!p)return!0;var b=p.getValue(),A="";return u&&(A=bt(u)?u.checked?"true":"false":u.value),u=A,u!==b?(p.setValue(u),!0):!1}function hn(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function An(u,p){var b=p.checked;return je({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:b??u._wrapperState.initialChecked})}function Fn(u,p){var b=p.defaultValue==null?"":p.defaultValue,A=p.checked!=null?p.checked:p.defaultChecked;b=mt(p.value!=null?p.value:b),u._wrapperState={initialChecked:A,initialValue:b,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function Nn(u,p){p=p.checked,p!=null&&_e(u,"checked",p,!1)}function xr(u,p){Nn(u,p);var b=mt(p.value),A=p.type;if(b!=null)A==="number"?(b===0&&u.value===""||u.value!=b)&&(u.value=""+b):u.value!==""+b&&(u.value=""+b);else if(A==="submit"||A==="reset"){u.removeAttribute("value");return}p.hasOwnProperty("value")?Zr(u,p.type,b):p.hasOwnProperty("defaultValue")&&Zr(u,p.type,mt(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(u.defaultChecked=!!p.defaultChecked)}function nr(u,p,b){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var A=p.type;if(!(A!=="submit"&&A!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+u._wrapperState.initialValue,b||p===u.value||(u.value=p),u.defaultValue=p}b=u.name,b!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,b!==""&&(u.name=b)}function Zr(u,p,b){(p!=="number"||hn(u.ownerDocument)!==u)&&(b==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+b&&(u.defaultValue=""+b))}var Br=Array.isArray;function ui(u,p,b,A){if(u=u.options,p){p={};for(var D=0;D<b.length;D++)p["$"+b[D]]=!0;for(b=0;b<u.length;b++)D=p.hasOwnProperty("$"+u[b].value),u[b].selected!==D&&(u[b].selected=D),D&&A&&(u[b].defaultSelected=!0)}else{for(b=""+mt(b),p=null,D=0;D<u.length;D++){if(u[D].value===b){u[D].selected=!0,A&&(u[D].defaultSelected=!0);return}p!==null||u[D].disabled||(p=u[D])}p!==null&&(p.selected=!0)}}function gi(u,p){if(p.dangerouslySetInnerHTML!=null)throw Error(r(91));return je({},p,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function Xi(u,p){var b=p.value;if(b==null){if(b=p.children,p=p.defaultValue,b!=null){if(p!=null)throw Error(r(92));if(Br(b)){if(1<b.length)throw Error(r(93));b=b[0]}p=b}p==null&&(p=""),b=p}u._wrapperState={initialValue:mt(b)}}function Ri(u,p){var b=mt(p.value),A=mt(p.defaultValue);b!=null&&(b=""+b,b!==u.value&&(u.value=b),p.defaultValue==null&&u.defaultValue!==b&&(u.defaultValue=b)),A!=null&&(u.defaultValue=""+A)}function dr(u){var p=u.textContent;p===u._wrapperState.initialValue&&p!==""&&p!==null&&(u.value=p)}function Nr(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cr(u,p){return u==null||u==="http://www.w3.org/1999/xhtml"?Nr(p):u==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var Cr,Oi=function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,b,A,D){MSApp.execUnsafeLocalFunction(function(){return u(p,b,A,D)})}:u}(function(u,p){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=p;else{for(Cr=Cr||document.createElement("div"),Cr.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=Cr.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;p.firstChild;)u.appendChild(p.firstChild)}});function Di(u,p){if(p){var b=u.firstChild;if(b&&b===u.lastChild&&b.nodeType===3){b.nodeValue=p;return}}u.textContent=p}var wr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rr=["Webkit","ms","Moz","O"];Object.keys(wr).forEach(function(u){rr.forEach(function(p){p=p+u.charAt(0).toUpperCase()+u.substring(1),wr[p]=wr[u]})});function Fi(u,p,b){return p==null||typeof p=="boolean"||p===""?"":b||typeof p!="number"||p===0||wr.hasOwnProperty(u)&&wr[u]?(""+p).trim():p+"px"}function ao(u,p){u=u.style;for(var b in p)if(p.hasOwnProperty(b)){var A=b.indexOf("--")===0,D=Fi(b,p[b],A);b==="float"&&(b="cssFloat"),A?u.setProperty(b,D):u[b]=D}}var lo=je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ao(u,p){if(p){if(lo[u]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(r(137,u));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(r(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(r(61))}if(p.style!=null&&typeof p.style!="object")throw Error(r(62))}}function Fo(u,p){if(u.indexOf("-")===-1)return typeof p.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var go=null;function rs(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Ae=null,J=null,te=null;function ke(u){if(u=Cc(u)){if(typeof Ae!="function")throw Error(r(280));var p=u.stateNode;p&&(p=zh(p),Ae(u.stateNode,u.type,p))}}function Oe(u){J?te?te.push(u):te=[u]:J=u}function Ge(){if(J){var u=J,p=te;if(te=J=null,ke(u),p)for(u=0;u<p.length;u++)ke(p[u])}}function rt(u,p){return u(p)}function it(){}var Ze=!1;function dt(u,p,b){if(Ze)return u(p,b);Ze=!0;try{return rt(u,p,b)}finally{Ze=!1,(J!==null||te!==null)&&(it(),Ge())}}function Xt(u,p){var b=u.stateNode;if(b===null)return null;var A=zh(b);if(A===null)return null;b=A[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(A=!A.disabled)||(u=u.type,A=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!A;break e;default:u=!1}if(u)return null;if(b&&typeof b!="function")throw Error(r(231,p,typeof b));return b}var Gt=!1;if(C)try{var $t={};Object.defineProperty($t,"passive",{get:function(){Gt=!0}}),window.addEventListener("test",$t,$t),window.removeEventListener("test",$t,$t)}catch{Gt=!1}function G(u,p,b,A,D,V,re,De,Xe){var Ct=Array.prototype.slice.call(arguments,3);try{p.apply(b,Ct)}catch(rn){this.onError(rn)}}var ee=!1,Q=null,B=!1,ce=null,Qe={onError:function(u){ee=!0,Q=u}};function ot(u,p,b,A,D,V,re,De,Xe){ee=!1,Q=null,G.apply(Qe,arguments)}function Lt(u,p,b,A,D,V,re,De,Xe){if(ot.apply(this,arguments),ee){if(ee){var Ct=Q;ee=!1,Q=null}else throw Error(r(198));B||(B=!0,ce=Ct)}}function Ut(u){var p=u,b=u;if(u.alternate)for(;p.return;)p=p.return;else{u=p;do p=u,(p.flags&4098)!==0&&(b=p.return),u=p.return;while(u)}return p.tag===3?b:null}function Ln(u){if(u.tag===13){var p=u.memoizedState;if(p===null&&(u=u.alternate,u!==null&&(p=u.memoizedState)),p!==null)return p.dehydrated}return null}function ln(u){if(Ut(u)!==u)throw Error(r(188))}function or(u){var p=u.alternate;if(!p){if(p=Ut(u),p===null)throw Error(r(188));return p!==u?null:u}for(var b=u,A=p;;){var D=b.return;if(D===null)break;var V=D.alternate;if(V===null){if(A=D.return,A!==null){b=A;continue}break}if(D.child===V.child){for(V=D.child;V;){if(V===b)return ln(D),u;if(V===A)return ln(D),p;V=V.sibling}throw Error(r(188))}if(b.return!==A.return)b=D,A=V;else{for(var re=!1,De=D.child;De;){if(De===b){re=!0,b=D,A=V;break}if(De===A){re=!0,A=D,b=V;break}De=De.sibling}if(!re){for(De=V.child;De;){if(De===b){re=!0,b=V,A=D;break}if(De===A){re=!0,A=V,b=D;break}De=De.sibling}if(!re)throw Error(r(189))}}if(b.alternate!==A)throw Error(r(190))}if(b.tag!==3)throw Error(r(188));return b.stateNode.current===b?u:p}function Cn(u){return u=or(u),u!==null?ur(u):null}function ur(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var p=ur(u);if(p!==null)return p;u=u.sibling}return null}var hr=t.unstable_scheduleCallback,bn=t.unstable_cancelCallback,Sr=t.unstable_shouldYield,fr=t.unstable_requestPaint,On=t.unstable_now,Gn=t.unstable_getCurrentPriorityLevel,yn=t.unstable_ImmediatePriority,Pn=t.unstable_UserBlockingPriority,mn=t.unstable_NormalPriority,Dn=t.unstable_LowPriority,En=t.unstable_IdlePriority,cn=null,yt=null;function Te(u){if(yt&&typeof yt.onCommitFiberRoot=="function")try{yt.onCommitFiberRoot(cn,u,void 0,(u.current.flags&128)===128)}catch{}}var Dt=Math.clz32?Math.clz32:tn,Tt=Math.log,It=Math.LN2;function tn(u){return u>>>=0,u===0?32:31-(Tt(u)/It|0)|0}var Bn=64,pr=4194304;function _r(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function sr(u,p){var b=u.pendingLanes;if(b===0)return 0;var A=0,D=u.suspendedLanes,V=u.pingedLanes,re=b&268435455;if(re!==0){var De=re&~D;De!==0?A=_r(De):(V&=re,V!==0&&(A=_r(V)))}else re=b&~D,re!==0?A=_r(re):V!==0&&(A=_r(V));if(A===0)return 0;if(p!==0&&p!==A&&(p&D)===0&&(D=A&-A,V=p&-p,D>=V||D===16&&(V&4194240)!==0))return p;if((A&4)!==0&&(A|=b&16),p=u.entangledLanes,p!==0)for(u=u.entanglements,p&=A;0<p;)b=31-Dt(p),D=1<<b,A|=u[b],p&=~D;return A}function pe(u,p){switch(u){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wn(u,p){for(var b=u.suspendedLanes,A=u.pingedLanes,D=u.expirationTimes,V=u.pendingLanes;0<V;){var re=31-Dt(V),De=1<<re,Xe=D[re];Xe===-1?((De&b)===0||(De&A)!==0)&&(D[re]=pe(De,p)):Xe<=p&&(u.expiredLanes|=De),V&=~De}}function Tn(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function yr(){var u=Bn;return Bn<<=1,(Bn&4194240)===0&&(Bn=64),u}function ar(u){for(var p=[],b=0;31>b;b++)p.push(u);return p}function xn(u,p,b){u.pendingLanes|=p,p!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,p=31-Dt(p),u[p]=b}function Er(u,p){var b=u.pendingLanes&~p;u.pendingLanes=p,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=p,u.mutableReadLanes&=p,u.entangledLanes&=p,p=u.entanglements;var A=u.eventTimes;for(u=u.expirationTimes;0<b;){var D=31-Dt(b),V=1<<D;p[D]=0,A[D]=-1,u[D]=-1,b&=~V}}function ie(u,p){var b=u.entangledLanes|=p;for(u=u.entanglements;b;){var A=31-Dt(b),D=1<<A;D&p|u[A]&p&&(u[A]|=p),b&=~D}}var ae=0;function Le(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var tt,zt,an,Qn,Fr,Vr=!1,ro=[],Wi=null,Ps=null,Gs=null,ha=new Map,Eo=new Map,_i=[],Fd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vh(u,p){switch(u){case"focusin":case"focusout":Wi=null;break;case"dragenter":case"dragleave":Ps=null;break;case"mouseover":case"mouseout":Gs=null;break;case"pointerover":case"pointerout":ha.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":Eo.delete(p.pointerId)}}function To(u,p,b,A,D,V){return u===null||u.nativeEvent!==V?(u={blockedOn:p,domEventName:b,eventSystemFlags:A,nativeEvent:V,targetContainers:[D]},p!==null&&(p=Cc(p),p!==null&&zt(p)),u):(u.eventSystemFlags|=A,p=u.targetContainers,D!==null&&p.indexOf(D)===-1&&p.push(D),u)}function Is(u,p,b,A,D){switch(p){case"focusin":return Wi=To(Wi,u,p,b,A,D),!0;case"dragenter":return Ps=To(Ps,u,p,b,A,D),!0;case"mouseover":return Gs=To(Gs,u,p,b,A,D),!0;case"pointerover":var V=D.pointerId;return ha.set(V,To(ha.get(V)||null,u,p,b,A,D)),!0;case"gotpointercapture":return V=D.pointerId,Eo.set(V,To(Eo.get(V)||null,u,p,b,A,D)),!0}return!1}function Ud(u){var p=ls(u.target);if(p!==null){var b=Ut(p);if(b!==null){if(p=b.tag,p===13){if(p=Ln(b),p!==null){u.blockedOn=p,Fr(u.priority,function(){an(b)});return}}else if(p===3&&b.stateNode.current.memoizedState.isDehydrated){u.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}u.blockedOn=null}function Ja(u){if(u.blockedOn!==null)return!1;for(var p=u.targetContainers;0<p.length;){var b=Vd(u.domEventName,u.eventSystemFlags,p[0],u.nativeEvent);if(b===null){b=u.nativeEvent;var A=new b.constructor(b.type,b);go=A,b.target.dispatchEvent(A),go=null}else return p=Cc(b),p!==null&&zt(p),u.blockedOn=b,!1;p.shift()}return!0}function Ui(u,p,b){Ja(u)&&b.delete(p)}function mu(){Vr=!1,Wi!==null&&Ja(Wi)&&(Wi=null),Ps!==null&&Ja(Ps)&&(Ps=null),Gs!==null&&Ja(Gs)&&(Gs=null),ha.forEach(Ui),Eo.forEach(Ui)}function xl(u,p){u.blockedOn===p&&(u.blockedOn=null,Vr||(Vr=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,mu)))}function Zs(u){function p(D){return xl(D,u)}if(0<ro.length){xl(ro[0],u);for(var b=1;b<ro.length;b++){var A=ro[b];A.blockedOn===u&&(A.blockedOn=null)}}for(Wi!==null&&xl(Wi,u),Ps!==null&&xl(Ps,u),Gs!==null&&xl(Gs,u),ha.forEach(p),Eo.forEach(p),b=0;b<_i.length;b++)A=_i[b],A.blockedOn===u&&(A.blockedOn=null);for(;0<_i.length&&(b=_i[0],b.blockedOn===null);)Ud(b),b.blockedOn===null&&_i.shift()}var Yi=Ie.ReactCurrentBatchConfig,oc=!0;function $d(u,p,b,A){var D=ae,V=Yi.transition;Yi.transition=null;try{ae=1,da(u,p,b,A)}finally{ae=D,Yi.transition=V}}function Pa(u,p,b,A){var D=ae,V=Yi.transition;Yi.transition=null;try{ae=4,da(u,p,b,A)}finally{ae=D,Yi.transition=V}}function da(u,p,b,A){if(oc){var D=Vd(u,p,b,A);if(D===null)yc(u,p,A,wl,b),vh(u,A);else if(Is(D,u,p,b,A))A.stopPropagation();else if(vh(u,A),p&4&&-1<Fd.indexOf(u)){for(;D!==null;){var V=Cc(D);if(V!==null&&tt(V),V=Vd(u,p,b,A),V===null&&yc(u,p,A,wl,b),V===D)break;D=V}D!==null&&A.stopPropagation()}else yc(u,p,A,null,b)}}var wl=null;function Vd(u,p,b,A){if(wl=null,u=rs(A),u=ls(u),u!==null)if(p=Ut(u),p===null)u=null;else if(b=p.tag,b===13){if(u=Ln(p),u!==null)return u;u=null}else if(b===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;u=null}else p!==u&&(u=null);return wl=u,null}function xh(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Gn()){case yn:return 1;case Pn:return 4;case mn:case Dn:return 16;case En:return 536870912;default:return 16}default:return 16}}var ys=null,Ls=null,sc=null;function Qa(){if(sc)return sc;var u,p=Ls,b=p.length,A,D="value"in ys?ys.value:ys.textContent,V=D.length;for(u=0;u<b&&p[u]===D[u];u++);var re=b-u;for(A=1;A<=re&&p[b-A]===D[V-A];A++);return sc=D.slice(u,1<A?1-A:void 0)}function Rs(u){var p=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&p===13&&(u=13)):u=p,u===10&&(u=13),32<=u||u===13?u:0}function el(){return!0}function fa(){return!1}function Uo(u){function p(b,A,D,V,re){this._reactName=b,this._targetInst=D,this.type=A,this.nativeEvent=V,this.target=re,this.currentTarget=null;for(var De in u)u.hasOwnProperty(De)&&(b=u[De],this[De]=b?b(V):V[De]);return this.isDefaultPrevented=(V.defaultPrevented!=null?V.defaultPrevented:V.returnValue===!1)?el:fa,this.isPropagationStopped=fa,this}return je(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=el)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=el)},persist:function(){},isPersistent:el}),p}var Hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bl=Uo(Hs),ac=je({},Hs,{view:0,detail:0}),wh=Uo(ac),gu,_u,pa,Hr=je({},ac,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vu,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==pa&&(pa&&u.type==="mousemove"?(gu=u.screenX-pa.screenX,_u=u.screenY-pa.screenY):_u=gu=0,pa=u),gu)},movementY:function(u){return"movementY"in u?u.movementY:_u}}),hp=Uo(Hr),Wd=je({},Hr,{dataTransfer:0}),dp=Uo(Wd),qd=je({},ac,{relatedTarget:0}),bh=Uo(qd),Gd=je({},Hs,{animationName:0,elapsedTime:0,pseudoElement:0}),lc=Uo(Gd),Eh=je({},Hs,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),cc=Uo(Eh),Ia=je({},Hs,{data:0}),tl=Uo(Ia),Th={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zd(u){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(u):(u=yu[u])?!!p[u]:!1}function vu(){return Zd}var Ch=je({},ac,{key:function(u){if(u.key){var p=Th[u.key]||u.key;if(p!=="Unidentified")return p}return u.type==="keypress"?(u=Rs(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?fp[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vu,charCode:function(u){return u.type==="keypress"?Rs(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Rs(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),Sh=Uo(Ch),Hd=je({},Hr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qr=Uo(Hd),xu=je({},ac,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vu}),pp=Uo(xu),Kd=je({},Hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),mp=Uo(Kd),El=je({},Hr,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),Xd=Uo(El),Km=[9,13,27,32],Yd=C&&"CompositionEvent"in window,wu=null;C&&"documentMode"in document&&(wu=document.documentMode);var Jd=C&&"TextEvent"in window&&!wu,kh=C&&(!Yd||wu&&8<wu&&11>=wu),Mh=" ",bu=!1;function Qd(u,p){switch(u){case"keyup":return Km.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ef(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var uc=!1;function Eu(u,p){switch(u){case"compositionend":return ef(p);case"keypress":return p.which!==32?null:(bu=!0,Mh);case"textInput":return u=p.data,u===Mh&&bu?null:u;default:return null}}function hc(u,p){if(uc)return u==="compositionend"||!Yd&&Qd(u,p)?(u=Qa(),sc=Ls=ys=null,uc=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return kh&&p.locale!=="ko"?null:p.data;default:return null}}var tf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dc(u){var p=u&&u.nodeName&&u.nodeName.toLowerCase();return p==="input"?!!tf[u.type]:p==="textarea"}function Ah(u,p,b,A){Oe(A),p=ss(p,"onChange"),0<p.length&&(b=new bl("onChange","change",null,b,A),u.push({event:b,listeners:p}))}var is=null,nl=null;function nf(u){Ml(u,0)}function Tl(u){var p=Il(u);if(wt(p))return u}function gp(u,p){if(u==="change")return p}var Ph=!1;if(C){var rf;if(C){var Tu="oninput"in document;if(!Tu){var Cu=document.createElement("div");Cu.setAttribute("oninput","return;"),Tu=typeof Cu.oninput=="function"}rf=Tu}else rf=!1;Ph=rf&&(!document.documentMode||9<document.documentMode)}function fc(){is&&(is.detachEvent("onpropertychange",of),nl=is=null)}function of(u){if(u.propertyName==="value"&&Tl(nl)){var p=[];Ah(p,nl,u,rs(u)),dt(nf,p)}}function sf(u,p,b){u==="focusin"?(fc(),is=p,nl=b,is.attachEvent("onpropertychange",of)):u==="focusout"&&fc()}function Xm(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return Tl(nl)}function af(u,p){if(u==="click")return Tl(p)}function _p(u,p){if(u==="input"||u==="change")return Tl(p)}function Su(u,p){return u===p&&(u!==0||1/u===1/p)||u!==u&&p!==p}var Os=typeof Object.is=="function"?Object.is:Su;function rl(u,p){if(Os(u,p))return!0;if(typeof u!="object"||u===null||typeof p!="object"||p===null)return!1;var b=Object.keys(u),A=Object.keys(p);if(b.length!==A.length)return!1;for(A=0;A<b.length;A++){var D=b[A];if(!a.call(p,D)||!Os(u[D],p[D]))return!1}return!0}function lf(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function Cl(u,p){var b=lf(u);u=0;for(var A;b;){if(b.nodeType===3){if(A=u+b.textContent.length,u<=p&&A>=p)return{node:b,offset:p-u};u=A}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=lf(b)}}function yp(u,p){return u&&p?u===p?!0:u&&u.nodeType===3?!1:p&&p.nodeType===3?yp(u,p.parentNode):"contains"in u?u.contains(p):u.compareDocumentPosition?!!(u.compareDocumentPosition(p)&16):!1:!1}function vp(){for(var u=window,p=hn();p instanceof u.HTMLIFrameElement;){try{var b=typeof p.contentWindow.location.href=="string"}catch{b=!1}if(b)u=p.contentWindow;else break;p=hn(u.document)}return p}function cf(u){var p=u&&u.nodeName&&u.nodeName.toLowerCase();return p&&(p==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||p==="textarea"||u.contentEditable==="true")}function Ym(u){var p=vp(),b=u.focusedElem,A=u.selectionRange;if(p!==b&&b&&b.ownerDocument&&yp(b.ownerDocument.documentElement,b)){if(A!==null&&cf(b)){if(p=A.start,u=A.end,u===void 0&&(u=p),"selectionStart"in b)b.selectionStart=p,b.selectionEnd=Math.min(u,b.value.length);else if(u=(p=b.ownerDocument||document)&&p.defaultView||window,u.getSelection){u=u.getSelection();var D=b.textContent.length,V=Math.min(A.start,D);A=A.end===void 0?V:Math.min(A.end,D),!u.extend&&V>A&&(D=A,A=V,V=D),D=Cl(b,V);var re=Cl(b,A);D&&re&&(u.rangeCount!==1||u.anchorNode!==D.node||u.anchorOffset!==D.offset||u.focusNode!==re.node||u.focusOffset!==re.offset)&&(p=p.createRange(),p.setStart(D.node,D.offset),u.removeAllRanges(),V>A?(u.addRange(p),u.extend(re.node,re.offset)):(p.setEnd(re.node,re.offset),u.addRange(p)))}}for(p=[],u=b;u=u.parentNode;)u.nodeType===1&&p.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<p.length;b++)u=p[b],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var Jm=C&&"documentMode"in document&&11>=document.documentMode,Sl=null,pc=null,ma=null,Ih=!1;function uf(u,p,b){var A=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;Ih||Sl==null||Sl!==hn(A)||(A=Sl,"selectionStart"in A&&cf(A)?A={start:A.selectionStart,end:A.selectionEnd}:(A=(A.ownerDocument&&A.ownerDocument.defaultView||window).getSelection(),A={anchorNode:A.anchorNode,anchorOffset:A.anchorOffset,focusNode:A.focusNode,focusOffset:A.focusOffset}),ma&&rl(ma,A)||(ma=A,A=ss(pc,"onSelect"),0<A.length&&(p=new bl("onSelect","select",null,p,b),u.push({event:p,listeners:A}),p.target=Sl)))}function Ds(u,p){var b={};return b[u.toLowerCase()]=p.toLowerCase(),b["Webkit"+u]="webkit"+p,b["Moz"+u]="moz"+p,b}var La={animationend:Ds("Animation","AnimationEnd"),animationiteration:Ds("Animation","AnimationIteration"),animationstart:Ds("Animation","AnimationStart"),transitionend:Ds("Transition","TransitionEnd")},os={},mc={};C&&(mc=document.createElement("div").style,"AnimationEvent"in window||(delete La.animationend.animation,delete La.animationiteration.animation,delete La.animationstart.animation),"TransitionEvent"in window||delete La.transitionend.transition);function ku(u){if(os[u])return os[u];if(!La[u])return u;var p=La[u],b;for(b in p)if(p.hasOwnProperty(b)&&b in mc)return os[u]=p[b];return u}var il=ku("animationend"),kl=ku("animationiteration"),Mu=ku("animationstart"),Au=ku("transitionend"),Kr=new Map,gc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ra(u,p){Kr.set(u,p),m(p,[u])}for(var _c=0;_c<gc.length;_c++){var ol=gc[_c],xp=ol.toLowerCase(),Lh=ol[0].toUpperCase()+ol.slice(1);Ra(xp,"on"+Lh)}Ra(il,"onAnimationEnd"),Ra(kl,"onAnimationIteration"),Ra(Mu,"onAnimationStart"),Ra("dblclick","onDoubleClick"),Ra("focusin","onFocus"),Ra("focusout","onBlur"),Ra(Au,"onTransitionEnd"),x("onMouseEnter",["mouseout","mouseover"]),x("onMouseLeave",["mouseout","mouseover"]),x("onPointerEnter",["pointerout","pointerover"]),x("onPointerLeave",["pointerout","pointerover"]),m("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),m("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),m("onBeforeInput",["compositionend","keypress","textInput","paste"]),m("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),m("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),m("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wp=new Set("cancel close invalid load scroll toggle".split(" ").concat(vs));function Pu(u,p,b){var A=u.type||"unknown-event";u.currentTarget=b,Lt(A,p,void 0,u),u.currentTarget=null}function Ml(u,p){p=(p&4)!==0;for(var b=0;b<u.length;b++){var A=u[b],D=A.event;A=A.listeners;e:{var V=void 0;if(p)for(var re=A.length-1;0<=re;re--){var De=A[re],Xe=De.instance,Ct=De.currentTarget;if(De=De.listener,Xe!==V&&D.isPropagationStopped())break e;Pu(D,De,Ct),V=Xe}else for(re=0;re<A.length;re++){if(De=A[re],Xe=De.instance,Ct=De.currentTarget,De=De.listener,Xe!==V&&D.isPropagationStopped())break e;Pu(D,De,Ct),V=Xe}}}if(B)throw u=ce,B=!1,ce=null,u}function pi(u,p){var b=p[Dh];b===void 0&&(b=p[Dh]=new Set);var A=u+"__bubble";b.has(A)||(Lu(p,u,2,!1),b.add(A))}function Iu(u,p,b){var A=0;p&&(A|=4),Lu(b,u,A,p)}var sl="_reactListening"+Math.random().toString(36).slice(2);function Oa(u){if(!u[sl]){u[sl]=!0,l.forEach(function(b){b!=="selectionchange"&&(wp.has(b)||Iu(b,!1,u),Iu(b,!0,u))});var p=u.nodeType===9?u:u.ownerDocument;p===null||p[sl]||(p[sl]=!0,Iu("selectionchange",!1,p))}}function Lu(u,p,b,A){switch(xh(p)){case 1:var D=$d;break;case 4:D=Pa;break;default:D=da}b=D.bind(null,p,b,u),D=void 0,!Gt||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(D=!0),A?D!==void 0?u.addEventListener(p,b,{capture:!0,passive:D}):u.addEventListener(p,b,!0):D!==void 0?u.addEventListener(p,b,{passive:D}):u.addEventListener(p,b,!1)}function yc(u,p,b,A,D){var V=A;if((p&1)===0&&(p&2)===0&&A!==null)e:for(;;){if(A===null)return;var re=A.tag;if(re===3||re===4){var De=A.stateNode.containerInfo;if(De===D||De.nodeType===8&&De.parentNode===D)break;if(re===4)for(re=A.return;re!==null;){var Xe=re.tag;if((Xe===3||Xe===4)&&(Xe=re.stateNode.containerInfo,Xe===D||Xe.nodeType===8&&Xe.parentNode===D))return;re=re.return}for(;De!==null;){if(re=ls(De),re===null)return;if(Xe=re.tag,Xe===5||Xe===6){A=V=re;continue e}De=De.parentNode}}A=A.return}dt(function(){var Ct=V,rn=rs(b),on=[];e:{var nn=Kr.get(u);if(nn!==void 0){var Un=bl,Jn=u;switch(u){case"keypress":if(Rs(b)===0)break e;case"keydown":case"keyup":Un=Sh;break;case"focusin":Jn="focus",Un=bh;break;case"focusout":Jn="blur",Un=bh;break;case"beforeblur":case"afterblur":Un=bh;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Un=hp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Un=dp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Un=pp;break;case il:case kl:case Mu:Un=lc;break;case Au:Un=mp;break;case"scroll":Un=wh;break;case"wheel":Un=Xd;break;case"copy":case"cut":case"paste":Un=cc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Un=qr}var er=(p&4)!==0,ho=!er&&u==="scroll",_t=er?nn!==null?nn+"Capture":null:nn;er=[];for(var nt=Ct,Et;nt!==null;){Et=nt;var dn=Et.stateNode;if(Et.tag===5&&dn!==null&&(Et=dn,_t!==null&&(dn=Xt(nt,_t),dn!=null&&er.push(fn(nt,dn,Et)))),ho)break;nt=nt.return}0<er.length&&(nn=new Un(nn,Jn,null,b,rn),on.push({event:nn,listeners:er}))}}if((p&7)===0){e:{if(nn=u==="mouseover"||u==="pointerover",Un=u==="mouseout"||u==="pointerout",nn&&b!==go&&(Jn=b.relatedTarget||b.fromElement)&&(ls(Jn)||Jn[Ks]))break e;if((Un||nn)&&(nn=rn.window===rn?rn:(nn=rn.ownerDocument)?nn.defaultView||nn.parentWindow:window,Un?(Jn=b.relatedTarget||b.toElement,Un=Ct,Jn=Jn?ls(Jn):null,Jn!==null&&(ho=Ut(Jn),Jn!==ho||Jn.tag!==5&&Jn.tag!==6)&&(Jn=null)):(Un=null,Jn=Ct),Un!==Jn)){if(er=hp,dn="onMouseLeave",_t="onMouseEnter",nt="mouse",(u==="pointerout"||u==="pointerover")&&(er=qr,dn="onPointerLeave",_t="onPointerEnter",nt="pointer"),ho=Un==null?nn:Il(Un),Et=Jn==null?nn:Il(Jn),nn=new er(dn,nt+"leave",Un,b,rn),nn.target=ho,nn.relatedTarget=Et,dn=null,ls(rn)===Ct&&(er=new er(_t,nt+"enter",Jn,b,rn),er.target=Et,er.relatedTarget=ho,dn=er),ho=dn,Un&&Jn)t:{for(er=Un,_t=Jn,nt=0,Et=er;Et;Et=Al(Et))nt++;for(Et=0,dn=_t;dn;dn=Al(dn))Et++;for(;0<nt-Et;)er=Al(er),nt--;for(;0<Et-nt;)_t=Al(_t),Et--;for(;nt--;){if(er===_t||_t!==null&&er===_t.alternate)break t;er=Al(er),_t=Al(_t)}er=null}else er=null;Un!==null&&vc(on,nn,Un,er,!1),Jn!==null&&ho!==null&&vc(on,ho,Jn,er,!0)}}e:{if(nn=Ct?Il(Ct):window,Un=nn.nodeName&&nn.nodeName.toLowerCase(),Un==="select"||Un==="input"&&nn.type==="file")var tr=gp;else if(dc(nn))if(Ph)tr=_p;else{tr=Xm;var gr=sf}else(Un=nn.nodeName)&&Un.toLowerCase()==="input"&&(nn.type==="checkbox"||nn.type==="radio")&&(tr=af);if(tr&&(tr=tr(u,Ct))){Ah(on,tr,b,rn);break e}gr&&gr(u,nn,Ct),u==="focusout"&&(gr=nn._wrapperState)&&gr.controlled&&nn.type==="number"&&Zr(nn,"number",nn.value)}switch(gr=Ct?Il(Ct):window,u){case"focusin":(dc(gr)||gr.contentEditable==="true")&&(Sl=gr,pc=Ct,ma=null);break;case"focusout":ma=pc=Sl=null;break;case"mousedown":Ih=!0;break;case"contextmenu":case"mouseup":case"dragend":Ih=!1,uf(on,b,rn);break;case"selectionchange":if(Jm)break;case"keydown":case"keyup":uf(on,b,rn)}var Tr;if(Yd)e:{switch(u){case"compositionstart":var Dr="onCompositionStart";break e;case"compositionend":Dr="onCompositionEnd";break e;case"compositionupdate":Dr="onCompositionUpdate";break e}Dr=void 0}else uc?Qd(u,b)&&(Dr="onCompositionEnd"):u==="keydown"&&b.keyCode===229&&(Dr="onCompositionStart");Dr&&(kh&&b.locale!=="ko"&&(uc||Dr!=="onCompositionStart"?Dr==="onCompositionEnd"&&uc&&(Tr=Qa()):(ys=rn,Ls="value"in ys?ys.value:ys.textContent,uc=!0)),gr=ss(Ct,Dr),0<gr.length&&(Dr=new tl(Dr,u,null,b,rn),on.push({event:Dr,listeners:gr}),Tr?Dr.data=Tr:(Tr=ef(b),Tr!==null&&(Dr.data=Tr)))),(Tr=Jd?Eu(u,b):hc(u,b))&&(Ct=ss(Ct,"onBeforeInput"),0<Ct.length&&(rn=new tl("onBeforeInput","beforeinput",null,b,rn),on.push({event:rn,listeners:Ct}),rn.data=Tr))}Ml(on,p)})}function fn(u,p,b){return{instance:u,listener:p,currentTarget:b}}function ss(u,p){for(var b=p+"Capture",A=[];u!==null;){var D=u,V=D.stateNode;D.tag===5&&V!==null&&(D=V,V=Xt(u,b),V!=null&&A.unshift(fn(u,V,D)),V=Xt(u,p),V!=null&&A.push(fn(u,V,D))),u=u.return}return A}function Al(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function vc(u,p,b,A,D){for(var V=p._reactName,re=[];b!==null&&b!==A;){var De=b,Xe=De.alternate,Ct=De.stateNode;if(Xe!==null&&Xe===A)break;De.tag===5&&Ct!==null&&(De=Ct,D?(Xe=Xt(b,V),Xe!=null&&re.unshift(fn(b,Xe,De))):D||(Xe=Xt(b,V),Xe!=null&&re.push(fn(b,Xe,De)))),b=b.return}re.length!==0&&u.push({event:p,listeners:re})}var Ru=/\r\n?/g,Co=/\u0000|\uFFFD/g;function xc(u){return(typeof u=="string"?u:""+u).replace(Ru,`
`).replace(Co,"")}function Pl(u,p,b){if(p=xc(p),xc(u)!==p&&b)throw Error(r(425))}function wc(){}var bc=null,Rh=null;function Ec(u,p){return u==="textarea"||u==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var al=typeof setTimeout=="function"?setTimeout:void 0,hf=typeof clearTimeout=="function"?clearTimeout:void 0,bp=typeof Promise=="function"?Promise:void 0,Ep=typeof queueMicrotask=="function"?queueMicrotask:typeof bp<"u"?function(u){return bp.resolve(null).then(u).catch(Tc)}:al;function Tc(u){setTimeout(function(){throw u})}function Ou(u,p){var b=p,A=0;do{var D=b.nextSibling;if(u.removeChild(b),D&&D.nodeType===8)if(b=D.data,b==="/$"){if(A===0){u.removeChild(D),Zs(p);return}A--}else b!=="$"&&b!=="$?"&&b!=="$!"||A++;b=D}while(b);Zs(p)}function ga(u){for(;u!=null;u=u.nextSibling){var p=u.nodeType;if(p===1||p===3)break;if(p===8){if(p=u.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return u}function Oh(u){u=u.previousSibling;for(var p=0;u;){if(u.nodeType===8){var b=u.data;if(b==="$"||b==="$!"||b==="$?"){if(p===0)return u;p--}else b==="/$"&&p++}u=u.previousSibling}return null}var Da=Math.random().toString(36).slice(2),as="__reactFiber$"+Da,za="__reactProps$"+Da,Ks="__reactContainer$"+Da,Dh="__reactEvents$"+Da,df="__reactListeners$"+Da,Tp="__reactHandles$"+Da;function ls(u){var p=u[as];if(p)return p;for(var b=u.parentNode;b;){if(p=b[Ks]||b[as]){if(b=p.alternate,p.child!==null||b!==null&&b.child!==null)for(u=Oh(u);u!==null;){if(b=u[as])return b;u=Oh(u)}return p}u=b,b=u.parentNode}return null}function Cc(u){return u=u[as]||u[Ks],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function Il(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(r(33))}function zh(u){return u[za]||null}var Bh=[],ll=-1;function Ba(u){return{current:u}}function Pi(u){0>ll||(u.current=Bh[ll],Bh[ll]=null,ll--)}function Ur(u,p){ll++,Bh[ll]=u.current,u.current=p}var cl={},Po=Ba(cl),cs=Ba(!1),Ll=cl;function Io(u,p){var b=u.type.contextTypes;if(!b)return cl;var A=u.stateNode;if(A&&A.__reactInternalMemoizedUnmaskedChildContext===p)return A.__reactInternalMemoizedMaskedChildContext;var D={},V;for(V in b)D[V]=p[V];return A&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=p,u.__reactInternalMemoizedMaskedChildContext=D),D}function Ho(u){return u=u.childContextTypes,u!=null}function jh(){Pi(cs),Pi(Po)}function zs(u,p,b){if(Po.current!==cl)throw Error(r(168));Ur(Po,p),Ur(cs,b)}function Xs(u,p,b){var A=u.stateNode;if(p=p.childContextTypes,typeof A.getChildContext!="function")return b;A=A.getChildContext();for(var D in A)if(!(D in p))throw Error(r(108,ir(u)||"Unknown",D));return je({},b,A)}function _a(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||cl,Ll=Po.current,Ur(Po,u),Ur(cs,cs.current),!0}function Du(u,p,b){var A=u.stateNode;if(!A)throw Error(r(169));b?(u=Xs(u,p,Ll),A.__reactInternalMemoizedMergedChildContext=u,Pi(cs),Pi(Po),Ur(Po,u)):Pi(cs),Ur(cs,b)}var gn=null,Sc=!1,zu=!1;function Rl(u){gn===null?gn=[u]:gn.push(u)}function Ol(u){Sc=!0,Rl(u)}function un(){if(!zu&&gn!==null){zu=!0;var u=0,p=ae;try{var b=gn;for(ae=1;u<b.length;u++){var A=b[u];do A=A(!0);while(A!==null)}gn=null,Sc=!1}catch(D){throw gn!==null&&(gn=gn.slice(u+1)),hr(yn,un),D}finally{ae=p,zu=!1}}return null}var ul=[],kc=0,Bu=null,Mc=0,xs=[],ws=0,Dl=null,ja=1,Ys="";function Na(u,p){ul[kc++]=Mc,ul[kc++]=Bu,Bu=u,Mc=p}function Nh(u,p,b){xs[ws++]=ja,xs[ws++]=Ys,xs[ws++]=Dl,Dl=u;var A=ja;u=Ys;var D=32-Dt(A)-1;A&=~(1<<D),b+=1;var V=32-Dt(p)+D;if(30<V){var re=D-D%5;V=(A&(1<<re)-1).toString(32),A>>=re,D-=re,ja=1<<32-Dt(p)+D|b<<D|A,Ys=V+u}else ja=1<<V|b<<D|A,Ys=u}function hl(u){u.return!==null&&(Na(u,1),Nh(u,1,0))}function g(u){for(;u===Bu;)Bu=ul[--kc],ul[kc]=null,Mc=ul[--kc],ul[kc]=null;for(;u===Dl;)Dl=xs[--ws],xs[ws]=null,Ys=xs[--ws],xs[ws]=null,ja=xs[--ws],xs[ws]=null}var s=null,h=null,y=!1,w=null;function T(u,p){var b=ds(5,null,null,0);b.elementType="DELETED",b.stateNode=p,b.return=u,p=u.deletions,p===null?(u.deletions=[b],u.flags|=16):p.push(b)}function P(u,p){switch(u.tag){case 5:var b=u.type;return p=p.nodeType!==1||b.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(u.stateNode=p,s=u,h=ga(p.firstChild),!0):!1;case 6:return p=u.pendingProps===""||p.nodeType!==3?null:p,p!==null?(u.stateNode=p,s=u,h=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(b=Dl!==null?{id:ja,overflow:Ys}:null,u.memoizedState={dehydrated:p,treeContext:b,retryLane:1073741824},b=ds(18,null,null,0),b.stateNode=p,b.return=u,u.child=b,s=u,h=null,!0):!1;default:return!1}}function I(u){return(u.mode&1)!==0&&(u.flags&128)===0}function O(u){if(y){var p=h;if(p){var b=p;if(!P(u,p)){if(I(u))throw Error(r(418));p=ga(b.nextSibling);var A=s;p&&P(u,p)?T(A,b):(u.flags=u.flags&-4097|2,y=!1,s=u)}}else{if(I(u))throw Error(r(418));u.flags=u.flags&-4097|2,y=!1,s=u}}}function $(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;s=u}function U(u){if(u!==s)return!1;if(!y)return $(u),y=!0,!1;var p;if((p=u.tag!==3)&&!(p=u.tag!==5)&&(p=u.type,p=p!=="head"&&p!=="body"&&!Ec(u.type,u.memoizedProps)),p&&(p=h)){if(I(u))throw H(),Error(r(418));for(;p;)T(u,p),p=ga(p.nextSibling)}if($(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(r(317));e:{for(u=u.nextSibling,p=0;u;){if(u.nodeType===8){var b=u.data;if(b==="/$"){if(p===0){h=ga(u.nextSibling);break e}p--}else b!=="$"&&b!=="$!"&&b!=="$?"||p++}u=u.nextSibling}h=null}}else h=s?ga(u.stateNode.nextSibling):null;return!0}function H(){for(var u=h;u;)u=ga(u.nextSibling)}function oe(){h=s=null,y=!1}function de(u){w===null?w=[u]:w.push(u)}var me=Ie.ReactCurrentBatchConfig;function fe(u,p){if(u&&u.defaultProps){p=je({},p),u=u.defaultProps;for(var b in u)p[b]===void 0&&(p[b]=u[b]);return p}return p}var ye=Ba(null),K=null,ue=null,Ee=null;function Ce(){Ee=ue=K=null}function Fe(u){var p=ye.current;Pi(ye),u._currentValue=p}function $e(u,p,b){for(;u!==null;){var A=u.alternate;if((u.childLanes&p)!==p?(u.childLanes|=p,A!==null&&(A.childLanes|=p)):A!==null&&(A.childLanes&p)!==p&&(A.childLanes|=p),u===b)break;u=u.return}}function Ne(u,p){K=u,Ee=ue=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&p)!==0&&($i=!0),u.firstContext=null)}function Je(u){var p=u._currentValue;if(Ee!==u)if(u={context:u,memoizedValue:p,next:null},ue===null){if(K===null)throw Error(r(308));ue=u,K.dependencies={lanes:0,firstContext:u}}else ue=ue.next=u;return p}var Ye=null;function ut(u){Ye===null?Ye=[u]:Ye.push(u)}function Kt(u,p,b,A){var D=p.interleaved;return D===null?(b.next=b,ut(p)):(b.next=D.next,D.next=b),p.interleaved=b,st(u,A)}function st(u,p){u.lanes|=p;var b=u.alternate;for(b!==null&&(b.lanes|=p),b=u,u=u.return;u!==null;)u.childLanes|=p,b=u.alternate,b!==null&&(b.childLanes|=p),b=u,u=u.return;return b.tag===3?b.stateNode:null}var Mt=!1;function gt(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Zt(u,p){u=u.updateQueue,p.updateQueue===u&&(p.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function at(u,p){return{eventTime:u,lane:p,tag:0,payload:null,callback:null,next:null}}function St(u,p,b){var A=u.updateQueue;if(A===null)return null;if(A=A.shared,(si&2)!==0){var D=A.pending;return D===null?p.next=p:(p.next=D.next,D.next=p),A.pending=p,st(u,b)}return D=A.interleaved,D===null?(p.next=p,ut(A)):(p.next=D.next,D.next=p),A.interleaved=p,st(u,b)}function Ht(u,p,b){if(p=p.updateQueue,p!==null&&(p=p.shared,(b&4194240)!==0)){var A=p.lanes;A&=u.pendingLanes,b|=A,p.lanes=b,ie(u,b)}}function Ft(u,p){var b=u.updateQueue,A=u.alternate;if(A!==null&&(A=A.updateQueue,b===A)){var D=null,V=null;if(b=b.firstBaseUpdate,b!==null){do{var re={eventTime:b.eventTime,lane:b.lane,tag:b.tag,payload:b.payload,callback:b.callback,next:null};V===null?D=V=re:V=V.next=re,b=b.next}while(b!==null);V===null?D=V=p:V=V.next=p}else D=V=p;b={baseState:A.baseState,firstBaseUpdate:D,lastBaseUpdate:V,shared:A.shared,effects:A.effects},u.updateQueue=b;return}u=b.lastBaseUpdate,u===null?b.firstBaseUpdate=p:u.next=p,b.lastBaseUpdate=p}function Yt(u,p,b,A){var D=u.updateQueue;Mt=!1;var V=D.firstBaseUpdate,re=D.lastBaseUpdate,De=D.shared.pending;if(De!==null){D.shared.pending=null;var Xe=De,Ct=Xe.next;Xe.next=null,re===null?V=Ct:re.next=Ct,re=Xe;var rn=u.alternate;rn!==null&&(rn=rn.updateQueue,De=rn.lastBaseUpdate,De!==re&&(De===null?rn.firstBaseUpdate=Ct:De.next=Ct,rn.lastBaseUpdate=Xe))}if(V!==null){var on=D.baseState;re=0,rn=Ct=Xe=null,De=V;do{var nn=De.lane,Un=De.eventTime;if((A&nn)===nn){rn!==null&&(rn=rn.next={eventTime:Un,lane:0,tag:De.tag,payload:De.payload,callback:De.callback,next:null});e:{var Jn=u,er=De;switch(nn=p,Un=b,er.tag){case 1:if(Jn=er.payload,typeof Jn=="function"){on=Jn.call(Un,on,nn);break e}on=Jn;break e;case 3:Jn.flags=Jn.flags&-65537|128;case 0:if(Jn=er.payload,nn=typeof Jn=="function"?Jn.call(Un,on,nn):Jn,nn==null)break e;on=je({},on,nn);break e;case 2:Mt=!0}}De.callback!==null&&De.lane!==0&&(u.flags|=64,nn=D.effects,nn===null?D.effects=[De]:nn.push(De))}else Un={eventTime:Un,lane:nn,tag:De.tag,payload:De.payload,callback:De.callback,next:null},rn===null?(Ct=rn=Un,Xe=on):rn=rn.next=Un,re|=nn;if(De=De.next,De===null){if(De=D.shared.pending,De===null)break;nn=De,De=nn.next,nn.next=null,D.lastBaseUpdate=nn,D.shared.pending=null}}while(!0);if(rn===null&&(Xe=on),D.baseState=Xe,D.firstBaseUpdate=Ct,D.lastBaseUpdate=rn,p=D.shared.interleaved,p!==null){D=p;do re|=D.lane,D=D.next;while(D!==p)}else V===null&&(D.shared.lanes=0);Bc|=re,u.lanes=re,u.memoizedState=on}}function $n(u,p,b){if(u=p.effects,p.effects=null,u!==null)for(p=0;p<u.length;p++){var A=u[p],D=A.callback;if(D!==null){if(A.callback=null,A=b,typeof D!="function")throw Error(r(191,D));D.call(A)}}}var mr=new n.Component().refs;function kn(u,p,b,A){p=u.memoizedState,b=b(A,p),b=b==null?p:je({},p,b),u.memoizedState=b,u.lanes===0&&(u.updateQueue.baseState=b)}var Zn={isMounted:function(u){return(u=u._reactInternals)?Ut(u)===u:!1},enqueueSetState:function(u,p,b){u=u._reactInternals;var A=Jo(),D=Nc(u),V=at(A,D);V.payload=p,b!=null&&(V.callback=b),p=St(u,V,D),p!==null&&(ia(p,u,D,A),Ht(p,u,D))},enqueueReplaceState:function(u,p,b){u=u._reactInternals;var A=Jo(),D=Nc(u),V=at(A,D);V.tag=1,V.payload=p,b!=null&&(V.callback=b),p=St(u,V,D),p!==null&&(ia(p,u,D,A),Ht(p,u,D))},enqueueForceUpdate:function(u,p){u=u._reactInternals;var b=Jo(),A=Nc(u),D=at(b,A);D.tag=2,p!=null&&(D.callback=p),p=St(u,D,A),p!==null&&(ia(p,u,A,b),Ht(p,u,A))}};function zr(u,p,b,A,D,V,re){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(A,V,re):p.prototype&&p.prototype.isPureReactComponent?!rl(b,A)||!rl(D,V):!0}function Or(u,p,b){var A=!1,D=cl,V=p.contextType;return typeof V=="object"&&V!==null?V=Je(V):(D=Ho(p)?Ll:Po.current,A=p.contextTypes,V=(A=A!=null)?Io(u,D):cl),p=new p(b,V),u.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Zn,u.stateNode=p,p._reactInternals=u,A&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=D,u.__reactInternalMemoizedMaskedChildContext=V),p}function jn(u,p,b,A){u=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(b,A),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(b,A),p.state!==u&&Zn.enqueueReplaceState(p,p.state,null)}function Jr(u,p,b,A){var D=u.stateNode;D.props=b,D.state=u.memoizedState,D.refs=mr,gt(u);var V=p.contextType;typeof V=="object"&&V!==null?D.context=Je(V):(V=Ho(p)?Ll:Po.current,D.context=Io(u,V)),D.state=u.memoizedState,V=p.getDerivedStateFromProps,typeof V=="function"&&(kn(u,p,V,b),D.state=u.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(p=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),p!==D.state&&Zn.enqueueReplaceState(D,D.state,null),Yt(u,b,D,A),D.state=u.memoizedState),typeof D.componentDidMount=="function"&&(u.flags|=4194308)}function ti(u,p,b){if(u=b.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(b._owner){if(b=b._owner,b){if(b.tag!==1)throw Error(r(309));var A=b.stateNode}if(!A)throw Error(r(147,u));var D=A,V=""+u;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===V?p.ref:(p=function(re){var De=D.refs;De===mr&&(De=D.refs={}),re===null?delete De[V]:De[V]=re},p._stringRef=V,p)}if(typeof u!="string")throw Error(r(284));if(!b._owner)throw Error(r(290,u))}return u}function oi(u,p){throw u=Object.prototype.toString.call(p),Error(r(31,u==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":u))}function di(u){var p=u._init;return p(u._payload)}function Lo(u){function p(_t,nt){if(u){var Et=_t.deletions;Et===null?(_t.deletions=[nt],_t.flags|=16):Et.push(nt)}}function b(_t,nt){if(!u)return null;for(;nt!==null;)p(_t,nt),nt=nt.sibling;return null}function A(_t,nt){for(_t=new Map;nt!==null;)nt.key!==null?_t.set(nt.key,nt):_t.set(nt.index,nt),nt=nt.sibling;return _t}function D(_t,nt){return _t=Uc(_t,nt),_t.index=0,_t.sibling=null,_t}function V(_t,nt,Et){return _t.index=Et,u?(Et=_t.alternate,Et!==null?(Et=Et.index,Et<nt?(_t.flags|=2,nt):Et):(_t.flags|=2,nt)):(_t.flags|=1048576,nt)}function re(_t){return u&&_t.alternate===null&&(_t.flags|=2),_t}function De(_t,nt,Et,dn){return nt===null||nt.tag!==6?(nt=kg(Et,_t.mode,dn),nt.return=_t,nt):(nt=D(nt,Et),nt.return=_t,nt)}function Xe(_t,nt,Et,dn){var tr=Et.type;return tr===Ke?rn(_t,nt,Et.props.children,dn,Et.key):nt!==null&&(nt.elementType===tr||typeof tr=="object"&&tr!==null&&tr.$$typeof===In&&di(tr)===nt.type)?(dn=D(nt,Et.props),dn.ref=ti(_t,nt,Et),dn.return=_t,dn):(dn=Zp(Et.type,Et.key,Et.props,null,_t.mode,dn),dn.ref=ti(_t,nt,Et),dn.return=_t,dn)}function Ct(_t,nt,Et,dn){return nt===null||nt.tag!==4||nt.stateNode.containerInfo!==Et.containerInfo||nt.stateNode.implementation!==Et.implementation?(nt=Pf(Et,_t.mode,dn),nt.return=_t,nt):(nt=D(nt,Et.children||[]),nt.return=_t,nt)}function rn(_t,nt,Et,dn,tr){return nt===null||nt.tag!==7?(nt=Gu(Et,_t.mode,dn,tr),nt.return=_t,nt):(nt=D(nt,Et),nt.return=_t,nt)}function on(_t,nt,Et){if(typeof nt=="string"&&nt!==""||typeof nt=="number")return nt=kg(""+nt,_t.mode,Et),nt.return=_t,nt;if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case Me:return Et=Zp(nt.type,nt.key,nt.props,null,_t.mode,Et),Et.ref=ti(_t,null,nt),Et.return=_t,Et;case Ve:return nt=Pf(nt,_t.mode,Et),nt.return=_t,nt;case In:var dn=nt._init;return on(_t,dn(nt._payload),Et)}if(Br(nt)||Bt(nt))return nt=Gu(nt,_t.mode,Et,null),nt.return=_t,nt;oi(_t,nt)}return null}function nn(_t,nt,Et,dn){var tr=nt!==null?nt.key:null;if(typeof Et=="string"&&Et!==""||typeof Et=="number")return tr!==null?null:De(_t,nt,""+Et,dn);if(typeof Et=="object"&&Et!==null){switch(Et.$$typeof){case Me:return Et.key===tr?Xe(_t,nt,Et,dn):null;case Ve:return Et.key===tr?Ct(_t,nt,Et,dn):null;case In:return tr=Et._init,nn(_t,nt,tr(Et._payload),dn)}if(Br(Et)||Bt(Et))return tr!==null?null:rn(_t,nt,Et,dn,null);oi(_t,Et)}return null}function Un(_t,nt,Et,dn,tr){if(typeof dn=="string"&&dn!==""||typeof dn=="number")return _t=_t.get(Et)||null,De(nt,_t,""+dn,tr);if(typeof dn=="object"&&dn!==null){switch(dn.$$typeof){case Me:return _t=_t.get(dn.key===null?Et:dn.key)||null,Xe(nt,_t,dn,tr);case Ve:return _t=_t.get(dn.key===null?Et:dn.key)||null,Ct(nt,_t,dn,tr);case In:var gr=dn._init;return Un(_t,nt,Et,gr(dn._payload),tr)}if(Br(dn)||Bt(dn))return _t=_t.get(Et)||null,rn(nt,_t,dn,tr,null);oi(nt,dn)}return null}function Jn(_t,nt,Et,dn){for(var tr=null,gr=null,Tr=nt,Dr=nt=0,fo=null;Tr!==null&&Dr<Et.length;Dr++){Tr.index>Dr?(fo=Tr,Tr=null):fo=Tr.sibling;var ri=nn(_t,Tr,Et[Dr],dn);if(ri===null){Tr===null&&(Tr=fo);break}u&&Tr&&ri.alternate===null&&p(_t,Tr),nt=V(ri,nt,Dr),gr===null?tr=ri:gr.sibling=ri,gr=ri,Tr=fo}if(Dr===Et.length)return b(_t,Tr),y&&Na(_t,Dr),tr;if(Tr===null){for(;Dr<Et.length;Dr++)Tr=on(_t,Et[Dr],dn),Tr!==null&&(nt=V(Tr,nt,Dr),gr===null?tr=Tr:gr.sibling=Tr,gr=Tr);return y&&Na(_t,Dr),tr}for(Tr=A(_t,Tr);Dr<Et.length;Dr++)fo=Un(Tr,_t,Dr,Et[Dr],dn),fo!==null&&(u&&fo.alternate!==null&&Tr.delete(fo.key===null?Dr:fo.key),nt=V(fo,nt,Dr),gr===null?tr=fo:gr.sibling=fo,gr=fo);return u&&Tr.forEach(function(ql){return p(_t,ql)}),y&&Na(_t,Dr),tr}function er(_t,nt,Et,dn){var tr=Bt(Et);if(typeof tr!="function")throw Error(r(150));if(Et=tr.call(Et),Et==null)throw Error(r(151));for(var gr=tr=null,Tr=nt,Dr=nt=0,fo=null,ri=Et.next();Tr!==null&&!ri.done;Dr++,ri=Et.next()){Tr.index>Dr?(fo=Tr,Tr=null):fo=Tr.sibling;var ql=nn(_t,Tr,ri.value,dn);if(ql===null){Tr===null&&(Tr=fo);break}u&&Tr&&ql.alternate===null&&p(_t,Tr),nt=V(ql,nt,Dr),gr===null?tr=ql:gr.sibling=ql,gr=ql,Tr=fo}if(ri.done)return b(_t,Tr),y&&Na(_t,Dr),tr;if(Tr===null){for(;!ri.done;Dr++,ri=Et.next())ri=on(_t,ri.value,dn),ri!==null&&(nt=V(ri,nt,Dr),gr===null?tr=ri:gr.sibling=ri,gr=ri);return y&&Na(_t,Dr),tr}for(Tr=A(_t,Tr);!ri.done;Dr++,ri=Et.next())ri=Un(Tr,_t,Dr,ri.value,dn),ri!==null&&(u&&ri.alternate!==null&&Tr.delete(ri.key===null?Dr:ri.key),nt=V(ri,nt,Dr),gr===null?tr=ri:gr.sibling=ri,gr=ri);return u&&Tr.forEach(function(Df){return p(_t,Df)}),y&&Na(_t,Dr),tr}function ho(_t,nt,Et,dn){if(typeof Et=="object"&&Et!==null&&Et.type===Ke&&Et.key===null&&(Et=Et.props.children),typeof Et=="object"&&Et!==null){switch(Et.$$typeof){case Me:e:{for(var tr=Et.key,gr=nt;gr!==null;){if(gr.key===tr){if(tr=Et.type,tr===Ke){if(gr.tag===7){b(_t,gr.sibling),nt=D(gr,Et.props.children),nt.return=_t,_t=nt;break e}}else if(gr.elementType===tr||typeof tr=="object"&&tr!==null&&tr.$$typeof===In&&di(tr)===gr.type){b(_t,gr.sibling),nt=D(gr,Et.props),nt.ref=ti(_t,gr,Et),nt.return=_t,_t=nt;break e}b(_t,gr);break}else p(_t,gr);gr=gr.sibling}Et.type===Ke?(nt=Gu(Et.props.children,_t.mode,dn,Et.key),nt.return=_t,_t=nt):(dn=Zp(Et.type,Et.key,Et.props,null,_t.mode,dn),dn.ref=ti(_t,nt,Et),dn.return=_t,_t=dn)}return re(_t);case Ve:e:{for(gr=Et.key;nt!==null;){if(nt.key===gr)if(nt.tag===4&&nt.stateNode.containerInfo===Et.containerInfo&&nt.stateNode.implementation===Et.implementation){b(_t,nt.sibling),nt=D(nt,Et.children||[]),nt.return=_t,_t=nt;break e}else{b(_t,nt);break}else p(_t,nt);nt=nt.sibling}nt=Pf(Et,_t.mode,dn),nt.return=_t,_t=nt}return re(_t);case In:return gr=Et._init,ho(_t,nt,gr(Et._payload),dn)}if(Br(Et))return Jn(_t,nt,Et,dn);if(Bt(Et))return er(_t,nt,Et,dn);oi(_t,Et)}return typeof Et=="string"&&Et!==""||typeof Et=="number"?(Et=""+Et,nt!==null&&nt.tag===6?(b(_t,nt.sibling),nt=D(nt,Et),nt.return=_t,_t=nt):(b(_t,nt),nt=kg(Et,_t.mode,dn),nt.return=_t,_t=nt),re(_t)):b(_t,nt)}return ho}var qi=Lo(!0),bs=Lo(!1),us={},Qr=Ba(us),ni=Ba(us),Wr=Ba(us);function Ei(u){if(u===us)throw Error(r(174));return u}function Ro(u,p){switch(Ur(Wr,p),Ur(ni,u),Ur(Qr,us),u=p.nodeType,u){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:cr(null,"");break;default:u=u===8?p.parentNode:p,p=u.namespaceURI||null,u=u.tagName,p=cr(p,u)}Pi(Qr),Ur(Qr,p)}function hi(){Pi(Qr),Pi(ni),Pi(Wr)}function Ko(u){Ei(Wr.current);var p=Ei(Qr.current),b=cr(p,u.type);p!==b&&(Ur(ni,u),Ur(Qr,b))}function Ac(u){ni.current===u&&(Pi(Qr),Pi(ni))}var yi=Ba(0);function dl(u){for(var p=u;p!==null;){if(p.tag===13){var b=p.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||b.data==="$?"||b.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var Js=[];function ya(){for(var u=0;u<Js.length;u++)Js[u]._workInProgressVersionPrimary=null;Js.length=0}var va=Ie.ReactCurrentDispatcher,Pc=Ie.ReactCurrentBatchConfig,Qs=0,zi=null,So=null,Oo=null,Cp=!1,ju=!1,Ic=0,s1=0;function $o(){throw Error(r(321))}function Fh(u,p){if(p===null)return!1;for(var b=0;b<p.length&&b<u.length;b++)if(!Os(u[b],p[b]))return!1;return!0}function Fa(u,p,b,A,D,V){if(Qs=V,zi=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,va.current=u===null||u.memoizedState===null?Pp:h1,u=b(A,D),ju){V=0;do{if(ju=!1,Ic=0,25<=V)throw Error(r(301));V+=1,Oo=So=null,p.updateQueue=null,va.current=d1,u=b(A,D)}while(ju)}if(va.current=Wh,p=So!==null&&So.next!==null,Qs=0,Oo=So=zi=null,Cp=!1,p)throw Error(r(300));return u}function Uh(){var u=Ic!==0;return Ic=0,u}function Ua(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Oo===null?zi.memoizedState=Oo=u:Oo=Oo.next=u,Oo}function ea(){if(So===null){var u=zi.alternate;u=u!==null?u.memoizedState:null}else u=So.next;var p=Oo===null?zi.memoizedState:Oo.next;if(p!==null)Oo=p,So=u;else{if(u===null)throw Error(r(310));So=u,u={memoizedState:So.memoizedState,baseState:So.baseState,baseQueue:So.baseQueue,queue:So.queue,next:null},Oo===null?zi.memoizedState=Oo=u:Oo=Oo.next=u}return Oo}function ff(u,p){return typeof p=="function"?p(u):p}function Qm(u){var p=ea(),b=p.queue;if(b===null)throw Error(r(311));b.lastRenderedReducer=u;var A=So,D=A.baseQueue,V=b.pending;if(V!==null){if(D!==null){var re=D.next;D.next=V.next,V.next=re}A.baseQueue=D=V,b.pending=null}if(D!==null){V=D.next,A=A.baseState;var De=re=null,Xe=null,Ct=V;do{var rn=Ct.lane;if((Qs&rn)===rn)Xe!==null&&(Xe=Xe.next={lane:0,action:Ct.action,hasEagerState:Ct.hasEagerState,eagerState:Ct.eagerState,next:null}),A=Ct.hasEagerState?Ct.eagerState:u(A,Ct.action);else{var on={lane:rn,action:Ct.action,hasEagerState:Ct.hasEagerState,eagerState:Ct.eagerState,next:null};Xe===null?(De=Xe=on,re=A):Xe=Xe.next=on,zi.lanes|=rn,Bc|=rn}Ct=Ct.next}while(Ct!==null&&Ct!==V);Xe===null?re=A:Xe.next=De,Os(A,p.memoizedState)||($i=!0),p.memoizedState=A,p.baseState=re,p.baseQueue=Xe,b.lastRenderedState=A}if(u=b.interleaved,u!==null){D=u;do V=D.lane,zi.lanes|=V,Bc|=V,D=D.next;while(D!==u)}else D===null&&(b.lanes=0);return[p.memoizedState,b.dispatch]}function eg(u){var p=ea(),b=p.queue;if(b===null)throw Error(r(311));b.lastRenderedReducer=u;var A=b.dispatch,D=b.pending,V=p.memoizedState;if(D!==null){b.pending=null;var re=D=D.next;do V=u(V,re.action),re=re.next;while(re!==D);Os(V,p.memoizedState)||($i=!0),p.memoizedState=V,p.baseQueue===null&&(p.baseState=V),b.lastRenderedState=V}return[V,A]}function Sp(){}function $h(u,p){var b=zi,A=ea(),D=p(),V=!Os(A.memoizedState,D);if(V&&(A.memoizedState=D,$i=!0),A=A.queue,Ap(xa.bind(null,b,A,u),[u]),A.getSnapshot!==p||V||Oo!==null&&Oo.memoizedState.tag&1){if(b.flags|=2048,pf(9,fl.bind(null,b,A,D,p),void 0,null),ji===null)throw Error(r(349));(Qs&30)!==0||Nu(b,p,D)}return D}function Nu(u,p,b){u.flags|=16384,u={getSnapshot:p,value:b},p=zi.updateQueue,p===null?(p={lastEffect:null,stores:null},zi.updateQueue=p,p.stores=[u]):(b=p.stores,b===null?p.stores=[u]:b.push(u))}function fl(u,p,b,A){p.value=b,p.getSnapshot=A,zl(p)&&Bl(u)}function xa(u,p,b){return b(function(){zl(p)&&Bl(u)})}function zl(u){var p=u.getSnapshot;u=u.value;try{var b=p();return!Os(u,b)}catch{return!0}}function Bl(u){var p=st(u,1);p!==null&&ia(p,u,1,-1)}function Lc(u){var p=Ua();return typeof u=="function"&&(u=u()),p.memoizedState=p.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ff,lastRenderedState:u},p.queue=u,u=u.dispatch=rg.bind(null,zi,u),[p.memoizedState,u]}function pf(u,p,b,A){return u={tag:u,create:p,destroy:b,deps:A,next:null},p=zi.updateQueue,p===null?(p={lastEffect:null,stores:null},zi.updateQueue=p,p.lastEffect=u.next=u):(b=p.lastEffect,b===null?p.lastEffect=u.next=u:(A=b.next,b.next=u,u.next=A,p.lastEffect=u)),u}function a1(){return ea().memoizedState}function kp(u,p,b,A){var D=Ua();zi.flags|=u,D.memoizedState=pf(1|p,b,void 0,A===void 0?null:A)}function Mp(u,p,b,A){var D=ea();A=A===void 0?null:A;var V=void 0;if(So!==null){var re=So.memoizedState;if(V=re.destroy,A!==null&&Fh(A,re.deps)){D.memoizedState=pf(p,b,V,A);return}}zi.flags|=u,D.memoizedState=pf(1|p,b,V,A)}function tg(u,p){return kp(8390656,8,u,p)}function Ap(u,p){return Mp(2048,8,u,p)}function wa(u,p){return Mp(4,2,u,p)}function l1(u,p){return Mp(4,4,u,p)}function c1(u,p){if(typeof p=="function")return u=u(),p(u),function(){p(null)};if(p!=null)return u=u(),p.current=u,function(){p.current=null}}function Ji(u,p,b){return b=b!=null?b.concat([u]):null,Mp(4,4,c1.bind(null,p,u),b)}function Wn(){}function jl(u,p){var b=ea();p=p===void 0?null:p;var A=b.memoizedState;return A!==null&&p!==null&&Fh(p,A[1])?A[0]:(b.memoizedState=[u,p],u)}function mf(u,p){var b=ea();p=p===void 0?null:p;var A=b.memoizedState;return A!==null&&p!==null&&Fh(p,A[1])?A[0]:(u=u(),b.memoizedState=[u,p],u)}function Es(u,p,b){return(Qs&21)===0?(u.baseState&&(u.baseState=!1,$i=!0),u.memoizedState=b):(Os(b,p)||(b=yr(),zi.lanes|=b,Bc|=b,u.baseState=!0),p)}function u1(u,p){var b=ae;ae=b!==0&&4>b?b:4,u(!0);var A=Pc.transition;Pc.transition={};try{u(!1),p()}finally{ae=b,Pc.transition=A}}function ng(){return ea().memoizedState}function $a(u,p,b){var A=Nc(u);if(b={lane:A,action:b,hasEagerState:!1,eagerState:null,next:null},Rc(u))Vh(p,b);else if(b=Kt(u,p,b,A),b!==null){var D=Jo();ia(b,u,A,D),Oc(b,p,A)}}function rg(u,p,b){var A=Nc(u),D={lane:A,action:b,hasEagerState:!1,eagerState:null,next:null};if(Rc(u))Vh(p,D);else{var V=u.alternate;if(u.lanes===0&&(V===null||V.lanes===0)&&(V=p.lastRenderedReducer,V!==null))try{var re=p.lastRenderedState,De=V(re,b);if(D.hasEagerState=!0,D.eagerState=De,Os(De,re)){var Xe=p.interleaved;Xe===null?(D.next=D,ut(p)):(D.next=Xe.next,Xe.next=D),p.interleaved=D;return}}catch{}finally{}b=Kt(u,p,D,A),b!==null&&(D=Jo(),ia(b,u,A,D),Oc(b,p,A))}}function Rc(u){var p=u.alternate;return u===zi||p!==null&&p===zi}function Vh(u,p){ju=Cp=!0;var b=u.pending;b===null?p.next=p:(p.next=b.next,b.next=p),u.pending=p}function Oc(u,p,b){if((b&4194240)!==0){var A=p.lanes;A&=u.pendingLanes,b|=A,p.lanes=b,ie(u,b)}}var Wh={readContext:Je,useCallback:$o,useContext:$o,useEffect:$o,useImperativeHandle:$o,useInsertionEffect:$o,useLayoutEffect:$o,useMemo:$o,useReducer:$o,useRef:$o,useState:$o,useDebugValue:$o,useDeferredValue:$o,useTransition:$o,useMutableSource:$o,useSyncExternalStore:$o,useId:$o,unstable_isNewReconciler:!1},Pp={readContext:Je,useCallback:function(u,p){return Ua().memoizedState=[u,p===void 0?null:p],u},useContext:Je,useEffect:tg,useImperativeHandle:function(u,p,b){return b=b!=null?b.concat([u]):null,kp(4194308,4,c1.bind(null,p,u),b)},useLayoutEffect:function(u,p){return kp(4194308,4,u,p)},useInsertionEffect:function(u,p){return kp(4,2,u,p)},useMemo:function(u,p){var b=Ua();return p=p===void 0?null:p,u=u(),b.memoizedState=[u,p],u},useReducer:function(u,p,b){var A=Ua();return p=b!==void 0?b(p):p,A.memoizedState=A.baseState=p,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:p},A.queue=u,u=u.dispatch=$a.bind(null,zi,u),[A.memoizedState,u]},useRef:function(u){var p=Ua();return u={current:u},p.memoizedState=u},useState:Lc,useDebugValue:Wn,useDeferredValue:function(u){return Ua().memoizedState=u},useTransition:function(){var u=Lc(!1),p=u[0];return u=u1.bind(null,u[1]),Ua().memoizedState=u,[p,u]},useMutableSource:function(){},useSyncExternalStore:function(u,p,b){var A=zi,D=Ua();if(y){if(b===void 0)throw Error(r(407));b=b()}else{if(b=p(),ji===null)throw Error(r(349));(Qs&30)!==0||Nu(A,p,b)}D.memoizedState=b;var V={value:b,getSnapshot:p};return D.queue=V,tg(xa.bind(null,A,V,u),[u]),A.flags|=2048,pf(9,fl.bind(null,A,V,b,p),void 0,null),b},useId:function(){var u=Ua(),p=ji.identifierPrefix;if(y){var b=Ys,A=ja;b=(A&~(1<<32-Dt(A)-1)).toString(32)+b,p=":"+p+"R"+b,b=Ic++,0<b&&(p+="H"+b.toString(32)),p+=":"}else b=s1++,p=":"+p+"r"+b.toString(32)+":";return u.memoizedState=p},unstable_isNewReconciler:!1},h1={readContext:Je,useCallback:jl,useContext:Je,useEffect:Ap,useImperativeHandle:Ji,useInsertionEffect:wa,useLayoutEffect:l1,useMemo:mf,useReducer:Qm,useRef:a1,useState:function(){return Qm(ff)},useDebugValue:Wn,useDeferredValue:function(u){var p=ea();return Es(p,So.memoizedState,u)},useTransition:function(){var u=Qm(ff)[0],p=ea().memoizedState;return[u,p]},useMutableSource:Sp,useSyncExternalStore:$h,useId:ng,unstable_isNewReconciler:!1},d1={readContext:Je,useCallback:jl,useContext:Je,useEffect:Ap,useImperativeHandle:Ji,useInsertionEffect:wa,useLayoutEffect:l1,useMemo:mf,useReducer:eg,useRef:a1,useState:function(){return eg(ff)},useDebugValue:Wn,useDeferredValue:function(u){var p=ea();return So===null?p.memoizedState=u:Es(p,So.memoizedState,u)},useTransition:function(){var u=eg(ff)[0],p=ea().memoizedState;return[u,p]},useMutableSource:Sp,useSyncExternalStore:$h,useId:ng,unstable_isNewReconciler:!1};function qh(u,p){try{var b="",A=p;do b+=Mn(A),A=A.return;while(A);var D=b}catch(V){D=`
Error generating stack: `+V.message+`
`+V.stack}return{value:u,source:p,stack:D,digest:null}}function gf(u,p,b){return{value:u,source:null,stack:b??null,digest:p??null}}function Ip(u,p){try{console.error(p.value)}catch(b){setTimeout(function(){throw b})}}var _f=typeof WeakMap=="function"?WeakMap:Map;function Fu(u,p,b){b=at(-1,b),b.tag=3,b.payload={element:null};var A=p.value;return b.callback=function(){Up||(Up=!0,Wa=A),Ip(u,p)},b}function pl(u,p,b){b=at(-1,b),b.tag=3;var A=u.type.getDerivedStateFromError;if(typeof A=="function"){var D=p.value;b.payload=function(){return A(D)},b.callback=function(){Ip(u,p)}}var V=u.stateNode;return V!==null&&typeof V.componentDidCatch=="function"&&(b.callback=function(){Ip(u,p),typeof A!="function"&&(js===null?js=new Set([this]):js.add(this));var re=p.stack;this.componentDidCatch(p.value,{componentStack:re!==null?re:""})}),b}function Lp(u,p,b){var A=u.pingCache;if(A===null){A=u.pingCache=new _f;var D=new Set;A.set(p,D)}else D=A.get(p),D===void 0&&(D=new Set,A.set(p,D));D.has(b)||(D.add(b),u=Dy.bind(null,u,p,b),p.then(u,u))}function ig(u){do{var p;if((p=u.tag===13)&&(p=u.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return u;u=u.return}while(u!==null);return null}function Gh(u,p,b,A,D){return(u.mode&1)===0?(u===p?u.flags|=65536:(u.flags|=128,b.flags|=131072,b.flags&=-52805,b.tag===1&&(b.alternate===null?b.tag=17:(p=at(-1,1),p.tag=2,St(b,p,1))),b.lanes|=1),u):(u.flags|=65536,u.lanes=D,u)}var yf=Ie.ReactCurrentOwner,$i=!1;function Do(u,p,b,A){p.child=u===null?bs(p,null,b,A):qi(p,u.child,b,A)}function Xo(u,p,b,A,D){b=b.render;var V=p.ref;return Ne(p,D),A=Fa(u,p,b,A,V,D),b=Uh(),u!==null&&!$i?(p.updateQueue=u.updateQueue,p.flags&=-2053,u.lanes&=~D,na(u,p,D)):(y&&b&&hl(p),p.flags|=1,Do(u,p,A,D),p.child)}function ta(u,p,b,A,D){if(u===null){var V=b.type;return typeof V=="function"&&!Sg(V)&&V.defaultProps===void 0&&b.compare===null&&b.defaultProps===void 0?(p.tag=15,p.type=V,Rp(u,p,V,A,D)):(u=Zp(b.type,null,A,p,p.mode,D),u.ref=p.ref,u.return=p,p.child=u)}if(V=u.child,(u.lanes&D)===0){var re=V.memoizedProps;if(b=b.compare,b=b!==null?b:rl,b(re,A)&&u.ref===p.ref)return na(u,p,D)}return p.flags|=1,u=Uc(V,A),u.ref=p.ref,u.return=p,p.child=u}function Rp(u,p,b,A,D){if(u!==null){var V=u.memoizedProps;if(rl(V,A)&&u.ref===p.ref)if($i=!1,p.pendingProps=A=V,(u.lanes&D)!==0)(u.flags&131072)!==0&&($i=!0);else return p.lanes=u.lanes,na(u,p,D)}return Uu(u,p,b,A,D)}function Gi(u,p,b){var A=p.pendingProps,D=A.children,V=u!==null?u.memoizedState:null;if(A.mode==="hidden")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ur(io,Hi),Hi|=b;else{if((b&1073741824)===0)return u=V!==null?V.baseLanes|b:b,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:u,cachePool:null,transitions:null},p.updateQueue=null,Ur(io,Hi),Hi|=u,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},A=V!==null?V.baseLanes:b,Ur(io,Hi),Hi|=A}else V!==null?(A=V.baseLanes|b,p.memoizedState=null):A=b,Ur(io,Hi),Hi|=A;return Do(u,p,D,b),p.child}function og(u,p){var b=p.ref;(u===null&&b!==null||u!==null&&u.ref!==b)&&(p.flags|=512,p.flags|=2097152)}function Uu(u,p,b,A,D){var V=Ho(b)?Ll:Po.current;return V=Io(p,V),Ne(p,D),b=Fa(u,p,b,A,V,D),A=Uh(),u!==null&&!$i?(p.updateQueue=u.updateQueue,p.flags&=-2053,u.lanes&=~D,na(u,p,D)):(y&&A&&hl(p),p.flags|=1,Do(u,p,b,D),p.child)}function ba(u,p,b,A,D){if(Ho(b)){var V=!0;_a(p)}else V=!1;if(Ne(p,D),p.stateNode===null)xf(u,p),Or(p,b,A),Jr(p,b,A,D),A=!0;else if(u===null){var re=p.stateNode,De=p.memoizedProps;re.props=De;var Xe=re.context,Ct=b.contextType;typeof Ct=="object"&&Ct!==null?Ct=Je(Ct):(Ct=Ho(b)?Ll:Po.current,Ct=Io(p,Ct));var rn=b.getDerivedStateFromProps,on=typeof rn=="function"||typeof re.getSnapshotBeforeUpdate=="function";on||typeof re.UNSAFE_componentWillReceiveProps!="function"&&typeof re.componentWillReceiveProps!="function"||(De!==A||Xe!==Ct)&&jn(p,re,A,Ct),Mt=!1;var nn=p.memoizedState;re.state=nn,Yt(p,A,re,D),Xe=p.memoizedState,De!==A||nn!==Xe||cs.current||Mt?(typeof rn=="function"&&(kn(p,b,rn,A),Xe=p.memoizedState),(De=Mt||zr(p,b,De,A,nn,Xe,Ct))?(on||typeof re.UNSAFE_componentWillMount!="function"&&typeof re.componentWillMount!="function"||(typeof re.componentWillMount=="function"&&re.componentWillMount(),typeof re.UNSAFE_componentWillMount=="function"&&re.UNSAFE_componentWillMount()),typeof re.componentDidMount=="function"&&(p.flags|=4194308)):(typeof re.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=A,p.memoizedState=Xe),re.props=A,re.state=Xe,re.context=Ct,A=De):(typeof re.componentDidMount=="function"&&(p.flags|=4194308),A=!1)}else{re=p.stateNode,Zt(u,p),De=p.memoizedProps,Ct=p.type===p.elementType?De:fe(p.type,De),re.props=Ct,on=p.pendingProps,nn=re.context,Xe=b.contextType,typeof Xe=="object"&&Xe!==null?Xe=Je(Xe):(Xe=Ho(b)?Ll:Po.current,Xe=Io(p,Xe));var Un=b.getDerivedStateFromProps;(rn=typeof Un=="function"||typeof re.getSnapshotBeforeUpdate=="function")||typeof re.UNSAFE_componentWillReceiveProps!="function"&&typeof re.componentWillReceiveProps!="function"||(De!==on||nn!==Xe)&&jn(p,re,A,Xe),Mt=!1,nn=p.memoizedState,re.state=nn,Yt(p,A,re,D);var Jn=p.memoizedState;De!==on||nn!==Jn||cs.current||Mt?(typeof Un=="function"&&(kn(p,b,Un,A),Jn=p.memoizedState),(Ct=Mt||zr(p,b,Ct,A,nn,Jn,Xe)||!1)?(rn||typeof re.UNSAFE_componentWillUpdate!="function"&&typeof re.componentWillUpdate!="function"||(typeof re.componentWillUpdate=="function"&&re.componentWillUpdate(A,Jn,Xe),typeof re.UNSAFE_componentWillUpdate=="function"&&re.UNSAFE_componentWillUpdate(A,Jn,Xe)),typeof re.componentDidUpdate=="function"&&(p.flags|=4),typeof re.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof re.componentDidUpdate!="function"||De===u.memoizedProps&&nn===u.memoizedState||(p.flags|=4),typeof re.getSnapshotBeforeUpdate!="function"||De===u.memoizedProps&&nn===u.memoizedState||(p.flags|=1024),p.memoizedProps=A,p.memoizedState=Jn),re.props=A,re.state=Jn,re.context=Xe,A=Ct):(typeof re.componentDidUpdate!="function"||De===u.memoizedProps&&nn===u.memoizedState||(p.flags|=4),typeof re.getSnapshotBeforeUpdate!="function"||De===u.memoizedProps&&nn===u.memoizedState||(p.flags|=1024),A=!1)}return sg(u,p,b,A,V,D)}function sg(u,p,b,A,D,V){og(u,p);var re=(p.flags&128)!==0;if(!A&&!re)return D&&Du(p,b,!1),na(u,p,V);A=p.stateNode,yf.current=p;var De=re&&typeof b.getDerivedStateFromError!="function"?null:A.render();return p.flags|=1,u!==null&&re?(p.child=qi(p,u.child,null,V),p.child=qi(p,null,De,V)):Do(u,p,De,V),p.memoizedState=A.state,D&&Du(p,b,!0),p.child}function f1(u){var p=u.stateNode;p.pendingContext?zs(u,p.pendingContext,p.pendingContext!==p.context):p.context&&zs(u,p.context,!1),Ro(u,p.containerInfo)}function ag(u,p,b,A,D){return oe(),de(D),p.flags|=256,Do(u,p,b,A),p.child}var Op={dehydrated:null,treeContext:null,retryLane:0};function Nl(u){return{baseLanes:u,cachePool:null,transitions:null}}function lg(u,p,b){var A=p.pendingProps,D=yi.current,V=!1,re=(p.flags&128)!==0,De;if((De=re)||(De=u!==null&&u.memoizedState===null?!1:(D&2)!==0),De?(V=!0,p.flags&=-129):(u===null||u.memoizedState!==null)&&(D|=1),Ur(yi,D&1),u===null)return O(p),u=p.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((p.mode&1)===0?p.lanes=1:u.data==="$!"?p.lanes=8:p.lanes=1073741824,null):(re=A.children,u=A.fallback,V?(A=p.mode,V=p.child,re={mode:"hidden",children:re},(A&1)===0&&V!==null?(V.childLanes=0,V.pendingProps=re):V=Hp(re,A,0,null),u=Gu(u,A,b,null),V.return=p,u.return=p,V.sibling=u,p.child=V,p.child.memoizedState=Nl(b),p.memoizedState=Op,u):Dp(p,re));if(D=u.memoizedState,D!==null&&(De=D.dehydrated,De!==null))return p1(u,p,re,A,De,D,b);if(V){V=A.fallback,re=p.mode,D=u.child,De=D.sibling;var Xe={mode:"hidden",children:A.children};return(re&1)===0&&p.child!==D?(A=p.child,A.childLanes=0,A.pendingProps=Xe,p.deletions=null):(A=Uc(D,Xe),A.subtreeFlags=D.subtreeFlags&14680064),De!==null?V=Uc(De,V):(V=Gu(V,re,b,null),V.flags|=2),V.return=p,A.return=p,A.sibling=V,p.child=A,A=V,V=p.child,re=u.child.memoizedState,re=re===null?Nl(b):{baseLanes:re.baseLanes|b,cachePool:null,transitions:re.transitions},V.memoizedState=re,V.childLanes=u.childLanes&~b,p.memoizedState=Op,A}return V=u.child,u=V.sibling,A=Uc(V,{mode:"visible",children:A.children}),(p.mode&1)===0&&(A.lanes=b),A.return=p,A.sibling=null,u!==null&&(b=p.deletions,b===null?(p.deletions=[u],p.flags|=16):b.push(u)),p.child=A,p.memoizedState=null,A}function Dp(u,p){return p=Hp({mode:"visible",children:p},u.mode,0,null),p.return=u,u.child=p}function vf(u,p,b,A){return A!==null&&de(A),qi(p,u.child,null,b),u=Dp(p,p.pendingProps.children),u.flags|=2,p.memoizedState=null,u}function p1(u,p,b,A,D,V,re){if(b)return p.flags&256?(p.flags&=-257,A=gf(Error(r(422))),vf(u,p,re,A)):p.memoizedState!==null?(p.child=u.child,p.flags|=128,null):(V=A.fallback,D=p.mode,A=Hp({mode:"visible",children:A.children},D,0,null),V=Gu(V,D,re,null),V.flags|=2,A.return=p,V.return=p,A.sibling=V,p.child=A,(p.mode&1)!==0&&qi(p,u.child,null,re),p.child.memoizedState=Nl(re),p.memoizedState=Op,V);if((p.mode&1)===0)return vf(u,p,re,null);if(D.data==="$!"){if(A=D.nextSibling&&D.nextSibling.dataset,A)var De=A.dgst;return A=De,V=Error(r(419)),A=gf(V,A,void 0),vf(u,p,re,A)}if(De=(re&u.childLanes)!==0,$i||De){if(A=ji,A!==null){switch(re&-re){case 4:D=2;break;case 16:D=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:D=32;break;case 536870912:D=268435456;break;default:D=0}D=(D&(A.suspendedLanes|re))!==0?0:D,D!==0&&D!==V.retryLane&&(V.retryLane=D,st(u,D),ia(A,u,D,-1))}return qp(),A=gf(Error(r(421))),vf(u,p,re,A)}return D.data==="$?"?(p.flags|=128,p.child=u.child,p=zy.bind(null,u),D._reactRetry=p,null):(u=V.treeContext,h=ga(D.nextSibling),s=p,y=!0,w=null,u!==null&&(xs[ws++]=ja,xs[ws++]=Ys,xs[ws++]=Dl,ja=u.id,Ys=u.overflow,Dl=p),p=Dp(p,A.children),p.flags|=4096,p)}function m1(u,p,b){u.lanes|=p;var A=u.alternate;A!==null&&(A.lanes|=p),$e(u.return,p,b)}function cg(u,p,b,A,D){var V=u.memoizedState;V===null?u.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:A,tail:b,tailMode:D}:(V.isBackwards=p,V.rendering=null,V.renderingStartTime=0,V.last=A,V.tail=b,V.tailMode=D)}function ug(u,p,b){var A=p.pendingProps,D=A.revealOrder,V=A.tail;if(Do(u,p,A.children,b),A=yi.current,(A&2)!==0)A=A&1|2,p.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=p.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&m1(u,b,p);else if(u.tag===19)m1(u,b,p);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===p)break e;for(;u.sibling===null;){if(u.return===null||u.return===p)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}A&=1}if(Ur(yi,A),(p.mode&1)===0)p.memoizedState=null;else switch(D){case"forwards":for(b=p.child,D=null;b!==null;)u=b.alternate,u!==null&&dl(u)===null&&(D=b),b=b.sibling;b=D,b===null?(D=p.child,p.child=null):(D=b.sibling,b.sibling=null),cg(p,!1,D,b,V);break;case"backwards":for(b=null,D=p.child,p.child=null;D!==null;){if(u=D.alternate,u!==null&&dl(u)===null){p.child=D;break}u=D.sibling,D.sibling=b,b=D,D=u}cg(p,!0,b,null,V);break;case"together":cg(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function xf(u,p){(p.mode&1)===0&&u!==null&&(u.alternate=null,p.alternate=null,p.flags|=2)}function na(u,p,b){if(u!==null&&(p.dependencies=u.dependencies),Bc|=p.lanes,(b&p.childLanes)===0)return null;if(u!==null&&p.child!==u.child)throw Error(r(153));if(p.child!==null){for(u=p.child,b=Uc(u,u.pendingProps),p.child=b,b.return=p;u.sibling!==null;)u=u.sibling,b=b.sibling=Uc(u,u.pendingProps),b.return=p;b.sibling=null}return p.child}function hg(u,p,b){switch(p.tag){case 3:f1(p),oe();break;case 5:Ko(p);break;case 1:Ho(p.type)&&_a(p);break;case 4:Ro(p,p.stateNode.containerInfo);break;case 10:var A=p.type._context,D=p.memoizedProps.value;Ur(ye,A._currentValue),A._currentValue=D;break;case 13:if(A=p.memoizedState,A!==null)return A.dehydrated!==null?(Ur(yi,yi.current&1),p.flags|=128,null):(b&p.child.childLanes)!==0?lg(u,p,b):(Ur(yi,yi.current&1),u=na(u,p,b),u!==null?u.sibling:null);Ur(yi,yi.current&1);break;case 19:if(A=(b&p.childLanes)!==0,(u.flags&128)!==0){if(A)return ug(u,p,b);p.flags|=128}if(D=p.memoizedState,D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),Ur(yi,yi.current),A)break;return null;case 22:case 23:return p.lanes=0,Gi(u,p,b)}return na(u,p,b)}var zp,wf,Yo,Bp;zp=function(u,p){for(var b=p.child;b!==null;){if(b.tag===5||b.tag===6)u.appendChild(b.stateNode);else if(b.tag!==4&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===p)break;for(;b.sibling===null;){if(b.return===null||b.return===p)return;b=b.return}b.sibling.return=b.return,b=b.sibling}},wf=function(){},Yo=function(u,p,b,A){var D=u.memoizedProps;if(D!==A){u=p.stateNode,Ei(Qr.current);var V=null;switch(b){case"input":D=An(u,D),A=An(u,A),V=[];break;case"select":D=je({},D,{value:void 0}),A=je({},A,{value:void 0}),V=[];break;case"textarea":D=gi(u,D),A=gi(u,A),V=[];break;default:typeof D.onClick!="function"&&typeof A.onClick=="function"&&(u.onclick=wc)}Ao(b,A);var re;b=null;for(Ct in D)if(!A.hasOwnProperty(Ct)&&D.hasOwnProperty(Ct)&&D[Ct]!=null)if(Ct==="style"){var De=D[Ct];for(re in De)De.hasOwnProperty(re)&&(b||(b={}),b[re]="")}else Ct!=="dangerouslySetInnerHTML"&&Ct!=="children"&&Ct!=="suppressContentEditableWarning"&&Ct!=="suppressHydrationWarning"&&Ct!=="autoFocus"&&(d.hasOwnProperty(Ct)?V||(V=[]):(V=V||[]).push(Ct,null));for(Ct in A){var Xe=A[Ct];if(De=D?.[Ct],A.hasOwnProperty(Ct)&&Xe!==De&&(Xe!=null||De!=null))if(Ct==="style")if(De){for(re in De)!De.hasOwnProperty(re)||Xe&&Xe.hasOwnProperty(re)||(b||(b={}),b[re]="");for(re in Xe)Xe.hasOwnProperty(re)&&De[re]!==Xe[re]&&(b||(b={}),b[re]=Xe[re])}else b||(V||(V=[]),V.push(Ct,b)),b=Xe;else Ct==="dangerouslySetInnerHTML"?(Xe=Xe?Xe.__html:void 0,De=De?De.__html:void 0,Xe!=null&&De!==Xe&&(V=V||[]).push(Ct,Xe)):Ct==="children"?typeof Xe!="string"&&typeof Xe!="number"||(V=V||[]).push(Ct,""+Xe):Ct!=="suppressContentEditableWarning"&&Ct!=="suppressHydrationWarning"&&(d.hasOwnProperty(Ct)?(Xe!=null&&Ct==="onScroll"&&pi("scroll",u),V||De===Xe||(V=[])):(V=V||[]).push(Ct,Xe))}b&&(V=V||[]).push("style",b);var Ct=V;(p.updateQueue=Ct)&&(p.flags|=4)}},Bp=function(u,p,b,A){b!==A&&(p.flags|=4)};function Zh(u,p){if(!y)switch(u.tailMode){case"hidden":p=u.tail;for(var b=null;p!==null;)p.alternate!==null&&(b=p),p=p.sibling;b===null?u.tail=null:b.sibling=null;break;case"collapsed":b=u.tail;for(var A=null;b!==null;)b.alternate!==null&&(A=b),b=b.sibling;A===null?p||u.tail===null?u.tail=null:u.tail.sibling=null:A.sibling=null}}function Zi(u){var p=u.alternate!==null&&u.alternate.child===u.child,b=0,A=0;if(p)for(var D=u.child;D!==null;)b|=D.lanes|D.childLanes,A|=D.subtreeFlags&14680064,A|=D.flags&14680064,D.return=u,D=D.sibling;else for(D=u.child;D!==null;)b|=D.lanes|D.childLanes,A|=D.subtreeFlags,A|=D.flags,D.return=u,D=D.sibling;return u.subtreeFlags|=A,u.childLanes=b,p}function Ly(u,p,b){var A=p.pendingProps;switch(g(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zi(p),null;case 1:return Ho(p.type)&&jh(),Zi(p),null;case 3:return A=p.stateNode,hi(),Pi(cs),Pi(Po),ya(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(u===null||u.child===null)&&(U(p)?p.flags|=4:u===null||u.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,w!==null&&(Vp(w),w=null))),wf(u,p),Zi(p),null;case 5:Ac(p);var D=Ei(Wr.current);if(b=p.type,u!==null&&p.stateNode!=null)Yo(u,p,b,A,D),u.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!A){if(p.stateNode===null)throw Error(r(166));return Zi(p),null}if(u=Ei(Qr.current),U(p)){A=p.stateNode,b=p.type;var V=p.memoizedProps;switch(A[as]=p,A[za]=V,u=(p.mode&1)!==0,b){case"dialog":pi("cancel",A),pi("close",A);break;case"iframe":case"object":case"embed":pi("load",A);break;case"video":case"audio":for(D=0;D<vs.length;D++)pi(vs[D],A);break;case"source":pi("error",A);break;case"img":case"image":case"link":pi("error",A),pi("load",A);break;case"details":pi("toggle",A);break;case"input":Fn(A,V),pi("invalid",A);break;case"select":A._wrapperState={wasMultiple:!!V.multiple},pi("invalid",A);break;case"textarea":Xi(A,V),pi("invalid",A)}Ao(b,V),D=null;for(var re in V)if(V.hasOwnProperty(re)){var De=V[re];re==="children"?typeof De=="string"?A.textContent!==De&&(V.suppressHydrationWarning!==!0&&Pl(A.textContent,De,u),D=["children",De]):typeof De=="number"&&A.textContent!==""+De&&(V.suppressHydrationWarning!==!0&&Pl(A.textContent,De,u),D=["children",""+De]):d.hasOwnProperty(re)&&De!=null&&re==="onScroll"&&pi("scroll",A)}switch(b){case"input":Nt(A),nr(A,V,!0);break;case"textarea":Nt(A),dr(A);break;case"select":case"option":break;default:typeof V.onClick=="function"&&(A.onclick=wc)}A=D,p.updateQueue=A,A!==null&&(p.flags|=4)}else{re=D.nodeType===9?D:D.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=Nr(b)),u==="http://www.w3.org/1999/xhtml"?b==="script"?(u=re.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof A.is=="string"?u=re.createElement(b,{is:A.is}):(u=re.createElement(b),b==="select"&&(re=u,A.multiple?re.multiple=!0:A.size&&(re.size=A.size))):u=re.createElementNS(u,b),u[as]=p,u[za]=A,zp(u,p,!1,!1),p.stateNode=u;e:{switch(re=Fo(b,A),b){case"dialog":pi("cancel",u),pi("close",u),D=A;break;case"iframe":case"object":case"embed":pi("load",u),D=A;break;case"video":case"audio":for(D=0;D<vs.length;D++)pi(vs[D],u);D=A;break;case"source":pi("error",u),D=A;break;case"img":case"image":case"link":pi("error",u),pi("load",u),D=A;break;case"details":pi("toggle",u),D=A;break;case"input":Fn(u,A),D=An(u,A),pi("invalid",u);break;case"option":D=A;break;case"select":u._wrapperState={wasMultiple:!!A.multiple},D=je({},A,{value:void 0}),pi("invalid",u);break;case"textarea":Xi(u,A),D=gi(u,A),pi("invalid",u);break;default:D=A}Ao(b,D),De=D;for(V in De)if(De.hasOwnProperty(V)){var Xe=De[V];V==="style"?ao(u,Xe):V==="dangerouslySetInnerHTML"?(Xe=Xe?Xe.__html:void 0,Xe!=null&&Oi(u,Xe)):V==="children"?typeof Xe=="string"?(b!=="textarea"||Xe!=="")&&Di(u,Xe):typeof Xe=="number"&&Di(u,""+Xe):V!=="suppressContentEditableWarning"&&V!=="suppressHydrationWarning"&&V!=="autoFocus"&&(d.hasOwnProperty(V)?Xe!=null&&V==="onScroll"&&pi("scroll",u):Xe!=null&&_e(u,V,Xe,re))}switch(b){case"input":Nt(u),nr(u,A,!1);break;case"textarea":Nt(u),dr(u);break;case"option":A.value!=null&&u.setAttribute("value",""+mt(A.value));break;case"select":u.multiple=!!A.multiple,V=A.value,V!=null?ui(u,!!A.multiple,V,!1):A.defaultValue!=null&&ui(u,!!A.multiple,A.defaultValue,!0);break;default:typeof D.onClick=="function"&&(u.onclick=wc)}switch(b){case"button":case"input":case"select":case"textarea":A=!!A.autoFocus;break e;case"img":A=!0;break e;default:A=!1}}A&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return Zi(p),null;case 6:if(u&&p.stateNode!=null)Bp(u,p,u.memoizedProps,A);else{if(typeof A!="string"&&p.stateNode===null)throw Error(r(166));if(b=Ei(Wr.current),Ei(Qr.current),U(p)){if(A=p.stateNode,b=p.memoizedProps,A[as]=p,(V=A.nodeValue!==b)&&(u=s,u!==null))switch(u.tag){case 3:Pl(A.nodeValue,b,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&Pl(A.nodeValue,b,(u.mode&1)!==0)}V&&(p.flags|=4)}else A=(b.nodeType===9?b:b.ownerDocument).createTextNode(A),A[as]=p,p.stateNode=A}return Zi(p),null;case 13:if(Pi(yi),A=p.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(y&&h!==null&&(p.mode&1)!==0&&(p.flags&128)===0)H(),oe(),p.flags|=98560,V=!1;else if(V=U(p),A!==null&&A.dehydrated!==null){if(u===null){if(!V)throw Error(r(318));if(V=p.memoizedState,V=V!==null?V.dehydrated:null,!V)throw Error(r(317));V[as]=p}else oe(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;Zi(p),V=!1}else w!==null&&(Vp(w),w=null),V=!0;if(!V)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=b,p):(A=A!==null,A!==(u!==null&&u.memoizedState!==null)&&A&&(p.child.flags|=8192,(p.mode&1)!==0&&(u===null||(yi.current&1)!==0?ko===0&&(ko=3):qp())),p.updateQueue!==null&&(p.flags|=4),Zi(p),null);case 4:return hi(),wf(u,p),u===null&&Oa(p.stateNode.containerInfo),Zi(p),null;case 10:return Fe(p.type._context),Zi(p),null;case 17:return Ho(p.type)&&jh(),Zi(p),null;case 19:if(Pi(yi),V=p.memoizedState,V===null)return Zi(p),null;if(A=(p.flags&128)!==0,re=V.rendering,re===null)if(A)Zh(V,!1);else{if(ko!==0||u!==null&&(u.flags&128)!==0)for(u=p.child;u!==null;){if(re=dl(u),re!==null){for(p.flags|=128,Zh(V,!1),A=re.updateQueue,A!==null&&(p.updateQueue=A,p.flags|=4),p.subtreeFlags=0,A=b,b=p.child;b!==null;)V=b,u=A,V.flags&=14680066,re=V.alternate,re===null?(V.childLanes=0,V.lanes=u,V.child=null,V.subtreeFlags=0,V.memoizedProps=null,V.memoizedState=null,V.updateQueue=null,V.dependencies=null,V.stateNode=null):(V.childLanes=re.childLanes,V.lanes=re.lanes,V.child=re.child,V.subtreeFlags=0,V.deletions=null,V.memoizedProps=re.memoizedProps,V.memoizedState=re.memoizedState,V.updateQueue=re.updateQueue,V.type=re.type,u=re.dependencies,V.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),b=b.sibling;return Ur(yi,yi.current&1|2),p.child}u=u.sibling}V.tail!==null&&On()>jc&&(p.flags|=128,A=!0,Zh(V,!1),p.lanes=4194304)}else{if(!A)if(u=dl(re),u!==null){if(p.flags|=128,A=!0,b=u.updateQueue,b!==null&&(p.updateQueue=b,p.flags|=4),Zh(V,!0),V.tail===null&&V.tailMode==="hidden"&&!re.alternate&&!y)return Zi(p),null}else 2*On()-V.renderingStartTime>jc&&b!==1073741824&&(p.flags|=128,A=!0,Zh(V,!1),p.lanes=4194304);V.isBackwards?(re.sibling=p.child,p.child=re):(b=V.last,b!==null?b.sibling=re:p.child=re,V.last=re)}return V.tail!==null?(p=V.tail,V.rendering=p,V.tail=p.sibling,V.renderingStartTime=On(),p.sibling=null,b=yi.current,Ur(yi,A?b&1|2:b&1),p):(Zi(p),null);case 22:case 23:return xg(),A=p.memoizedState!==null,u!==null&&u.memoizedState!==null!==A&&(p.flags|=8192),A&&(p.mode&1)!==0?(Hi&1073741824)!==0&&(Zi(p),p.subtreeFlags&6&&(p.flags|=8192)):Zi(p),null;case 24:return null;case 25:return null}throw Error(r(156,p.tag))}function $u(u,p){switch(g(p),p.tag){case 1:return Ho(p.type)&&jh(),u=p.flags,u&65536?(p.flags=u&-65537|128,p):null;case 3:return hi(),Pi(cs),Pi(Po),ya(),u=p.flags,(u&65536)!==0&&(u&128)===0?(p.flags=u&-65537|128,p):null;case 5:return Ac(p),null;case 13:if(Pi(yi),u=p.memoizedState,u!==null&&u.dehydrated!==null){if(p.alternate===null)throw Error(r(340));oe()}return u=p.flags,u&65536?(p.flags=u&-65537|128,p):null;case 19:return Pi(yi),null;case 4:return hi(),null;case 10:return Fe(p.type._context),null;case 22:case 23:return xg(),null;case 24:return null;default:return null}}var Dc=!1,Bi=!1,Ea=typeof WeakSet=="function"?WeakSet:Set,Hn=null;function Fl(u,p){var b=u.ref;if(b!==null)if(typeof b=="function")try{b(null)}catch(A){Qi(u,p,A)}else b.current=null}function jp(u,p,b){try{b()}catch(A){Qi(u,p,A)}}var g1=!1;function dg(u,p){if(bc=oc,u=vp(),cf(u)){if("selectionStart"in u)var b={start:u.selectionStart,end:u.selectionEnd};else e:{b=(b=u.ownerDocument)&&b.defaultView||window;var A=b.getSelection&&b.getSelection();if(A&&A.rangeCount!==0){b=A.anchorNode;var D=A.anchorOffset,V=A.focusNode;A=A.focusOffset;try{b.nodeType,V.nodeType}catch{b=null;break e}var re=0,De=-1,Xe=-1,Ct=0,rn=0,on=u,nn=null;t:for(;;){for(var Un;on!==b||D!==0&&on.nodeType!==3||(De=re+D),on!==V||A!==0&&on.nodeType!==3||(Xe=re+A),on.nodeType===3&&(re+=on.nodeValue.length),(Un=on.firstChild)!==null;)nn=on,on=Un;for(;;){if(on===u)break t;if(nn===b&&++Ct===D&&(De=re),nn===V&&++rn===A&&(Xe=re),(Un=on.nextSibling)!==null)break;on=nn,nn=on.parentNode}on=Un}b=De===-1||Xe===-1?null:{start:De,end:Xe}}else b=null}b=b||{start:0,end:0}}else b=null;for(Rh={focusedElem:u,selectionRange:b},oc=!1,Hn=p;Hn!==null;)if(p=Hn,u=p.child,(p.subtreeFlags&1028)!==0&&u!==null)u.return=p,Hn=u;else for(;Hn!==null;){p=Hn;try{var Jn=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(Jn!==null){var er=Jn.memoizedProps,ho=Jn.memoizedState,_t=p.stateNode,nt=_t.getSnapshotBeforeUpdate(p.elementType===p.type?er:fe(p.type,er),ho);_t.__reactInternalSnapshotBeforeUpdate=nt}break;case 3:var Et=p.stateNode.containerInfo;Et.nodeType===1?Et.textContent="":Et.nodeType===9&&Et.documentElement&&Et.removeChild(Et.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(dn){Qi(p,p.return,dn)}if(u=p.sibling,u!==null){u.return=p.return,Hn=u;break}Hn=p.return}return Jn=g1,g1=!1,Jn}function Bs(u,p,b){var A=p.updateQueue;if(A=A!==null?A.lastEffect:null,A!==null){var D=A=A.next;do{if((D.tag&u)===u){var V=D.destroy;D.destroy=void 0,V!==void 0&&jp(p,b,V)}D=D.next}while(D!==A)}}function ml(u,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var b=p=p.next;do{if((b.tag&u)===u){var A=b.create;b.destroy=A()}b=b.next}while(b!==p)}}function Np(u){var p=u.ref;if(p!==null){var b=u.stateNode;switch(u.tag){case 5:u=b;break;default:u=b}typeof p=="function"?p(u):p.current=u}}function fg(u){var p=u.alternate;p!==null&&(u.alternate=null,fg(p)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(p=u.stateNode,p!==null&&(delete p[as],delete p[za],delete p[Dh],delete p[df],delete p[Tp])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function _1(u){return u.tag===5||u.tag===3||u.tag===4}function bf(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||_1(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function Ef(u,p,b){var A=u.tag;if(A===5||A===6)u=u.stateNode,p?b.nodeType===8?b.parentNode.insertBefore(u,p):b.insertBefore(u,p):(b.nodeType===8?(p=b.parentNode,p.insertBefore(u,b)):(p=b,p.appendChild(u)),b=b._reactRootContainer,b!=null||p.onclick!==null||(p.onclick=wc));else if(A!==4&&(u=u.child,u!==null))for(Ef(u,p,b),u=u.sibling;u!==null;)Ef(u,p,b),u=u.sibling}function zc(u,p,b){var A=u.tag;if(A===5||A===6)u=u.stateNode,p?b.insertBefore(u,p):b.appendChild(u);else if(A!==4&&(u=u.child,u!==null))for(zc(u,p,b),u=u.sibling;u!==null;)zc(u,p,b),u=u.sibling}var co=null,Ts=!1;function Va(u,p,b){for(b=b.child;b!==null;)pg(u,p,b),b=b.sibling}function pg(u,p,b){if(yt&&typeof yt.onCommitFiberUnmount=="function")try{yt.onCommitFiberUnmount(cn,b)}catch{}switch(b.tag){case 5:Bi||Fl(b,p);case 6:var A=co,D=Ts;co=null,Va(u,p,b),co=A,Ts=D,co!==null&&(Ts?(u=co,b=b.stateNode,u.nodeType===8?u.parentNode.removeChild(b):u.removeChild(b)):co.removeChild(b.stateNode));break;case 18:co!==null&&(Ts?(u=co,b=b.stateNode,u.nodeType===8?Ou(u.parentNode,b):u.nodeType===1&&Ou(u,b),Zs(u)):Ou(co,b.stateNode));break;case 4:A=co,D=Ts,co=b.stateNode.containerInfo,Ts=!0,Va(u,p,b),co=A,Ts=D;break;case 0:case 11:case 14:case 15:if(!Bi&&(A=b.updateQueue,A!==null&&(A=A.lastEffect,A!==null))){D=A=A.next;do{var V=D,re=V.destroy;V=V.tag,re!==void 0&&((V&2)!==0||(V&4)!==0)&&jp(b,p,re),D=D.next}while(D!==A)}Va(u,p,b);break;case 1:if(!Bi&&(Fl(b,p),A=b.stateNode,typeof A.componentWillUnmount=="function"))try{A.props=b.memoizedProps,A.state=b.memoizedState,A.componentWillUnmount()}catch(De){Qi(b,p,De)}Va(u,p,b);break;case 21:Va(u,p,b);break;case 22:b.mode&1?(Bi=(A=Bi)||b.memoizedState!==null,Va(u,p,b),Bi=A):Va(u,p,b);break;default:Va(u,p,b)}}function Hh(u){var p=u.updateQueue;if(p!==null){u.updateQueue=null;var b=u.stateNode;b===null&&(b=u.stateNode=new Ea),p.forEach(function(A){var D=Tg.bind(null,u,A);b.has(A)||(b.add(A),A.then(D,D))})}}function ra(u,p){var b=p.deletions;if(b!==null)for(var A=0;A<b.length;A++){var D=b[A];try{var V=u,re=p,De=re;e:for(;De!==null;){switch(De.tag){case 5:co=De.stateNode,Ts=!1;break e;case 3:co=De.stateNode.containerInfo,Ts=!0;break e;case 4:co=De.stateNode.containerInfo,Ts=!0;break e}De=De.return}if(co===null)throw Error(r(160));pg(V,re,D),co=null,Ts=!1;var Xe=D.alternate;Xe!==null&&(Xe.return=null),D.return=null}catch(Ct){Qi(D,p,Ct)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)mg(p,u),p=p.sibling}function mg(u,p){var b=u.alternate,A=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(ra(p,u),Cs(u),A&4){try{Bs(3,u,u.return),ml(3,u)}catch(er){Qi(u,u.return,er)}try{Bs(5,u,u.return)}catch(er){Qi(u,u.return,er)}}break;case 1:ra(p,u),Cs(u),A&512&&b!==null&&Fl(b,b.return);break;case 5:if(ra(p,u),Cs(u),A&512&&b!==null&&Fl(b,b.return),u.flags&32){var D=u.stateNode;try{Di(D,"")}catch(er){Qi(u,u.return,er)}}if(A&4&&(D=u.stateNode,D!=null)){var V=u.memoizedProps,re=b!==null?b.memoizedProps:V,De=u.type,Xe=u.updateQueue;if(u.updateQueue=null,Xe!==null)try{De==="input"&&V.type==="radio"&&V.name!=null&&Nn(D,V),Fo(De,re);var Ct=Fo(De,V);for(re=0;re<Xe.length;re+=2){var rn=Xe[re],on=Xe[re+1];rn==="style"?ao(D,on):rn==="dangerouslySetInnerHTML"?Oi(D,on):rn==="children"?Di(D,on):_e(D,rn,on,Ct)}switch(De){case"input":xr(D,V);break;case"textarea":Ri(D,V);break;case"select":var nn=D._wrapperState.wasMultiple;D._wrapperState.wasMultiple=!!V.multiple;var Un=V.value;Un!=null?ui(D,!!V.multiple,Un,!1):nn!==!!V.multiple&&(V.defaultValue!=null?ui(D,!!V.multiple,V.defaultValue,!0):ui(D,!!V.multiple,V.multiple?[]:"",!1))}D[za]=V}catch(er){Qi(u,u.return,er)}}break;case 6:if(ra(p,u),Cs(u),A&4){if(u.stateNode===null)throw Error(r(162));D=u.stateNode,V=u.memoizedProps;try{D.nodeValue=V}catch(er){Qi(u,u.return,er)}}break;case 3:if(ra(p,u),Cs(u),A&4&&b!==null&&b.memoizedState.isDehydrated)try{Zs(p.containerInfo)}catch(er){Qi(u,u.return,er)}break;case 4:ra(p,u),Cs(u);break;case 13:ra(p,u),Cs(u),D=u.child,D.flags&8192&&(V=D.memoizedState!==null,D.stateNode.isHidden=V,!V||D.alternate!==null&&D.alternate.memoizedState!==null||(_g=On())),A&4&&Hh(u);break;case 22:if(rn=b!==null&&b.memoizedState!==null,u.mode&1?(Bi=(Ct=Bi)||rn,ra(p,u),Bi=Ct):ra(p,u),Cs(u),A&8192){if(Ct=u.memoizedState!==null,(u.stateNode.isHidden=Ct)&&!rn&&(u.mode&1)!==0)for(Hn=u,rn=u.child;rn!==null;){for(on=Hn=rn;Hn!==null;){switch(nn=Hn,Un=nn.child,nn.tag){case 0:case 11:case 14:case 15:Bs(4,nn,nn.return);break;case 1:Fl(nn,nn.return);var Jn=nn.stateNode;if(typeof Jn.componentWillUnmount=="function"){A=nn,b=nn.return;try{p=A,Jn.props=p.memoizedProps,Jn.state=p.memoizedState,Jn.componentWillUnmount()}catch(er){Qi(A,b,er)}}break;case 5:Fl(nn,nn.return);break;case 22:if(nn.memoizedState!==null){v1(on);continue}}Un!==null?(Un.return=nn,Hn=Un):v1(on)}rn=rn.sibling}e:for(rn=null,on=u;;){if(on.tag===5){if(rn===null){rn=on;try{D=on.stateNode,Ct?(V=D.style,typeof V.setProperty=="function"?V.setProperty("display","none","important"):V.display="none"):(De=on.stateNode,Xe=on.memoizedProps.style,re=Xe!=null&&Xe.hasOwnProperty("display")?Xe.display:null,De.style.display=Fi("display",re))}catch(er){Qi(u,u.return,er)}}}else if(on.tag===6){if(rn===null)try{on.stateNode.nodeValue=Ct?"":on.memoizedProps}catch(er){Qi(u,u.return,er)}}else if((on.tag!==22&&on.tag!==23||on.memoizedState===null||on===u)&&on.child!==null){on.child.return=on,on=on.child;continue}if(on===u)break e;for(;on.sibling===null;){if(on.return===null||on.return===u)break e;rn===on&&(rn=null),on=on.return}rn===on&&(rn=null),on.sibling.return=on.return,on=on.sibling}}break;case 19:ra(p,u),Cs(u),A&4&&Hh(u);break;case 21:break;default:ra(p,u),Cs(u)}}function Cs(u){var p=u.flags;if(p&2){try{e:{for(var b=u.return;b!==null;){if(_1(b)){var A=b;break e}b=b.return}throw Error(r(160))}switch(A.tag){case 5:var D=A.stateNode;A.flags&32&&(Di(D,""),A.flags&=-33);var V=bf(u);zc(u,V,D);break;case 3:case 4:var re=A.stateNode.containerInfo,De=bf(u);Ef(u,De,re);break;default:throw Error(r(161))}}catch(Xe){Qi(u,u.return,Xe)}u.flags&=-3}p&4096&&(u.flags&=-4097)}function y1(u,p,b){Hn=u,Fp(u)}function Fp(u,p,b){for(var A=(u.mode&1)!==0;Hn!==null;){var D=Hn,V=D.child;if(D.tag===22&&A){var re=D.memoizedState!==null||Dc;if(!re){var De=D.alternate,Xe=De!==null&&De.memoizedState!==null||Bi;De=Dc;var Ct=Bi;if(Dc=re,(Bi=Xe)&&!Ct)for(Hn=D;Hn!==null;)re=Hn,Xe=re.child,re.tag===22&&re.memoizedState!==null?x1(D):Xe!==null?(Xe.return=re,Hn=Xe):x1(D);for(;V!==null;)Hn=V,Fp(V),V=V.sibling;Hn=D,Dc=De,Bi=Ct}gg(u)}else(D.subtreeFlags&8772)!==0&&V!==null?(V.return=D,Hn=V):gg(u)}}function gg(u){for(;Hn!==null;){var p=Hn;if((p.flags&8772)!==0){var b=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:Bi||ml(5,p);break;case 1:var A=p.stateNode;if(p.flags&4&&!Bi)if(b===null)A.componentDidMount();else{var D=p.elementType===p.type?b.memoizedProps:fe(p.type,b.memoizedProps);A.componentDidUpdate(D,b.memoizedState,A.__reactInternalSnapshotBeforeUpdate)}var V=p.updateQueue;V!==null&&$n(p,V,A);break;case 3:var re=p.updateQueue;if(re!==null){if(b=null,p.child!==null)switch(p.child.tag){case 5:b=p.child.stateNode;break;case 1:b=p.child.stateNode}$n(p,re,b)}break;case 5:var De=p.stateNode;if(b===null&&p.flags&4){b=De;var Xe=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":Xe.autoFocus&&b.focus();break;case"img":Xe.src&&(b.src=Xe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var Ct=p.alternate;if(Ct!==null){var rn=Ct.memoizedState;if(rn!==null){var on=rn.dehydrated;on!==null&&Zs(on)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Bi||p.flags&512&&Np(p)}catch(nn){Qi(p,p.return,nn)}}if(p===u){Hn=null;break}if(b=p.sibling,b!==null){b.return=p.return,Hn=b;break}Hn=p.return}}function v1(u){for(;Hn!==null;){var p=Hn;if(p===u){Hn=null;break}var b=p.sibling;if(b!==null){b.return=p.return,Hn=b;break}Hn=p.return}}function x1(u){for(;Hn!==null;){var p=Hn;try{switch(p.tag){case 0:case 11:case 15:var b=p.return;try{ml(4,p)}catch(Xe){Qi(p,b,Xe)}break;case 1:var A=p.stateNode;if(typeof A.componentDidMount=="function"){var D=p.return;try{A.componentDidMount()}catch(Xe){Qi(p,D,Xe)}}var V=p.return;try{Np(p)}catch(Xe){Qi(p,V,Xe)}break;case 5:var re=p.return;try{Np(p)}catch(Xe){Qi(p,re,Xe)}}}catch(Xe){Qi(p,p.return,Xe)}if(p===u){Hn=null;break}var De=p.sibling;if(De!==null){De.return=p.return,Hn=De;break}Hn=p.return}}var Tf=Math.ceil,Cf=Ie.ReactCurrentDispatcher,gl=Ie.ReactCurrentOwner,$r=Ie.ReactCurrentBatchConfig,si=0,ji=null,Ti=null,Ni=0,Hi=0,io=Ba(0),ko=0,uo=null,Bc=0,Ul=0,Sf=0,Kh=null,hs=null,_g=0,jc=1/0,_l=null,Up=!1,Wa=null,js=null,Vu=!1,qa=null,Xh=0,Yh=0,yg=null,kf=-1,$p=0;function Jo(){return(si&6)!==0?On():kf!==-1?kf:kf=On()}function Nc(u){return(u.mode&1)===0?1:(si&2)!==0&&Ni!==0?Ni&-Ni:me.transition!==null?($p===0&&($p=yr()),$p):(u=ae,u!==0||(u=window.event,u=u===void 0?16:xh(u.type)),u)}function ia(u,p,b,A){if(50<Yh)throw Yh=0,yg=null,Error(r(185));xn(u,b,A),((si&2)===0||u!==ji)&&(u===ji&&((si&2)===0&&(Ul|=b),ko===4&&oa(u,Ni)),Ss(u,A),b===1&&si===0&&(p.mode&1)===0&&(jc=On()+500,Sc&&un()))}function Ss(u,p){var b=u.callbackNode;wn(u,p);var A=sr(u,u===ji?Ni:0);if(A===0)b!==null&&bn(b),u.callbackNode=null,u.callbackPriority=0;else if(p=A&-A,u.callbackPriority!==p){if(b!=null&&bn(b),p===1)u.tag===0?Ol(Mf.bind(null,u)):Rl(Mf.bind(null,u)),Ep(function(){(si&6)===0&&un()}),b=null;else{switch(Le(A)){case 1:b=yn;break;case 4:b=Pn;break;case 16:b=mn;break;case 536870912:b=En;break;default:b=mn}b=Cg(b,vg.bind(null,u))}u.callbackPriority=p,u.callbackNode=b}}function vg(u,p){if(kf=-1,$p=0,(si&6)!==0)throw Error(r(327));var b=u.callbackNode;if(zo()&&u.callbackNode!==b)return null;var A=sr(u,u===ji?Ni:0);if(A===0)return null;if((A&30)!==0||(A&u.expiredLanes)!==0||p)p=Gp(u,A);else{p=A;var D=si;si|=2;var V=w1();(ji!==u||Ni!==p)&&(_l=null,jc=On()+500,Wu(u,p));do try{b1();break}catch(De){wg(u,De)}while(!0);Ce(),Cf.current=V,si=D,Ti!==null?p=0:(ji=null,Ni=0,p=ko)}if(p!==0){if(p===2&&(D=Tn(u),D!==0&&(A=D,p=$l(u,D))),p===1)throw b=uo,Wu(u,0),oa(u,A),Ss(u,On()),b;if(p===6)oa(u,A);else{if(D=u.current.alternate,(A&30)===0&&!Ry(D)&&(p=Gp(u,A),p===2&&(V=Tn(u),V!==0&&(A=V,p=$l(u,V))),p===1))throw b=uo,Wu(u,0),oa(u,A),Ss(u,On()),b;switch(u.finishedWork=D,u.finishedLanes=A,p){case 0:case 1:throw Error(r(345));case 2:Vl(u,hs,_l);break;case 3:if(oa(u,A),(A&130023424)===A&&(p=_g+500-On(),10<p)){if(sr(u,0)!==0)break;if(D=u.suspendedLanes,(D&A)!==A){Jo(),u.pingedLanes|=u.suspendedLanes&D;break}u.timeoutHandle=al(Vl.bind(null,u,hs,_l),p);break}Vl(u,hs,_l);break;case 4:if(oa(u,A),(A&4194240)===A)break;for(p=u.eventTimes,D=-1;0<A;){var re=31-Dt(A);V=1<<re,re=p[re],re>D&&(D=re),A&=~V}if(A=D,A=On()-A,A=(120>A?120:480>A?480:1080>A?1080:1920>A?1920:3e3>A?3e3:4320>A?4320:1960*Tf(A/1960))-A,10<A){u.timeoutHandle=al(Vl.bind(null,u,hs,_l),A);break}Vl(u,hs,_l);break;case 5:Vl(u,hs,_l);break;default:throw Error(r(329))}}}return Ss(u,On()),u.callbackNode===b?vg.bind(null,u):null}function $l(u,p){var b=Kh;return u.current.memoizedState.isDehydrated&&(Wu(u,p).flags|=256),u=Gp(u,p),u!==2&&(p=hs,hs=b,p!==null&&Vp(p)),u}function Vp(u){hs===null?hs=u:hs.push.apply(hs,u)}function Ry(u){for(var p=u;;){if(p.flags&16384){var b=p.updateQueue;if(b!==null&&(b=b.stores,b!==null))for(var A=0;A<b.length;A++){var D=b[A],V=D.getSnapshot;D=D.value;try{if(!Os(V(),D))return!1}catch{return!1}}}if(b=p.child,p.subtreeFlags&16384&&b!==null)b.return=p,p=b;else{if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function oa(u,p){for(p&=~Sf,p&=~Ul,u.suspendedLanes|=p,u.pingedLanes&=~p,u=u.expirationTimes;0<p;){var b=31-Dt(p),A=1<<b;u[b]=-1,p&=~A}}function Mf(u){if((si&6)!==0)throw Error(r(327));zo();var p=sr(u,0);if((p&1)===0)return Ss(u,On()),null;var b=Gp(u,p);if(u.tag!==0&&b===2){var A=Tn(u);A!==0&&(p=A,b=$l(u,A))}if(b===1)throw b=uo,Wu(u,0),oa(u,p),Ss(u,On()),b;if(b===6)throw Error(r(345));return u.finishedWork=u.current.alternate,u.finishedLanes=p,Vl(u,hs,_l),Ss(u,On()),null}function Wp(u,p){var b=si;si|=1;try{return u(p)}finally{si=b,si===0&&(jc=On()+500,Sc&&un())}}function Fc(u){qa!==null&&qa.tag===0&&(si&6)===0&&zo();var p=si;si|=1;var b=$r.transition,A=ae;try{if($r.transition=null,ae=1,u)return u()}finally{ae=A,$r.transition=b,si=p,(si&6)===0&&un()}}function xg(){Hi=io.current,Pi(io)}function Wu(u,p){u.finishedWork=null,u.finishedLanes=0;var b=u.timeoutHandle;if(b!==-1&&(u.timeoutHandle=-1,hf(b)),Ti!==null)for(b=Ti.return;b!==null;){var A=b;switch(g(A),A.tag){case 1:A=A.type.childContextTypes,A!=null&&jh();break;case 3:hi(),Pi(cs),Pi(Po),ya();break;case 5:Ac(A);break;case 4:hi();break;case 13:Pi(yi);break;case 19:Pi(yi);break;case 10:Fe(A.type._context);break;case 22:case 23:xg()}b=b.return}if(ji=u,Ti=u=Uc(u.current,null),Ni=Hi=p,ko=0,uo=null,Sf=Ul=Bc=0,hs=Kh=null,Ye!==null){for(p=0;p<Ye.length;p++)if(b=Ye[p],A=b.interleaved,A!==null){b.interleaved=null;var D=A.next,V=b.pending;if(V!==null){var re=V.next;V.next=D,A.next=re}b.pending=A}Ye=null}return u}function wg(u,p){do{var b=Ti;try{if(Ce(),va.current=Wh,Cp){for(var A=zi.memoizedState;A!==null;){var D=A.queue;D!==null&&(D.pending=null),A=A.next}Cp=!1}if(Qs=0,Oo=So=zi=null,ju=!1,Ic=0,gl.current=null,b===null||b.return===null){ko=1,uo=p,Ti=null;break}e:{var V=u,re=b.return,De=b,Xe=p;if(p=Ni,De.flags|=32768,Xe!==null&&typeof Xe=="object"&&typeof Xe.then=="function"){var Ct=Xe,rn=De,on=rn.tag;if((rn.mode&1)===0&&(on===0||on===11||on===15)){var nn=rn.alternate;nn?(rn.updateQueue=nn.updateQueue,rn.memoizedState=nn.memoizedState,rn.lanes=nn.lanes):(rn.updateQueue=null,rn.memoizedState=null)}var Un=ig(re);if(Un!==null){Un.flags&=-257,Gh(Un,re,De,V,p),Un.mode&1&&Lp(V,Ct,p),p=Un,Xe=Ct;var Jn=p.updateQueue;if(Jn===null){var er=new Set;er.add(Xe),p.updateQueue=er}else Jn.add(Xe);break e}else{if((p&1)===0){Lp(V,Ct,p),qp();break e}Xe=Error(r(426))}}else if(y&&De.mode&1){var ho=ig(re);if(ho!==null){(ho.flags&65536)===0&&(ho.flags|=256),Gh(ho,re,De,V,p),de(qh(Xe,De));break e}}V=Xe=qh(Xe,De),ko!==4&&(ko=2),Kh===null?Kh=[V]:Kh.push(V),V=re;do{switch(V.tag){case 3:V.flags|=65536,p&=-p,V.lanes|=p;var _t=Fu(V,Xe,p);Ft(V,_t);break e;case 1:De=Xe;var nt=V.type,Et=V.stateNode;if((V.flags&128)===0&&(typeof nt.getDerivedStateFromError=="function"||Et!==null&&typeof Et.componentDidCatch=="function"&&(js===null||!js.has(Et)))){V.flags|=65536,p&=-p,V.lanes|=p;var dn=pl(V,De,p);Ft(V,dn);break e}}V=V.return}while(V!==null)}Eg(b)}catch(tr){p=tr,Ti===b&&b!==null&&(Ti=b=b.return);continue}break}while(!0)}function w1(){var u=Cf.current;return Cf.current=Wh,u===null?Wh:u}function qp(){(ko===0||ko===3||ko===2)&&(ko=4),ji===null||(Bc&268435455)===0&&(Ul&268435455)===0||oa(ji,Ni)}function Gp(u,p){var b=si;si|=2;var A=w1();(ji!==u||Ni!==p)&&(_l=null,Wu(u,p));do try{Oy();break}catch(D){wg(u,D)}while(!0);if(Ce(),si=b,Cf.current=A,Ti!==null)throw Error(r(261));return ji=null,Ni=0,ko}function Oy(){for(;Ti!==null;)bg(Ti)}function b1(){for(;Ti!==null&&!Sr();)bg(Ti)}function bg(u){var p=Af(u.alternate,u,Hi);u.memoizedProps=u.pendingProps,p===null?Eg(u):Ti=p,gl.current=null}function Eg(u){var p=u;do{var b=p.alternate;if(u=p.return,(p.flags&32768)===0){if(b=Ly(b,p,Hi),b!==null){Ti=b;return}}else{if(b=$u(b,p),b!==null){b.flags&=32767,Ti=b;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{ko=6,Ti=null;return}}if(p=p.sibling,p!==null){Ti=p;return}Ti=p=u}while(p!==null);ko===0&&(ko=5)}function Vl(u,p,b){var A=ae,D=$r.transition;try{$r.transition=null,ae=1,Wl(u,p,b,A)}finally{$r.transition=D,ae=A}return null}function Wl(u,p,b,A){do zo();while(qa!==null);if((si&6)!==0)throw Error(r(327));b=u.finishedWork;var D=u.finishedLanes;if(b===null)return null;if(u.finishedWork=null,u.finishedLanes=0,b===u.current)throw Error(r(177));u.callbackNode=null,u.callbackPriority=0;var V=b.lanes|b.childLanes;if(Er(u,V),u===ji&&(Ti=ji=null,Ni=0),(b.subtreeFlags&2064)===0&&(b.flags&2064)===0||Vu||(Vu=!0,Cg(mn,function(){return zo(),null})),V=(b.flags&15990)!==0,(b.subtreeFlags&15990)!==0||V){V=$r.transition,$r.transition=null;var re=ae;ae=1;var De=si;si|=4,gl.current=null,dg(u,b),mg(b,u),Ym(Rh),oc=!!bc,Rh=bc=null,u.current=b,y1(b),fr(),si=De,ae=re,$r.transition=V}else u.current=b;if(Vu&&(Vu=!1,qa=u,Xh=D),V=u.pendingLanes,V===0&&(js=null),Te(b.stateNode),Ss(u,On()),p!==null)for(A=u.onRecoverableError,b=0;b<p.length;b++)D=p[b],A(D.value,{componentStack:D.stack,digest:D.digest});if(Up)throw Up=!1,u=Wa,Wa=null,u;return(Xh&1)!==0&&u.tag!==0&&zo(),V=u.pendingLanes,(V&1)!==0?u===yg?Yh++:(Yh=0,yg=u):Yh=0,un(),null}function zo(){if(qa!==null){var u=Le(Xh),p=$r.transition,b=ae;try{if($r.transition=null,ae=16>u?16:u,qa===null)var A=!1;else{if(u=qa,qa=null,Xh=0,(si&6)!==0)throw Error(r(331));var D=si;for(si|=4,Hn=u.current;Hn!==null;){var V=Hn,re=V.child;if((Hn.flags&16)!==0){var De=V.deletions;if(De!==null){for(var Xe=0;Xe<De.length;Xe++){var Ct=De[Xe];for(Hn=Ct;Hn!==null;){var rn=Hn;switch(rn.tag){case 0:case 11:case 15:Bs(8,rn,V)}var on=rn.child;if(on!==null)on.return=rn,Hn=on;else for(;Hn!==null;){rn=Hn;var nn=rn.sibling,Un=rn.return;if(fg(rn),rn===Ct){Hn=null;break}if(nn!==null){nn.return=Un,Hn=nn;break}Hn=Un}}}var Jn=V.alternate;if(Jn!==null){var er=Jn.child;if(er!==null){Jn.child=null;do{var ho=er.sibling;er.sibling=null,er=ho}while(er!==null)}}Hn=V}}if((V.subtreeFlags&2064)!==0&&re!==null)re.return=V,Hn=re;else e:for(;Hn!==null;){if(V=Hn,(V.flags&2048)!==0)switch(V.tag){case 0:case 11:case 15:Bs(9,V,V.return)}var _t=V.sibling;if(_t!==null){_t.return=V.return,Hn=_t;break e}Hn=V.return}}var nt=u.current;for(Hn=nt;Hn!==null;){re=Hn;var Et=re.child;if((re.subtreeFlags&2064)!==0&&Et!==null)Et.return=re,Hn=Et;else e:for(re=nt;Hn!==null;){if(De=Hn,(De.flags&2048)!==0)try{switch(De.tag){case 0:case 11:case 15:ml(9,De)}}catch(tr){Qi(De,De.return,tr)}if(De===re){Hn=null;break e}var dn=De.sibling;if(dn!==null){dn.return=De.return,Hn=dn;break e}Hn=De.return}}if(si=D,un(),yt&&typeof yt.onPostCommitFiberRoot=="function")try{yt.onPostCommitFiberRoot(cn,u)}catch{}A=!0}return A}finally{ae=b,$r.transition=p}}return!1}function E1(u,p,b){p=qh(b,p),p=Fu(u,p,1),u=St(u,p,1),p=Jo(),u!==null&&(xn(u,1,p),Ss(u,p))}function Qi(u,p,b){if(u.tag===3)E1(u,u,b);else for(;p!==null;){if(p.tag===3){E1(p,u,b);break}else if(p.tag===1){var A=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(js===null||!js.has(A))){u=qh(b,u),u=pl(p,u,1),p=St(p,u,1),u=Jo(),p!==null&&(xn(p,1,u),Ss(p,u));break}}p=p.return}}function Dy(u,p,b){var A=u.pingCache;A!==null&&A.delete(p),p=Jo(),u.pingedLanes|=u.suspendedLanes&b,ji===u&&(Ni&b)===b&&(ko===4||ko===3&&(Ni&130023424)===Ni&&500>On()-_g?Wu(u,0):Sf|=b),Ss(u,p)}function T1(u,p){p===0&&((u.mode&1)===0?p=1:(p=pr,pr<<=1,(pr&130023424)===0&&(pr=4194304)));var b=Jo();u=st(u,p),u!==null&&(xn(u,p,b),Ss(u,b))}function zy(u){var p=u.memoizedState,b=0;p!==null&&(b=p.retryLane),T1(u,b)}function Tg(u,p){var b=0;switch(u.tag){case 13:var A=u.stateNode,D=u.memoizedState;D!==null&&(b=D.retryLane);break;case 19:A=u.stateNode;break;default:throw Error(r(314))}A!==null&&A.delete(p),T1(u,b)}var Af;Af=function(u,p,b){if(u!==null)if(u.memoizedProps!==p.pendingProps||cs.current)$i=!0;else{if((u.lanes&b)===0&&(p.flags&128)===0)return $i=!1,hg(u,p,b);$i=(u.flags&131072)!==0}else $i=!1,y&&(p.flags&1048576)!==0&&Nh(p,Mc,p.index);switch(p.lanes=0,p.tag){case 2:var A=p.type;xf(u,p),u=p.pendingProps;var D=Io(p,Po.current);Ne(p,b),D=Fa(null,p,A,u,D,b);var V=Uh();return p.flags|=1,typeof D=="object"&&D!==null&&typeof D.render=="function"&&D.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,Ho(A)?(V=!0,_a(p)):V=!1,p.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,gt(p),D.updater=Zn,p.stateNode=D,D._reactInternals=p,Jr(p,A,u,b),p=sg(null,p,A,!0,V,b)):(p.tag=0,y&&V&&hl(p),Do(null,p,D,b),p=p.child),p;case 16:A=p.elementType;e:{switch(xf(u,p),u=p.pendingProps,D=A._init,A=D(A._payload),p.type=A,D=p.tag=By(A),u=fe(A,u),D){case 0:p=Uu(null,p,A,u,b);break e;case 1:p=ba(null,p,A,u,b);break e;case 11:p=Xo(null,p,A,u,b);break e;case 14:p=ta(null,p,A,fe(A.type,u),b);break e}throw Error(r(306,A,""))}return p;case 0:return A=p.type,D=p.pendingProps,D=p.elementType===A?D:fe(A,D),Uu(u,p,A,D,b);case 1:return A=p.type,D=p.pendingProps,D=p.elementType===A?D:fe(A,D),ba(u,p,A,D,b);case 3:e:{if(f1(p),u===null)throw Error(r(387));A=p.pendingProps,V=p.memoizedState,D=V.element,Zt(u,p),Yt(p,A,null,b);var re=p.memoizedState;if(A=re.element,V.isDehydrated)if(V={element:A,isDehydrated:!1,cache:re.cache,pendingSuspenseBoundaries:re.pendingSuspenseBoundaries,transitions:re.transitions},p.updateQueue.baseState=V,p.memoizedState=V,p.flags&256){D=qh(Error(r(423)),p),p=ag(u,p,A,b,D);break e}else if(A!==D){D=qh(Error(r(424)),p),p=ag(u,p,A,b,D);break e}else for(h=ga(p.stateNode.containerInfo.firstChild),s=p,y=!0,w=null,b=bs(p,null,A,b),p.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(oe(),A===D){p=na(u,p,b);break e}Do(u,p,A,b)}p=p.child}return p;case 5:return Ko(p),u===null&&O(p),A=p.type,D=p.pendingProps,V=u!==null?u.memoizedProps:null,re=D.children,Ec(A,D)?re=null:V!==null&&Ec(A,V)&&(p.flags|=32),og(u,p),Do(u,p,re,b),p.child;case 6:return u===null&&O(p),null;case 13:return lg(u,p,b);case 4:return Ro(p,p.stateNode.containerInfo),A=p.pendingProps,u===null?p.child=qi(p,null,A,b):Do(u,p,A,b),p.child;case 11:return A=p.type,D=p.pendingProps,D=p.elementType===A?D:fe(A,D),Xo(u,p,A,D,b);case 7:return Do(u,p,p.pendingProps,b),p.child;case 8:return Do(u,p,p.pendingProps.children,b),p.child;case 12:return Do(u,p,p.pendingProps.children,b),p.child;case 10:e:{if(A=p.type._context,D=p.pendingProps,V=p.memoizedProps,re=D.value,Ur(ye,A._currentValue),A._currentValue=re,V!==null)if(Os(V.value,re)){if(V.children===D.children&&!cs.current){p=na(u,p,b);break e}}else for(V=p.child,V!==null&&(V.return=p);V!==null;){var De=V.dependencies;if(De!==null){re=V.child;for(var Xe=De.firstContext;Xe!==null;){if(Xe.context===A){if(V.tag===1){Xe=at(-1,b&-b),Xe.tag=2;var Ct=V.updateQueue;if(Ct!==null){Ct=Ct.shared;var rn=Ct.pending;rn===null?Xe.next=Xe:(Xe.next=rn.next,rn.next=Xe),Ct.pending=Xe}}V.lanes|=b,Xe=V.alternate,Xe!==null&&(Xe.lanes|=b),$e(V.return,b,p),De.lanes|=b;break}Xe=Xe.next}}else if(V.tag===10)re=V.type===p.type?null:V.child;else if(V.tag===18){if(re=V.return,re===null)throw Error(r(341));re.lanes|=b,De=re.alternate,De!==null&&(De.lanes|=b),$e(re,b,p),re=V.sibling}else re=V.child;if(re!==null)re.return=V;else for(re=V;re!==null;){if(re===p){re=null;break}if(V=re.sibling,V!==null){V.return=re.return,re=V;break}re=re.return}V=re}Do(u,p,D.children,b),p=p.child}return p;case 9:return D=p.type,A=p.pendingProps.children,Ne(p,b),D=Je(D),A=A(D),p.flags|=1,Do(u,p,A,b),p.child;case 14:return A=p.type,D=fe(A,p.pendingProps),D=fe(A.type,D),ta(u,p,A,D,b);case 15:return Rp(u,p,p.type,p.pendingProps,b);case 17:return A=p.type,D=p.pendingProps,D=p.elementType===A?D:fe(A,D),xf(u,p),p.tag=1,Ho(A)?(u=!0,_a(p)):u=!1,Ne(p,b),Or(p,A,D),Jr(p,A,D,b),sg(null,p,A,!0,u,b);case 19:return ug(u,p,b);case 22:return Gi(u,p,b)}throw Error(r(156,p.tag))};function Cg(u,p){return hr(u,p)}function qu(u,p,b,A){this.tag=u,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ds(u,p,b,A){return new qu(u,p,b,A)}function Sg(u){return u=u.prototype,!(!u||!u.isReactComponent)}function By(u){if(typeof u=="function")return Sg(u)?1:0;if(u!=null){if(u=u.$$typeof,u===Ue)return 11;if(u===Wt)return 14}return 2}function Uc(u,p){var b=u.alternate;return b===null?(b=ds(u.tag,p,u.key,u.mode),b.elementType=u.elementType,b.type=u.type,b.stateNode=u.stateNode,b.alternate=u,u.alternate=b):(b.pendingProps=p,b.type=u.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=u.flags&14680064,b.childLanes=u.childLanes,b.lanes=u.lanes,b.child=u.child,b.memoizedProps=u.memoizedProps,b.memoizedState=u.memoizedState,b.updateQueue=u.updateQueue,p=u.dependencies,b.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},b.sibling=u.sibling,b.index=u.index,b.ref=u.ref,b}function Zp(u,p,b,A,D,V){var re=2;if(A=u,typeof u=="function")Sg(u)&&(re=1);else if(typeof u=="string")re=5;else e:switch(u){case Ke:return Gu(b.children,D,V,p);case et:re=8,D|=8;break;case qe:return u=ds(12,b,p,D|2),u.elementType=qe,u.lanes=V,u;case lt:return u=ds(13,b,p,D),u.elementType=lt,u.lanes=V,u;case ht:return u=ds(19,b,p,D),u.elementType=ht,u.lanes=V,u;case Sn:return Hp(b,D,V,p);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case ge:re=10;break e;case We:re=9;break e;case Ue:re=11;break e;case Wt:re=14;break e;case In:re=16,A=null;break e}throw Error(r(130,u==null?u:typeof u,""))}return p=ds(re,b,p,D),p.elementType=u,p.type=A,p.lanes=V,p}function Gu(u,p,b,A){return u=ds(7,u,A,p),u.lanes=b,u}function Hp(u,p,b,A){return u=ds(22,u,A,p),u.elementType=Sn,u.lanes=b,u.stateNode={isHidden:!1},u}function kg(u,p,b){return u=ds(6,u,null,p),u.lanes=b,u}function Pf(u,p,b){return p=ds(4,u.children!==null?u.children:[],u.key,p),p.lanes=b,p.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},p}function jy(u,p,b,A,D){this.tag=p,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ar(0),this.expirationTimes=ar(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ar(0),this.identifierPrefix=A,this.onRecoverableError=D,this.mutableSourceEagerHydrationData=null}function $c(u,p,b,A,D,V,re,De,Xe){return u=new jy(u,p,b,De,Xe),p===1?(p=1,V===!0&&(p|=8)):p=0,V=ds(3,null,null,p),u.current=V,V.stateNode=u,V.memoizedState={element:A,isDehydrated:b,cache:null,transitions:null,pendingSuspenseBoundaries:null},gt(V),u}function Ny(u,p,b){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ve,key:A==null?null:""+A,children:u,containerInfo:p,implementation:b}}function eo(u){if(!u)return cl;u=u._reactInternals;e:{if(Ut(u)!==u||u.tag!==1)throw Error(r(170));var p=u;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(Ho(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(r(171))}if(u.tag===1){var b=u.type;if(Ho(b))return Xs(u,b,p)}return p}function If(u,p,b,A,D,V,re,De,Xe){return u=$c(b,A,!0,u,D,V,re,De,Xe),u.context=eo(null),b=u.current,A=Jo(),D=Nc(b),V=at(A,D),V.callback=p??null,St(b,V,D),u.current.lanes=D,xn(u,D,A),Ss(u,A),u}function Lf(u,p,b,A){var D=p.current,V=Jo(),re=Nc(D);return b=eo(b),p.context===null?p.context=b:p.pendingContext=b,p=at(V,re),p.payload={element:u},A=A===void 0?null:A,A!==null&&(p.callback=A),u=St(D,p,re),u!==null&&(ia(u,D,re,V),Ht(u,D,re)),re}function Zu(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function Rf(u,p){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var b=u.retryLane;u.retryLane=b!==0&&b<p?b:p}}function Hu(u,p){Rf(u,p),(u=u.alternate)&&Rf(u,p)}function C1(){return null}var Mg=typeof reportError=="function"?reportError:function(u){console.error(u)};function Ku(u){this._internalRoot=u}Jh.prototype.render=Ku.prototype.render=function(u){var p=this._internalRoot;if(p===null)throw Error(r(409));Lf(u,p,null,null)},Jh.prototype.unmount=Ku.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var p=u.containerInfo;Fc(function(){Lf(null,u,null,null)}),p[Ks]=null}};function Jh(u){this._internalRoot=u}Jh.prototype.unstable_scheduleHydration=function(u){if(u){var p=Qn();u={blockedOn:null,target:u,priority:p};for(var b=0;b<_i.length&&p!==0&&p<_i[b].priority;b++);_i.splice(b,0,u),b===0&&Ud(u)}};function Of(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function Qh(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function S1(){}function k1(u,p,b,A,D){if(D){if(typeof A=="function"){var V=A;A=function(){var Ct=Zu(re);V.call(Ct)}}var re=If(p,A,u,0,null,!1,!1,"",S1);return u._reactRootContainer=re,u[Ks]=re.current,Oa(u.nodeType===8?u.parentNode:u),Fc(),re}for(;D=u.lastChild;)u.removeChild(D);if(typeof A=="function"){var De=A;A=function(){var Ct=Zu(Xe);De.call(Ct)}}var Xe=$c(u,0,!1,null,null,!1,!1,"",S1);return u._reactRootContainer=Xe,u[Ks]=Xe.current,Oa(u.nodeType===8?u.parentNode:u),Fc(function(){Lf(p,Xe,b,A)}),Xe}function Vc(u,p,b,A,D){var V=b._reactRootContainer;if(V){var re=V;if(typeof D=="function"){var De=D;D=function(){var Xe=Zu(re);De.call(Xe)}}Lf(p,re,u,D)}else re=k1(b,p,u,D,A);return Zu(re)}tt=function(u){switch(u.tag){case 3:var p=u.stateNode;if(p.current.memoizedState.isDehydrated){var b=_r(p.pendingLanes);b!==0&&(ie(p,b|1),Ss(p,On()),(si&6)===0&&(jc=On()+500,un()))}break;case 13:Fc(function(){var A=st(u,1);if(A!==null){var D=Jo();ia(A,u,1,D)}}),Hu(u,1)}},zt=function(u){if(u.tag===13){var p=st(u,134217728);if(p!==null){var b=Jo();ia(p,u,134217728,b)}Hu(u,134217728)}},an=function(u){if(u.tag===13){var p=Nc(u),b=st(u,p);if(b!==null){var A=Jo();ia(b,u,p,A)}Hu(u,p)}},Qn=function(){return ae},Fr=function(u,p){var b=ae;try{return ae=u,p()}finally{ae=b}},Ae=function(u,p,b){switch(p){case"input":if(xr(u,b),p=b.name,b.type==="radio"&&p!=null){for(b=u;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<b.length;p++){var A=b[p];if(A!==u&&A.form===u.form){var D=zh(A);if(!D)throw Error(r(90));wt(A),xr(A,D)}}}break;case"textarea":Ri(u,b);break;case"select":p=b.value,p!=null&&ui(u,!!b.multiple,p,!1)}},rt=Wp,it=Fc;var Fy={usingClientEntryPoint:!1,Events:[Cc,Il,zh,Oe,Ge,Wp]},Xu={findFiberByHostInstance:ls,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Uy={bundleType:Xu.bundleType,version:Xu.version,rendererPackageName:Xu.rendererPackageName,rendererConfig:Xu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ie.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=Cn(u),u===null?null:u.stateNode},findFiberByHostInstance:Xu.findFiberByHostInstance||C1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ed=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ed.isDisabled&&ed.supportsFiber)try{cn=ed.inject(Uy),yt=ed}catch{}}return Sa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Fy,Sa.createPortal=function(u,p){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Of(p))throw Error(r(200));return Ny(u,p,null,b)},Sa.createRoot=function(u,p){if(!Of(u))throw Error(r(299));var b=!1,A="",D=Mg;return p!=null&&(p.unstable_strictMode===!0&&(b=!0),p.identifierPrefix!==void 0&&(A=p.identifierPrefix),p.onRecoverableError!==void 0&&(D=p.onRecoverableError)),p=$c(u,1,!1,null,null,b,!1,A,D),u[Ks]=p.current,Oa(u.nodeType===8?u.parentNode:u),new Ku(p)},Sa.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var p=u._reactInternals;if(p===void 0)throw typeof u.render=="function"?Error(r(188)):(u=Object.keys(u).join(","),Error(r(268,u)));return u=Cn(p),u=u===null?null:u.stateNode,u},Sa.flushSync=function(u){return Fc(u)},Sa.hydrate=function(u,p,b){if(!Qh(p))throw Error(r(200));return Vc(null,u,p,!0,b)},Sa.hydrateRoot=function(u,p,b){if(!Of(u))throw Error(r(405));var A=b!=null&&b.hydratedSources||null,D=!1,V="",re=Mg;if(b!=null&&(b.unstable_strictMode===!0&&(D=!0),b.identifierPrefix!==void 0&&(V=b.identifierPrefix),b.onRecoverableError!==void 0&&(re=b.onRecoverableError)),p=If(p,null,u,1,b??null,D,!1,V,re),u[Ks]=p.current,Oa(u),A)for(u=0;u<A.length;u++)b=A[u],D=b._getVersion,D=D(b._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[b,D]:p.mutableSourceEagerHydrationData.push(b,D);return new Jh(p)},Sa.render=function(u,p,b){if(!Qh(p))throw Error(r(200));return Vc(null,u,p,!1,b)},Sa.unmountComponentAtNode=function(u){if(!Qh(u))throw Error(r(40));return u._reactRootContainer?(Fc(function(){Vc(null,null,u,!1,function(){u._reactRootContainer=null,u[Ks]=null})}),!0):!1},Sa.unstable_batchedUpdates=Wp,Sa.unstable_renderSubtreeIntoContainer=function(u,p,b,A){if(!Qh(b))throw Error(r(200));if(u==null||u._reactInternals===void 0)throw Error(r(38));return Vc(u,p,b,!1,A)},Sa.version="18.2.0-next-9e3b772b8-20220608",Sa}var r5;function fT(){if(r5)return xv.exports;r5=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),xv.exports=wk(),xv.exports}var i5;function bk(){if(i5)return Z1;i5=1;var n=fT();return Z1.createRoot=n.createRoot,Z1.hydrateRoot=n.hydrateRoot,Z1}var Ek=bk();const Tk=cu(Ek);var He=aw();const pT=cu(He),Ck=hT({__proto__:null,default:pT},[He]);let C_=class mT extends Error{constructor(t,r,l){super(typeof r=="object"?r.message:r||t,{cause:typeof r=="object"?r.cause:l}),this.type=t,Object.setPrototypeOf(this,mT.prototype)}};function Sk(n){return n.replace(/_[a-z]/g,t=>t[1].toUpperCase())}const kk="ERR_INVALID_VALUE",Mk="ERR_UNEXPECTED_VALUE",Ak="ERR_UNEXPECTED_TYPE",Pk="ERR_PARSE";function Ik(n){let t=n;if(typeof t=="string")try{t=JSON.parse(t)}catch(r){throw new C_(kk,{cause:r})}if(typeof t!="object"||!t||Array.isArray(t))throw new C_(Mk);return t}function lw(n,t){return r=>{const l=d=>{if(!(r&&d===void 0))try{return t(d)}catch(m){throw new C_(Pk,{message:`"${n}" transformer failed to parse the value`,cause:m})}};return Object.assign(l,{isValid(d){try{return l(d),!0}catch{return!1}}})}}function Lk(n){throw new C_(Ak,`Unexpected value received: ${JSON.stringify(n)}`)}const Rk=lw("string",n=>{if(typeof n=="string"||typeof n=="number")return n.toString();Lk(n)});function oy(n){return/^#[\da-f]{6}$/i.test(n)}function Ok(n){return/^#[\da-f]{3}$/i.test(n)}function gT(n){const t=n.replace(/\s/g,"").toLowerCase();if(oy(t))return t;if(Ok(t)){let l="#";for(let d=0;d<3;d+=1)l+=t[1+d].repeat(2);return l}const r=t.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||t.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!r)throw new Error(`Value "${n}" does not satisfy any of known RGB formats.`);return r.slice(1).reduce((l,d)=>{const m=parseInt(d,10).toString(16);return l+(m.length===1?"0":"")+m},"#")}const Dk=lw("rgb",n=>gT(Rk()(n))),zk=lw("themeParams",n=>{const t=Dk(!0);return Object.entries(Ik(n)).reduce((r,[l,d])=>(r[Sk(l)]=t(d),r),{})});let w0=class _T extends Error{constructor(t,r,l){super(typeof r=="object"?r.message:r||t,{cause:typeof r=="object"?r.cause:l}),this.type=t,Object.setPrototypeOf(this,_T.prototype)}};function yT(n){return n.replace(/[A-Z]/g,t=>`_${t.toLowerCase()}`)}function Bk(n){return n.replace(/_[a-z]/g,t=>t[1].toUpperCase())}const jk="ERR_INVALID_VALUE",Nk="ERR_UNEXPECTED_VALUE",Fk="ERR_UNEXPECTED_TYPE",vT="ERR_PARSE";function xT(n,t){const r={};for(const l in n){const d=n[l];if(!d)continue;let m,x;typeof d=="function"?(m=l,x=d):[m,x]=d;try{const C=x(t(m));C!==void 0&&(r[l]=C)}catch(C){throw new w0(vT,`Parser for "${l}" property failed${m===l?"":`. Source field: "${m}"`}`,C)}}return r}function wT(n){let t=n;if(typeof t=="string")try{t=JSON.parse(t)}catch(r){throw new w0(jk,{cause:r})}if(typeof t!="object"||!t||Array.isArray(t))throw new w0(Nk);return t}function uu(n,t){return r=>{const l=d=>{if(!(r&&d===void 0))try{return t(d)}catch(m){throw new w0(vT,{message:`"${n}" transformer failed to parse the value`,cause:m})}};return Object.assign(l,{isValid(d){try{return l(d),!0}catch{return!1}}})}}function Xc(n,t){return uu(t||"object",r=>{const l=wT(r);return xT(n,d=>l[d])})}function U0(n){throw new w0(Fk,`Unexpected value received: ${JSON.stringify(n)}`)}const S_=uu("boolean",n=>{if(typeof n=="boolean")return n;const t=String(n);if(t==="1"||t==="true")return!0;if(t==="0"||t==="false")return!1;U0(n)}),ec=uu("string",n=>{if(typeof n=="string"||typeof n=="number")return n.toString();U0(n)}),b0=uu("number",n=>{if(typeof n=="number")return n;if(typeof n=="string"){const t=Number(n);if(!Number.isNaN(t))return t}U0(n)}),Uk=uu("date",n=>n instanceof Date?n:new Date(b0()(n)*1e3));function bT(n,t){return uu(t||"searchParams",r=>{typeof r!="string"&&!(r instanceof URLSearchParams)&&U0(r);const l=typeof r=="string"?new URLSearchParams(r):r;return xT(n,d=>{const m=l.get(d);return m===null?void 0:m})})}function Ev(n){for(const t in n)n[t]=[yT(t),n[t]];return n}const $k=n=>{const t=b0(),r=b0(!0),l=ec(),d=ec(!0),m=S_(!0),x=Xc(Ev({addedToAttachmentMenu:m,allowsWriteToPm:m,firstName:l,id:t,isBot:m,isPremium:m,languageCode:d,lastName:d,photoUrl:d,username:d}),"User")(!0);return bT(Ev({authDate:Uk(),canSendAfter:r,chat:Xc(Ev({id:t,type:l,title:l,photoUrl:d,username:d}),"Chat")(!0),chatInstance:d,chatType:d,hash:l,queryId:d,receiver:x,startParam:d,user:x}),"initData")(n)};function Vk(n){return/^#[\da-f]{6}$/i.test(n)}function Wk(n){return/^#[\da-f]{3}$/i.test(n)}function qk(n){const t=n.replace(/\s/g,"").toLowerCase();if(Vk(t))return t;if(Wk(t)){let l="#";for(let d=0;d<3;d+=1)l+=t[1+d].repeat(2);return l}const r=t.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||t.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!r)throw new Error(`Value "${n}" does not satisfy any of known RGB formats.`);return r.slice(1).reduce((l,d)=>{const m=parseInt(d,10).toString(16);return l+(m.length===1?"0":"")+m},"#")}const Gk=uu("rgb",n=>qk(ec()(n))),Zk=uu("themeParams",n=>{const t=Gk(!0);return Object.entries(wT(n)).reduce((r,[l,d])=>(r[Bk(l)]=t(d),r),{})});function Hk(n){return JSON.stringify(Object.fromEntries(Object.entries(n).map(([t,r])=>[yT(t),r])))}const Kk=n=>{const t=ec(),r=ec(!0),l=S_(!0);return bT({botInline:["tgWebAppBotInline",l],initData:["tgWebAppData",$k(!0)],initDataRaw:["tgWebAppData",r],platform:["tgWebAppPlatform",t],showSettings:["tgWebAppShowSettings",l],startParam:["tgWebAppStartParam",r],themeParams:["tgWebAppThemeParams",Zk()],version:["tgWebAppVersion",t]},"launchParams")(n)};function Xk(n){const{initDataRaw:t,startParam:r,showSettings:l,botInline:d}=n,m=new URLSearchParams;return m.set("tgWebAppPlatform",n.platform),m.set("tgWebAppThemeParams",Hk(n.themeParams)),m.set("tgWebAppVersion",n.version),t&&m.set("tgWebAppData",t),r&&m.set("tgWebAppStartParam",r),typeof l=="boolean"&&m.set("tgWebAppShowSettings",l?"1":"0"),typeof d=="boolean"&&m.set("tgWebAppBotInline",d?"1":"0"),m.toString()}const Yk=Xc({eventType:ec(),eventData:n=>n},"miniAppsMessage"),ET=uu("fn",n=>{if(typeof n=="function")return n;U0(n)});function Jk(n){return!!n&&typeof n=="object"&&!Array.isArray(n)}const Qk=Xc({TelegramWebviewProxy:Xc({postEvent:ET()})()});function eM(n){return Qk().isValid(n)}function tM(){try{return window.self!==window.top}catch{return!0}}var nM=Object.defineProperty,rM=(n,t,r)=>t in n?nM(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,iM=(n,t,r)=>rM(n,t+"",r);let iu=class TT extends Error{constructor(t,r,l){super(typeof r=="object"?r.message:r||t,{cause:typeof r=="object"?r.cause:l}),this.type=t,Object.setPrototypeOf(this,TT.prototype)}};function px(n,t,r){return n.addEventListener(t,r),()=>n.removeEventListener(t,r)}function $0(...n){const t=n.flat(1);return[t.push.bind(t),()=>{t.forEach(r=>{r()})}]}const oM="ERR_ABORTED",sM="ERR_CANCELED",aM="ERR_TIMED_OUT";function o5(n){return new iu(oM,{cause:n})}function s5(n,t){return n.reject=t.reject,n}class Xf extends Promise{constructor(t,r){let l,d;typeof t=="function"?(l=t,d=r):d=t;let m,x;super((C,a)=>{d||(d={});const{abortSignal:M}=d;if(M&&M.aborted)return a(o5(M.reason));const[R,j]=$0(),F=se=>(...xe)=>(j(),se(...xe)),Z=new AbortController,{signal:Y}=Z;x=F(se=>{Z.abort(se),a(se)}),m=F(C),M&&R(px(M,"abort",()=>{x(o5(M.reason))}));const{timeout:ne}=d;if(ne){const se=setTimeout(()=>{x(new iu(aM,`Timeout reached: ${ne}ms`))},ne);R(()=>{clearTimeout(se)})}l&&l(m,x,Y)}),iM(this,"reject"),this.reject=x}static withFn(t,r){return new Xf((l,d,m)=>{try{const x=t(m);return x instanceof Promise?x.then(l,d):l(x)}catch(x){d(x)}},r)}static resolve(t){return new Xf(r=>{r(t)})}static reject(t){return new Xf((r,l)=>{l(t)})}cancel(){this.reject(new iu(sM))}catch(t){return this.then(void 0,t)}finally(t){return s5(super.finally(t),this)}then(t,r){return s5(super.then(t,r),this)}}function CT(n){return`tapps/${n}`}function V0(n,t){sessionStorage.setItem(CT(n),JSON.stringify(t))}function W0(n){const t=sessionStorage.getItem(CT(n));try{return t?JSON.parse(t):void 0}catch{}}function cw(n){return n.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}function lM(n,t){t||(t={});const{textColor:r,bgColor:l,shouldLog:d=!0}=t;function m(x,...C){if(!d||typeof d=="function"&&!d())return;const a="font-weight:bold;padding:0 5px;border-radius:5px";console[x](`%c${Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(new Date)}%c / %c${n}`,`${a};background-color: lightblue;color:black`,"",`${a};${r?`color:${r};`:""}${l?`background-color:${l}`:""}`,...C)}return[function(...x){m("log",...x)},function(...x){m("error",...x)}]}function uw(n,t){document.documentElement.style.setProperty(n,t)}function hw(n){document.documentElement.style.removeProperty(n)}function cM(n,t){t()}function Fm(n,t){t||(t={});const r=t.equals||Object.is;let l=[],d=n;const m=M=>{if(!r(d,M)){const R=d;d=M,cM(a,()=>{[...l].forEach(([j,F])=>{j(M,R),F&&C(j,!0)})})}};function x(M){const R=typeof M!="object"?{once:M}:M;return{once:R.once||!1,signal:R.signal||!1}}const C=(M,R)=>{const j=x(R),F=l.findIndex(([Z,Y])=>Z===M&&Y.once===j.once&&Y.signal===j.signal);F>=0&&l.splice(F,1)},a=Object.assign(function(){return uM(a),d},{destroy(){l=[]},set:m,reset(){m(n)},sub(M,R){return l.push([M,x(R)]),()=>C(M,R)},unsub:C,unsubAll(){l=l.filter(M=>M[1].signal)}});return a}const Tv=[];function uM(n){Tv.length&&Tv[Tv.length-1].add(n)}const ST=Fm(!1),[kT,hM]=lM("Bridge",{bgColor:"#9147ff",textColor:"white",shouldLog:ST}),dM={clipboard_text_received:Xc({req_id:ec(),data:n=>n===null?n:ec(!0)(n)},"clipboard_text_received"),custom_method_invoked:Xc({req_id:ec(),result:n=>n,error:ec(!0)},"custom_method_invoked"),popup_closed:uu("popup_closed",n=>n?Xc({button_id:t=>t==null?void 0:ec()(t)})()(n):{}),viewport_changed:Xc({height:b0(),width:n=>n==null?window.innerWidth:b0()(n),is_state_stable:S_(),is_expanded:S_()},"viewport_changed")};function fM(n){const t=window,[,r]=$0(px(t,"resize",()=>{n(["viewport_changed",{width:window.innerWidth,height:window.innerHeight,is_state_stable:!0,is_expanded:!0}])}),px(t,"message",l=>{if(l.source!==t.parent)return;let d;try{d=Yk()(l.data)}catch{return}const{eventType:m,eventData:x}=d,C=dM[m];try{const a=C?C()(x):x;kT("Event received:",a?{eventType:m,eventData:a}:{eventType:m}),n([m,a])}catch(a){hM([`An error occurred processing the "${m}" event from the Telegram application.`,"Please, file an issue here:","https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose"].join(`
`),d,a)}}));return r}const a5=Fm(),l5=Fm();function pM(){return l5()||l5.set(fM(a5.set)),a5}const Cv=Fm({});function MT(n){let t=Cv()[n];return t||(t=Fm(void 0,{equals(){return!1}}),pM().sub(r=>{r&&r[0]===n&&t.set(r[1])}),Cv.set({...Cv(),[n]:t})),t}function Lm(n,t,r){return MT(n).sub(t,r)}const mM="ERR_METHOD_UNSUPPORTED",gM="ERR_RETRIEVE_LP_FAILED",_M="ERR_METHOD_PARAMETER_UNSUPPORTED",yM="ERR_UNKNOWN_ENV",vM=Fm("https://web.telegram.org");function dw(n,t){kT("Posting event:",t?{eventType:n,eventData:t}:{eventType:n});const r=window;if(eM(r)){r.TelegramWebviewProxy.postEvent(n,JSON.stringify(t));return}const l=JSON.stringify({eventType:n,eventData:t});if(tM())return r.parent.postMessage(l,vM());const{external:d}=r;if(Xc({notify:ET()})().isValid(d)){d.notify(l);return}throw new iu(yM)}function xM(n,t,r){r||(r={});const{capture:l}=r,[d,m]=$0();return new Xf(x=>{(Array.isArray(t)?t:[t]).forEach(C=>{d(Lm(C,a=>{(!l||(Array.isArray(t)?l({event:C,payload:a}):l(a)))&&x(a)}))}),(r.postEvent||dw)(n,r.params)},r).finally(m)}function AT(n){return Kk()(n)}function PT(n){return AT(n.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&"))}function wM(){return PT(window.location.href)}function bM(){const n=performance.getEntriesByType("navigation")[0];if(!n)throw new Error("Unable to get first navigation entry.");return PT(n.name)}const EM="launchParams";function TM(){return AT(W0(EM)||"")}function CM(n){V0("launchParams",Xk(n))}function IT(n){return n instanceof Error?n.message+(n.cause?`
  ${IT(n.cause)}`:""):JSON.stringify(n)}function Um(){const n=[];for(const t of[wM,bM,TM])try{const r=t();return CM(r),r}catch(r){n.push(r)}throw new iu(gM,["Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?","📖 Refer to docs for more information:","https://docs.telegram-mini-apps.com/packages/telegram-apps-sdk/environment","Collected errors:",...n.map(t=>`— ${IT(t)}`)].join(`
`))}function SM(n,t){window.dispatchEvent(new MessageEvent("message",{data:JSON.stringify({eventType:n,eventData:t}),source:window.parent}))}function kM(){[["TelegramGameProxy_receiveEvent"],["TelegramGameProxy","receiveEvent"],["Telegram","WebView","receiveEvent"]].forEach(n=>{let t=window;n.forEach((r,l,d)=>{if(l===d.length-1){t[r]=SM;return}r in t||(t[r]={}),t=t[r]})})}function MM(){["TelegramGameProxy_receiveEvent","TelegramGameProxy","Telegram"].forEach(n=>{delete window[n]})}function fw(n,t,r){MT(n).unsub(t,r)}function c5(n){return n.split(".").map(Number)}function AM(n,t){const r=c5(n),l=c5(t),d=Math.max(r.length,l.length);for(let m=0;m<d;m+=1){const x=r[m]||0,C=l[m]||0;if(x!==C)return x>C?1:-1}return 0}function ka(n,t){return AM(n,t)<=0}function E0(n,t,r){if(typeof r=="string"){if(n==="web_app_open_link"){if(t==="try_instant_view")return ka("6.4",r);if(t==="try_browser")return ka("7.6",r)}if(n==="web_app_set_header_color"&&t==="color")return ka("6.9",r);if(n==="web_app_close"&&t==="return_back")return ka("7.6",r);if(n==="web_app_setup_main_button"&&t==="has_shine_effect")return ka("7.10",r)}switch(n){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return ka("6.1",t);case"web_app_open_popup":return ka("6.2",t);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return ka("6.4",t);case"web_app_switch_inline_query":return ka("6.7",t);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return ka("6.9",t);case"web_app_setup_settings_button":return ka("6.10",t);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return ka("7.2",t);case"web_app_setup_swipe_behavior":return ka("7.7",t);case"web_app_setup_secondary_button":case"web_app_set_bottom_bar_color":return ka("7.10",t);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(n)}}function PM(n,t){t||(t="strict");const r=typeof t=="function"?t:l=>{const{method:d,version:m}=l;let x,C;if("param"in l?(x=`Parameter "${l.param}" of "${d}" method is unsupported in Mini Apps version ${m}`,C=_M):(x=`Method "${d}" is unsupported in Mini Apps version ${m}`,C=mM),t==="strict")throw new iu(C,x);return console.warn(x)};return(l,d)=>E0(l,n)?Jk(d)&&l==="web_app_set_header_color"&&"color"in d&&!E0(l,"color",n)?r({version:n,method:l,param:"color"}):dw(l,d):r({version:n,method:l})}function IM(){return performance.getEntriesByType("navigation")[0]}function sy(){const n=IM();return!!n&&n.type==="reload"}let bm;function LM(n,t){bm&&bm.set(n,t)||t()}function RM(n){if(bm)return n();bm=new Map;try{n()}finally{bm.forEach(t=>t()),bm=void 0}}function Zo(n,t){t||(t={});const r=t.equals||Object.is;let l=[],d=n;const m=M=>{if(!r(d,M)){const R=d;d=M,LM(a,()=>{[...l].forEach(([j,F])=>{j(M,R),F&&C(j,!0)})})}};function x(M){const R=typeof M!="object"?{once:M}:M;return{once:R.once||!1,signal:R.signal||!1}}const C=(M,R)=>{const j=x(R),F=l.findIndex(([Z,Y])=>Z===M&&Y.once===j.once&&Y.signal===j.signal);F>=0&&l.splice(F,1)},a=Object.assign(function(){return OM(a),d},{destroy(){l=[]},set:m,reset(){m(n)},sub(M,R){return l.push([M,x(R)]),()=>C(M,R)},unsub:C,unsubAll(){l=l.filter(M=>M[1].signal)}});return a}const o0=[];function OM(n){o0.length&&o0[o0.length-1].add(n)}function hu(n,t){let r=new Set;const l=Zo(m(),t);function d(){l.set(m())}function m(){r.forEach(a=>a.unsub(d,{signal:!0}));const x=new Set;let C;o0.push(x);try{C=n()}finally{o0.pop()}return x.forEach(a=>{a.sub(d,{signal:!0})}),r=x,C}return Object.assign(function(){return l()},{destroy:l.destroy,sub:l.sub,unsub:l.unsub,unsubAll:l.unsubAll})}const LT=Zo(dw),ay=Zo("0.0");function DM(n){n||(n={});const{postEvent:t}=n,r=n.version||Um().version;ay.set(r),LT.set(typeof t=="function"?t:PM(r,t))}const zM=(n,t,r)=>(r||(r={}),r.postEvent||(r.postEvent=ou),xM(n,t,r)),ou=(n,t)=>LT()(n,t);function s0(n,t){t(),n.sub(t)}const RT="web_app_setup_back_button",OT="back_button_pressed",DT="backButton";function BM(){np.set(!1)}function jM(){return E0(RT,ay())}const np=Zo(!1),k_=Zo(!1);function NM(){k_()||(np.set(sy()&&W0(DT)||!1),s0(np,zT),k_.set(!0))}function zT(){const n=np();ou(RT,{is_visible:n}),V0(DT,n)}function FM(n){return Lm(OT,n)}function UM(n){fw(OT,n)}function $M(){np.set(!0)}function VM(){np.unsub(zT),k_.set(!1)}const a0=Object.freeze(Object.defineProperty({__proto__:null,hide:BM,isMounted:k_,isSupported:jM,isVisible:np,mount:NM,offClick:UM,onClick:FM,show:$M,unmount:VM},Symbol.toStringTag,{value:"Module"})),ly="ERR_ALREADY_CALLED";function WM(n,t,{isMounting:r,isMounted:l,mountError:d}){return function(m){if(l())return Xf.resolve();if(r())throw new iu(ly);return r.set(!0),Xf.withFn(x=>n({abortSignal:x}),m).then(x=>[!0,x],x=>[!1,x]).then(x=>{RM(()=>{if(r.set(!1),l.set(!0),x[0])t(x[1]);else{const C=x[1];throw d.set(C),C}})})}}function pw(n,t,r){return Object.assign(n,{isSupported(){return E0(t,ay())&&(!r||r())}})}const mw=Zo(void 0);function du(n){return hu(()=>{const t=mw();return t?t[n]:void 0})}const BT=du("authDate"),jT=du("canSendAfter"),qM=hu(()=>{const n=BT(),t=jT();return t&&n?new Date(n.getTime()+t*1e3):void 0}),GM=du("chat"),ZM=du("chatType"),HM=du("chatInstance"),KM=du("hash"),XM=du("queryId"),NT=Zo(),YM=du("receiver");function JM(){const n=Um();mw.set(n.initData),NT.set(n.initDataRaw)}const QM=du("startParam"),e2=du("user"),t2=Object.freeze(Object.defineProperty({__proto__:null,authDate:BT,canSendAfter:jT,canSendAfterDate:qM,chat:GM,chatInstance:HM,chatType:ZM,hash:KM,queryId:XM,raw:NT,receiver:YM,restore:JM,startParam:QM,state:mw,user:e2},Symbol.toStringTag,{value:"Module"}));function FT(n){const t=gT(n);return Math.sqrt([.299,.587,.114].reduce((r,l,d)=>{const m=parseInt(t.slice(1+d*2,1+(d+1)*2),16);return r+m*m*l},0))<120}const M_=Zo(!1),m_=Zo(!1),vd=Zo({});function ua(n){return hu(()=>vd()[n])}const n2=ua("accentTextColor"),gw=ua("bgColor"),r2=ua("buttonColor"),i2=ua("buttonTextColor"),UT=ua("bottomBarBgColor"),o2=ua("destructiveTextColor"),$T=ua("headerBgColor"),s2=ua("hintColor"),a2=hu(()=>{const{bgColor:n}=vd();return!n||FT(n)}),l2=ua("linkColor"),A_=ua("secondaryBgColor"),c2=ua("sectionBgColor"),u2=ua("sectionHeaderTextColor"),h2=ua("sectionSeparatorColor"),d2=ua("subtitleTextColor"),f2=ua("textColor");function p2(n,t){return Object.assign(n,{supports(r){const l=t[r];return E0(l[0],l[1],ay())}})}function m2(n){return zk()(n)}const VT="themeParams",WT="theme_changed";function g2(n){if(m_())throw new iu(ly);n||(n=l=>`--tg-theme-${cw(l)}`);function t(l){Object.entries(vd()).forEach(([d,m])=>{m&&l(d,m)})}function r(){t((l,d)=>{uw(n(l),d)})}return r(),vd.sub(r),m_.set(!0),()=>{t(hw),vd.unsub(r),m_.set(!1)}}function qT(){M_()||(Lm(WT,GT),vd.set(sy()&&W0(VT)||Um().themeParams),M_.set(!0))}const GT=n=>{const t=m2(n.theme_params);vd.set(t),V0(VT,t)};function _2(){fw(WT,GT),M_.set(!1)}function ZT(n){return hu(()=>{const t=n();return oy(t)?t:t==="bg_color"?gw():A_()})}const bd=Zo("bg_color"),_w=ZT(bd),Ed=Zo("bottom_bar_bg_color"),HT=hu(()=>{const n=Ed();return oy(n)?n:n==="bottom_bar_bg_color"?UT()||A_():n==="secondary_bg_color"?A_():gw()}),Td=Zo("bg_color"),KT=ZT(Td),P_=Zo(!1),g_=Zo(!1),y2=hu(()=>{const n=_w();return n?FT(n):!1}),XT=hu(()=>({backgroundColor:bd(),bottomBarColor:Ed(),headerColor:Td()})),YT="web_app_set_background_color",JT="web_app_set_bottom_bar_color",mx="web_app_set_header_color",QT="miniApp";function v2(n){if(g_())throw new iu(ly);const[t,r]=$0();function l(d,m){function x(){uw(d,m()||null)}x(),t(m.sub(x),hw.bind(null,d))}return n||(n=d=>`--tg-${cw(d)}`),l(n("bgColor"),_w),l(n("bottomBarColor"),HT),l(n("headerColor"),KT),t(()=>{g_.set(!1)}),g_.set(!0),r}function x2(n){ou("web_app_close",{return_back:n})}function w2(){if(!P_()){const n=sy()&&W0(QT);qT(),bd.set(n?n.backgroundColor:"bg_color"),Ed.set(n?n.bottomBarColor:"bottom_bar_bg_color"),Td.set(n?n.headerColor:$T()||"bg_color"),s0(bd,eC),s0(Ed,tC),s0(Td,nC),P_.set(!0)}}function eC(){const n=bd();yw(),ou(YT,{color:n})}function tC(){yw(),ou(JT,{color:Ed()})}function nC(){const n=Td();yw(),ou(mx,oy(n)?{color:n}:{color_key:n})}function b2(){ou("web_app_ready")}function yw(){V0(QT,XT())}const E2=pw(n=>{bd.set(n)},YT),T2=pw(n=>{Ed.set(n)},JT),C2=p2(pw(n=>{Td.set(n)},mx),{color:[mx,"color"]});function S2(){bd.unsub(eC),Ed.unsub(tC),Td.unsub(nC),P_.set(!1)}const gx=Object.freeze(Object.defineProperty({__proto__:null,backgroundColor:bd,backgroundColorRGB:_w,bindCssVars:v2,bottomBarColor:Ed,bottomBarColorRGB:HT,close:x2,headerColor:Td,headerColorRGB:KT,isCssVarsBound:g_,isDark:y2,isMounted:P_,mount:w2,ready:b2,setBackgroundColor:E2,setBottomBarColor:T2,setHeaderColor:C2,state:XT,unmount:S2},Symbol.toStringTag,{value:"Module"})),u5=Object.freeze(Object.defineProperty({__proto__:null,accentTextColor:n2,backgroundColor:gw,bindCssVars:g2,bottomBarBgColor:UT,buttonColor:r2,buttonTextColor:i2,destructiveTextColor:o2,headerBackgroundColor:$T,hintColor:s2,isCssVarsBound:m_,isDark:a2,isMounted:M_,linkColor:l2,mount:qT,secondaryBackgroundColor:A_,sectionBackgroundColor:c2,sectionHeaderTextColor:u2,sectionSeparatorColor:h2,state:vd,subtitleTextColor:d2,textColor:f2,unmount:_2},Symbol.toStringTag,{value:"Module"})),Ka=Zo({height:0,width:0,isExpanded:!1,stableHeight:0}),rC=Zo(!1),__=Zo(!1),iC=Zo(!1),oC=Zo(void 0);function cy(n){return hu(()=>Ka()[n])}const k2=cy("height"),M2=cy("isExpanded"),A2=hu(()=>{const n=Ka();return n.height===n.stableHeight}),P2=cy("stableHeight"),I2=cy("width");function L2(n){return zM("web_app_request_viewport","viewport_changed",n).then(t=>({height:t.height,width:t.width,isExpanded:t.is_expanded,isStable:t.is_state_stable}))}function R2(n){if(__())throw new iu(ly);n||(n=l=>`--tg-viewport-${cw(l)}`);const t=["height","width","stableHeight"];function r(){t.forEach(l=>{uw(n(l),`${Ka()[l]}px`)})}return r(),Ka.sub(r),__.set(!0),()=>{t.forEach(hw),Ka.unsub(r),__.set(!1)}}function O2(){ou("web_app_expand")}function sC(n){return{isExpanded:n.isExpanded,height:Sv(n.height),width:Sv(n.width),stableHeight:Sv(n.stableHeight)}}const D2=WM(n=>{const t=sy()&&W0("viewport");if(t)return t;if(["macos","tdesktop","unigram","webk","weba","web"].includes(Um().platform)){const r=window;return{isExpanded:!0,height:r.innerHeight,width:r.innerWidth,stableHeight:r.innerHeight}}return n.timeout||(n.timeout=1e3),L2(n).then(r=>({height:r.height,isExpanded:r.isExpanded,stableHeight:r.isStable?r.height:Ka().stableHeight,width:r.width}))},n=>{Lm("viewport_changed",aC),s0(Ka,lC),Ka.set(sC(n))},{isMounted:rC,isMounting:iC,mountError:oC}),aC=n=>{Ka.set(sC({height:n.height,width:n.width,isExpanded:n.is_expanded,stableHeight:n.is_state_stable?n.height:Ka().stableHeight}))};function lC(){V0("viewport",Ka())}function Sv(n){return Math.max(n,0)}function z2(){fw("viewport_changed",aC),Ka.unsub(lC)}const h5=Object.freeze(Object.defineProperty({__proto__:null,bindCssVars:R2,expand:O2,height:k2,isCssVarsBound:__,isExpanded:M2,isMounted:rC,isMounting:iC,isStable:A2,mount:D2,mountError:oC,stableHeight:P2,state:Ka,unmount:z2,width:I2},Symbol.toStringTag,{value:"Module"}));function B2(n){DM(n),kM();const[t,r]=$0(Lm("reload_iframe",()=>{ou("iframe_will_reload"),window.location.reload()}),MM),{acceptCustomStyles:l=!0}={};if(l){const d=document.createElement("style");d.id="telegram-custom-styles",document.head.appendChild(d),t(Lm("set_custom_style",m=>{d.innerHTML=m}),()=>{document.head.removeChild(d)})}return ou("iframe_ready",{reload_supported:!0}),r}function j2(){return He.useMemo(Um,[])}function N2(n){return He.useSyncExternalStore(t=>n.sub(t),n)}var y_={exports:{}},F2=y_.exports,d5;function U2(){return d5||(d5=1,function(n){(function(t,r){n.exports?n.exports=r():(t.nacl||(t.nacl={}),t.nacl.util=r())})(F2,function(){var t={};function r(l){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(l))throw new TypeError("invalid encoding")}return t.decodeUTF8=function(l){if(typeof l!="string")throw new TypeError("expected string");var d,m=unescape(encodeURIComponent(l)),x=new Uint8Array(m.length);for(d=0;d<m.length;d++)x[d]=m.charCodeAt(d);return x},t.encodeUTF8=function(l){var d,m=[];for(d=0;d<l.length;d++)m.push(String.fromCharCode(l[d]));return decodeURIComponent(escape(m.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(t.encodeBase64=function(l){return Buffer.from(l).toString("base64")},t.decodeBase64=function(l){return r(l),new Uint8Array(Array.prototype.slice.call(Buffer.from(l,"base64"),0))}):(t.encodeBase64=function(l){return new Buffer(l).toString("base64")},t.decodeBase64=function(l){return r(l),new Uint8Array(Array.prototype.slice.call(new Buffer(l,"base64"),0))}):(t.encodeBase64=function(l){var d,m=[],x=l.length;for(d=0;d<x;d++)m.push(String.fromCharCode(l[d]));return btoa(m.join(""))},t.decodeBase64=function(l){r(l);var d,m=atob(l),x=new Uint8Array(m.length);for(d=0;d<m.length;d++)x[d]=m.charCodeAt(d);return x}),t})}(y_)),y_.exports}var $2=U2();const T0=cu($2);function V2(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var kv={exports:{}};const W2={},q2=Object.freeze(Object.defineProperty({__proto__:null,default:W2},Symbol.toStringTag,{value:"Module"})),G2=dT(q2);var f5;function Z2(){return f5||(f5=1,function(n){(function(t){var r=function(G){var ee,Q=new Float64Array(16);if(G)for(ee=0;ee<G.length;ee++)Q[ee]=G[ee];return Q},l=function(){throw new Error("no PRNG")},d=new Uint8Array(16),m=new Uint8Array(32);m[0]=9;var x=r(),C=r([1]),a=r([56129,1]),M=r([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),R=r([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),j=r([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),F=r([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),Z=r([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Y(G,ee,Q,B){G[ee]=Q>>24&255,G[ee+1]=Q>>16&255,G[ee+2]=Q>>8&255,G[ee+3]=Q&255,G[ee+4]=B>>24&255,G[ee+5]=B>>16&255,G[ee+6]=B>>8&255,G[ee+7]=B&255}function ne(G,ee,Q,B,ce){var Qe,ot=0;for(Qe=0;Qe<ce;Qe++)ot|=G[ee+Qe]^Q[B+Qe];return(1&ot-1>>>8)-1}function se(G,ee,Q,B){return ne(G,ee,Q,B,16)}function xe(G,ee,Q,B){return ne(G,ee,Q,B,32)}function Se(G,ee,Q,B){for(var ce=B[0]&255|(B[1]&255)<<8|(B[2]&255)<<16|(B[3]&255)<<24,Qe=Q[0]&255|(Q[1]&255)<<8|(Q[2]&255)<<16|(Q[3]&255)<<24,ot=Q[4]&255|(Q[5]&255)<<8|(Q[6]&255)<<16|(Q[7]&255)<<24,Lt=Q[8]&255|(Q[9]&255)<<8|(Q[10]&255)<<16|(Q[11]&255)<<24,Ut=Q[12]&255|(Q[13]&255)<<8|(Q[14]&255)<<16|(Q[15]&255)<<24,Ln=B[4]&255|(B[5]&255)<<8|(B[6]&255)<<16|(B[7]&255)<<24,ln=ee[0]&255|(ee[1]&255)<<8|(ee[2]&255)<<16|(ee[3]&255)<<24,or=ee[4]&255|(ee[5]&255)<<8|(ee[6]&255)<<16|(ee[7]&255)<<24,Cn=ee[8]&255|(ee[9]&255)<<8|(ee[10]&255)<<16|(ee[11]&255)<<24,ur=ee[12]&255|(ee[13]&255)<<8|(ee[14]&255)<<16|(ee[15]&255)<<24,hr=B[8]&255|(B[9]&255)<<8|(B[10]&255)<<16|(B[11]&255)<<24,bn=Q[16]&255|(Q[17]&255)<<8|(Q[18]&255)<<16|(Q[19]&255)<<24,Sr=Q[20]&255|(Q[21]&255)<<8|(Q[22]&255)<<16|(Q[23]&255)<<24,fr=Q[24]&255|(Q[25]&255)<<8|(Q[26]&255)<<16|(Q[27]&255)<<24,On=Q[28]&255|(Q[29]&255)<<8|(Q[30]&255)<<16|(Q[31]&255)<<24,Gn=B[12]&255|(B[13]&255)<<8|(B[14]&255)<<16|(B[15]&255)<<24,yn=ce,Pn=Qe,mn=ot,Dn=Lt,En=Ut,cn=Ln,yt=ln,Te=or,Dt=Cn,Tt=ur,It=hr,tn=bn,Bn=Sr,pr=fr,_r=On,sr=Gn,pe,wn=0;wn<20;wn+=2)pe=yn+Bn|0,En^=pe<<7|pe>>>25,pe=En+yn|0,Dt^=pe<<9|pe>>>23,pe=Dt+En|0,Bn^=pe<<13|pe>>>19,pe=Bn+Dt|0,yn^=pe<<18|pe>>>14,pe=cn+Pn|0,Tt^=pe<<7|pe>>>25,pe=Tt+cn|0,pr^=pe<<9|pe>>>23,pe=pr+Tt|0,Pn^=pe<<13|pe>>>19,pe=Pn+pr|0,cn^=pe<<18|pe>>>14,pe=It+yt|0,_r^=pe<<7|pe>>>25,pe=_r+It|0,mn^=pe<<9|pe>>>23,pe=mn+_r|0,yt^=pe<<13|pe>>>19,pe=yt+mn|0,It^=pe<<18|pe>>>14,pe=sr+tn|0,Dn^=pe<<7|pe>>>25,pe=Dn+sr|0,Te^=pe<<9|pe>>>23,pe=Te+Dn|0,tn^=pe<<13|pe>>>19,pe=tn+Te|0,sr^=pe<<18|pe>>>14,pe=yn+Dn|0,Pn^=pe<<7|pe>>>25,pe=Pn+yn|0,mn^=pe<<9|pe>>>23,pe=mn+Pn|0,Dn^=pe<<13|pe>>>19,pe=Dn+mn|0,yn^=pe<<18|pe>>>14,pe=cn+En|0,yt^=pe<<7|pe>>>25,pe=yt+cn|0,Te^=pe<<9|pe>>>23,pe=Te+yt|0,En^=pe<<13|pe>>>19,pe=En+Te|0,cn^=pe<<18|pe>>>14,pe=It+Tt|0,tn^=pe<<7|pe>>>25,pe=tn+It|0,Dt^=pe<<9|pe>>>23,pe=Dt+tn|0,Tt^=pe<<13|pe>>>19,pe=Tt+Dt|0,It^=pe<<18|pe>>>14,pe=sr+_r|0,Bn^=pe<<7|pe>>>25,pe=Bn+sr|0,pr^=pe<<9|pe>>>23,pe=pr+Bn|0,_r^=pe<<13|pe>>>19,pe=_r+pr|0,sr^=pe<<18|pe>>>14;yn=yn+ce|0,Pn=Pn+Qe|0,mn=mn+ot|0,Dn=Dn+Lt|0,En=En+Ut|0,cn=cn+Ln|0,yt=yt+ln|0,Te=Te+or|0,Dt=Dt+Cn|0,Tt=Tt+ur|0,It=It+hr|0,tn=tn+bn|0,Bn=Bn+Sr|0,pr=pr+fr|0,_r=_r+On|0,sr=sr+Gn|0,G[0]=yn>>>0&255,G[1]=yn>>>8&255,G[2]=yn>>>16&255,G[3]=yn>>>24&255,G[4]=Pn>>>0&255,G[5]=Pn>>>8&255,G[6]=Pn>>>16&255,G[7]=Pn>>>24&255,G[8]=mn>>>0&255,G[9]=mn>>>8&255,G[10]=mn>>>16&255,G[11]=mn>>>24&255,G[12]=Dn>>>0&255,G[13]=Dn>>>8&255,G[14]=Dn>>>16&255,G[15]=Dn>>>24&255,G[16]=En>>>0&255,G[17]=En>>>8&255,G[18]=En>>>16&255,G[19]=En>>>24&255,G[20]=cn>>>0&255,G[21]=cn>>>8&255,G[22]=cn>>>16&255,G[23]=cn>>>24&255,G[24]=yt>>>0&255,G[25]=yt>>>8&255,G[26]=yt>>>16&255,G[27]=yt>>>24&255,G[28]=Te>>>0&255,G[29]=Te>>>8&255,G[30]=Te>>>16&255,G[31]=Te>>>24&255,G[32]=Dt>>>0&255,G[33]=Dt>>>8&255,G[34]=Dt>>>16&255,G[35]=Dt>>>24&255,G[36]=Tt>>>0&255,G[37]=Tt>>>8&255,G[38]=Tt>>>16&255,G[39]=Tt>>>24&255,G[40]=It>>>0&255,G[41]=It>>>8&255,G[42]=It>>>16&255,G[43]=It>>>24&255,G[44]=tn>>>0&255,G[45]=tn>>>8&255,G[46]=tn>>>16&255,G[47]=tn>>>24&255,G[48]=Bn>>>0&255,G[49]=Bn>>>8&255,G[50]=Bn>>>16&255,G[51]=Bn>>>24&255,G[52]=pr>>>0&255,G[53]=pr>>>8&255,G[54]=pr>>>16&255,G[55]=pr>>>24&255,G[56]=_r>>>0&255,G[57]=_r>>>8&255,G[58]=_r>>>16&255,G[59]=_r>>>24&255,G[60]=sr>>>0&255,G[61]=sr>>>8&255,G[62]=sr>>>16&255,G[63]=sr>>>24&255}function _e(G,ee,Q,B){for(var ce=B[0]&255|(B[1]&255)<<8|(B[2]&255)<<16|(B[3]&255)<<24,Qe=Q[0]&255|(Q[1]&255)<<8|(Q[2]&255)<<16|(Q[3]&255)<<24,ot=Q[4]&255|(Q[5]&255)<<8|(Q[6]&255)<<16|(Q[7]&255)<<24,Lt=Q[8]&255|(Q[9]&255)<<8|(Q[10]&255)<<16|(Q[11]&255)<<24,Ut=Q[12]&255|(Q[13]&255)<<8|(Q[14]&255)<<16|(Q[15]&255)<<24,Ln=B[4]&255|(B[5]&255)<<8|(B[6]&255)<<16|(B[7]&255)<<24,ln=ee[0]&255|(ee[1]&255)<<8|(ee[2]&255)<<16|(ee[3]&255)<<24,or=ee[4]&255|(ee[5]&255)<<8|(ee[6]&255)<<16|(ee[7]&255)<<24,Cn=ee[8]&255|(ee[9]&255)<<8|(ee[10]&255)<<16|(ee[11]&255)<<24,ur=ee[12]&255|(ee[13]&255)<<8|(ee[14]&255)<<16|(ee[15]&255)<<24,hr=B[8]&255|(B[9]&255)<<8|(B[10]&255)<<16|(B[11]&255)<<24,bn=Q[16]&255|(Q[17]&255)<<8|(Q[18]&255)<<16|(Q[19]&255)<<24,Sr=Q[20]&255|(Q[21]&255)<<8|(Q[22]&255)<<16|(Q[23]&255)<<24,fr=Q[24]&255|(Q[25]&255)<<8|(Q[26]&255)<<16|(Q[27]&255)<<24,On=Q[28]&255|(Q[29]&255)<<8|(Q[30]&255)<<16|(Q[31]&255)<<24,Gn=B[12]&255|(B[13]&255)<<8|(B[14]&255)<<16|(B[15]&255)<<24,yn=ce,Pn=Qe,mn=ot,Dn=Lt,En=Ut,cn=Ln,yt=ln,Te=or,Dt=Cn,Tt=ur,It=hr,tn=bn,Bn=Sr,pr=fr,_r=On,sr=Gn,pe,wn=0;wn<20;wn+=2)pe=yn+Bn|0,En^=pe<<7|pe>>>25,pe=En+yn|0,Dt^=pe<<9|pe>>>23,pe=Dt+En|0,Bn^=pe<<13|pe>>>19,pe=Bn+Dt|0,yn^=pe<<18|pe>>>14,pe=cn+Pn|0,Tt^=pe<<7|pe>>>25,pe=Tt+cn|0,pr^=pe<<9|pe>>>23,pe=pr+Tt|0,Pn^=pe<<13|pe>>>19,pe=Pn+pr|0,cn^=pe<<18|pe>>>14,pe=It+yt|0,_r^=pe<<7|pe>>>25,pe=_r+It|0,mn^=pe<<9|pe>>>23,pe=mn+_r|0,yt^=pe<<13|pe>>>19,pe=yt+mn|0,It^=pe<<18|pe>>>14,pe=sr+tn|0,Dn^=pe<<7|pe>>>25,pe=Dn+sr|0,Te^=pe<<9|pe>>>23,pe=Te+Dn|0,tn^=pe<<13|pe>>>19,pe=tn+Te|0,sr^=pe<<18|pe>>>14,pe=yn+Dn|0,Pn^=pe<<7|pe>>>25,pe=Pn+yn|0,mn^=pe<<9|pe>>>23,pe=mn+Pn|0,Dn^=pe<<13|pe>>>19,pe=Dn+mn|0,yn^=pe<<18|pe>>>14,pe=cn+En|0,yt^=pe<<7|pe>>>25,pe=yt+cn|0,Te^=pe<<9|pe>>>23,pe=Te+yt|0,En^=pe<<13|pe>>>19,pe=En+Te|0,cn^=pe<<18|pe>>>14,pe=It+Tt|0,tn^=pe<<7|pe>>>25,pe=tn+It|0,Dt^=pe<<9|pe>>>23,pe=Dt+tn|0,Tt^=pe<<13|pe>>>19,pe=Tt+Dt|0,It^=pe<<18|pe>>>14,pe=sr+_r|0,Bn^=pe<<7|pe>>>25,pe=Bn+sr|0,pr^=pe<<9|pe>>>23,pe=pr+Bn|0,_r^=pe<<13|pe>>>19,pe=_r+pr|0,sr^=pe<<18|pe>>>14;G[0]=yn>>>0&255,G[1]=yn>>>8&255,G[2]=yn>>>16&255,G[3]=yn>>>24&255,G[4]=cn>>>0&255,G[5]=cn>>>8&255,G[6]=cn>>>16&255,G[7]=cn>>>24&255,G[8]=It>>>0&255,G[9]=It>>>8&255,G[10]=It>>>16&255,G[11]=It>>>24&255,G[12]=sr>>>0&255,G[13]=sr>>>8&255,G[14]=sr>>>16&255,G[15]=sr>>>24&255,G[16]=yt>>>0&255,G[17]=yt>>>8&255,G[18]=yt>>>16&255,G[19]=yt>>>24&255,G[20]=Te>>>0&255,G[21]=Te>>>8&255,G[22]=Te>>>16&255,G[23]=Te>>>24&255,G[24]=Dt>>>0&255,G[25]=Dt>>>8&255,G[26]=Dt>>>16&255,G[27]=Dt>>>24&255,G[28]=Tt>>>0&255,G[29]=Tt>>>8&255,G[30]=Tt>>>16&255,G[31]=Tt>>>24&255}function Ie(G,ee,Q,B){Se(G,ee,Q,B)}function Me(G,ee,Q,B){_e(G,ee,Q,B)}var Ve=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function Ke(G,ee,Q,B,ce,Qe,ot){var Lt=new Uint8Array(16),Ut=new Uint8Array(64),Ln,ln;for(ln=0;ln<16;ln++)Lt[ln]=0;for(ln=0;ln<8;ln++)Lt[ln]=Qe[ln];for(;ce>=64;){for(Ie(Ut,Lt,ot,Ve),ln=0;ln<64;ln++)G[ee+ln]=Q[B+ln]^Ut[ln];for(Ln=1,ln=8;ln<16;ln++)Ln=Ln+(Lt[ln]&255)|0,Lt[ln]=Ln&255,Ln>>>=8;ce-=64,ee+=64,B+=64}if(ce>0)for(Ie(Ut,Lt,ot,Ve),ln=0;ln<ce;ln++)G[ee+ln]=Q[B+ln]^Ut[ln];return 0}function et(G,ee,Q,B,ce){var Qe=new Uint8Array(16),ot=new Uint8Array(64),Lt,Ut;for(Ut=0;Ut<16;Ut++)Qe[Ut]=0;for(Ut=0;Ut<8;Ut++)Qe[Ut]=B[Ut];for(;Q>=64;){for(Ie(ot,Qe,ce,Ve),Ut=0;Ut<64;Ut++)G[ee+Ut]=ot[Ut];for(Lt=1,Ut=8;Ut<16;Ut++)Lt=Lt+(Qe[Ut]&255)|0,Qe[Ut]=Lt&255,Lt>>>=8;Q-=64,ee+=64}if(Q>0)for(Ie(ot,Qe,ce,Ve),Ut=0;Ut<Q;Ut++)G[ee+Ut]=ot[Ut];return 0}function qe(G,ee,Q,B,ce){var Qe=new Uint8Array(32);Me(Qe,B,ce,Ve);for(var ot=new Uint8Array(8),Lt=0;Lt<8;Lt++)ot[Lt]=B[Lt+16];return et(G,ee,Q,ot,Qe)}function ge(G,ee,Q,B,ce,Qe,ot){var Lt=new Uint8Array(32);Me(Lt,Qe,ot,Ve);for(var Ut=new Uint8Array(8),Ln=0;Ln<8;Ln++)Ut[Ln]=Qe[Ln+16];return Ke(G,ee,Q,B,ce,Ut,Lt)}var We=function(G){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var ee,Q,B,ce,Qe,ot,Lt,Ut;ee=G[0]&255|(G[1]&255)<<8,this.r[0]=ee&8191,Q=G[2]&255|(G[3]&255)<<8,this.r[1]=(ee>>>13|Q<<3)&8191,B=G[4]&255|(G[5]&255)<<8,this.r[2]=(Q>>>10|B<<6)&7939,ce=G[6]&255|(G[7]&255)<<8,this.r[3]=(B>>>7|ce<<9)&8191,Qe=G[8]&255|(G[9]&255)<<8,this.r[4]=(ce>>>4|Qe<<12)&255,this.r[5]=Qe>>>1&8190,ot=G[10]&255|(G[11]&255)<<8,this.r[6]=(Qe>>>14|ot<<2)&8191,Lt=G[12]&255|(G[13]&255)<<8,this.r[7]=(ot>>>11|Lt<<5)&8065,Ut=G[14]&255|(G[15]&255)<<8,this.r[8]=(Lt>>>8|Ut<<8)&8191,this.r[9]=Ut>>>5&127,this.pad[0]=G[16]&255|(G[17]&255)<<8,this.pad[1]=G[18]&255|(G[19]&255)<<8,this.pad[2]=G[20]&255|(G[21]&255)<<8,this.pad[3]=G[22]&255|(G[23]&255)<<8,this.pad[4]=G[24]&255|(G[25]&255)<<8,this.pad[5]=G[26]&255|(G[27]&255)<<8,this.pad[6]=G[28]&255|(G[29]&255)<<8,this.pad[7]=G[30]&255|(G[31]&255)<<8};We.prototype.blocks=function(G,ee,Q){for(var B=this.fin?0:2048,ce,Qe,ot,Lt,Ut,Ln,ln,or,Cn,ur,hr,bn,Sr,fr,On,Gn,yn,Pn,mn,Dn=this.h[0],En=this.h[1],cn=this.h[2],yt=this.h[3],Te=this.h[4],Dt=this.h[5],Tt=this.h[6],It=this.h[7],tn=this.h[8],Bn=this.h[9],pr=this.r[0],_r=this.r[1],sr=this.r[2],pe=this.r[3],wn=this.r[4],Tn=this.r[5],yr=this.r[6],ar=this.r[7],xn=this.r[8],Er=this.r[9];Q>=16;)ce=G[ee+0]&255|(G[ee+1]&255)<<8,Dn+=ce&8191,Qe=G[ee+2]&255|(G[ee+3]&255)<<8,En+=(ce>>>13|Qe<<3)&8191,ot=G[ee+4]&255|(G[ee+5]&255)<<8,cn+=(Qe>>>10|ot<<6)&8191,Lt=G[ee+6]&255|(G[ee+7]&255)<<8,yt+=(ot>>>7|Lt<<9)&8191,Ut=G[ee+8]&255|(G[ee+9]&255)<<8,Te+=(Lt>>>4|Ut<<12)&8191,Dt+=Ut>>>1&8191,Ln=G[ee+10]&255|(G[ee+11]&255)<<8,Tt+=(Ut>>>14|Ln<<2)&8191,ln=G[ee+12]&255|(G[ee+13]&255)<<8,It+=(Ln>>>11|ln<<5)&8191,or=G[ee+14]&255|(G[ee+15]&255)<<8,tn+=(ln>>>8|or<<8)&8191,Bn+=or>>>5|B,Cn=0,ur=Cn,ur+=Dn*pr,ur+=En*(5*Er),ur+=cn*(5*xn),ur+=yt*(5*ar),ur+=Te*(5*yr),Cn=ur>>>13,ur&=8191,ur+=Dt*(5*Tn),ur+=Tt*(5*wn),ur+=It*(5*pe),ur+=tn*(5*sr),ur+=Bn*(5*_r),Cn+=ur>>>13,ur&=8191,hr=Cn,hr+=Dn*_r,hr+=En*pr,hr+=cn*(5*Er),hr+=yt*(5*xn),hr+=Te*(5*ar),Cn=hr>>>13,hr&=8191,hr+=Dt*(5*yr),hr+=Tt*(5*Tn),hr+=It*(5*wn),hr+=tn*(5*pe),hr+=Bn*(5*sr),Cn+=hr>>>13,hr&=8191,bn=Cn,bn+=Dn*sr,bn+=En*_r,bn+=cn*pr,bn+=yt*(5*Er),bn+=Te*(5*xn),Cn=bn>>>13,bn&=8191,bn+=Dt*(5*ar),bn+=Tt*(5*yr),bn+=It*(5*Tn),bn+=tn*(5*wn),bn+=Bn*(5*pe),Cn+=bn>>>13,bn&=8191,Sr=Cn,Sr+=Dn*pe,Sr+=En*sr,Sr+=cn*_r,Sr+=yt*pr,Sr+=Te*(5*Er),Cn=Sr>>>13,Sr&=8191,Sr+=Dt*(5*xn),Sr+=Tt*(5*ar),Sr+=It*(5*yr),Sr+=tn*(5*Tn),Sr+=Bn*(5*wn),Cn+=Sr>>>13,Sr&=8191,fr=Cn,fr+=Dn*wn,fr+=En*pe,fr+=cn*sr,fr+=yt*_r,fr+=Te*pr,Cn=fr>>>13,fr&=8191,fr+=Dt*(5*Er),fr+=Tt*(5*xn),fr+=It*(5*ar),fr+=tn*(5*yr),fr+=Bn*(5*Tn),Cn+=fr>>>13,fr&=8191,On=Cn,On+=Dn*Tn,On+=En*wn,On+=cn*pe,On+=yt*sr,On+=Te*_r,Cn=On>>>13,On&=8191,On+=Dt*pr,On+=Tt*(5*Er),On+=It*(5*xn),On+=tn*(5*ar),On+=Bn*(5*yr),Cn+=On>>>13,On&=8191,Gn=Cn,Gn+=Dn*yr,Gn+=En*Tn,Gn+=cn*wn,Gn+=yt*pe,Gn+=Te*sr,Cn=Gn>>>13,Gn&=8191,Gn+=Dt*_r,Gn+=Tt*pr,Gn+=It*(5*Er),Gn+=tn*(5*xn),Gn+=Bn*(5*ar),Cn+=Gn>>>13,Gn&=8191,yn=Cn,yn+=Dn*ar,yn+=En*yr,yn+=cn*Tn,yn+=yt*wn,yn+=Te*pe,Cn=yn>>>13,yn&=8191,yn+=Dt*sr,yn+=Tt*_r,yn+=It*pr,yn+=tn*(5*Er),yn+=Bn*(5*xn),Cn+=yn>>>13,yn&=8191,Pn=Cn,Pn+=Dn*xn,Pn+=En*ar,Pn+=cn*yr,Pn+=yt*Tn,Pn+=Te*wn,Cn=Pn>>>13,Pn&=8191,Pn+=Dt*pe,Pn+=Tt*sr,Pn+=It*_r,Pn+=tn*pr,Pn+=Bn*(5*Er),Cn+=Pn>>>13,Pn&=8191,mn=Cn,mn+=Dn*Er,mn+=En*xn,mn+=cn*ar,mn+=yt*yr,mn+=Te*Tn,Cn=mn>>>13,mn&=8191,mn+=Dt*wn,mn+=Tt*pe,mn+=It*sr,mn+=tn*_r,mn+=Bn*pr,Cn+=mn>>>13,mn&=8191,Cn=(Cn<<2)+Cn|0,Cn=Cn+ur|0,ur=Cn&8191,Cn=Cn>>>13,hr+=Cn,Dn=ur,En=hr,cn=bn,yt=Sr,Te=fr,Dt=On,Tt=Gn,It=yn,tn=Pn,Bn=mn,ee+=16,Q-=16;this.h[0]=Dn,this.h[1]=En,this.h[2]=cn,this.h[3]=yt,this.h[4]=Te,this.h[5]=Dt,this.h[6]=Tt,this.h[7]=It,this.h[8]=tn,this.h[9]=Bn},We.prototype.finish=function(G,ee){var Q=new Uint16Array(10),B,ce,Qe,ot;if(this.leftover){for(ot=this.leftover,this.buffer[ot++]=1;ot<16;ot++)this.buffer[ot]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(B=this.h[1]>>>13,this.h[1]&=8191,ot=2;ot<10;ot++)this.h[ot]+=B,B=this.h[ot]>>>13,this.h[ot]&=8191;for(this.h[0]+=B*5,B=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=B,B=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=B,Q[0]=this.h[0]+5,B=Q[0]>>>13,Q[0]&=8191,ot=1;ot<10;ot++)Q[ot]=this.h[ot]+B,B=Q[ot]>>>13,Q[ot]&=8191;for(Q[9]-=8192,ce=(B^1)-1,ot=0;ot<10;ot++)Q[ot]&=ce;for(ce=~ce,ot=0;ot<10;ot++)this.h[ot]=this.h[ot]&ce|Q[ot];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,Qe=this.h[0]+this.pad[0],this.h[0]=Qe&65535,ot=1;ot<8;ot++)Qe=(this.h[ot]+this.pad[ot]|0)+(Qe>>>16)|0,this.h[ot]=Qe&65535;G[ee+0]=this.h[0]>>>0&255,G[ee+1]=this.h[0]>>>8&255,G[ee+2]=this.h[1]>>>0&255,G[ee+3]=this.h[1]>>>8&255,G[ee+4]=this.h[2]>>>0&255,G[ee+5]=this.h[2]>>>8&255,G[ee+6]=this.h[3]>>>0&255,G[ee+7]=this.h[3]>>>8&255,G[ee+8]=this.h[4]>>>0&255,G[ee+9]=this.h[4]>>>8&255,G[ee+10]=this.h[5]>>>0&255,G[ee+11]=this.h[5]>>>8&255,G[ee+12]=this.h[6]>>>0&255,G[ee+13]=this.h[6]>>>8&255,G[ee+14]=this.h[7]>>>0&255,G[ee+15]=this.h[7]>>>8&255},We.prototype.update=function(G,ee,Q){var B,ce;if(this.leftover){for(ce=16-this.leftover,ce>Q&&(ce=Q),B=0;B<ce;B++)this.buffer[this.leftover+B]=G[ee+B];if(Q-=ce,ee+=ce,this.leftover+=ce,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(Q>=16&&(ce=Q-Q%16,this.blocks(G,ee,ce),ee+=ce,Q-=ce),Q){for(B=0;B<Q;B++)this.buffer[this.leftover+B]=G[ee+B];this.leftover+=Q}};function Ue(G,ee,Q,B,ce,Qe){var ot=new We(Qe);return ot.update(Q,B,ce),ot.finish(G,ee),0}function lt(G,ee,Q,B,ce,Qe){var ot=new Uint8Array(16);return Ue(ot,0,Q,B,ce,Qe),se(G,ee,ot,0)}function ht(G,ee,Q,B,ce){var Qe;if(Q<32)return-1;for(ge(G,0,ee,0,Q,B,ce),Ue(G,16,G,32,Q-32,G),Qe=0;Qe<16;Qe++)G[Qe]=0;return 0}function Wt(G,ee,Q,B,ce){var Qe,ot=new Uint8Array(32);if(Q<32||(qe(ot,0,32,B,ce),lt(ee,16,ee,32,Q-32,ot)!==0))return-1;for(ge(G,0,ee,0,Q,B,ce),Qe=0;Qe<32;Qe++)G[Qe]=0;return 0}function In(G,ee){var Q;for(Q=0;Q<16;Q++)G[Q]=ee[Q]|0}function Sn(G){var ee,Q,B=1;for(ee=0;ee<16;ee++)Q=G[ee]+B+65535,B=Math.floor(Q/65536),G[ee]=Q-B*65536;G[0]+=B-1+37*(B-1)}function qt(G,ee,Q){for(var B,ce=~(Q-1),Qe=0;Qe<16;Qe++)B=ce&(G[Qe]^ee[Qe]),G[Qe]^=B,ee[Qe]^=B}function Bt(G,ee){var Q,B,ce,Qe=r(),ot=r();for(Q=0;Q<16;Q++)ot[Q]=ee[Q];for(Sn(ot),Sn(ot),Sn(ot),B=0;B<2;B++){for(Qe[0]=ot[0]-65517,Q=1;Q<15;Q++)Qe[Q]=ot[Q]-65535-(Qe[Q-1]>>16&1),Qe[Q-1]&=65535;Qe[15]=ot[15]-32767-(Qe[14]>>16&1),ce=Qe[15]>>16&1,Qe[14]&=65535,qt(ot,Qe,1-ce)}for(Q=0;Q<16;Q++)G[2*Q]=ot[Q]&255,G[2*Q+1]=ot[Q]>>8}function je(G,ee){var Q=new Uint8Array(32),B=new Uint8Array(32);return Bt(Q,G),Bt(B,ee),xe(Q,0,B,0)}function At(G){var ee=new Uint8Array(32);return Bt(ee,G),ee[0]&1}function sn(G,ee){var Q;for(Q=0;Q<16;Q++)G[Q]=ee[2*Q]+(ee[2*Q+1]<<8);G[15]&=32767}function zn(G,ee,Q){for(var B=0;B<16;B++)G[B]=ee[B]+Q[B]}function vn(G,ee,Q){for(var B=0;B<16;B++)G[B]=ee[B]-Q[B]}function Mn(G,ee,Q){var B,ce,Qe=0,ot=0,Lt=0,Ut=0,Ln=0,ln=0,or=0,Cn=0,ur=0,hr=0,bn=0,Sr=0,fr=0,On=0,Gn=0,yn=0,Pn=0,mn=0,Dn=0,En=0,cn=0,yt=0,Te=0,Dt=0,Tt=0,It=0,tn=0,Bn=0,pr=0,_r=0,sr=0,pe=Q[0],wn=Q[1],Tn=Q[2],yr=Q[3],ar=Q[4],xn=Q[5],Er=Q[6],ie=Q[7],ae=Q[8],Le=Q[9],tt=Q[10],zt=Q[11],an=Q[12],Qn=Q[13],Fr=Q[14],Vr=Q[15];B=ee[0],Qe+=B*pe,ot+=B*wn,Lt+=B*Tn,Ut+=B*yr,Ln+=B*ar,ln+=B*xn,or+=B*Er,Cn+=B*ie,ur+=B*ae,hr+=B*Le,bn+=B*tt,Sr+=B*zt,fr+=B*an,On+=B*Qn,Gn+=B*Fr,yn+=B*Vr,B=ee[1],ot+=B*pe,Lt+=B*wn,Ut+=B*Tn,Ln+=B*yr,ln+=B*ar,or+=B*xn,Cn+=B*Er,ur+=B*ie,hr+=B*ae,bn+=B*Le,Sr+=B*tt,fr+=B*zt,On+=B*an,Gn+=B*Qn,yn+=B*Fr,Pn+=B*Vr,B=ee[2],Lt+=B*pe,Ut+=B*wn,Ln+=B*Tn,ln+=B*yr,or+=B*ar,Cn+=B*xn,ur+=B*Er,hr+=B*ie,bn+=B*ae,Sr+=B*Le,fr+=B*tt,On+=B*zt,Gn+=B*an,yn+=B*Qn,Pn+=B*Fr,mn+=B*Vr,B=ee[3],Ut+=B*pe,Ln+=B*wn,ln+=B*Tn,or+=B*yr,Cn+=B*ar,ur+=B*xn,hr+=B*Er,bn+=B*ie,Sr+=B*ae,fr+=B*Le,On+=B*tt,Gn+=B*zt,yn+=B*an,Pn+=B*Qn,mn+=B*Fr,Dn+=B*Vr,B=ee[4],Ln+=B*pe,ln+=B*wn,or+=B*Tn,Cn+=B*yr,ur+=B*ar,hr+=B*xn,bn+=B*Er,Sr+=B*ie,fr+=B*ae,On+=B*Le,Gn+=B*tt,yn+=B*zt,Pn+=B*an,mn+=B*Qn,Dn+=B*Fr,En+=B*Vr,B=ee[5],ln+=B*pe,or+=B*wn,Cn+=B*Tn,ur+=B*yr,hr+=B*ar,bn+=B*xn,Sr+=B*Er,fr+=B*ie,On+=B*ae,Gn+=B*Le,yn+=B*tt,Pn+=B*zt,mn+=B*an,Dn+=B*Qn,En+=B*Fr,cn+=B*Vr,B=ee[6],or+=B*pe,Cn+=B*wn,ur+=B*Tn,hr+=B*yr,bn+=B*ar,Sr+=B*xn,fr+=B*Er,On+=B*ie,Gn+=B*ae,yn+=B*Le,Pn+=B*tt,mn+=B*zt,Dn+=B*an,En+=B*Qn,cn+=B*Fr,yt+=B*Vr,B=ee[7],Cn+=B*pe,ur+=B*wn,hr+=B*Tn,bn+=B*yr,Sr+=B*ar,fr+=B*xn,On+=B*Er,Gn+=B*ie,yn+=B*ae,Pn+=B*Le,mn+=B*tt,Dn+=B*zt,En+=B*an,cn+=B*Qn,yt+=B*Fr,Te+=B*Vr,B=ee[8],ur+=B*pe,hr+=B*wn,bn+=B*Tn,Sr+=B*yr,fr+=B*ar,On+=B*xn,Gn+=B*Er,yn+=B*ie,Pn+=B*ae,mn+=B*Le,Dn+=B*tt,En+=B*zt,cn+=B*an,yt+=B*Qn,Te+=B*Fr,Dt+=B*Vr,B=ee[9],hr+=B*pe,bn+=B*wn,Sr+=B*Tn,fr+=B*yr,On+=B*ar,Gn+=B*xn,yn+=B*Er,Pn+=B*ie,mn+=B*ae,Dn+=B*Le,En+=B*tt,cn+=B*zt,yt+=B*an,Te+=B*Qn,Dt+=B*Fr,Tt+=B*Vr,B=ee[10],bn+=B*pe,Sr+=B*wn,fr+=B*Tn,On+=B*yr,Gn+=B*ar,yn+=B*xn,Pn+=B*Er,mn+=B*ie,Dn+=B*ae,En+=B*Le,cn+=B*tt,yt+=B*zt,Te+=B*an,Dt+=B*Qn,Tt+=B*Fr,It+=B*Vr,B=ee[11],Sr+=B*pe,fr+=B*wn,On+=B*Tn,Gn+=B*yr,yn+=B*ar,Pn+=B*xn,mn+=B*Er,Dn+=B*ie,En+=B*ae,cn+=B*Le,yt+=B*tt,Te+=B*zt,Dt+=B*an,Tt+=B*Qn,It+=B*Fr,tn+=B*Vr,B=ee[12],fr+=B*pe,On+=B*wn,Gn+=B*Tn,yn+=B*yr,Pn+=B*ar,mn+=B*xn,Dn+=B*Er,En+=B*ie,cn+=B*ae,yt+=B*Le,Te+=B*tt,Dt+=B*zt,Tt+=B*an,It+=B*Qn,tn+=B*Fr,Bn+=B*Vr,B=ee[13],On+=B*pe,Gn+=B*wn,yn+=B*Tn,Pn+=B*yr,mn+=B*ar,Dn+=B*xn,En+=B*Er,cn+=B*ie,yt+=B*ae,Te+=B*Le,Dt+=B*tt,Tt+=B*zt,It+=B*an,tn+=B*Qn,Bn+=B*Fr,pr+=B*Vr,B=ee[14],Gn+=B*pe,yn+=B*wn,Pn+=B*Tn,mn+=B*yr,Dn+=B*ar,En+=B*xn,cn+=B*Er,yt+=B*ie,Te+=B*ae,Dt+=B*Le,Tt+=B*tt,It+=B*zt,tn+=B*an,Bn+=B*Qn,pr+=B*Fr,_r+=B*Vr,B=ee[15],yn+=B*pe,Pn+=B*wn,mn+=B*Tn,Dn+=B*yr,En+=B*ar,cn+=B*xn,yt+=B*Er,Te+=B*ie,Dt+=B*ae,Tt+=B*Le,It+=B*tt,tn+=B*zt,Bn+=B*an,pr+=B*Qn,_r+=B*Fr,sr+=B*Vr,Qe+=38*Pn,ot+=38*mn,Lt+=38*Dn,Ut+=38*En,Ln+=38*cn,ln+=38*yt,or+=38*Te,Cn+=38*Dt,ur+=38*Tt,hr+=38*It,bn+=38*tn,Sr+=38*Bn,fr+=38*pr,On+=38*_r,Gn+=38*sr,ce=1,B=Qe+ce+65535,ce=Math.floor(B/65536),Qe=B-ce*65536,B=ot+ce+65535,ce=Math.floor(B/65536),ot=B-ce*65536,B=Lt+ce+65535,ce=Math.floor(B/65536),Lt=B-ce*65536,B=Ut+ce+65535,ce=Math.floor(B/65536),Ut=B-ce*65536,B=Ln+ce+65535,ce=Math.floor(B/65536),Ln=B-ce*65536,B=ln+ce+65535,ce=Math.floor(B/65536),ln=B-ce*65536,B=or+ce+65535,ce=Math.floor(B/65536),or=B-ce*65536,B=Cn+ce+65535,ce=Math.floor(B/65536),Cn=B-ce*65536,B=ur+ce+65535,ce=Math.floor(B/65536),ur=B-ce*65536,B=hr+ce+65535,ce=Math.floor(B/65536),hr=B-ce*65536,B=bn+ce+65535,ce=Math.floor(B/65536),bn=B-ce*65536,B=Sr+ce+65535,ce=Math.floor(B/65536),Sr=B-ce*65536,B=fr+ce+65535,ce=Math.floor(B/65536),fr=B-ce*65536,B=On+ce+65535,ce=Math.floor(B/65536),On=B-ce*65536,B=Gn+ce+65535,ce=Math.floor(B/65536),Gn=B-ce*65536,B=yn+ce+65535,ce=Math.floor(B/65536),yn=B-ce*65536,Qe+=ce-1+37*(ce-1),ce=1,B=Qe+ce+65535,ce=Math.floor(B/65536),Qe=B-ce*65536,B=ot+ce+65535,ce=Math.floor(B/65536),ot=B-ce*65536,B=Lt+ce+65535,ce=Math.floor(B/65536),Lt=B-ce*65536,B=Ut+ce+65535,ce=Math.floor(B/65536),Ut=B-ce*65536,B=Ln+ce+65535,ce=Math.floor(B/65536),Ln=B-ce*65536,B=ln+ce+65535,ce=Math.floor(B/65536),ln=B-ce*65536,B=or+ce+65535,ce=Math.floor(B/65536),or=B-ce*65536,B=Cn+ce+65535,ce=Math.floor(B/65536),Cn=B-ce*65536,B=ur+ce+65535,ce=Math.floor(B/65536),ur=B-ce*65536,B=hr+ce+65535,ce=Math.floor(B/65536),hr=B-ce*65536,B=bn+ce+65535,ce=Math.floor(B/65536),bn=B-ce*65536,B=Sr+ce+65535,ce=Math.floor(B/65536),Sr=B-ce*65536,B=fr+ce+65535,ce=Math.floor(B/65536),fr=B-ce*65536,B=On+ce+65535,ce=Math.floor(B/65536),On=B-ce*65536,B=Gn+ce+65535,ce=Math.floor(B/65536),Gn=B-ce*65536,B=yn+ce+65535,ce=Math.floor(B/65536),yn=B-ce*65536,Qe+=ce-1+37*(ce-1),G[0]=Qe,G[1]=ot,G[2]=Lt,G[3]=Ut,G[4]=Ln,G[5]=ln,G[6]=or,G[7]=Cn,G[8]=ur,G[9]=hr,G[10]=bn,G[11]=Sr,G[12]=fr,G[13]=On,G[14]=Gn,G[15]=yn}function Yn(G,ee){Mn(G,ee,ee)}function ir(G,ee){var Q=r(),B;for(B=0;B<16;B++)Q[B]=ee[B];for(B=253;B>=0;B--)Yn(Q,Q),B!==2&&B!==4&&Mn(Q,Q,ee);for(B=0;B<16;B++)G[B]=Q[B]}function mt(G,ee){var Q=r(),B;for(B=0;B<16;B++)Q[B]=ee[B];for(B=250;B>=0;B--)Yn(Q,Q),B!==1&&Mn(Q,Q,ee);for(B=0;B<16;B++)G[B]=Q[B]}function bt(G,ee,Q){var B=new Uint8Array(32),ce=new Float64Array(80),Qe,ot,Lt=r(),Ut=r(),Ln=r(),ln=r(),or=r(),Cn=r();for(ot=0;ot<31;ot++)B[ot]=ee[ot];for(B[31]=ee[31]&127|64,B[0]&=248,sn(ce,Q),ot=0;ot<16;ot++)Ut[ot]=ce[ot],ln[ot]=Lt[ot]=Ln[ot]=0;for(Lt[0]=ln[0]=1,ot=254;ot>=0;--ot)Qe=B[ot>>>3]>>>(ot&7)&1,qt(Lt,Ut,Qe),qt(Ln,ln,Qe),zn(or,Lt,Ln),vn(Lt,Lt,Ln),zn(Ln,Ut,ln),vn(Ut,Ut,ln),Yn(ln,or),Yn(Cn,Lt),Mn(Lt,Ln,Lt),Mn(Ln,Ut,or),zn(or,Lt,Ln),vn(Lt,Lt,Ln),Yn(Ut,Lt),vn(Ln,ln,Cn),Mn(Lt,Ln,a),zn(Lt,Lt,ln),Mn(Ln,Ln,Lt),Mn(Lt,ln,Cn),Mn(ln,Ut,ce),Yn(Ut,or),qt(Lt,Ut,Qe),qt(Ln,ln,Qe);for(ot=0;ot<16;ot++)ce[ot+16]=Lt[ot],ce[ot+32]=Ln[ot],ce[ot+48]=Ut[ot],ce[ot+64]=ln[ot];var ur=ce.subarray(32),hr=ce.subarray(16);return ir(ur,ur),Mn(hr,hr,ur),Bt(G,hr),0}function xt(G,ee){return bt(G,ee,m)}function Nt(G,ee){return l(ee,32),xt(G,ee)}function wt(G,ee,Q){var B=new Uint8Array(32);return bt(B,Q,ee),Me(G,d,B,Ve)}var hn=ht,An=Wt;function Fn(G,ee,Q,B,ce,Qe){var ot=new Uint8Array(32);return wt(ot,ce,Qe),hn(G,ee,Q,B,ot)}function Nn(G,ee,Q,B,ce,Qe){var ot=new Uint8Array(32);return wt(ot,ce,Qe),An(G,ee,Q,B,ot)}var xr=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function nr(G,ee,Q,B){for(var ce=new Int32Array(16),Qe=new Int32Array(16),ot,Lt,Ut,Ln,ln,or,Cn,ur,hr,bn,Sr,fr,On,Gn,yn,Pn,mn,Dn,En,cn,yt,Te,Dt,Tt,It,tn,Bn=G[0],pr=G[1],_r=G[2],sr=G[3],pe=G[4],wn=G[5],Tn=G[6],yr=G[7],ar=ee[0],xn=ee[1],Er=ee[2],ie=ee[3],ae=ee[4],Le=ee[5],tt=ee[6],zt=ee[7],an=0;B>=128;){for(En=0;En<16;En++)cn=8*En+an,ce[En]=Q[cn+0]<<24|Q[cn+1]<<16|Q[cn+2]<<8|Q[cn+3],Qe[En]=Q[cn+4]<<24|Q[cn+5]<<16|Q[cn+6]<<8|Q[cn+7];for(En=0;En<80;En++)if(ot=Bn,Lt=pr,Ut=_r,Ln=sr,ln=pe,or=wn,Cn=Tn,ur=yr,hr=ar,bn=xn,Sr=Er,fr=ie,On=ae,Gn=Le,yn=tt,Pn=zt,yt=yr,Te=zt,Dt=Te&65535,Tt=Te>>>16,It=yt&65535,tn=yt>>>16,yt=(pe>>>14|ae<<18)^(pe>>>18|ae<<14)^(ae>>>9|pe<<23),Te=(ae>>>14|pe<<18)^(ae>>>18|pe<<14)^(pe>>>9|ae<<23),Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,yt=pe&wn^~pe&Tn,Te=ae&Le^~ae&tt,Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,yt=xr[En*2],Te=xr[En*2+1],Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,yt=ce[En%16],Te=Qe[En%16],Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,Tt+=Dt>>>16,It+=Tt>>>16,tn+=It>>>16,mn=It&65535|tn<<16,Dn=Dt&65535|Tt<<16,yt=mn,Te=Dn,Dt=Te&65535,Tt=Te>>>16,It=yt&65535,tn=yt>>>16,yt=(Bn>>>28|ar<<4)^(ar>>>2|Bn<<30)^(ar>>>7|Bn<<25),Te=(ar>>>28|Bn<<4)^(Bn>>>2|ar<<30)^(Bn>>>7|ar<<25),Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,yt=Bn&pr^Bn&_r^pr&_r,Te=ar&xn^ar&Er^xn&Er,Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,Tt+=Dt>>>16,It+=Tt>>>16,tn+=It>>>16,ur=It&65535|tn<<16,Pn=Dt&65535|Tt<<16,yt=Ln,Te=fr,Dt=Te&65535,Tt=Te>>>16,It=yt&65535,tn=yt>>>16,yt=mn,Te=Dn,Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,Tt+=Dt>>>16,It+=Tt>>>16,tn+=It>>>16,Ln=It&65535|tn<<16,fr=Dt&65535|Tt<<16,pr=ot,_r=Lt,sr=Ut,pe=Ln,wn=ln,Tn=or,yr=Cn,Bn=ur,xn=hr,Er=bn,ie=Sr,ae=fr,Le=On,tt=Gn,zt=yn,ar=Pn,En%16===15)for(cn=0;cn<16;cn++)yt=ce[cn],Te=Qe[cn],Dt=Te&65535,Tt=Te>>>16,It=yt&65535,tn=yt>>>16,yt=ce[(cn+9)%16],Te=Qe[(cn+9)%16],Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,mn=ce[(cn+1)%16],Dn=Qe[(cn+1)%16],yt=(mn>>>1|Dn<<31)^(mn>>>8|Dn<<24)^mn>>>7,Te=(Dn>>>1|mn<<31)^(Dn>>>8|mn<<24)^(Dn>>>7|mn<<25),Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,mn=ce[(cn+14)%16],Dn=Qe[(cn+14)%16],yt=(mn>>>19|Dn<<13)^(Dn>>>29|mn<<3)^mn>>>6,Te=(Dn>>>19|mn<<13)^(mn>>>29|Dn<<3)^(Dn>>>6|mn<<26),Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,Tt+=Dt>>>16,It+=Tt>>>16,tn+=It>>>16,ce[cn]=It&65535|tn<<16,Qe[cn]=Dt&65535|Tt<<16;yt=Bn,Te=ar,Dt=Te&65535,Tt=Te>>>16,It=yt&65535,tn=yt>>>16,yt=G[0],Te=ee[0],Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,Tt+=Dt>>>16,It+=Tt>>>16,tn+=It>>>16,G[0]=Bn=It&65535|tn<<16,ee[0]=ar=Dt&65535|Tt<<16,yt=pr,Te=xn,Dt=Te&65535,Tt=Te>>>16,It=yt&65535,tn=yt>>>16,yt=G[1],Te=ee[1],Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,Tt+=Dt>>>16,It+=Tt>>>16,tn+=It>>>16,G[1]=pr=It&65535|tn<<16,ee[1]=xn=Dt&65535|Tt<<16,yt=_r,Te=Er,Dt=Te&65535,Tt=Te>>>16,It=yt&65535,tn=yt>>>16,yt=G[2],Te=ee[2],Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,Tt+=Dt>>>16,It+=Tt>>>16,tn+=It>>>16,G[2]=_r=It&65535|tn<<16,ee[2]=Er=Dt&65535|Tt<<16,yt=sr,Te=ie,Dt=Te&65535,Tt=Te>>>16,It=yt&65535,tn=yt>>>16,yt=G[3],Te=ee[3],Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,Tt+=Dt>>>16,It+=Tt>>>16,tn+=It>>>16,G[3]=sr=It&65535|tn<<16,ee[3]=ie=Dt&65535|Tt<<16,yt=pe,Te=ae,Dt=Te&65535,Tt=Te>>>16,It=yt&65535,tn=yt>>>16,yt=G[4],Te=ee[4],Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,Tt+=Dt>>>16,It+=Tt>>>16,tn+=It>>>16,G[4]=pe=It&65535|tn<<16,ee[4]=ae=Dt&65535|Tt<<16,yt=wn,Te=Le,Dt=Te&65535,Tt=Te>>>16,It=yt&65535,tn=yt>>>16,yt=G[5],Te=ee[5],Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,Tt+=Dt>>>16,It+=Tt>>>16,tn+=It>>>16,G[5]=wn=It&65535|tn<<16,ee[5]=Le=Dt&65535|Tt<<16,yt=Tn,Te=tt,Dt=Te&65535,Tt=Te>>>16,It=yt&65535,tn=yt>>>16,yt=G[6],Te=ee[6],Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,Tt+=Dt>>>16,It+=Tt>>>16,tn+=It>>>16,G[6]=Tn=It&65535|tn<<16,ee[6]=tt=Dt&65535|Tt<<16,yt=yr,Te=zt,Dt=Te&65535,Tt=Te>>>16,It=yt&65535,tn=yt>>>16,yt=G[7],Te=ee[7],Dt+=Te&65535,Tt+=Te>>>16,It+=yt&65535,tn+=yt>>>16,Tt+=Dt>>>16,It+=Tt>>>16,tn+=It>>>16,G[7]=yr=It&65535|tn<<16,ee[7]=zt=Dt&65535|Tt<<16,an+=128,B-=128}return B}function Zr(G,ee,Q){var B=new Int32Array(8),ce=new Int32Array(8),Qe=new Uint8Array(256),ot,Lt=Q;for(B[0]=1779033703,B[1]=3144134277,B[2]=1013904242,B[3]=2773480762,B[4]=1359893119,B[5]=2600822924,B[6]=528734635,B[7]=1541459225,ce[0]=4089235720,ce[1]=2227873595,ce[2]=4271175723,ce[3]=1595750129,ce[4]=2917565137,ce[5]=725511199,ce[6]=4215389547,ce[7]=327033209,nr(B,ce,ee,Q),Q%=128,ot=0;ot<Q;ot++)Qe[ot]=ee[Lt-Q+ot];for(Qe[Q]=128,Q=256-128*(Q<112?1:0),Qe[Q-9]=0,Y(Qe,Q-8,Lt/536870912|0,Lt<<3),nr(B,ce,Qe,Q),ot=0;ot<8;ot++)Y(G,8*ot,B[ot],ce[ot]);return 0}function Br(G,ee){var Q=r(),B=r(),ce=r(),Qe=r(),ot=r(),Lt=r(),Ut=r(),Ln=r(),ln=r();vn(Q,G[1],G[0]),vn(ln,ee[1],ee[0]),Mn(Q,Q,ln),zn(B,G[0],G[1]),zn(ln,ee[0],ee[1]),Mn(B,B,ln),Mn(ce,G[3],ee[3]),Mn(ce,ce,R),Mn(Qe,G[2],ee[2]),zn(Qe,Qe,Qe),vn(ot,B,Q),vn(Lt,Qe,ce),zn(Ut,Qe,ce),zn(Ln,B,Q),Mn(G[0],ot,Lt),Mn(G[1],Ln,Ut),Mn(G[2],Ut,Lt),Mn(G[3],ot,Ln)}function ui(G,ee,Q){var B;for(B=0;B<4;B++)qt(G[B],ee[B],Q)}function gi(G,ee){var Q=r(),B=r(),ce=r();ir(ce,ee[2]),Mn(Q,ee[0],ce),Mn(B,ee[1],ce),Bt(G,B),G[31]^=At(Q)<<7}function Xi(G,ee,Q){var B,ce;for(In(G[0],x),In(G[1],C),In(G[2],C),In(G[3],x),ce=255;ce>=0;--ce)B=Q[ce/8|0]>>(ce&7)&1,ui(G,ee,B),Br(ee,G),Br(G,G),ui(G,ee,B)}function Ri(G,ee){var Q=[r(),r(),r(),r()];In(Q[0],j),In(Q[1],F),In(Q[2],C),Mn(Q[3],j,F),Xi(G,Q,ee)}function dr(G,ee,Q){var B=new Uint8Array(64),ce=[r(),r(),r(),r()],Qe;for(Q||l(ee,32),Zr(B,ee,32),B[0]&=248,B[31]&=127,B[31]|=64,Ri(ce,B),gi(G,ce),Qe=0;Qe<32;Qe++)ee[Qe+32]=G[Qe];return 0}var Nr=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function cr(G,ee){var Q,B,ce,Qe;for(B=63;B>=32;--B){for(Q=0,ce=B-32,Qe=B-12;ce<Qe;++ce)ee[ce]+=Q-16*ee[B]*Nr[ce-(B-32)],Q=Math.floor((ee[ce]+128)/256),ee[ce]-=Q*256;ee[ce]+=Q,ee[B]=0}for(Q=0,ce=0;ce<32;ce++)ee[ce]+=Q-(ee[31]>>4)*Nr[ce],Q=ee[ce]>>8,ee[ce]&=255;for(ce=0;ce<32;ce++)ee[ce]-=Q*Nr[ce];for(B=0;B<32;B++)ee[B+1]+=ee[B]>>8,G[B]=ee[B]&255}function Cr(G){var ee=new Float64Array(64),Q;for(Q=0;Q<64;Q++)ee[Q]=G[Q];for(Q=0;Q<64;Q++)G[Q]=0;cr(G,ee)}function Oi(G,ee,Q,B){var ce=new Uint8Array(64),Qe=new Uint8Array(64),ot=new Uint8Array(64),Lt,Ut,Ln=new Float64Array(64),ln=[r(),r(),r(),r()];Zr(ce,B,32),ce[0]&=248,ce[31]&=127,ce[31]|=64;var or=Q+64;for(Lt=0;Lt<Q;Lt++)G[64+Lt]=ee[Lt];for(Lt=0;Lt<32;Lt++)G[32+Lt]=ce[32+Lt];for(Zr(ot,G.subarray(32),Q+32),Cr(ot),Ri(ln,ot),gi(G,ln),Lt=32;Lt<64;Lt++)G[Lt]=B[Lt];for(Zr(Qe,G,Q+64),Cr(Qe),Lt=0;Lt<64;Lt++)Ln[Lt]=0;for(Lt=0;Lt<32;Lt++)Ln[Lt]=ot[Lt];for(Lt=0;Lt<32;Lt++)for(Ut=0;Ut<32;Ut++)Ln[Lt+Ut]+=Qe[Lt]*ce[Ut];return cr(G.subarray(32),Ln),or}function Di(G,ee){var Q=r(),B=r(),ce=r(),Qe=r(),ot=r(),Lt=r(),Ut=r();return In(G[2],C),sn(G[1],ee),Yn(ce,G[1]),Mn(Qe,ce,M),vn(ce,ce,G[2]),zn(Qe,G[2],Qe),Yn(ot,Qe),Yn(Lt,ot),Mn(Ut,Lt,ot),Mn(Q,Ut,ce),Mn(Q,Q,Qe),mt(Q,Q),Mn(Q,Q,ce),Mn(Q,Q,Qe),Mn(Q,Q,Qe),Mn(G[0],Q,Qe),Yn(B,G[0]),Mn(B,B,Qe),je(B,ce)&&Mn(G[0],G[0],Z),Yn(B,G[0]),Mn(B,B,Qe),je(B,ce)?-1:(At(G[0])===ee[31]>>7&&vn(G[0],x,G[0]),Mn(G[3],G[0],G[1]),0)}function wr(G,ee,Q,B){var ce,Qe=new Uint8Array(32),ot=new Uint8Array(64),Lt=[r(),r(),r(),r()],Ut=[r(),r(),r(),r()];if(Q<64||Di(Ut,B))return-1;for(ce=0;ce<Q;ce++)G[ce]=ee[ce];for(ce=0;ce<32;ce++)G[ce+32]=B[ce];if(Zr(ot,G,Q),Cr(ot),Xi(Lt,Ut,ot),Ri(Ut,ee.subarray(32)),Br(Lt,Ut),gi(Qe,Lt),Q-=64,xe(ee,0,Qe,0)){for(ce=0;ce<Q;ce++)G[ce]=0;return-1}for(ce=0;ce<Q;ce++)G[ce]=ee[ce+64];return Q}var rr=32,Fi=24,ao=32,lo=16,Ao=32,Fo=32,go=32,rs=32,Ae=32,J=Fi,te=ao,ke=lo,Oe=64,Ge=32,rt=64,it=32,Ze=64;t.lowlevel={crypto_core_hsalsa20:Me,crypto_stream_xor:ge,crypto_stream:qe,crypto_stream_salsa20_xor:Ke,crypto_stream_salsa20:et,crypto_onetimeauth:Ue,crypto_onetimeauth_verify:lt,crypto_verify_16:se,crypto_verify_32:xe,crypto_secretbox:ht,crypto_secretbox_open:Wt,crypto_scalarmult:bt,crypto_scalarmult_base:xt,crypto_box_beforenm:wt,crypto_box_afternm:hn,crypto_box:Fn,crypto_box_open:Nn,crypto_box_keypair:Nt,crypto_hash:Zr,crypto_sign:Oi,crypto_sign_keypair:dr,crypto_sign_open:wr,crypto_secretbox_KEYBYTES:rr,crypto_secretbox_NONCEBYTES:Fi,crypto_secretbox_ZEROBYTES:ao,crypto_secretbox_BOXZEROBYTES:lo,crypto_scalarmult_BYTES:Ao,crypto_scalarmult_SCALARBYTES:Fo,crypto_box_PUBLICKEYBYTES:go,crypto_box_SECRETKEYBYTES:rs,crypto_box_BEFORENMBYTES:Ae,crypto_box_NONCEBYTES:J,crypto_box_ZEROBYTES:te,crypto_box_BOXZEROBYTES:ke,crypto_sign_BYTES:Oe,crypto_sign_PUBLICKEYBYTES:Ge,crypto_sign_SECRETKEYBYTES:rt,crypto_sign_SEEDBYTES:it,crypto_hash_BYTES:Ze,gf:r,D:M,L:Nr,pack25519:Bt,unpack25519:sn,M:Mn,A:zn,S:Yn,Z:vn,pow2523:mt,add:Br,set25519:In,modL:cr,scalarmult:Xi,scalarbase:Ri};function dt(G,ee){if(G.length!==rr)throw new Error("bad key size");if(ee.length!==Fi)throw new Error("bad nonce size")}function Xt(G,ee){if(G.length!==go)throw new Error("bad public key size");if(ee.length!==rs)throw new Error("bad secret key size")}function Gt(){for(var G=0;G<arguments.length;G++)if(!(arguments[G]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function $t(G){for(var ee=0;ee<G.length;ee++)G[ee]=0}t.randomBytes=function(G){var ee=new Uint8Array(G);return l(ee,G),ee},t.secretbox=function(G,ee,Q){Gt(G,ee,Q),dt(Q,ee);for(var B=new Uint8Array(ao+G.length),ce=new Uint8Array(B.length),Qe=0;Qe<G.length;Qe++)B[Qe+ao]=G[Qe];return ht(ce,B,B.length,ee,Q),ce.subarray(lo)},t.secretbox.open=function(G,ee,Q){Gt(G,ee,Q),dt(Q,ee);for(var B=new Uint8Array(lo+G.length),ce=new Uint8Array(B.length),Qe=0;Qe<G.length;Qe++)B[Qe+lo]=G[Qe];return B.length<32||Wt(ce,B,B.length,ee,Q)!==0?null:ce.subarray(ao)},t.secretbox.keyLength=rr,t.secretbox.nonceLength=Fi,t.secretbox.overheadLength=lo,t.scalarMult=function(G,ee){if(Gt(G,ee),G.length!==Fo)throw new Error("bad n size");if(ee.length!==Ao)throw new Error("bad p size");var Q=new Uint8Array(Ao);return bt(Q,G,ee),Q},t.scalarMult.base=function(G){if(Gt(G),G.length!==Fo)throw new Error("bad n size");var ee=new Uint8Array(Ao);return xt(ee,G),ee},t.scalarMult.scalarLength=Fo,t.scalarMult.groupElementLength=Ao,t.box=function(G,ee,Q,B){var ce=t.box.before(Q,B);return t.secretbox(G,ee,ce)},t.box.before=function(G,ee){Gt(G,ee),Xt(G,ee);var Q=new Uint8Array(Ae);return wt(Q,G,ee),Q},t.box.after=t.secretbox,t.box.open=function(G,ee,Q,B){var ce=t.box.before(Q,B);return t.secretbox.open(G,ee,ce)},t.box.open.after=t.secretbox.open,t.box.keyPair=function(){var G=new Uint8Array(go),ee=new Uint8Array(rs);return Nt(G,ee),{publicKey:G,secretKey:ee}},t.box.keyPair.fromSecretKey=function(G){if(Gt(G),G.length!==rs)throw new Error("bad secret key size");var ee=new Uint8Array(go);return xt(ee,G),{publicKey:ee,secretKey:new Uint8Array(G)}},t.box.publicKeyLength=go,t.box.secretKeyLength=rs,t.box.sharedKeyLength=Ae,t.box.nonceLength=J,t.box.overheadLength=t.secretbox.overheadLength,t.sign=function(G,ee){if(Gt(G,ee),ee.length!==rt)throw new Error("bad secret key size");var Q=new Uint8Array(Oe+G.length);return Oi(Q,G,G.length,ee),Q},t.sign.open=function(G,ee){if(Gt(G,ee),ee.length!==Ge)throw new Error("bad public key size");var Q=new Uint8Array(G.length),B=wr(Q,G,G.length,ee);if(B<0)return null;for(var ce=new Uint8Array(B),Qe=0;Qe<ce.length;Qe++)ce[Qe]=Q[Qe];return ce},t.sign.detached=function(G,ee){for(var Q=t.sign(G,ee),B=new Uint8Array(Oe),ce=0;ce<B.length;ce++)B[ce]=Q[ce];return B},t.sign.detached.verify=function(G,ee,Q){if(Gt(G,ee,Q),ee.length!==Oe)throw new Error("bad signature size");if(Q.length!==Ge)throw new Error("bad public key size");var B=new Uint8Array(Oe+G.length),ce=new Uint8Array(Oe+G.length),Qe;for(Qe=0;Qe<Oe;Qe++)B[Qe]=ee[Qe];for(Qe=0;Qe<G.length;Qe++)B[Qe+Oe]=G[Qe];return wr(ce,B,B.length,Q)>=0},t.sign.keyPair=function(){var G=new Uint8Array(Ge),ee=new Uint8Array(rt);return dr(G,ee),{publicKey:G,secretKey:ee}},t.sign.keyPair.fromSecretKey=function(G){if(Gt(G),G.length!==rt)throw new Error("bad secret key size");for(var ee=new Uint8Array(Ge),Q=0;Q<ee.length;Q++)ee[Q]=G[32+Q];return{publicKey:ee,secretKey:new Uint8Array(G)}},t.sign.keyPair.fromSeed=function(G){if(Gt(G),G.length!==it)throw new Error("bad seed size");for(var ee=new Uint8Array(Ge),Q=new Uint8Array(rt),B=0;B<32;B++)Q[B]=G[B];return dr(ee,Q,!0),{publicKey:ee,secretKey:Q}},t.sign.publicKeyLength=Ge,t.sign.secretKeyLength=rt,t.sign.seedLength=it,t.sign.signatureLength=Oe,t.hash=function(G){Gt(G);var ee=new Uint8Array(Ze);return Zr(ee,G,G.length),ee},t.hash.hashLength=Ze,t.verify=function(G,ee){return Gt(G,ee),G.length===0||ee.length===0||G.length!==ee.length?!1:ne(G,0,ee,0,G.length)===0},t.setPRNG=function(G){l=G},function(){var G=typeof self<"u"?self.crypto||self.msCrypto:null;if(G&&G.getRandomValues){var ee=65536;t.setPRNG(function(Q,B){var ce,Qe=new Uint8Array(B);for(ce=0;ce<B;ce+=ee)G.getRandomValues(Qe.subarray(ce,ce+Math.min(B-ce,ee)));for(ce=0;ce<B;ce++)Q[ce]=Qe[ce];$t(Qe)})}else typeof V2<"u"&&(G=G2,G&&G.randomBytes&&t.setPRNG(function(Q,B){var ce,Qe=G.randomBytes(B);for(ce=0;ce<B;ce++)Q[ce]=Qe[ce];$t(Qe)}))}()})(n.exports?n.exports:self.nacl=self.nacl||{})}(kv)),kv.exports}var H2=Z2();const H1=cu(H2);var hd;(function(n){n[n.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",n[n.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",n[n.MANIFEST_NOT_FOUND_ERROR=2]="MANIFEST_NOT_FOUND_ERROR",n[n.MANIFEST_CONTENT_ERROR=3]="MANIFEST_CONTENT_ERROR",n[n.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",n[n.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",n[n.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"})(hd||(hd={}));var p5;(function(n){n[n.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",n[n.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"})(p5||(p5={}));var Em;(function(n){n[n.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",n[n.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",n[n.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",n[n.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",n[n.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"})(Em||(Em={}));var m5;(function(n){n[n.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",n[n.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",n[n.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",n[n.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",n[n.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"})(m5||(m5={}));var g5;(function(n){n[n.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",n[n.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",n[n.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",n[n.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"})(g5||(g5={}));var I_;(function(n){n.MAINNET="-239",n.TESTNET="-3"})(I_||(I_={}));function K2(n,t){const r=T0.encodeBase64(n);return t?encodeURIComponent(r):r}function X2(n,t){return t&&(n=decodeURIComponent(n)),T0.decodeBase64(n)}function Y2(n,t=!1){let r;return n instanceof Uint8Array?r=n:(typeof n!="string"&&(n=JSON.stringify(n)),r=T0.decodeUTF8(n)),K2(r,t)}function J2(n,t=!1){const r=X2(n,t);return{toString(){return T0.encodeUTF8(r)},toObject(){try{return JSON.parse(T0.encodeUTF8(r))}catch{return null}},toUint8Array(){return r}}}const vw={encode:Y2,decode:J2};function Q2(n,t){const r=new Uint8Array(n.length+t.length);return r.set(n),r.set(t,n.length),r}function eA(n,t){if(t>=n.length)throw new Error("Index is out of buffer");const r=n.slice(0,t),l=n.slice(t);return[r,l]}function Mv(n){let t="";return n.forEach(r=>{t+=("0"+(r&255).toString(16)).slice(-2)}),t}function L_(n){if(n.length%2!==0)throw new Error(`Cannot convert ${n} to bytesArray`);const t=new Uint8Array(n.length/2);for(let r=0;r<n.length;r+=2)t[r/2]=parseInt(n.slice(r,r+2),16);return t}class _x{constructor(t){this.nonceLength=24,this.keyPair=t?this.createKeypairFromString(t):this.createKeypair(),this.sessionId=Mv(this.keyPair.publicKey)}createKeypair(){return H1.box.keyPair()}createKeypairFromString(t){return{publicKey:L_(t.publicKey),secretKey:L_(t.secretKey)}}createNonce(){return H1.randomBytes(this.nonceLength)}encrypt(t,r){const l=new TextEncoder().encode(t),d=this.createNonce(),m=H1.box(l,d,r,this.keyPair.secretKey);return Q2(d,m)}decrypt(t,r){const[l,d]=eA(t,this.nonceLength),m=H1.box.open(d,l,r,this.keyPair.secretKey);if(!m)throw new Error(`Decryption error: 
 message: ${t.toString()} 
 sender pubkey: ${r.toString()} 
 keypair pubkey: ${this.keyPair.publicKey.toString()} 
 keypair secretkey: ${this.keyPair.secretKey.toString()}`);return new TextDecoder().decode(m)}stringifyKeypair(){return{publicKey:Mv(this.keyPair.publicKey),secretKey:Mv(this.keyPair.secretKey)}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function tA(n,t){var r={};for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&t.indexOf(l)<0&&(r[l]=n[l]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,l=Object.getOwnPropertySymbols(n);d<l.length;d++)t.indexOf(l[d])<0&&Object.prototype.propertyIsEnumerable.call(n,l[d])&&(r[l[d]]=n[l[d]]);return r}function Xn(n,t,r,l){function d(m){return m instanceof r?m:new r(function(x){x(m)})}return new(r||(r=Promise))(function(m,x){function C(R){try{M(l.next(R))}catch(j){x(j)}}function a(R){try{M(l.throw(R))}catch(j){x(j)}}function M(R){R.done?m(R.value):d(R.value).then(C,a)}M((l=l.apply(n,[])).next())})}class br extends Error{constructor(t,r){super(t,r),this.message=`${br.prefix} ${this.constructor.name}${this.info?": "+this.info:""}${t?`
`+t:""}`,Object.setPrototypeOf(this,br.prototype)}get info(){return""}}br.prefix="[TON_CONNECT_SDK_ERROR]";class xw extends br{get info(){return"Passed DappMetadata is in incorrect format."}constructor(...t){super(...t),Object.setPrototypeOf(this,xw.prototype)}}class uy extends br{get info(){return"Passed `tonconnect-manifest.json` contains errors. Check format of your manifest. See more https://github.com/ton-connect/docs/blob/main/requests-responses.md#app-manifest"}constructor(...t){super(...t),Object.setPrototypeOf(this,uy.prototype)}}class hy extends br{get info(){return"Manifest not found. Make sure you added `tonconnect-manifest.json` to the root of your app or passed correct manifestUrl. See more https://github.com/ton-connect/docs/blob/main/requests-responses.md#app-manifest"}constructor(...t){super(...t),Object.setPrototypeOf(this,hy.prototype)}}class ww extends br{get info(){return"Wallet connection called but wallet already connected. To avoid the error, disconnect the wallet before doing a new connection."}constructor(...t){super(...t),Object.setPrototypeOf(this,ww.prototype)}}class R_ extends br{get info(){return"Send transaction or other protocol methods called while wallet is not connected."}constructor(...t){super(...t),Object.setPrototypeOf(this,R_.prototype)}}function nA(n){return"jsBridgeKey"in n}class dy extends br{get info(){return"User rejects the action in the wallet."}constructor(...t){super(...t),Object.setPrototypeOf(this,dy.prototype)}}class fy extends br{get info(){return"Request to the wallet contains errors."}constructor(...t){super(...t),Object.setPrototypeOf(this,fy.prototype)}}class py extends br{get info(){return"App tries to send rpc request to the injected wallet while not connected."}constructor(...t){super(...t),Object.setPrototypeOf(this,py.prototype)}}class bw extends br{get info(){return"There is an attempt to connect to the injected wallet while it is not exists in the webpage."}constructor(...t){super(...t),Object.setPrototypeOf(this,bw.prototype)}}class Ew extends br{get info(){return"An error occurred while fetching the wallets list."}constructor(...t){super(...t),Object.setPrototypeOf(this,Ew.prototype)}}class Tm extends br{get info(){return"Passed address is in incorrect format."}constructor(...t){super(...t),Object.setPrototypeOf(this,Tm.prototype)}}class O_ extends br{get info(){return"Passed hex is in incorrect format."}constructor(...t){super(...t),Object.setPrototypeOf(this,O_.prototype)}}class Cd extends br{constructor(...t){super(...t),Object.setPrototypeOf(this,Cd.prototype)}}const _5={[hd.UNKNOWN_ERROR]:Cd,[hd.USER_REJECTS_ERROR]:dy,[hd.BAD_REQUEST_ERROR]:fy,[hd.UNKNOWN_APP_ERROR]:py,[hd.MANIFEST_NOT_FOUND_ERROR]:hy,[hd.MANIFEST_CONTENT_ERROR]:uy};class rA{parseError(t){let r=Cd;return t.code in _5&&(r=_5[t.code]||Cd),new r(t.message)}}const iA=new rA;class oA{isError(t){return"error"in t}}const y5={[Em.UNKNOWN_ERROR]:Cd,[Em.USER_REJECTS_ERROR]:dy,[Em.BAD_REQUEST_ERROR]:fy,[Em.UNKNOWN_APP_ERROR]:py};class sA extends oA{convertToRpcRequest(t){return{method:"sendTransaction",params:[JSON.stringify(t)]}}parseAndThrowError(t){let r=Cd;throw t.error.code in y5&&(r=y5[t.error.code]||Cd),new r(t.error.message)}convertFromRpcResponse(t){return{boc:t.result}}}const K1=new sA;class aA{constructor(t,r){this.storage=t,this.storeKey="ton-connect-storage_http-bridge-gateway::"+r}storeLastEventId(t){return Xn(this,void 0,void 0,function*(){return this.storage.setItem(this.storeKey,t)})}removeLastEventId(){return Xn(this,void 0,void 0,function*(){return this.storage.removeItem(this.storeKey)})}getLastEventId(){return Xn(this,void 0,void 0,function*(){const t=yield this.storage.getItem(this.storeKey);return t||null})}}function lA(n){return n.slice(-1)==="/"?n.slice(0,-1):n}function cC(n,t){return lA(n)+"/"+t}function Yf(n){if(!n)return!1;const t=new URL(n);return t.protocol==="tg:"||t.hostname==="t.me"}function uC(n){return n.replaceAll(".","%2E").replaceAll("-","%2D").replaceAll("_","%5F").replaceAll("&","-").replaceAll("=","__").replaceAll("%","--")}function hC(n,t){return Xn(this,void 0,void 0,function*(){return new Promise((r,l)=>{var d,m;if(!((d=void 0)===null||d===void 0)&&d.aborted){l(new br("Delay aborted"));return}const x=setTimeout(()=>r(),n);(m=void 0)===null||m===void 0||m.addEventListener("abort",()=>{clearTimeout(x),l(new br("Delay aborted"))})})})}function tc(n){const t=new AbortController;return n?.aborted?t.abort():n?.addEventListener("abort",()=>t.abort(),{once:!0}),t}function l0(n,t){var r,l;return Xn(this,void 0,void 0,function*(){const d=(r=t?.attempts)!==null&&r!==void 0?r:10,m=(l=t?.delayMs)!==null&&l!==void 0?l:200,x=tc(t?.signal);if(typeof n!="function")throw new br(`Expected a function, got ${typeof n}`);let C=0,a;for(;C<d;){if(x.signal.aborted)throw new br(`Aborted after attempts ${C}`);try{return yield n({signal:x.signal})}catch(M){a=M,C++,C<d&&(yield hC(m))}}throw a})}function ts(...n){try{console.debug("[TON_CONNECT_SDK]",...n)}catch{}}function Qc(...n){try{console.error("[TON_CONNECT_SDK]",...n)}catch{}}function cA(...n){try{console.warn("[TON_CONNECT_SDK]",...n)}catch{}}function uA(n,t){let r=null,l=null,d=null,m=null,x=null;const C=(j,...F)=>Xn(this,void 0,void 0,function*(){if(m=j??null,x?.abort(),x=tc(j),x.signal.aborted)throw new br("Resource creation was aborted");l=F??null;const Z=n(x.signal,...F);d=Z;const Y=yield Z;if(d!==Z&&Y!==r)throw yield t(Y),new br("Resource creation was aborted by a new resource creation");return r=Y,r});return{create:C,current:()=>r??null,dispose:()=>Xn(this,void 0,void 0,function*(){try{const j=r;r=null;const F=d;d=null;try{x?.abort()}catch{}yield Promise.allSettled([j?t(j):Promise.resolve(),F?t(yield F):Promise.resolve()])}catch{}}),recreate:j=>Xn(this,void 0,void 0,function*(){const F=r,Z=d,Y=l,ne=m;if(yield hC(j),F===r&&Z===d&&Y===l&&ne===m)return yield C(m,...Y??[]);throw new br("Resource recreation was aborted by a new resource creation")})}}function hA(n,t){const r=t?.timeout,l=t?.signal,d=tc(l);return new Promise((m,x)=>{if(d.signal.aborted){x(new br("Operation aborted"));return}let C;typeof r<"u"&&(C=setTimeout(()=>{d.abort(),x(new br(`Timeout after ${r}ms`))},r)),d.signal.addEventListener("abort",()=>{clearTimeout(C),x(new br("Operation aborted"))},{once:!0});const a={timeout:r,abort:d.signal};n(m,x,a).finally(()=>clearTimeout(C))})}class Av{constructor(t,r,l,d,m){this.bridgeUrl=r,this.sessionId=l,this.listener=d,this.errorsListener=m,this.ssePath="events",this.postPath="message",this.heartbeatMessage="heartbeat",this.defaultTtl=300,this.defaultReconnectDelay=5e3,this.eventSource=uA((x,C)=>Xn(this,void 0,void 0,function*(){const a={bridgeUrl:this.bridgeUrl,ssePath:this.ssePath,sessionId:this.sessionId,bridgeGatewayStorage:this.bridgeGatewayStorage,errorHandler:this.errorsHandler.bind(this),messageHandler:this.messagesHandler.bind(this),signal:x,openingDeadlineMS:C};return yield dA(a)}),x=>Xn(this,void 0,void 0,function*(){x.close()})),this.bridgeGatewayStorage=new aA(t,r)}get isReady(){const t=this.eventSource.current();return t?.readyState===EventSource.OPEN}get isClosed(){const t=this.eventSource.current();return t?.readyState!==EventSource.OPEN}get isConnecting(){const t=this.eventSource.current();return t?.readyState===EventSource.CONNECTING}registerSession(t){return Xn(this,void 0,void 0,function*(){yield this.eventSource.create(t?.signal,t?.openingDeadlineMS)})}send(t,r,l,d){var m;return Xn(this,void 0,void 0,function*(){const x={};typeof d=="number"?x.ttl=d:(x.ttl=d?.ttl,x.signal=d?.signal,x.attempts=d?.attempts);const C=new URL(cC(this.bridgeUrl,this.postPath));C.searchParams.append("client_id",this.sessionId),C.searchParams.append("to",r),C.searchParams.append("ttl",(x?.ttl||this.defaultTtl).toString()),C.searchParams.append("topic",l);const a=vw.encode(t);yield l0(M=>Xn(this,void 0,void 0,function*(){const R=yield this.post(C,a,M.signal);if(!R.ok)throw new br(`Bridge send failed, status ${R.status}`)}),{attempts:(m=x?.attempts)!==null&&m!==void 0?m:Number.MAX_SAFE_INTEGER,delayMs:5e3,signal:x?.signal})})}pause(){this.eventSource.dispose().catch(t=>Qc(`Bridge pause failed, ${t}`))}unPause(){return Xn(this,void 0,void 0,function*(){yield this.eventSource.recreate(0)})}close(){return Xn(this,void 0,void 0,function*(){yield this.eventSource.dispose().catch(t=>Qc(`Bridge close failed, ${t}`))})}setListener(t){this.listener=t}setErrorsListener(t){this.errorsListener=t}post(t,r,l){return Xn(this,void 0,void 0,function*(){const d=yield fetch(t,{method:"post",body:r,signal:l});if(!d.ok)throw new br(`Bridge send failed, status ${d.status}`);return d})}errorsHandler(t,r){return Xn(this,void 0,void 0,function*(){if(this.isConnecting){Qc("Bridge error",JSON.stringify(r));return}if(this.isReady){try{this.errorsListener(r)}catch{}return}if(this.isClosed)return t.close(),ts(`Bridge reconnecting, ${this.defaultReconnectDelay}ms delay`),yield this.eventSource.recreate(this.defaultReconnectDelay);throw new br("Bridge error, unknown state")})}messagesHandler(t){return Xn(this,void 0,void 0,function*(){if(t.data===this.heartbeatMessage||(yield this.bridgeGatewayStorage.storeLastEventId(t.lastEventId),this.isClosed))return;let r;try{r=JSON.parse(t.data)}catch(l){throw new br(`Bridge message parse failed, message ${l.data}`)}this.listener(r)})}}function dA(n){return Xn(this,void 0,void 0,function*(){return yield hA((t,r,l)=>Xn(this,void 0,void 0,function*(){var d;const x=tc(l.signal).signal;if(x.aborted){r(new br("Bridge connection aborted"));return}const C=new URL(cC(n.bridgeUrl,n.ssePath));C.searchParams.append("client_id",n.sessionId);const a=yield n.bridgeGatewayStorage.getLastEventId();if(a&&C.searchParams.append("last_event_id",a),x.aborted){r(new br("Bridge connection aborted"));return}const M=new EventSource(C.toString());M.onerror=R=>Xn(this,void 0,void 0,function*(){if(x.aborted){M.close(),r(new br("Bridge connection aborted"));return}try{const j=yield n.errorHandler(M,R);j!==M&&M.close(),j&&j!==M&&t(j)}catch(j){M.close(),r(j)}}),M.onopen=()=>{if(x.aborted){M.close(),r(new br("Bridge connection aborted"));return}t(M)},M.onmessage=R=>{if(x.aborted){M.close(),r(new br("Bridge connection aborted"));return}n.messageHandler(R)},(d=n.signal)===null||d===void 0||d.addEventListener("abort",()=>{M.close(),r(new br("Bridge connection aborted"))})}),{timeout:n.openingDeadlineMS,signal:n.signal})})}function c0(n){return!("connectEvent"in n)}class C0{constructor(t){this.storage=t,this.storeKey="ton-connect-storage_bridge-connection"}storeConnection(t){return Xn(this,void 0,void 0,function*(){if(t.type==="injected")return this.storage.setItem(this.storeKey,JSON.stringify(t));if(!c0(t)){const l={sessionKeyPair:t.session.sessionCrypto.stringifyKeypair(),walletPublicKey:t.session.walletPublicKey,bridgeUrl:t.session.bridgeUrl},d={type:"http",connectEvent:t.connectEvent,session:l,lastWalletEventId:t.lastWalletEventId,nextRpcRequestId:t.nextRpcRequestId};return this.storage.setItem(this.storeKey,JSON.stringify(d))}const r={type:"http",connectionSource:t.connectionSource,sessionCrypto:t.sessionCrypto.stringifyKeypair()};return this.storage.setItem(this.storeKey,JSON.stringify(r))})}removeConnection(){return Xn(this,void 0,void 0,function*(){return this.storage.removeItem(this.storeKey)})}getConnection(){return Xn(this,void 0,void 0,function*(){const t=yield this.storage.getItem(this.storeKey);if(!t)return null;const r=JSON.parse(t);if(r.type==="injected")return r;if("connectEvent"in r){const l=new _x(r.session.sessionKeyPair);return{type:"http",connectEvent:r.connectEvent,lastWalletEventId:r.lastWalletEventId,nextRpcRequestId:r.nextRpcRequestId,session:{sessionCrypto:l,bridgeUrl:r.session.bridgeUrl,walletPublicKey:r.session.walletPublicKey}}}return{type:"http",sessionCrypto:new _x(r.sessionCrypto),connectionSource:r.connectionSource}})}getHttpConnection(){return Xn(this,void 0,void 0,function*(){const t=yield this.getConnection();if(!t)throw new br("Trying to read HTTP connection source while nothing is stored");if(t.type==="injected")throw new br("Trying to read HTTP connection source while injected connection is stored");return t})}getHttpPendingConnection(){return Xn(this,void 0,void 0,function*(){const t=yield this.getConnection();if(!t)throw new br("Trying to read HTTP connection source while nothing is stored");if(t.type==="injected")throw new br("Trying to read HTTP connection source while injected connection is stored");if(!c0(t))throw new br("Trying to read HTTP-pending connection while http connection is stored");return t})}getInjectedConnection(){return Xn(this,void 0,void 0,function*(){const t=yield this.getConnection();if(!t)throw new br("Trying to read Injected bridge connection source while nothing is stored");if(t?.type==="http")throw new br("Trying to read Injected bridge connection source while HTTP connection is stored");return t})}storedConnectionType(){return Xn(this,void 0,void 0,function*(){const t=yield this.storage.getItem(this.storeKey);return t?JSON.parse(t).type:null})}storeLastWalletEventId(t){return Xn(this,void 0,void 0,function*(){const r=yield this.getConnection();if(r&&r.type==="http"&&!c0(r))return r.lastWalletEventId=t,this.storeConnection(r)})}getLastWalletEventId(){return Xn(this,void 0,void 0,function*(){const t=yield this.getConnection();if(t&&"lastWalletEventId"in t)return t.lastWalletEventId})}increaseNextRpcRequestId(){return Xn(this,void 0,void 0,function*(){const t=yield this.getConnection();if(t&&"nextRpcRequestId"in t){const r=t.nextRpcRequestId||0;return t.nextRpcRequestId=r+1,this.storeConnection(t)}})}getNextRpcRequestId(){return Xn(this,void 0,void 0,function*(){const t=yield this.getConnection();return t&&"nextRpcRequestId"in t&&t.nextRpcRequestId||0})}}const dC=2;class S0{constructor(t,r){this.storage=t,this.walletConnectionSource=r,this.type="http",this.standardUniversalLink="tc://",this.pendingRequests=new Map,this.session=null,this.gateway=null,this.pendingGateways=[],this.listeners=[],this.defaultOpeningDeadlineMS=5e3,this.connectionStorage=new C0(t)}static fromStorage(t){return Xn(this,void 0,void 0,function*(){const l=yield new C0(t).getHttpConnection();return c0(l)?new S0(t,l.connectionSource):new S0(t,{bridgeUrl:l.session.bridgeUrl})})}connect(t,r){var l;const d=tc(r?.signal);(l=this.abortController)===null||l===void 0||l.abort(),this.abortController=d,this.closeGateways();const m=new _x;this.session={sessionCrypto:m,bridgeUrl:"bridgeUrl"in this.walletConnectionSource?this.walletConnectionSource.bridgeUrl:""},this.connectionStorage.storeConnection({type:"http",connectionSource:this.walletConnectionSource,sessionCrypto:m}).then(()=>Xn(this,void 0,void 0,function*(){d.signal.aborted||(yield l0(C=>this.openGateways(m,{openingDeadlineMS:r?.openingDeadlineMS,signal:C?.signal}),{attempts:Number.MAX_SAFE_INTEGER,delayMs:5e3,signal:d.signal}))}));const x="universalLink"in this.walletConnectionSource&&this.walletConnectionSource.universalLink?this.walletConnectionSource.universalLink:this.standardUniversalLink;return this.generateUniversalLink(x,t)}restoreConnection(t){var r,l;return Xn(this,void 0,void 0,function*(){const d=tc(t?.signal);if((r=this.abortController)===null||r===void 0||r.abort(),this.abortController=d,d.signal.aborted)return;this.closeGateways();const m=yield this.connectionStorage.getHttpConnection();if(!m||d.signal.aborted)return;const x=(l=t?.openingDeadlineMS)!==null&&l!==void 0?l:this.defaultOpeningDeadlineMS;if(c0(m))return this.session={sessionCrypto:m.sessionCrypto,bridgeUrl:"bridgeUrl"in this.walletConnectionSource?this.walletConnectionSource.bridgeUrl:""},yield this.openGateways(m.sessionCrypto,{openingDeadlineMS:x,signal:d?.signal});if(Array.isArray(this.walletConnectionSource))throw new br("Internal error. Connection source is array while WalletConnectionSourceHTTP was expected.");if(this.session=m.session,this.gateway&&(ts("Gateway is already opened, closing previous gateway"),yield this.gateway.close()),this.gateway=new Av(this.storage,this.walletConnectionSource.bridgeUrl,m.session.sessionCrypto.sessionId,this.gatewayListener.bind(this),this.gatewayErrorsListener.bind(this)),!d.signal.aborted){this.listeners.forEach(C=>C(m.connectEvent));try{yield l0(C=>this.gateway.registerSession({openingDeadlineMS:x,signal:C.signal}),{attempts:Number.MAX_SAFE_INTEGER,delayMs:5e3,signal:d.signal})}catch{yield this.disconnect({signal:d.signal});return}}})}sendRequest(t,r){const l={};return typeof r=="function"?l.onRequestSent=r:(l.onRequestSent=r?.onRequestSent,l.signal=r?.signal,l.attempts=r?.attempts),new Promise((d,m)=>Xn(this,void 0,void 0,function*(){var x;if(!this.gateway||!this.session||!("walletPublicKey"in this.session))throw new br("Trying to send bridge request without session");const C=(yield this.connectionStorage.getNextRpcRequestId()).toString();yield this.connectionStorage.increaseNextRpcRequestId(),ts("Send http-bridge request:",Object.assign(Object.assign({},t),{id:C}));const a=this.session.sessionCrypto.encrypt(JSON.stringify(Object.assign(Object.assign({},t),{id:C})),L_(this.session.walletPublicKey));try{yield this.gateway.send(a,this.session.walletPublicKey,t.method,{attempts:l?.attempts,signal:l?.signal}),(x=l?.onRequestSent)===null||x===void 0||x.call(l),this.pendingRequests.set(C.toString(),d)}catch(M){m(M)}}))}closeConnection(){this.closeGateways(),this.listeners=[],this.session=null,this.gateway=null}disconnect(t){return Xn(this,void 0,void 0,function*(){return new Promise(r=>Xn(this,void 0,void 0,function*(){let l=!1,d=null;const m=()=>{l||(l=!0,this.removeBridgeAndSession().then(r))};try{this.closeGateways();const x=tc(t?.signal);d=setTimeout(()=>{x.abort()},this.defaultOpeningDeadlineMS),yield this.sendRequest({method:"disconnect",params:[]},{onRequestSent:m,signal:x.signal,attempts:1})}catch(x){ts("Disconnect error:",x),l||this.removeBridgeAndSession().then(r)}finally{d&&clearTimeout(d),m()}}))})}listen(t){return this.listeners.push(t),()=>this.listeners=this.listeners.filter(r=>r!==t)}pause(){var t;(t=this.gateway)===null||t===void 0||t.pause(),this.pendingGateways.forEach(r=>r.pause())}unPause(){return Xn(this,void 0,void 0,function*(){const t=this.pendingGateways.map(r=>r.unPause());this.gateway&&t.push(this.gateway.unPause()),yield Promise.all(t)})}pendingGatewaysListener(t,r,l){return Xn(this,void 0,void 0,function*(){if(!this.pendingGateways.includes(t)){yield t.close();return}return this.closeGateways({except:t}),this.gateway&&(ts("Gateway is already opened, closing previous gateway"),yield this.gateway.close()),this.session.bridgeUrl=r,this.gateway=t,this.gateway.setErrorsListener(this.gatewayErrorsListener.bind(this)),this.gateway.setListener(this.gatewayListener.bind(this)),this.gatewayListener(l)})}gatewayListener(t){return Xn(this,void 0,void 0,function*(){const r=JSON.parse(this.session.sessionCrypto.decrypt(vw.decode(t.message).toUint8Array(),L_(t.from)));if(ts("Wallet message received:",r),!("event"in r)){const d=r.id.toString(),m=this.pendingRequests.get(d);if(!m){ts(`Response id ${d} doesn't match any request's id`);return}m(r),this.pendingRequests.delete(d);return}if(r.id!==void 0){const d=yield this.connectionStorage.getLastWalletEventId();if(d!==void 0&&r.id<=d){Qc(`Received event id (=${r.id}) must be greater than stored last wallet event id (=${d}) `);return}r.event!=="connect"&&(yield this.connectionStorage.storeLastWalletEventId(r.id))}const l=this.listeners;r.event==="connect"&&(yield this.updateSession(r,t.from)),r.event==="disconnect"&&(ts("Removing bridge and session: received disconnect event"),yield this.removeBridgeAndSession()),l.forEach(d=>d(r))})}gatewayErrorsListener(t){return Xn(this,void 0,void 0,function*(){throw new br(`Bridge error ${JSON.stringify(t)}`)})}updateSession(t,r){return Xn(this,void 0,void 0,function*(){this.session=Object.assign(Object.assign({},this.session),{walletPublicKey:r});const l=t.payload.items.find(m=>m.name==="ton_addr"),d=Object.assign(Object.assign({},t),{payload:Object.assign(Object.assign({},t.payload),{items:[l]})});yield this.connectionStorage.storeConnection({type:"http",session:this.session,lastWalletEventId:t.id,connectEvent:d,nextRpcRequestId:0})})}removeBridgeAndSession(){return Xn(this,void 0,void 0,function*(){this.closeConnection(),yield this.connectionStorage.removeConnection()})}generateUniversalLink(t,r){return Yf(t)?this.generateTGUniversalLink(t,r):this.generateRegularUniversalLink(t,r)}generateRegularUniversalLink(t,r){const l=new URL(t);return l.searchParams.append("v",dC.toString()),l.searchParams.append("id",this.session.sessionCrypto.sessionId),l.searchParams.append("r",JSON.stringify(r)),l.toString()}generateTGUniversalLink(t,r){const d=this.generateRegularUniversalLink("about:blank",r).split("?")[1],m="tonconnect-"+uC(d),x=this.convertToDirectLink(t),C=new URL(x);return C.searchParams.append("startapp",m),C.toString()}convertToDirectLink(t){const r=new URL(t);return r.searchParams.has("attach")&&(r.searchParams.delete("attach"),r.pathname+="/start"),r.toString()}openGateways(t,r){return Xn(this,void 0,void 0,function*(){if(Array.isArray(this.walletConnectionSource)){this.pendingGateways.map(l=>l.close().catch()),this.pendingGateways=this.walletConnectionSource.map(l=>{const d=new Av(this.storage,l.bridgeUrl,t.sessionId,()=>{},()=>{});return d.setListener(m=>this.pendingGatewaysListener(d,l.bridgeUrl,m)),d}),yield Promise.allSettled(this.pendingGateways.map(l=>l0(d=>this.pendingGateways.some(m=>m===l)?l.registerSession({openingDeadlineMS:r?.openingDeadlineMS,signal:d.signal}):l.close(),{attempts:Number.MAX_SAFE_INTEGER,delayMs:5e3,signal:r?.signal})));return}else return this.gateway&&(ts("Gateway is already opened, closing previous gateway"),yield this.gateway.close()),this.gateway=new Av(this.storage,this.walletConnectionSource.bridgeUrl,t.sessionId,this.gatewayListener.bind(this),this.gatewayErrorsListener.bind(this)),yield this.gateway.registerSession({openingDeadlineMS:r?.openingDeadlineMS,signal:r?.signal})})}closeGateways(t){var r;(r=this.gateway)===null||r===void 0||r.close(),this.pendingGateways.filter(l=>l!==t?.except).forEach(l=>l.close()),this.pendingGateways=[]}}function v5(n,t){return fC(n,[t])}function fC(n,t){return!n||typeof n!="object"?!1:t.every(r=>r in n)}function fA(n){try{return!v5(n,"tonconnect")||!v5(n.tonconnect,"walletInfo")?!1:fC(n.tonconnect.walletInfo,["name","app_name","image","about_url","platforms"])}catch{return!1}}let pA=class Yg{constructor(){this.storage={}}static getInstance(){return Yg.instance||(Yg.instance=new Yg),Yg.instance}get length(){return Object.keys(this.storage).length}clear(){this.storage={}}getItem(t){var r;return(r=this.storage[t])!==null&&r!==void 0?r:null}key(t){var r;const l=Object.keys(this.storage);return t<0||t>=l.length?null:(r=l[t])!==null&&r!==void 0?r:null}removeItem(t){delete this.storage[t]}setItem(t,r){this.storage[t]=r}};function my(){if(!(typeof window>"u"))return window}function mA(){const n=my();if(!n)return[];try{return Object.keys(n)}catch{return[]}}function gA(){if(!(typeof document>"u"))return document}function _A(){var n;const t=(n=my())===null||n===void 0?void 0:n.location.origin;return t?t+"/tonconnect-manifest.json":""}function yA(){if(vA())return localStorage;if(xA())throw new br("`localStorage` is unavailable, but it is required for TonConnect. For more details, see https://github.com/ton-connect/sdk/tree/main/packages/sdk#init-connector");return pA.getInstance()}function vA(){try{return typeof localStorage<"u"}catch{return!1}}function xA(){return typeof process<"u"&&process.versions!=null&&process.versions.node!=null}class Aa{constructor(t,r){this.injectedWalletKey=r,this.type="injected",this.unsubscribeCallback=null,this.listenSubscriptions=!1,this.listeners=[];const l=Aa.window;if(!Aa.isWindowContainsWallet(l,r))throw new bw;this.connectionStorage=new C0(t),this.injectedWallet=l[r].tonconnect}static fromStorage(t){return Xn(this,void 0,void 0,function*(){const l=yield new C0(t).getInjectedConnection();return new Aa(t,l.jsBridgeKey)})}static isWalletInjected(t){return Aa.isWindowContainsWallet(this.window,t)}static isInsideWalletBrowser(t){return Aa.isWindowContainsWallet(this.window,t)?this.window[t].tonconnect.isWalletBrowser:!1}static getCurrentlyInjectedWallets(){return this.window?mA().filter(([l,d])=>fA(d)).map(([l,d])=>({name:d.tonconnect.walletInfo.name,appName:d.tonconnect.walletInfo.app_name,aboutUrl:d.tonconnect.walletInfo.about_url,imageUrl:d.tonconnect.walletInfo.image,tondns:d.tonconnect.walletInfo.tondns,jsBridgeKey:l,injected:!0,embedded:d.tonconnect.isWalletBrowser,platforms:d.tonconnect.walletInfo.platforms})):[]}static isWindowContainsWallet(t,r){return!!t&&r in t&&typeof t[r]=="object"&&"tonconnect"in t[r]}connect(t){this._connect(dC,t)}restoreConnection(){return Xn(this,void 0,void 0,function*(){try{ts("Injected Provider restoring connection...");const t=yield this.injectedWallet.restoreConnection();ts("Injected Provider restoring connection response",t),t.event==="connect"?(this.makeSubscriptions(),this.listeners.forEach(r=>r(t))):yield this.connectionStorage.removeConnection()}catch(t){yield this.connectionStorage.removeConnection(),console.error(t)}})}closeConnection(){this.listenSubscriptions&&this.injectedWallet.disconnect(),this.closeAllListeners()}disconnect(){return Xn(this,void 0,void 0,function*(){return new Promise(t=>{const r=()=>{this.closeAllListeners(),this.connectionStorage.removeConnection().then(t)};try{this.injectedWallet.disconnect(),r()}catch(l){ts(l),this.sendRequest({method:"disconnect",params:[]},r)}})})}closeAllListeners(){var t;this.listenSubscriptions=!1,this.listeners=[],(t=this.unsubscribeCallback)===null||t===void 0||t.call(this)}listen(t){return this.listeners.push(t),()=>this.listeners=this.listeners.filter(r=>r!==t)}sendRequest(t,r){var l;return Xn(this,void 0,void 0,function*(){const d={};typeof r=="function"?d.onRequestSent=r:(d.onRequestSent=r?.onRequestSent,d.signal=r?.signal);const m=(yield this.connectionStorage.getNextRpcRequestId()).toString();yield this.connectionStorage.increaseNextRpcRequestId(),ts("Send injected-bridge request:",Object.assign(Object.assign({},t),{id:m}));const x=this.injectedWallet.send(Object.assign(Object.assign({},t),{id:m}));return x.then(C=>ts("Wallet message received:",C)),(l=d?.onRequestSent)===null||l===void 0||l.call(d),x})}_connect(t,r){return Xn(this,void 0,void 0,function*(){try{ts(`Injected Provider connect request: protocolVersion: ${t}, message:`,r);const l=yield this.injectedWallet.connect(t,r);ts("Injected Provider connect response:",l),l.event==="connect"&&(yield this.updateSession(),this.makeSubscriptions()),this.listeners.forEach(d=>d(l))}catch(l){ts("Injected Provider connect error:",l);const d={event:"connect_error",payload:{code:0,message:l?.toString()}};this.listeners.forEach(m=>m(d))}})}makeSubscriptions(){this.listenSubscriptions=!0,this.unsubscribeCallback=this.injectedWallet.listen(t=>{ts("Wallet message received:",t),this.listenSubscriptions&&this.listeners.forEach(r=>r(t)),t.event==="disconnect"&&this.disconnect()})}updateSession(){return this.connectionStorage.storeConnection({type:"injected",jsBridgeKey:this.injectedWalletKey,nextRpcRequestId:0})}}Aa.window=my();class wA{constructor(){this.localStorage=yA()}getItem(t){return Xn(this,void 0,void 0,function*(){return this.localStorage.getItem(t)})}removeItem(t){return Xn(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}setItem(t,r){return Xn(this,void 0,void 0,function*(){this.localStorage.setItem(t,r)})}}function Jf(n){return bA(n)&&n.injected}function gy(n){return Jf(n)&&n.embedded}function bA(n){return"jsBridgeKey"in n}function Tw(n){return"bridgeUrl"in n}const EA=[{app_name:"telegram-wallet",name:"Wallet",image:"https://wallet.tg/images/logo-288.png",about_url:"https://wallet.tg/",universal_url:"https://t.me/wallet?attach=wallet",bridge:[{type:"sse",url:"https://bridge.tonapi.io/bridge"}],platforms:["ios","android","macos","windows","linux"]},{app_name:"tonkeeper",name:"Tonkeeper",image:"https://tonkeeper.com/assets/tonconnect-icon.png",tondns:"tonkeeper.ton",about_url:"https://tonkeeper.com",universal_url:"https://app.tonkeeper.com/ton-connect",deepLink:"tonkeeper-tc://",bridge:[{type:"sse",url:"https://bridge.tonapi.io/bridge"},{type:"js",key:"tonkeeper"}],platforms:["ios","android","chrome","firefox","macos"]},{app_name:"mytonwallet",name:"MyTonWallet",image:"https://mytonwallet.io/icon-256.png",about_url:"https://mytonwallet.io",universal_url:"https://connect.mytonwallet.org",bridge:[{type:"js",key:"mytonwallet"},{type:"sse",url:"https://tonconnectbridge.mytonwallet.org/bridge/"}],platforms:["chrome","windows","macos","linux","ios","android","firefox"]},{app_name:"openmask",name:"OpenMask",image:"https://raw.githubusercontent.com/OpenProduct/openmask-extension/main/public/openmask-logo-288.png",about_url:"https://www.openmask.app/",bridge:[{type:"js",key:"openmask"}],platforms:["chrome"]},{app_name:"tonhub",name:"Tonhub",image:"https://tonhub.com/tonconnect_logo.png",about_url:"https://tonhub.com",universal_url:"https://tonhub.com/ton-connect",bridge:[{type:"js",key:"tonhub"},{type:"sse",url:"https://connect.tonhubapi.com/tonconnect"}],platforms:["ios","android"]},{app_name:"dewallet",name:"DeWallet",image:"https://app.delabwallet.com/logo_black.png",about_url:"https://delabwallet.com",bridge:[{type:"js",key:"dewallet"}],platforms:["chrome"]},{app_name:"xtonwallet",name:"XTONWallet",image:"https://xtonwallet.com/assets/img/icon-256-back.png",about_url:"https://xtonwallet.com",bridge:[{type:"js",key:"xtonwallet"}],platforms:["chrome","firefox"]},{app_name:"tonwallet",name:"TON Wallet",image:"https://wallet.ton.org/assets/ui/qr-logo.png",about_url:"https://chrome.google.com/webstore/detail/ton-wallet/nphplpgoakhhjchkkhmiggakijnkhfnd",bridge:[{type:"js",key:"tonwallet"}],platforms:["chrome"]}];class yx{constructor(t){this.walletsListCache=null,this.walletsListCacheCreationTimestamp=null,this.walletsListSource="https://raw.githubusercontent.com/ton-blockchain/wallets-list/main/wallets-v2.json",t?.walletsListSource&&(this.walletsListSource=t.walletsListSource),t?.cacheTTLMs&&(this.cacheTTLMs=t.cacheTTLMs)}getWallets(){return Xn(this,void 0,void 0,function*(){return this.cacheTTLMs&&this.walletsListCacheCreationTimestamp&&Date.now()>this.walletsListCacheCreationTimestamp+this.cacheTTLMs&&(this.walletsListCache=null),this.walletsListCache||(this.walletsListCache=this.fetchWalletsList(),this.walletsListCache.then(()=>{this.walletsListCacheCreationTimestamp=Date.now()}).catch(()=>{this.walletsListCache=null,this.walletsListCacheCreationTimestamp=null})),this.walletsListCache})}getEmbeddedWallet(){return Xn(this,void 0,void 0,function*(){const r=(yield this.getWallets()).filter(gy);return r.length!==1?null:r[0]})}fetchWalletsList(){return Xn(this,void 0,void 0,function*(){let t=[];try{if(t=yield(yield fetch(this.walletsListSource)).json(),!Array.isArray(t))throw new Ew("Wrong wallets list format, wallets list must be an array.");const d=t.filter(m=>!this.isCorrectWalletConfigDTO(m));d.length&&(Qc(`Wallet(s) ${d.map(m=>m.name).join(", ")} config format is wrong. They were removed from the wallets list.`),t=t.filter(m=>this.isCorrectWalletConfigDTO(m)))}catch(l){Qc(l),t=EA}let r=[];try{r=Aa.getCurrentlyInjectedWallets()}catch(l){Qc(l)}return this.mergeWalletsLists(this.walletConfigDTOListToWalletConfigList(t),r)})}walletConfigDTOListToWalletConfigList(t){return t.map(r=>{const d={name:r.name,appName:r.app_name,imageUrl:r.image,aboutUrl:r.about_url,tondns:r.tondns,platforms:r.platforms};return r.bridge.forEach(m=>{if(m.type==="sse"&&(d.bridgeUrl=m.url,d.universalLink=r.universal_url,d.deepLink=r.deepLink),m.type==="js"){const x=m.key;d.jsBridgeKey=x,d.injected=Aa.isWalletInjected(x),d.embedded=Aa.isInsideWalletBrowser(x)}}),d})}mergeWalletsLists(t,r){return[...new Set(t.concat(r).map(d=>d.name)).values()].map(d=>{const m=t.find(C=>C.name===d),x=r.find(C=>C.name===d);return Object.assign(Object.assign({},m&&Object.assign({},m)),x&&Object.assign({},x))})}isCorrectWalletConfigDTO(t){if(!t||typeof t!="object")return!1;const r="name"in t,l="app_name"in t,d="image"in t,m="about_url"in t,x="platforms"in t;if(!r||!d||!m||!x||!l||!t.platforms||!Array.isArray(t.platforms)||!t.platforms.length||!("bridge"in t)||!Array.isArray(t.bridge)||!t.bridge.length)return!1;const C=t.bridge;if(C.some(R=>!R||typeof R!="object"||!("type"in R)))return!1;const a=C.find(R=>R.type==="sse");if(a&&(!("url"in a)||!a.url||!t.universal_url))return!1;const M=C.find(R=>R.type==="js");return!(M&&(!("key"in M)||!M.key))}}class D_ extends br{get info(){return"Wallet doesn't support requested feature method."}constructor(...t){super(...t),Object.setPrototypeOf(this,D_.prototype)}}function TA(n,t){const r=n.includes("SendTransaction"),l=n.find(d=>d&&typeof d=="object"&&d.name==="SendTransaction");if(!r&&!l)throw new D_("Wallet doesn't support SendTransaction feature.");if(l&&l.maxMessages!==void 0){if(l.maxMessages<t.requiredMessagesNumber)throw new D_(`Wallet is not able to handle such SendTransaction request. Max support messages number is ${l.maxMessages}, but ${t.requiredMessagesNumber} is required.`);return}cA("Connected wallet didn't provide information about max allowed messages in the SendTransaction request. Request may be rejected by the wallet.")}function pC(){return{type:"request-version"}}function mC(n){return{type:"response-version",version:n}}function ip(n){return{ton_connect_sdk_lib:n.ton_connect_sdk_lib,ton_connect_ui_lib:n.ton_connect_ui_lib}}function $m(n,t){var r,l,d,m,x,C,a,M;const j=((r=t?.connectItems)===null||r===void 0?void 0:r.tonProof)&&"proof"in t.connectItems.tonProof?"ton_proof":"ton_addr";return{wallet_address:(d=(l=t?.account)===null||l===void 0?void 0:l.address)!==null&&d!==void 0?d:null,wallet_type:(m=t?.device.appName)!==null&&m!==void 0?m:null,wallet_version:(x=t?.device.appVersion)!==null&&x!==void 0?x:null,auth_type:j,custom_data:Object.assign({chain_id:(a=(C=t?.account)===null||C===void 0?void 0:C.chain)!==null&&a!==void 0?a:null,provider:(M=t?.provider)!==null&&M!==void 0?M:null},ip(n))}}function gC(n){return{type:"connection-started",custom_data:ip(n)}}function _C(n,t){return Object.assign({type:"connection-completed",is_success:!0},$m(n,t))}function yC(n,t,r){return{type:"connection-error",is_success:!1,error_message:t,error_code:r??null,custom_data:ip(n)}}function vC(n){return{type:"connection-restoring-started",custom_data:ip(n)}}function xC(n,t){return Object.assign({type:"connection-restoring-completed",is_success:!0},$m(n,t))}function wC(n,t){return{type:"connection-restoring-error",is_success:!1,error_message:t,custom_data:ip(n)}}function Cw(n,t){var r,l,d,m;return{valid_until:(r=String(t.validUntil))!==null&&r!==void 0?r:null,from:(m=(l=t.from)!==null&&l!==void 0?l:(d=n?.account)===null||d===void 0?void 0:d.address)!==null&&m!==void 0?m:null,messages:t.messages.map(x=>{var C,a;return{address:(C=x.address)!==null&&C!==void 0?C:null,amount:(a=x.amount)!==null&&a!==void 0?a:null}})}}function bC(n,t,r){return Object.assign(Object.assign({type:"transaction-sent-for-signature"},$m(n,t)),Cw(t,r))}function EC(n,t,r,l){return Object.assign(Object.assign({type:"transaction-signed",is_success:!0,signed_transaction:l.boc},$m(n,t)),Cw(t,r))}function TC(n,t,r,l,d){return Object.assign(Object.assign({type:"transaction-signing-failed",is_success:!1,error_message:l,error_code:d??null},$m(n,t)),Cw(t,r))}function CC(n,t,r){return Object.assign({type:"disconnection",scope:r},$m(n,t))}class SC{constructor(){this.window=my()}dispatchEvent(t,r){var l;return Xn(this,void 0,void 0,function*(){const d=new CustomEvent(t,{detail:r});(l=this.window)===null||l===void 0||l.dispatchEvent(d)})}addEventListener(t,r,l){var d;return Xn(this,void 0,void 0,function*(){return(d=this.window)===null||d===void 0||d.addEventListener(t,r,l),()=>{var m;return(m=this.window)===null||m===void 0?void 0:m.removeEventListener(t,r)}})}}class CA{constructor(t){var r;this.eventPrefix="ton-connect-",this.tonConnectUiVersion=null,this.eventDispatcher=(r=t?.eventDispatcher)!==null&&r!==void 0?r:new SC,this.tonConnectSdkVersion=t.tonConnectSdkVersion,this.init().catch()}get version(){return ip({ton_connect_sdk_lib:this.tonConnectSdkVersion,ton_connect_ui_lib:this.tonConnectUiVersion})}init(){return Xn(this,void 0,void 0,function*(){try{yield this.setRequestVersionHandler(),this.tonConnectUiVersion=yield this.requestTonConnectUiVersion()}catch{}})}setRequestVersionHandler(){return Xn(this,void 0,void 0,function*(){yield this.eventDispatcher.addEventListener("ton-connect-request-version",()=>Xn(this,void 0,void 0,function*(){yield this.eventDispatcher.dispatchEvent("ton-connect-response-version",mC(this.tonConnectSdkVersion))}))})}requestTonConnectUiVersion(){return Xn(this,void 0,void 0,function*(){return new Promise((t,r)=>Xn(this,void 0,void 0,function*(){try{yield this.eventDispatcher.addEventListener("ton-connect-ui-response-version",l=>{t(l.detail.version)},{once:!0}),yield this.eventDispatcher.dispatchEvent("ton-connect-ui-request-version",pC())}catch(l){r(l)}}))})}dispatchUserActionEvent(t){try{this.eventDispatcher.dispatchEvent(`${this.eventPrefix}${t.type}`,t).catch()}catch{}}trackConnectionStarted(...t){try{const r=gC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackConnectionCompleted(...t){try{const r=_C(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackConnectionError(...t){try{const r=yC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackConnectionRestoringStarted(...t){try{const r=vC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackConnectionRestoringCompleted(...t){try{const r=xC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackConnectionRestoringError(...t){try{const r=wC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackDisconnection(...t){try{const r=CC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackTransactionSentForSignature(...t){try{const r=bC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackTransactionSigned(...t){try{const r=EC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackTransactionSigningFailed(...t){try{const r=TC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}}const SA="3.0.3";class rp{constructor(t){if(this.walletsList=new yx,this._wallet=null,this.provider=null,this.statusChangeSubscriptions=[],this.statusChangeErrorSubscriptions=[],this.dappSettings={manifestUrl:t?.manifestUrl||_A(),storage:t?.storage||new wA},this.walletsList=new yx({walletsListSource:t?.walletsListSource,cacheTTLMs:t?.walletsListCacheTTLMs}),this.tracker=new CA({eventDispatcher:t?.eventDispatcher,tonConnectSdkVersion:SA}),!this.dappSettings.manifestUrl)throw new xw("Dapp tonconnect-manifest.json must be specified if window.location.origin is undefined. See more https://github.com/ton-connect/docs/blob/main/requests-responses.md#app-manifest");this.bridgeConnectionStorage=new C0(this.dappSettings.storage),t?.disableAutoPauseConnection||this.addWindowFocusAndBlurSubscriptions()}static getWallets(){return this.walletsList.getWallets()}get connected(){return this._wallet!==null}get account(){var t;return((t=this._wallet)===null||t===void 0?void 0:t.account)||null}get wallet(){return this._wallet}set wallet(t){this._wallet=t,this.statusChangeSubscriptions.forEach(r=>r(this._wallet))}getWallets(){return this.walletsList.getWallets()}onStatusChange(t,r){return this.statusChangeSubscriptions.push(t),r&&this.statusChangeErrorSubscriptions.push(r),()=>{this.statusChangeSubscriptions=this.statusChangeSubscriptions.filter(l=>l!==t),r&&(this.statusChangeErrorSubscriptions=this.statusChangeErrorSubscriptions.filter(l=>l!==r))}}connect(t,r){var l,d;const m={};if(typeof r=="object"&&"tonProof"in r&&(m.request=r),typeof r=="object"&&("openingDeadlineMS"in r||"signal"in r||"request"in r)&&(m.request=r?.request,m.openingDeadlineMS=r?.openingDeadlineMS,m.signal=r?.signal),this.connected)throw new ww;const x=tc(m?.signal);if((l=this.abortController)===null||l===void 0||l.abort(),this.abortController=x,x.signal.aborted)throw new br("Connection was aborted");return(d=this.provider)===null||d===void 0||d.closeConnection(),this.provider=this.createProvider(t),x.signal.addEventListener("abort",()=>{var C;(C=this.provider)===null||C===void 0||C.closeConnection(),this.provider=null}),this.tracker.trackConnectionStarted(),this.provider.connect(this.createConnectRequest(m?.request),{openingDeadlineMS:m?.openingDeadlineMS,signal:x.signal})}restoreConnection(t){var r,l;return Xn(this,void 0,void 0,function*(){this.tracker.trackConnectionRestoringStarted();const d=tc(t?.signal);if((r=this.abortController)===null||r===void 0||r.abort(),this.abortController=d,d.signal.aborted){this.tracker.trackConnectionRestoringError("Connection restoring was aborted");return}const[m,x]=yield Promise.all([this.bridgeConnectionStorage.storedConnectionType(),this.walletsList.getEmbeddedWallet()]);if(d.signal.aborted){this.tracker.trackConnectionRestoringError("Connection restoring was aborted");return}let C=null;try{switch(m){case"http":C=yield S0.fromStorage(this.dappSettings.storage);break;case"injected":C=yield Aa.fromStorage(this.dappSettings.storage);break;default:if(x)C=this.createProvider(x);else return}}catch{this.tracker.trackConnectionRestoringError("Provider is not restored"),yield this.bridgeConnectionStorage.removeConnection(),C?.closeConnection(),C=null;return}if(d.signal.aborted){C?.closeConnection(),this.tracker.trackConnectionRestoringError("Connection restoring was aborted");return}if(!C){Qc("Provider is not restored"),this.tracker.trackConnectionRestoringError("Provider is not restored");return}(l=this.provider)===null||l===void 0||l.closeConnection(),this.provider=C,C.listen(this.walletEventsListener.bind(this));const a=()=>{this.tracker.trackConnectionRestoringError("Connection restoring was aborted"),C?.closeConnection(),C=null};return d.signal.addEventListener("abort",a),yield l0(M=>Xn(this,void 0,void 0,function*(){yield C?.restoreConnection({openingDeadlineMS:t?.openingDeadlineMS,signal:M.signal}),d.signal.removeEventListener("abort",a),this.connected?this.tracker.trackConnectionRestoringCompleted(this.wallet):this.tracker.trackConnectionRestoringError("Connection restoring failed")}),{attempts:Number.MAX_SAFE_INTEGER,delayMs:5e3,signal:t?.signal})})}sendTransaction(t,r){return Xn(this,void 0,void 0,function*(){const l={};typeof r=="function"?l.onRequestSent=r:(l.onRequestSent=r?.onRequestSent,l.signal=r?.signal);const d=tc(l?.signal);if(d.signal.aborted)throw new br("Transaction sending was aborted");this.checkConnection(),TA(this.wallet.device.features,{requiredMessagesNumber:t.messages.length}),this.tracker.trackTransactionSentForSignature(this.wallet,t);const{validUntil:m}=t,x=tA(t,["validUntil"]),C=t.from||this.account.address,a=t.network||this.account.chain,M=yield this.provider.sendRequest(K1.convertToRpcRequest(Object.assign(Object.assign({},x),{valid_until:m,from:C,network:a})),{onRequestSent:l.onRequestSent,signal:d.signal});if(K1.isError(M))return this.tracker.trackTransactionSigningFailed(this.wallet,t,M.error.message,M.error.code),K1.parseAndThrowError(M);const R=K1.convertFromRpcResponse(M);return this.tracker.trackTransactionSigned(this.wallet,t,R),R})}disconnect(t){var r;return Xn(this,void 0,void 0,function*(){if(!this.connected)throw new R_;const l=tc(t?.signal),d=this.abortController;if(this.abortController=l,l.signal.aborted)throw new br("Disconnect was aborted");this.onWalletDisconnected("dapp"),yield(r=this.provider)===null||r===void 0?void 0:r.disconnect({signal:l.signal}),d?.abort()})}pauseConnection(){var t;((t=this.provider)===null||t===void 0?void 0:t.type)==="http"&&this.provider.pause()}unPauseConnection(){var t;return((t=this.provider)===null||t===void 0?void 0:t.type)!=="http"?Promise.resolve():this.provider.unPause()}addWindowFocusAndBlurSubscriptions(){const t=gA();if(t)try{t.addEventListener("visibilitychange",()=>{t.hidden?this.pauseConnection():this.unPauseConnection().catch()})}catch(r){Qc("Cannot subscribe to the document.visibilitychange: ",r)}}createProvider(t){let r;return!Array.isArray(t)&&nA(t)?r=new Aa(this.dappSettings.storage,t.jsBridgeKey):r=new S0(this.dappSettings.storage,t),r.listen(this.walletEventsListener.bind(this)),r}walletEventsListener(t){switch(t.event){case"connect":this.onWalletConnected(t.payload);break;case"connect_error":this.onWalletConnectError(t.payload);break;case"disconnect":this.onWalletDisconnected("wallet")}}onWalletConnected(t){const r=t.items.find(m=>m.name==="ton_addr"),l=t.items.find(m=>m.name==="ton_proof");if(!r)throw new br("ton_addr connection item was not found");const d={device:t.device,provider:this.provider.type,account:{address:r.address,chain:r.network,walletStateInit:r.walletStateInit,publicKey:r.publicKey}};l&&(d.connectItems={tonProof:l}),this.wallet=d,this.tracker.trackConnectionCompleted(d)}onWalletConnectError(t){const r=iA.parseError(t);if(this.statusChangeErrorSubscriptions.forEach(l=>l(r)),ts(r),this.tracker.trackConnectionError(t.message,t.code),r instanceof hy||r instanceof uy)throw Qc(r),r}onWalletDisconnected(t){this.tracker.trackDisconnection(this.wallet,t),this.wallet=null}checkConnection(){if(!this.connected)throw new R_}createConnectRequest(t){const r=[{name:"ton_addr"}];return t?.tonProof&&r.push({name:"ton_proof",payload:t.tonProof}),{manifestUrl:this.dappSettings.manifestUrl,items:r}}}rp.walletsList=new yx;rp.isWalletInjected=n=>Aa.isWalletInjected(n);rp.isInsideWalletBrowser=n=>Aa.isInsideWalletBrowser(n);const kA=81,MA=128;function kC(n,t=!1){const{wc:r,hex:l}=AA(n);let d=kA;t&&(d|=MA);const m=new Int8Array(34);m[0]=d,m[1]=r,m.set(l,2);const x=new Uint8Array(36);return x.set(m),x.set(PA(m),34),vw.encode(x).replace(/\+/g,"-").replace(/\//g,"_")}function AA(n){if(!n.includes(":"))throw new Tm(`Wrong address ${n}. Address must include ":".`);const t=n.split(":");if(t.length!==2)throw new Tm(`Wrong address ${n}. Address must include ":" only once.`);const r=parseInt(t[0]);if(r!==0&&r!==-1)throw new Tm(`Wrong address ${n}. WC must be eq 0 or -1, but ${r} received.`);const l=t[1];if(l?.length!==64)throw new Tm(`Wrong address ${n}. Hex part must be 64bytes length, but ${l?.length} received.`);return{wc:r,hex:IA(l)}}function PA(n){let r=0;const l=new Uint8Array(n.length+2);l.set(n);for(let d of l){let m=128;for(;m>0;)r<<=1,d&m&&(r+=1),m>>=1,r>65535&&(r&=65535,r^=4129)}return new Uint8Array([Math.floor(r/256),r%256])}const vx={};for(let n=0;n<=255;n++){let t=n.toString(16);t.length<2&&(t="0"+t),vx[t]=n}function IA(n){n=n.toLowerCase();const t=n.length;if(t%2!==0)throw new O_("Hex string must have length a multiple of 2: "+n);const r=t/2,l=new Uint8Array(r);for(let d=0;d<r;d++){const m=d*2,x=n.substring(m,m+2);if(!vx.hasOwnProperty(x))throw new O_("Invalid hex character: "+x);l[d]=vx[x]}return l}var Jg={exports:{}},LA=Jg.exports,x5;function RA(){return x5||(x5=1,function(n,t){(function(r,l){var d="1.0.38",m="",x="?",C="function",a="undefined",M="object",R="string",j="major",F="model",Z="name",Y="type",ne="vendor",se="version",xe="architecture",Se="console",_e="mobile",Ie="tablet",Me="smarttv",Ve="wearable",Ke="embedded",et=500,qe="Amazon",ge="Apple",We="ASUS",Ue="BlackBerry",lt="Browser",ht="Chrome",Wt="Edge",In="Firefox",Sn="Google",qt="Huawei",Bt="LG",je="Microsoft",At="Motorola",sn="Opera",zn="Samsung",vn="Sharp",Mn="Sony",Yn="Xiaomi",ir="Zebra",mt="Facebook",bt="Chromium OS",xt="Mac OS",Nt=function(dr,Nr){var cr={};for(var Cr in dr)Nr[Cr]&&Nr[Cr].length%2===0?cr[Cr]=Nr[Cr].concat(dr[Cr]):cr[Cr]=dr[Cr];return cr},wt=function(dr){for(var Nr={},cr=0;cr<dr.length;cr++)Nr[dr[cr].toUpperCase()]=dr[cr];return Nr},hn=function(dr,Nr){return typeof dr===R?An(Nr).indexOf(An(dr))!==-1:!1},An=function(dr){return dr.toLowerCase()},Fn=function(dr){return typeof dr===R?dr.replace(/[^\d\.]/g,m).split(".")[0]:l},Nn=function(dr,Nr){if(typeof dr===R)return dr=dr.replace(/^\s\s*/,m),typeof Nr===a?dr:dr.substring(0,et)},xr=function(dr,Nr){for(var cr=0,Cr,Oi,Di,wr,rr,Fi;cr<Nr.length&&!rr;){var ao=Nr[cr],lo=Nr[cr+1];for(Cr=Oi=0;Cr<ao.length&&!rr&&ao[Cr];)if(rr=ao[Cr++].exec(dr),rr)for(Di=0;Di<lo.length;Di++)Fi=rr[++Oi],wr=lo[Di],typeof wr===M&&wr.length>0?wr.length===2?typeof wr[1]==C?this[wr[0]]=wr[1].call(this,Fi):this[wr[0]]=wr[1]:wr.length===3?typeof wr[1]===C&&!(wr[1].exec&&wr[1].test)?this[wr[0]]=Fi?wr[1].call(this,Fi,wr[2]):l:this[wr[0]]=Fi?Fi.replace(wr[1],wr[2]):l:wr.length===4&&(this[wr[0]]=Fi?wr[3].call(this,Fi.replace(wr[1],wr[2])):l):this[wr]=Fi||l;cr+=2}},nr=function(dr,Nr){for(var cr in Nr)if(typeof Nr[cr]===M&&Nr[cr].length>0){for(var Cr=0;Cr<Nr[cr].length;Cr++)if(hn(Nr[cr][Cr],dr))return cr===x?l:cr}else if(hn(Nr[cr],dr))return cr===x?l:cr;return dr},Zr={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},Br={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},ui={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[se,[Z,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[se,[Z,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[Z,se],[/opios[\/ ]+([\w\.]+)/i],[se,[Z,sn+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[se,[Z,sn+" GX"]],[/\bopr\/([\w\.]+)/i],[se,[Z,sn]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[se,[Z,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[Z,se],[/\bddg\/([\w\.]+)/i],[se,[Z,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[se,[Z,"UC"+lt]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[se,[Z,"WeChat"]],[/konqueror\/([\w\.]+)/i],[se,[Z,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[se,[Z,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[se,[Z,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[se,[Z,"Smart Lenovo "+lt]],[/(avast|avg)\/([\w\.]+)/i],[[Z,/(.+)/,"$1 Secure "+lt],se],[/\bfocus\/([\w\.]+)/i],[se,[Z,In+" Focus"]],[/\bopt\/([\w\.]+)/i],[se,[Z,sn+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[se,[Z,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[se,[Z,"Dolphin"]],[/coast\/([\w\.]+)/i],[se,[Z,sn+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[se,[Z,"MIUI "+lt]],[/fxios\/([-\w\.]+)/i],[se,[Z,In]],[/\bqihu|(qi?ho?o?|360)browser/i],[[Z,"360 "+lt]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[Z,/(.+)/,"$1 "+lt],se],[/samsungbrowser\/([\w\.]+)/i],[se,[Z,zn+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[Z,/_/g," "],se],[/metasr[\/ ]?([\d\.]+)/i],[se,[Z,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[Z,"Sogou Mobile"],se],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[Z,se],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[Z],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[Z,mt],se],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[Z,se],[/\bgsa\/([\w\.]+) .*safari\//i],[se,[Z,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[se,[Z,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[se,[Z,ht+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[Z,ht+" WebView"],se],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[se,[Z,"Android "+lt]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[Z,se],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[se,[Z,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[se,Z],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[Z,[se,nr,Zr]],[/(webkit|khtml)\/([\w\.]+)/i],[Z,se],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[Z,"Netscape"],se],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[se,[Z,In+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[Z,se],[/(cobalt)\/([\w\.]+)/i],[Z,[se,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[xe,"amd64"]],[/(ia32(?=;))/i],[[xe,An]],[/((?:i[346]|x)86)[;\)]/i],[[xe,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[xe,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[xe,"armhf"]],[/windows (ce|mobile); ppc;/i],[[xe,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[xe,/ower/,m,An]],[/(sun4\w)[;\)]/i],[[xe,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[xe,An]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[F,[ne,zn],[Y,Ie]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[F,[ne,zn],[Y,_e]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[F,[ne,ge],[Y,_e]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[F,[ne,ge],[Y,Ie]],[/(macintosh);/i],[F,[ne,ge]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[F,[ne,vn],[Y,_e]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[F,[ne,qt],[Y,Ie]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[F,[ne,qt],[Y,_e]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[F,/_/g," "],[ne,Yn],[Y,_e]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[F,/_/g," "],[ne,Yn],[Y,Ie]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[F,[ne,"OPPO"],[Y,_e]],[/\b(opd2\d{3}a?) bui/i],[F,[ne,"OPPO"],[Y,Ie]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[F,[ne,"Vivo"],[Y,_e]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[F,[ne,"Realme"],[Y,_e]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[F,[ne,At],[Y,_e]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[F,[ne,At],[Y,Ie]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[F,[ne,Bt],[Y,Ie]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[F,[ne,Bt],[Y,_e]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[F,[ne,"Lenovo"],[Y,Ie]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[F,/_/g," "],[ne,"Nokia"],[Y,_e]],[/(pixel c)\b/i],[F,[ne,Sn],[Y,Ie]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[F,[ne,Sn],[Y,_e]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[F,[ne,Mn],[Y,_e]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[F,"Xperia Tablet"],[ne,Mn],[Y,Ie]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[F,[ne,"OnePlus"],[Y,_e]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[F,[ne,qe],[Y,Ie]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[F,/(.+)/g,"Fire Phone $1"],[ne,qe],[Y,_e]],[/(playbook);[-\w\),; ]+(rim)/i],[F,ne,[Y,Ie]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[F,[ne,Ue],[Y,_e]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[F,[ne,We],[Y,Ie]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[F,[ne,We],[Y,_e]],[/(nexus 9)/i],[F,[ne,"HTC"],[Y,Ie]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[ne,[F,/_/g," "],[Y,_e]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[F,[ne,"Acer"],[Y,Ie]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[F,[ne,"Meizu"],[Y,_e]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[F,[ne,"Ulefone"],[Y,_e]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[ne,F,[Y,_e]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[ne,F,[Y,Ie]],[/(surface duo)/i],[F,[ne,je],[Y,Ie]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[F,[ne,"Fairphone"],[Y,_e]],[/(u304aa)/i],[F,[ne,"AT&T"],[Y,_e]],[/\bsie-(\w*)/i],[F,[ne,"Siemens"],[Y,_e]],[/\b(rct\w+) b/i],[F,[ne,"RCA"],[Y,Ie]],[/\b(venue[\d ]{2,7}) b/i],[F,[ne,"Dell"],[Y,Ie]],[/\b(q(?:mv|ta)\w+) b/i],[F,[ne,"Verizon"],[Y,Ie]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[F,[ne,"Barnes & Noble"],[Y,Ie]],[/\b(tm\d{3}\w+) b/i],[F,[ne,"NuVision"],[Y,Ie]],[/\b(k88) b/i],[F,[ne,"ZTE"],[Y,Ie]],[/\b(nx\d{3}j) b/i],[F,[ne,"ZTE"],[Y,_e]],[/\b(gen\d{3}) b.+49h/i],[F,[ne,"Swiss"],[Y,_e]],[/\b(zur\d{3}) b/i],[F,[ne,"Swiss"],[Y,Ie]],[/\b((zeki)?tb.*\b) b/i],[F,[ne,"Zeki"],[Y,Ie]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[ne,"Dragon Touch"],F,[Y,Ie]],[/\b(ns-?\w{0,9}) b/i],[F,[ne,"Insignia"],[Y,Ie]],[/\b((nxa|next)-?\w{0,9}) b/i],[F,[ne,"NextBook"],[Y,Ie]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[ne,"Voice"],F,[Y,_e]],[/\b(lvtel\-)?(v1[12]) b/i],[[ne,"LvTel"],F,[Y,_e]],[/\b(ph-1) /i],[F,[ne,"Essential"],[Y,_e]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[F,[ne,"Envizen"],[Y,Ie]],[/\b(trio[-\w\. ]+) b/i],[F,[ne,"MachSpeed"],[Y,Ie]],[/\btu_(1491) b/i],[F,[ne,"Rotor"],[Y,Ie]],[/(shield[\w ]+) b/i],[F,[ne,"Nvidia"],[Y,Ie]],[/(sprint) (\w+)/i],[ne,F,[Y,_e]],[/(kin\.[onetw]{3})/i],[[F,/\./g," "],[ne,je],[Y,_e]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[F,[ne,ir],[Y,Ie]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[F,[ne,ir],[Y,_e]],[/smart-tv.+(samsung)/i],[ne,[Y,Me]],[/hbbtv.+maple;(\d+)/i],[[F,/^/,"SmartTV"],[ne,zn],[Y,Me]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[ne,Bt],[Y,Me]],[/(apple) ?tv/i],[ne,[F,ge+" TV"],[Y,Me]],[/crkey/i],[[F,ht+"cast"],[ne,Sn],[Y,Me]],[/droid.+aft(\w+)( bui|\))/i],[F,[ne,qe],[Y,Me]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[F,[ne,vn],[Y,Me]],[/(bravia[\w ]+)( bui|\))/i],[F,[ne,Mn],[Y,Me]],[/(mitv-\w{5}) bui/i],[F,[ne,Yn],[Y,Me]],[/Hbbtv.*(technisat) (.*);/i],[ne,F,[Y,Me]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[ne,Nn],[F,Nn],[Y,Me]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[Y,Me]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[ne,F,[Y,Se]],[/droid.+; (shield) bui/i],[F,[ne,"Nvidia"],[Y,Se]],[/(playstation [345portablevi]+)/i],[F,[ne,Mn],[Y,Se]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[F,[ne,je],[Y,Se]],[/((pebble))app/i],[ne,F,[Y,Ve]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[F,[ne,ge],[Y,Ve]],[/droid.+; (glass) \d/i],[F,[ne,Sn],[Y,Ve]],[/droid.+; (wt63?0{2,3})\)/i],[F,[ne,ir],[Y,Ve]],[/(quest( \d| pro)?)/i],[F,[ne,mt],[Y,Ve]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[ne,[Y,Ke]],[/(aeobc)\b/i],[F,[ne,qe],[Y,Ke]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[F,[Y,_e]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[F,[Y,Ie]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[Y,Ie]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[Y,_e]],[/(android[-\w\. ]{0,9});.+buil/i],[F,[ne,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[se,[Z,Wt+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[se,[Z,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[Z,se],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[se,Z]],os:[[/microsoft (windows) (vista|xp)/i],[Z,se],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[Z,[se,nr,Br]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[se,nr,Br],[Z,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[se,/_/g,"."],[Z,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[Z,xt],[se,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[se,Z],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[Z,se],[/\(bb(10);/i],[se,[Z,Ue]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[se,[Z,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[se,[Z,In+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[se,[Z,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[se,[Z,"watchOS"]],[/crkey\/([\d\.]+)/i],[se,[Z,ht+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[Z,bt],se],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[Z,se],[/(sunos) ?([\w\.\d]*)/i],[[Z,"Solaris"],se],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[Z,se]]},gi=function(dr,Nr){if(typeof dr===M&&(Nr=dr,dr=l),!(this instanceof gi))return new gi(dr,Nr).getResult();var cr=typeof r!==a&&r.navigator?r.navigator:l,Cr=dr||(cr&&cr.userAgent?cr.userAgent:m),Oi=cr&&cr.userAgentData?cr.userAgentData:l,Di=Nr?Nt(ui,Nr):ui,wr=cr&&cr.userAgent==Cr;return this.getBrowser=function(){var rr={};return rr[Z]=l,rr[se]=l,xr.call(rr,Cr,Di.browser),rr[j]=Fn(rr[se]),wr&&cr&&cr.brave&&typeof cr.brave.isBrave==C&&(rr[Z]="Brave"),rr},this.getCPU=function(){var rr={};return rr[xe]=l,xr.call(rr,Cr,Di.cpu),rr},this.getDevice=function(){var rr={};return rr[ne]=l,rr[F]=l,rr[Y]=l,xr.call(rr,Cr,Di.device),wr&&!rr[Y]&&Oi&&Oi.mobile&&(rr[Y]=_e),wr&&rr[F]=="Macintosh"&&cr&&typeof cr.standalone!==a&&cr.maxTouchPoints&&cr.maxTouchPoints>2&&(rr[F]="iPad",rr[Y]=Ie),rr},this.getEngine=function(){var rr={};return rr[Z]=l,rr[se]=l,xr.call(rr,Cr,Di.engine),rr},this.getOS=function(){var rr={};return rr[Z]=l,rr[se]=l,xr.call(rr,Cr,Di.os),wr&&!rr[Z]&&Oi&&Oi.platform&&Oi.platform!="Unknown"&&(rr[Z]=Oi.platform.replace(/chrome os/i,bt).replace(/macos/i,xt)),rr},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return Cr},this.setUA=function(rr){return Cr=typeof rr===R&&rr.length>et?Nn(rr,et):rr,this},this.setUA(Cr),this};gi.VERSION=d,gi.BROWSER=wt([Z,se,j]),gi.CPU=wt([xe]),gi.DEVICE=wt([F,ne,Y,Se,_e,Me,Ie,Ve,Ke]),gi.ENGINE=gi.OS=wt([Z,se]),n.exports&&(t=n.exports=gi),t.UAParser=gi;var Xi=typeof r!==a&&(r.jQuery||r.Zepto);if(Xi&&!Xi.ua){var Ri=new gi;Xi.ua=Ri.getResult(),Xi.ua.get=function(){return Ri.getUA()},Xi.ua.set=function(dr){Ri.setUA(dr);var Nr=Ri.getResult();for(var cr in Nr)Xi.ua[cr]=Nr[cr]}}})(typeof window=="object"?window:LA)}(Jg,Jg.exports)),Jg.exports}var OA=RA();const DA=cu(OA);var Pv,w5;function zA(){if(w5)return Pv;w5=1;var n=function(Se){return t(Se)&&!r(Se)};function t(xe){return!!xe&&typeof xe=="object"}function r(xe){var Se=Object.prototype.toString.call(xe);return Se==="[object RegExp]"||Se==="[object Date]"||m(xe)}var l=typeof Symbol=="function"&&Symbol.for,d=l?Symbol.for("react.element"):60103;function m(xe){return xe.$$typeof===d}function x(xe){return Array.isArray(xe)?[]:{}}function C(xe,Se){return Se.clone!==!1&&Se.isMergeableObject(xe)?ne(x(xe),xe,Se):xe}function a(xe,Se,_e){return xe.concat(Se).map(function(Ie){return C(Ie,_e)})}function M(xe,Se){if(!Se.customMerge)return ne;var _e=Se.customMerge(xe);return typeof _e=="function"?_e:ne}function R(xe){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(xe).filter(function(Se){return Object.propertyIsEnumerable.call(xe,Se)}):[]}function j(xe){return Object.keys(xe).concat(R(xe))}function F(xe,Se){try{return Se in xe}catch{return!1}}function Z(xe,Se){return F(xe,Se)&&!(Object.hasOwnProperty.call(xe,Se)&&Object.propertyIsEnumerable.call(xe,Se))}function Y(xe,Se,_e){var Ie={};return _e.isMergeableObject(xe)&&j(xe).forEach(function(Me){Ie[Me]=C(xe[Me],_e)}),j(Se).forEach(function(Me){Z(xe,Me)||(F(xe,Me)&&_e.isMergeableObject(Se[Me])?Ie[Me]=M(Me,_e)(xe[Me],Se[Me],_e):Ie[Me]=C(Se[Me],_e))}),Ie}function ne(xe,Se,_e){_e=_e||{},_e.arrayMerge=_e.arrayMerge||a,_e.isMergeableObject=_e.isMergeableObject||n,_e.cloneUnlessOtherwiseSpecified=C;var Ie=Array.isArray(Se),Me=Array.isArray(xe),Ve=Ie===Me;return Ve?Ie?_e.arrayMerge(xe,Se,_e):Y(xe,Se,_e):C(Se,_e)}ne.all=function(Se,_e){if(!Array.isArray(Se))throw new Error("first argument should be an array");return Se.reduce(function(Ie,Me){return ne(Ie,Me,_e)},{})};var se=ne;return Pv=se,Pv}var BA=zA();const jA=cu(BA);var Iv={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var b5;function NA(){return b5||(b5=1,function(n){(function(){var t={}.hasOwnProperty;function r(){for(var m="",x=0;x<arguments.length;x++){var C=arguments[x];C&&(m=d(m,l(C)))}return m}function l(m){if(typeof m=="string"||typeof m=="number")return m;if(typeof m!="object")return"";if(Array.isArray(m))return r.apply(null,m);if(m.toString!==Object.prototype.toString&&!m.toString.toString().includes("[native code]"))return m.toString();var x="";for(var C in m)t.call(m,C)&&m[C]&&(x=d(x,C));return x}function d(m,x){return x?m?m+" "+x:m+x:m}n.exports?(r.default=r,n.exports=r):window.classNames=r})()}(Iv)),Iv.exports}var FA=NA();const v_=cu(FA);var UA=Object.defineProperty,$A=Object.defineProperties,VA=Object.getOwnPropertyDescriptors,E5=Object.getOwnPropertySymbols,WA=Object.prototype.hasOwnProperty,qA=Object.prototype.propertyIsEnumerable,xx=(n,t,r)=>t in n?UA(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Ai=(n,t)=>{for(var r in t||(t={}))WA.call(t,r)&&xx(n,r,t[r]);if(E5)for(var r of E5(t))qA.call(t,r)&&xx(n,r,t[r]);return n},Ha=(n,t)=>$A(n,VA(t)),kr=(n,t,r)=>(xx(n,typeof t!="symbol"?t+"":t,r),r),bi=(n,t,r)=>new Promise((l,d)=>{var m=a=>{try{C(r.next(a))}catch(M){d(M)}},x=a=>{try{C(r.throw(a))}catch(M){d(M)}},C=a=>a.done?l(a.value):Promise.resolve(a.value).then(m,x);C((r=r.apply(n,t)).next())}),T5,C5,S5,k5,M5,A5,P5,I5;const po={};function GA(n){po.context=n}const ZA=(n,t)=>n===t,rc=Symbol("solid-proxy"),wx=Symbol("solid-track"),z_={equals:ZA};let MC=OC;const mh=1,B_=2,AC={owned:null,cleanups:null,context:null,owner:null},Lv={};var ns=null;let Qf=null,wo=null,qs=null,hh=null,Sw=0;function u0(n,t){const r=wo,l=ns,d=n.length===0,m=d?AC:{owned:null,cleanups:null,context:null,owner:t===void 0?l:t},x=d?n:()=>n(()=>_s(()=>xy(m)));ns=m,wo=null;try{return Sd(x,!0)}finally{wo=r,ns=l}}function Ir(n,t){t=t?Object.assign({},z_,t):z_;const r={value:n,observers:null,observerSlots:null,comparator:t.equals||void 0},l=d=>(typeof d=="function"&&(d=d(r.value)),RC(r,d));return[LC.bind(r),l]}function kw(n,t,r){const l=vy(n,t,!0,mh);Vm(l)}function Yr(n,t,r){const l=vy(n,t,!1,mh);Vm(l)}function gs(n,t,r){MC=tP;const l=vy(n,t,!1,mh);l.user=!0,hh?hh.push(l):Vm(l)}function qn(n,t,r){r=r?Object.assign({},z_,r):z_;const l=vy(n,t,!0,0);return l.observers=null,l.observerSlots=null,l.comparator=r.equals||void 0,Vm(l),LC.bind(l)}function HA(n,t,r){let l,d,m;arguments.length===1?(l=!0,d=n,m={}):(l=n,d=t,m={});let x=null,C=Lv,a=null,M=!1,R="initialValue"in m,j=typeof l=="function"&&qn(l);const F=new Set,[Z,Y]=(m.storage||Ir)(m.initialValue),[ne,se]=Ir(void 0),[xe,Se]=Ir(void 0,{equals:!1}),[_e,Ie]=Ir(R?"ready":"unresolved");if(po.context){a=`${po.context.id}${po.context.count++}`;let qe;m.ssrLoadFrom==="initial"?C=m.initialValue:po.load&&(qe=po.load(a))&&(C=qe[0])}function Me(qe,ge,We,Ue){return x===qe&&(x=null,R=!0,(qe===C||ge===C)&&m.onHydrated&&queueMicrotask(()=>m.onHydrated(Ue,{value:ge})),C=Lv,Ve(ge,We)),ge}function Ve(qe,ge){Sd(()=>{ge===void 0&&Y(()=>qe),Ie(ge!==void 0?"errored":"ready"),se(ge);for(const We of F.keys())We.decrement();F.clear()},!1)}function Ke(){const qe=JA,ge=Z(),We=ne();if(We!==void 0&&!x)throw We;return wo&&wo.user,ge}function et(qe=!0){if(qe!==!1&&M)return;M=!1;const ge=j?j():l;if(ge==null||ge===!1){Me(x,_s(Z));return}const We=C!==Lv?C:_s(()=>d(ge,{value:Z(),refetching:qe}));return typeof We!="object"||!(We&&"then"in We)?(Me(x,We,void 0,ge),We):(x=We,M=!0,queueMicrotask(()=>M=!1),Sd(()=>{Ie(R?"refreshing":"pending"),Se()},!1),We.then(Ue=>Me(We,Ue,void 0,ge),Ue=>Me(We,void 0,zC(Ue),ge)))}return Object.defineProperties(Ke,{state:{get:()=>_e()},error:{get:()=>ne()},loading:{get(){const qe=_e();return qe==="pending"||qe==="refreshing"}},latest:{get(){if(!R)return Ke();const qe=ne();if(qe&&!x)throw qe;return Z()}}}),j?kw(()=>et(!1)):et(!1),[Ke,{refetch:et,mutate:Y}]}function PC(n){return Sd(n,!1)}function _s(n){if(wo===null)return n();const t=wo;wo=null;try{return n()}finally{wo=t}}function KA(n,t,r){const l=Array.isArray(n);let d;return m=>{let x;if(l){x=Array(n.length);for(let a=0;a<n.length;a++)x[a]=n[a]()}else x=n();const C=_s(()=>t(x,d,m));return d=x,C}}function XA(n){gs(()=>_s(n))}function la(n){return ns===null||(ns.cleanups===null?ns.cleanups=[n]:ns.cleanups.push(n)),n}function IC(){return wo}function YA(){return ns}function _y(n,t){const r=Symbol("context");return{id:r,Provider:nP(r),defaultValue:n}}function ca(n){let t;return(t=jC(ns,n.id))!==void 0?t:n.defaultValue}function yy(n){const t=qn(n),r=qn(()=>bx(t()));return r.toArray=()=>{const l=r();return Array.isArray(l)?l:l!=null?[l]:[]},r}let JA;function LC(){const n=Qf;if(this.sources&&(this.state||n))if(this.state===mh||n)Vm(this);else{const t=qs;qs=null,Sd(()=>N_(this),!1),qs=t}if(wo){const t=this.observers?this.observers.length:0;wo.sources?(wo.sources.push(this),wo.sourceSlots.push(t)):(wo.sources=[this],wo.sourceSlots=[t]),this.observers?(this.observers.push(wo),this.observerSlots.push(wo.sources.length-1)):(this.observers=[wo],this.observerSlots=[wo.sources.length-1])}return this.value}function RC(n,t,r){let l=n.value;return(!n.comparator||!n.comparator(l,t))&&(n.value=t,n.observers&&n.observers.length&&Sd(()=>{for(let d=0;d<n.observers.length;d+=1){const m=n.observers[d],x=Qf&&Qf.running;x&&Qf.disposed.has(m),(x&&!m.tState||!x&&!m.state)&&(m.pure?qs.push(m):hh.push(m),m.observers&&DC(m)),x||(m.state=mh)}if(qs.length>1e6)throw qs=[],new Error},!1)),t}function Vm(n){if(!n.fn)return;xy(n);const t=ns,r=wo,l=Sw;wo=ns=n,QA(n,n.value,l),wo=r,ns=t}function QA(n,t,r){let l;try{l=n.fn(t)}catch(d){n.pure&&(n.state=mh,n.owned&&n.owned.forEach(xy),n.owned=null),BC(d)}(!n.updatedAt||n.updatedAt<=r)&&(n.updatedAt!=null&&"observers"in n?RC(n,l):n.value=l,n.updatedAt=r)}function vy(n,t,r,l=mh,d){const m={fn:n,state:l,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:ns,context:null,pure:r};return ns===null||ns!==AC&&(ns.owned?ns.owned.push(m):ns.owned=[m]),m}function j_(n){const t=Qf;if(n.state===0||t)return;if(n.state===B_||t)return N_(n);if(n.suspense&&_s(n.suspense.inFallback))return n.suspense.effects.push(n);const r=[n];for(;(n=n.owner)&&(!n.updatedAt||n.updatedAt<Sw);)(n.state||t)&&r.push(n);for(let l=r.length-1;l>=0;l--)if(n=r[l],n.state===mh||t)Vm(n);else if(n.state===B_||t){const d=qs;qs=null,Sd(()=>N_(n,r[0]),!1),qs=d}}function Sd(n,t){if(qs)return n();let r=!1;t||(qs=[]),hh?r=!0:hh=[],Sw++;try{const l=n();return eP(r),l}catch(l){r||(hh=null),qs=null,BC(l)}}function eP(n){if(qs&&(OC(qs),qs=null),n)return;const t=hh;hh=null,t.length&&Sd(()=>MC(t),!1)}function OC(n){for(let t=0;t<n.length;t++)j_(n[t])}function tP(n){let t,r=0;for(t=0;t<n.length;t++){const l=n[t];l.user?n[r++]=l:j_(l)}for(po.context&&GA(),t=0;t<r;t++)j_(n[t])}function N_(n,t){const r=Qf;n.state=0;for(let l=0;l<n.sources.length;l+=1){const d=n.sources[l];d.sources&&(d.state===mh||r?d!==t&&j_(d):(d.state===B_||r)&&N_(d,t))}}function DC(n){const t=Qf;for(let r=0;r<n.observers.length;r+=1){const l=n.observers[r];(!l.state||t)&&(l.state=B_,l.pure?qs.push(l):hh.push(l),l.observers&&DC(l))}}function xy(n){let t;if(n.sources)for(;n.sources.length;){const r=n.sources.pop(),l=n.sourceSlots.pop(),d=r.observers;if(d&&d.length){const m=d.pop(),x=r.observerSlots.pop();l<d.length&&(m.sourceSlots[x]=l,d[l]=m,r.observerSlots[l]=x)}}if(n.owned){for(t=0;t<n.owned.length;t++)xy(n.owned[t]);n.owned=null}if(n.cleanups){for(t=0;t<n.cleanups.length;t++)n.cleanups[t]();n.cleanups=null}n.state=0,n.context=null}function zC(n){return n instanceof Error||typeof n=="string"?n:new Error("Unknown error")}function BC(n){throw n=zC(n),n}function jC(n,t){return n?n.context&&n.context[t]!==void 0?n.context[t]:jC(n.owner,t):void 0}function bx(n){if(typeof n=="function"&&!n.length)return bx(n());if(Array.isArray(n)){const t=[];for(let r=0;r<n.length;r++){const l=bx(n[r]);Array.isArray(l)?t.push.apply(t,l):t.push(l)}return t}return n}function nP(n,t){return function(l){let d;return Yr(()=>d=_s(()=>(ns.context={[n]:l.value},yy(()=>l.children))),void 0),d}}const rP=Symbol("fallback");function L5(n){for(let t=0;t<n.length;t++)n[t]()}function iP(n,t,r={}){let l=[],d=[],m=[],x=0,C=t.length>1?[]:null;return la(()=>L5(m)),()=>{let a=n()||[],M,R;return a[wx],_s(()=>{let F=a.length,Z,Y,ne,se,xe,Se,_e,Ie,Me;if(F===0)x!==0&&(L5(m),m=[],l=[],d=[],x=0,C&&(C=[])),r.fallback&&(l=[rP],d[0]=u0(Ve=>(m[0]=Ve,r.fallback())),x=1);else if(x===0){for(d=new Array(F),R=0;R<F;R++)l[R]=a[R],d[R]=u0(j);x=F}else{for(ne=new Array(F),se=new Array(F),C&&(xe=new Array(F)),Se=0,_e=Math.min(x,F);Se<_e&&l[Se]===a[Se];Se++);for(_e=x-1,Ie=F-1;_e>=Se&&Ie>=Se&&l[_e]===a[Ie];_e--,Ie--)ne[Ie]=d[_e],se[Ie]=m[_e],C&&(xe[Ie]=C[_e]);for(Z=new Map,Y=new Array(Ie+1),R=Ie;R>=Se;R--)Me=a[R],M=Z.get(Me),Y[R]=M===void 0?-1:M,Z.set(Me,R);for(M=Se;M<=_e;M++)Me=l[M],R=Z.get(Me),R!==void 0&&R!==-1?(ne[R]=d[M],se[R]=m[M],C&&(xe[R]=C[M]),R=Y[R],Z.set(Me,R)):m[M]();for(R=Se;R<F;R++)R in ne?(d[R]=ne[R],m[R]=se[R],C&&(C[R]=xe[R],C[R](R))):d[R]=u0(j);d=d.slice(0,x=F),l=a.slice(0)}return d});function j(F){if(m[R]=F,C){const[Z,Y]=Ir(R);return C[R]=Y,t(a[R],Z)}return t(a[R])}}}function he(n,t){return _s(()=>n(t||{}))}function X1(){return!0}const Ex={get(n,t,r){return t===rc?r:n.get(t)},has(n,t){return t===rc?!0:n.has(t)},set:X1,deleteProperty:X1,getOwnPropertyDescriptor(n,t){return{configurable:!0,enumerable:!0,get(){return n.get(t)},set:X1,deleteProperty:X1}},ownKeys(n){return n.keys()}};function Rv(n){return(n=typeof n=="function"?n():n)?n:{}}function eu(...n){let t=!1;for(let l=0;l<n.length;l++){const d=n[l];t=t||!!d&&rc in d,n[l]=typeof d=="function"?(t=!0,qn(d)):d}if(t)return new Proxy({get(l){for(let d=n.length-1;d>=0;d--){const m=Rv(n[d])[l];if(m!==void 0)return m}},has(l){for(let d=n.length-1;d>=0;d--)if(l in Rv(n[d]))return!0;return!1},keys(){const l=[];for(let d=0;d<n.length;d++)l.push(...Object.keys(Rv(n[d])));return[...new Set(l)]}},Ex);const r={};for(let l=n.length-1;l>=0;l--)if(n[l]){const d=Object.getOwnPropertyDescriptors(n[l]);for(const m in d)m in r||Object.defineProperty(r,m,{enumerable:!0,get(){for(let x=n.length-1;x>=0;x--){const C=(n[x]||{})[m];if(C!==void 0)return C}}})}return r}function Mw(n,...t){const r=new Set(t.flat());if(rc in n){const d=t.map(m=>new Proxy({get(x){return m.includes(x)?n[x]:void 0},has(x){return m.includes(x)&&x in n},keys(){return m.filter(x=>x in n)}},Ex));return d.push(new Proxy({get(m){return r.has(m)?void 0:n[m]},has(m){return r.has(m)?!1:m in n},keys(){return Object.keys(n).filter(m=>!r.has(m))}},Ex)),d}const l=Object.getOwnPropertyDescriptors(n);return t.push(Object.keys(l).filter(d=>!r.has(d))),t.map(d=>{const m={};for(let x=0;x<d.length;x++){const C=d[x];C in n&&Object.defineProperty(m,C,l[C]?l[C]:{get(){return n[C]},set(){return!0},enumerable:!0})}return m})}function q0(n){const t="fallback"in n&&{fallback:()=>n.fallback};return qn(iP(()=>n.each,n.children,t||void 0))}function jr(n){let t=!1;const r=n.keyed,l=qn(()=>n.when,void 0,{equals:(d,m)=>t?d===m:!d==!m});return qn(()=>{const d=l();if(d){const m=n.children,x=typeof m=="function"&&m.length>0;return t=r||x,x?_s(()=>m(d)):m}return n.fallback},void 0,void 0)}function G0(n){let t=!1,r=!1;const l=(x,C)=>x[0]===C[0]&&(t?x[1]===C[1]:!x[1]==!C[1])&&x[2]===C[2],d=yy(()=>n.children),m=qn(()=>{let x=d();Array.isArray(x)||(x=[x]);for(let C=0;C<x.length;C++){const a=x[C].when;if(a)return r=!!x[C].keyed,[C,a,x[C]]}return[-1]},void 0,{equals:l});return qn(()=>{const[x,C,a]=m();if(x<0)return n.fallback;const M=a.children,R=typeof M=="function"&&M.length>0;return t=r||R,R?_s(()=>M(C)):M},void 0,void 0)}function ks(n){return n}const oP=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],sP=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline",...oP]),aP=new Set(["innerHTML","textContent","innerText","children"]),lP=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),R5=Object.assign(Object.create(null),{class:"className",formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly"}),cP=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),uP=new Set(["altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","tref","tspan","use","view","vkern"]),hP={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function dP(n,t,r){let l=r.length,d=t.length,m=l,x=0,C=0,a=t[d-1].nextSibling,M=null;for(;x<d||C<m;){if(t[x]===r[C]){x++,C++;continue}for(;t[d-1]===r[m-1];)d--,m--;if(d===x){const R=m<l?C?r[C-1].nextSibling:r[m-C]:a;for(;C<m;)n.insertBefore(r[C++],R)}else if(m===C)for(;x<d;)(!M||!M.has(t[x]))&&t[x].remove(),x++;else if(t[x]===r[m-1]&&r[C]===t[d-1]){const R=t[--d].nextSibling;n.insertBefore(r[C++],t[x++].nextSibling),n.insertBefore(r[--m],R),t[d]=r[m]}else{if(!M){M=new Map;let j=C;for(;j<m;)M.set(r[j],j++)}const R=M.get(t[x]);if(R!=null)if(C<R&&R<m){let j=x,F=1,Z;for(;++j<d&&j<m&&!((Z=M.get(t[j]))==null||Z!==R+F);)F++;if(F>R-C){const Y=t[x];for(;C<R;)n.insertBefore(r[C++],Y)}else n.replaceChild(r[C++],t[x++])}else x++;else t[x++].remove()}}}const O5="_$DX_DELEGATE";function fP(n,t,r,l={}){let d;return u0(m=>{d=m,t===document?n():Ws(t,n(),t.firstChild?null:void 0,r)},l.owner),()=>{d(),t.textContent=""}}function ei(n,t,r){if(typeof window>"u")return null;const l=document.createElement("template");l.innerHTML=n;let d=l.content.firstChild;return r&&(d=d.firstChild),d}function pP(n,t=window.document){const r=t[O5]||(t[O5]=new Set);for(let l=0,d=n.length;l<d;l++){const m=n[l];r.has(m)||(r.add(m),t.addEventListener(m,bP))}}function vr(n,t,r){r==null?n.removeAttribute(t):n.setAttribute(t,r)}function mP(n,t,r,l){l==null?n.removeAttributeNS(t,r):n.setAttributeNS(t,r,l)}function Aw(n,t){t==null?n.removeAttribute("class"):n.className=t}function gP(n,t,r,l){if(l)Array.isArray(r)?(n[`$$${t}`]=r[0],n[`$$${t}Data`]=r[1]):n[`$$${t}`]=r;else if(Array.isArray(r)){const d=r[0];n.addEventListener(t,r[0]=m=>d.call(n,r[1],m))}else n.addEventListener(t,r)}function _P(n,t,r={}){const l=Object.keys(t||{}),d=Object.keys(r);let m,x;for(m=0,x=d.length;m<x;m++){const C=d[m];!C||C==="undefined"||t[C]||(D5(n,C,!1),delete r[C])}for(m=0,x=l.length;m<x;m++){const C=l[m],a=!!t[C];!C||C==="undefined"||r[C]===a||!a||(D5(n,C,!0),r[C]=a)}return r}function yP(n,t,r){if(!t)return r?vr(n,"style"):t;const l=n.style;if(typeof t=="string")return l.cssText=t;typeof r=="string"&&(l.cssText=r=void 0),r||(r={}),t||(t={});let d,m;for(m in r)t[m]==null&&l.removeProperty(m),delete r[m];for(m in t)d=t[m],d!==r[m]&&(l.setProperty(m,d),r[m]=d);return r}function NC(n,t={},r,l){const d={};return Yr(()=>d.children=k0(n,t.children,d.children)),Yr(()=>t.ref&&t.ref(n)),Yr(()=>vP(n,t,r,!0,d,!0)),d}function h0(n,t,r){return _s(()=>n(t,r))}function Ws(n,t,r,l){if(r!==void 0&&!l&&(l=[]),typeof t!="function")return k0(n,t,l,r);Yr(d=>k0(n,t(),d,r),l)}function vP(n,t,r,l,d={},m=!1){t||(t={});for(const x in d)if(!(x in t)){if(x==="children")continue;d[x]=z5(n,x,null,d[x],r,m)}for(const x in t){if(x==="children")continue;const C=t[x];d[x]=z5(n,x,C,d[x],r,m)}}function xP(n){let t,r;return!po.context||!(t=po.registry.get(r=EP()))?n.cloneNode(!0):(po.completed&&po.completed.add(t),po.registry.delete(r),t)}function wP(n){return n.toLowerCase().replace(/-([a-z])/g,(t,r)=>r.toUpperCase())}function D5(n,t,r){const l=t.trim().split(/\s+/);for(let d=0,m=l.length;d<m;d++)n.classList.toggle(l[d],r)}function z5(n,t,r,l,d,m){let x,C,a;if(t==="style")return yP(n,r,l);if(t==="classList")return _P(n,r,l);if(r===l)return l;if(t==="ref")m||r(n);else if(t.slice(0,3)==="on:"){const M=t.slice(3);l&&n.removeEventListener(M,l),r&&n.addEventListener(M,r)}else if(t.slice(0,10)==="oncapture:"){const M=t.slice(10);l&&n.removeEventListener(M,l,!0),r&&n.addEventListener(M,r,!0)}else if(t.slice(0,2)==="on"){const M=t.slice(2).toLowerCase(),R=cP.has(M);if(!R&&l){const j=Array.isArray(l)?l[0]:l;n.removeEventListener(M,j)}(R||r)&&(gP(n,M,r,R),R&&pP([M]))}else if((a=aP.has(t))||!d&&(R5[t]||(C=sP.has(t)))||(x=n.nodeName.includes("-")))t==="class"||t==="className"?Aw(n,r):x&&!C&&!a?n[wP(t)]=r:n[R5[t]||t]=r;else{const M=d&&t.indexOf(":")>-1&&hP[t.split(":")[0]];M?mP(n,M,t,r):vr(n,lP[t]||t,r)}return r}function bP(n){const t=`$$${n.type}`;let r=n.composedPath&&n.composedPath()[0]||n.target;for(n.target!==r&&Object.defineProperty(n,"target",{configurable:!0,value:r}),Object.defineProperty(n,"currentTarget",{configurable:!0,get(){return r||document}}),po.registry&&!po.done&&(po.done=!0,document.querySelectorAll("[id^=pl-]").forEach(l=>{for(;l&&l.nodeType!==8&&l.nodeValue!=="pl-"+n;){let d=l.nextSibling;l.remove(),l=d}l&&l.remove()}));r;){const l=r[t];if(l&&!r.disabled){const d=r[`${t}Data`];if(d!==void 0?l.call(r,d,n):l.call(r,n),n.cancelBubble)return}r=r._$host||r.parentNode||r.host}}function k0(n,t,r,l,d){for(po.context&&!r&&(r=[...n.childNodes]);typeof r=="function";)r=r();if(t===r)return r;const m=typeof t,x=l!==void 0;if(n=x&&r[0]&&r[0].parentNode||n,m==="string"||m==="number"){if(po.context)return r;if(m==="number"&&(t=t.toString()),x){let C=r[0];C&&C.nodeType===3?C.data=t:C=document.createTextNode(t),r=am(n,r,l,C)}else r!==""&&typeof r=="string"?r=n.firstChild.data=t:r=n.textContent=t}else if(t==null||m==="boolean"){if(po.context)return r;r=am(n,r,l)}else{if(m==="function")return Yr(()=>{let C=t();for(;typeof C=="function";)C=C();r=k0(n,C,r,l)}),()=>r;if(Array.isArray(t)){const C=[],a=r&&Array.isArray(r);if(Tx(C,t,r,d))return Yr(()=>r=k0(n,C,r,l,!0)),()=>r;if(po.context){if(!C.length)return r;for(let M=0;M<C.length;M++)if(C[M].parentNode)return r=C}if(C.length===0){if(r=am(n,r,l),x)return r}else a?r.length===0?B5(n,C,l):dP(n,r,C):(r&&am(n),B5(n,C));r=C}else if(t instanceof Node){if(po.context&&t.parentNode)return r=x?[t]:t;if(Array.isArray(r)){if(x)return r=am(n,r,l,t);am(n,r,null,t)}else r==null||r===""||!n.firstChild?n.appendChild(t):n.replaceChild(t,n.firstChild);r=t}}return r}function Tx(n,t,r,l){let d=!1;for(let m=0,x=t.length;m<x;m++){let C=t[m],a=r&&r[m];if(C instanceof Node)n.push(C);else if(!(C==null||C===!0||C===!1))if(Array.isArray(C))d=Tx(n,C,a)||d;else if(typeof C=="function")if(l){for(;typeof C=="function";)C=C();d=Tx(n,Array.isArray(C)?C:[C],Array.isArray(a)?a:[a])||d}else n.push(C),d=!0;else{const M=String(C);a&&a.nodeType===3&&a.data===M?n.push(a):n.push(document.createTextNode(M))}}return d}function B5(n,t,r=null){for(let l=0,d=t.length;l<d;l++)n.insertBefore(t[l],r)}function am(n,t,r,l){if(r===void 0)return n.textContent="";const d=l||document.createTextNode("");if(t.length){let m=!1;for(let x=t.length-1;x>=0;x--){const C=t[x];if(d!==C){const a=C.parentNode===n;!m&&!x?a?n.replaceChild(d,C):n.insertBefore(d,r):a&&C.remove()}else m=!0}}else n.insertBefore(d,r);return[d]}function EP(){const n=po.context;return`${n.id}${n.count++}`}const TP="http://www.w3.org/2000/svg";function FC(n,t=!1){return t?document.createElementNS(TP,n):document.createElement(n)}function UC(n){const{useShadow:t}=n,r=document.createTextNode(""),l=n.mount||document.body;function d(){if(po.context){const[m,x]=Ir(!1);return queueMicrotask(()=>x(!0)),()=>m()&&n.children}else return()=>n.children}if(l instanceof HTMLHeadElement){const[m,x]=Ir(!1),C=()=>x(!0);u0(a=>Ws(l,()=>m()?a():d()(),null)),la(()=>{po.context?queueMicrotask(C):C()})}else{const m=FC(n.isSVG?"g":"div",n.isSVG),x=t&&m.attachShadow?m.attachShadow({mode:"open"}):m;Object.defineProperty(m,"_$host",{get(){return r.parentNode},configurable:!0}),Ws(x,d()),l.appendChild(m),n.ref&&n.ref(m),la(()=>l.removeChild(m))}return r}function Rm(n){const[t,r]=Mw(n,["component"]),l=qn(()=>t.component);return qn(()=>{const d=l();switch(typeof d){case"function":return _s(()=>d(r));case"string":const m=uP.has(d),x=po.context?xP():FC(d,m);return NC(x,r,m),x}})}var bo=(n=>(n.DARK="DARK",n.LIGHT="LIGHT",n))(bo||{});let CP={data:""},SP=n=>typeof window=="object"?((n?n.querySelector("#_goober"):window._goober)||Object.assign((n||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:n||CP,kP=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,MP=/\/\*[^]*?\*\/|  +/g,j5=/\n+/g,qf=(n,t)=>{let r="",l="",d="";for(let m in n){let x=n[m];m[0]=="@"?m[1]=="i"?r=m+" "+x+";":l+=m[1]=="f"?qf(x,m):m+"{"+qf(x,m[1]=="k"?"":t)+"}":typeof x=="object"?l+=qf(x,t?t.replace(/([^,])+/g,C=>m.replace(/(^:.*)|([^,])+/g,a=>/&/.test(a)?a.replace(/&/g,C):C?C+" "+a:a)):m):x!=null&&(m=/^--/.test(m)?m:m.replace(/[A-Z]/g,"-$&").toLowerCase(),d+=qf.p?qf.p(m,x):m+":"+x+";")}return r+(t&&d?t+"{"+d+"}":d)+l},Qu={},$C=n=>{if(typeof n=="object"){let t="";for(let r in n)t+=r+$C(n[r]);return t}return n},AP=(n,t,r,l,d)=>{let m=$C(n),x=Qu[m]||(Qu[m]=(a=>{let M=0,R=11;for(;M<a.length;)R=101*R+a.charCodeAt(M++)>>>0;return"go"+R})(m));if(!Qu[x]){let a=m!==n?n:(M=>{let R,j,F=[{}];for(;R=kP.exec(M.replace(MP,""));)R[4]?F.shift():R[3]?(j=R[3].replace(j5," ").trim(),F.unshift(F[0][j]=F[0][j]||{})):F[0][R[1]]=R[2].replace(j5," ").trim();return F[0]})(n);Qu[x]=qf(d?{["@keyframes "+x]:a}:a,r?"":"."+x)}let C=r&&Qu.g?Qu.g:null;return r&&(Qu.g=Qu[x]),((a,M,R,j)=>{j?M.data=M.data.replace(j,a):M.data.indexOf(a)===-1&&(M.data=R?a+M.data:M.data+a)})(Qu[x],t,l,C),x},PP=(n,t,r)=>n.reduce((l,d,m)=>{let x=t[m];if(x&&x.call){let C=x(r),a=C&&C.props&&C.props.className||/^go/.test(C)&&C;x=a?"."+a:C&&typeof C=="object"?C.props?"":qf(C,""):C===!1?"":C}return l+d+(x??"")},"");function fh(n){let t=this||{},r=n.call?n(t.p):n;return AP(r.unshift?r.raw?PP(r,[].slice.call(arguments,1),t.p):r.reduce((l,d)=>Object.assign(l,d&&d.call?d(t.p):d),{}):r,SP(t.target),t.g,t.o,t.k)}fh.bind({g:1});let IP=fh.bind({k:1});const Pw=_y();function LP(n){return he(Pw.Provider,{value:n.theme,get children(){return n.children}})}function Vi(){return ca(Pw)}function VC(n){let t=this||{};return(...r)=>{const l=d=>{const m=ca(Pw),x=eu(d,{theme:m}),C=eu(x,{get class(){const Z=x.class,Y="class"in x&&/^go[0-9]+/.test(Z);let ne=fh.apply({target:t.target,o:Y,p:x,g:t.g},r);return[Z,ne].filter(Boolean).join(" ")}}),[a,M]=Mw(C,["as","theme"]),R=M,j=a.as||n;let F;return typeof j=="function"?F=j(R):t.g==1?(F=document.createElement(j),NC(F,R)):F=Rm(eu({component:j},R)),F};return l.class=d=>_s(()=>fh.apply({target:t.target,p:d,g:t.g},r)),l}}const jt=new Proxy(VC,{get(n,t){return n(t)}});function RP(){const n=VC.call({g:1},"div").apply(null,arguments);return function(r){return n(r),null}}const oh="tc-root",Iw="tc-disable-scroll",Ov="tc-using-mouse",OP=()=>{document.body.addEventListener("mousedown",()=>document.body.classList.add(Ov)),document.body.addEventListener("keydown",t=>{t.key==="Tab"&&document.body.classList.remove(Ov)});const n=RP`
    ${oh} * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        
        font-family: -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', Arial, Tahoma, Verdana, sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;        
        -webkit-tap-highlight-color: transparent;
    }
    
    ${oh} img {
      -webkit-user-select: none;
      -webkit-touch-callout: none;
    }   
 
    ${oh} *:focus {
        outline: #08f auto 2px;
    }
    
    ${oh} li {
        list-style: none;
    }
    
    ${oh} button {
        outline: none;
    }
    
    body.${Iw} {
        position: fixed; 
        overflow-y: scroll;
        right: 0;
        left: 0;
    }
    
    body.${Ov} ${oh} *:focus {
        outline: none;
    }
`;return he(n,{})};function DP(n){n[0]==="#"&&(n=n.slice(1));const t=parseInt(n,16),r=t>>16&255,l=t>>8&255,d=t&255;return[r,l,d].join(",")}function Z0(n,t){return n[0]==="#"&&(n=DP(n)),`rgba(${n}, ${t})`}function tu(n){return n.toString()+"px"}const Qg=class{constructor(){kr(this,"storage",{})}static getInstance(){return Qg.instance||(Qg.instance=new Qg),Qg.instance}get length(){return Object.keys(this.storage).length}clear(){this.storage={}}getItem(n){var t;return(t=this.storage[n])!=null?t:null}key(n){var t;const r=Object.keys(this.storage);return n<0||n>=r.length?null:(t=r[n])!=null?t:null}removeItem(n){delete this.storage[n]}setItem(n,t){this.storage[n]=t}};let WC=Qg;kr(WC,"instance");class Bo extends br{constructor(...t){super(...t),Object.setPrototypeOf(this,Bo.prototype)}}function x_(...n){try{console.debug("[TON_CONNECT_UI]",...n)}catch{}}function zP(...n){try{console.error("[TON_CONNECT_UI]",...n)}catch{}}function BP(...n){try{console.warn("[TON_CONNECT_UI]",...n)}catch{}}function F_(n,t="_self"){x_("openLink",n,t),window.open(n,t,"noopener noreferrer")}function so(n){F_(n,"_blank")}function gd(n,t){const r=()=>{Xr("safari")||Yc("android")&&Xr("firefox")||t()},l=setTimeout(()=>r(),200);window.addEventListener("blur",()=>clearTimeout(l),{once:!0}),F_(n,"_self")}function jP(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches?bo.LIGHT:bo.DARK}function NP(n){const t=r=>n(r.matches?bo.DARK:bo.LIGHT);return window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t),()=>window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",t)}function FP(){document.documentElement.scrollHeight!==document.documentElement.clientHeight&&(document.body.style.top=tu(-document.documentElement.scrollTop),document.body.classList.add(Iw))}function UP(){document.body.classList.remove(Iw),document.documentElement.scrollTo({top:-parseFloat(getComputedStyle(document.body).top)}),document.body.style.top="auto"}function $P(){document.body.hasAttribute("ontouchstart")||document.body.setAttribute("ontouchstart","")}function VP(){customElements.define(oh,class extends HTMLElement{})}function qC(n){return bi(this,null,function*(){yield new Promise(t=>requestAnimationFrame(t)),n()})}function WP(n){return bi(this,null,function*(){return yield new Promise(t=>requestAnimationFrame(t)),n()})}function GC(n){document.readyState!=="complete"?window.addEventListener("load",()=>qC(()=>GC(n)),{once:!0}):n.forEach(t=>{const r=new window.Image;r.src=t})}function gh(){if(typeof window<"u")return window}function Lw(){if(qP())return localStorage;if(GP())throw new Bo("`localStorage` is unavailable, but it is required for TonConnect. For more details, see https://github.com/ton-connect/sdk/tree/main/packages/sdk#init-connector");return WC.getInstance()}function qP(){try{return typeof localStorage<"u"}catch{return!1}}function GP(){return typeof process<"u"&&process.versions!=null&&process.versions.node!=null}function Rw(){var n,t,r;const l=new DA().getResult(),d=(n=l.os.name)==null?void 0:n.toLowerCase(),m=(t=l.device.model)==null?void 0:t.toLowerCase();let x;switch(!0){case m==="ipad":x="ipad";break;case d==="ios":x="ios";break;case d==="android":x="android";break;case d==="mac os":x="macos";break;case d==="linux":x="linux";break;case d?.includes("windows"):x="windows";break}const C=(r=l.browser.name)==null?void 0:r.toLowerCase();let a;switch(!0){case C==="chrome":a="chrome";break;case C==="firefox":a="firefox";break;case C?.includes("safari"):a="safari";break;case C?.includes("opera"):a="opera";break}return{os:x,browser:a}}function Yc(...n){return n.includes(Rw().os)}function Xr(...n){return n.includes(Rw().browser)}function Y1(n,t){const r=new URL(n);return t+r.search}class ZP{constructor(){kr(this,"localStorage"),kr(this,"storageKey","ton-connect-ui_wallet-info"),this.localStorage=Lw()}setWalletInfo(t){this.localStorage.setItem(this.storageKey,JSON.stringify(t))}getWalletInfo(){const t=this.localStorage.getItem(this.storageKey);return t?JSON.parse(t):null}removeWalletInfo(){this.localStorage.removeItem(this.storageKey)}}class HP{constructor(){kr(this,"localStorage"),kr(this,"storageKey","ton-connect-ui_preferred-wallet"),this.localStorage=Lw()}setPreferredWalletAppName(t){this.localStorage.setItem(this.storageKey,t)}getPreferredWalletAppName(){return this.localStorage.getItem(this.storageKey)||void 0}}class ZC{constructor(){kr(this,"localStorage"),kr(this,"storageKey","ton-connect-ui_last-selected-wallet-info"),this.localStorage=Lw()}setLastSelectedWalletInfo(t){this.localStorage.setItem(this.storageKey,JSON.stringify(t))}getLastSelectedWalletInfo(){const t=this.localStorage.getItem(this.storageKey);return t?JSON.parse(t):null}removeLastSelectedWalletInfo(){this.localStorage.removeItem(this.storageKey)}}const[Cx,N5]=Ir({status:"closed",closeReason:null}),F5=qn(()=>Cx().status==="opened"),[U_,U5]=Ir({status:"closed",closeReason:null}),$5=qn(()=>U_().status==="opened"),KP=qn(()=>{const n=U_();return n.status==="opened"?n.walletInfo:null});let Cm=typeof window<"u"?new ZC:void 0;const[XP,YP]=Ir(Cm?.getLastSelectedWalletInfo()||null),Ms=n=>{Cm||(Cm=new ZC),n?Cm.setLastSelectedWalletInfo(n):Cm.removeLastSelectedWalletInfo(),YP(n)},[ah,Sm]=Ir(null),JP={close:"Close",openWallet:"Open wallet",copyLink:"Copy Link",linkCopied:"Link Copied",copied:"Copied",yourWallet:"Your Wallet",retry:"Retry",get:"GET",mobile:"Mobile",browserExtension:"Browser Extension",desktop:"Desktop"},QP={connectWallet:"Connect Wallet",dropdown:{copy:"Copy address",copied:"Address copied!",disconnect:"Disconnect"}},eI={confirm:{header:"Open {{ name }} to confirm the transaction."},transactionSent:{header:"Transaction sent",text:"Your transaction will be processed in a few seconds."},transactionCanceled:{header:"Transaction canceled",text:"There will be no changes to your account."}},tI={walletOn:"Wallet On",recent:"Recent",installed:"Installed",popular:"Popular"},nI={loading:"Loading wallets",wallets:"Wallets",mobileUniversalModal:{connectYourWallet:"Connect your wallet",openWalletOnTelegramOrSelect:"Open Wallet in Telegram or select your wallet to connect",openWalletOnTelegram:"Open Wallet in Telegram",openLink:"Open Link",scan:"Scan with your mobile wallet"},desktopUniversalModal:{connectYourWallet:"Connect your wallet",scan:"Scan with your mobile wallet",availableWallets:"Available wallets"},mobileConnectionModal:{showQR:"Show QR Code",scanQR:"Scan the QR code below with your phone’s or {{ name }}’s camera",continueIn:"Continue in {{ name }}…",connectionDeclined:"Connection declined"},desktopConnectionModal:{scanQR:"Scan the QR code below with your phone’s or {{ name }}’s camera",continueInExtension:"Continue in {{ name }} browser extension…",dontHaveExtension:"Seems you don't have installed {{ name }} browser extension",getWallet:"Get {{ name }}",continueOnDesktop:"Continue in {{ name }} on desktop…",openWalletOnTelegram:"Open Wallet in Telegram on desktop",connectionDeclined:"Connection declined"},infoModal:{whatIsAWallet:"What is a wallet",secureDigitalAssets:"Secure digital assets storage",walletProtects:"A wallet protects and manages your digital assets including TON, tokens and collectables.",controlIdentity:"Control your Web3 identity",manageIdentity:"Manage your digital identity and access decentralized applications with ease. Maintain control over your data and engage securely in the blockchain ecosystem.",effortlessCryptoTransactions:"Effortless crypto transactions",easilySend:"Easily send, receive, monitor your cryptocurrencies. Streamline your operations with decentralized applications.",getAWallet:"Get a Wallet"}},rI={confirmTransaction:{header:"Confirm the transaction in {{ name }}",text:"It will only take a moment."},transactionSent:"$notifications.transactionSent",transactionCanceled:"$notifications.transactionCanceled"},iI={common:JP,button:QP,notifications:eI,walletItem:tI,walletModal:nI,actionModal:rI},oI={close:"Закрыть",openWallet:"Открыть кошелёк",copyLink:"Копировать ссылку",linkCopied:"Ссылка скопирована",copied:"Ссылка скопирована",yourWallet:"Ваш кошелёк",retry:"Повторить",get:"Скачать",mobile:"Мобильный",browserExtension:"Расширение",desktop:"Десктоп"},sI={connectWallet:"Подключить кошелёк",dropdown:{copy:"Скопировать адрес",copied:"Адрес скопирован!",disconnect:"Отключить кошелёк"}},aI={confirm:{header:"Откройте {{ name }}, чтобы подтвердить транзакцию."},transactionSent:{header:"Транзакция отправлена",text:"Ваша транзакция будет обработана через несколько секунд."},transactionCanceled:{header:"Транзакция отменена",text:"Состояние вашего счёта не изменится."}},lI={walletOn:"Wallet в",recent:"Недавний",installed:"Установлен",popular:"Популярен"},cI={loading:"Кошельки загружаются",wallets:"Кошельки",mobileUniversalModal:{connectYourWallet:"Подключите кошелёк",openWalletOnTelegramOrSelect:"Подключите Wallet в Telegram или выберете кошелёк для подключения",openWalletOnTelegram:"Открыть Wallet в Telegram",openLink:"Открыть ссылку",scan:"Отсканируйте камерой вашего телефона"},desktopUniversalModal:{connectYourWallet:"Подключите кошелёк",scan:"Отсканируйте QR-код камерой вашего телефона",availableWallets:"Доступные кошельки"},mobileConnectionModal:{showQR:"Показать QR-код",scanQR:"Отсканируйте QR-код ниже камерой в приложении {{ name }}, или камерой телефона",continueIn:"Продолжите в {{ name }}…",connectionDeclined:"Подключение отклонено"},desktopConnectionModal:{scanQR:"Отсканируйте QR-код ниже камерой в приложении {{ name }}, или камерой телефона",continueInExtension:"Откройте браузерное расширение {{ name }}",dontHaveExtension:"Похоже, у вас не установлено браузерное расширение {{ name }}",getWallet:"Скачать {{ name }}",continueOnDesktop:"Откройте {{ name }} на компьютере…",openWalletOnTelegram:"Открыть Wallet в Telegram",connectionDeclined:"Подключение отклонено"},infoModal:{whatIsAWallet:"Что такое кошелёк?",secureDigitalAssets:"Надежное хранилище цифровых активов",walletProtects:"Кошелёк защищает ваши цифровые активы, включая TON, токены и предметы коллекционирования, и управляет ими.",controlIdentity:"Контроль своей личности Web3",manageIdentity:"Управляйте своей цифровой идентификацией и с легкостью получайте доступ к децентрализованным приложениям. Сохраняйте контроль над своими данными и безопасно участвуйте в экосистеме блокчейна.",effortlessCryptoTransactions:"Простые криптотранзакции",easilySend:"Легко отправляйте, получайте и отслеживайте свои криптовалюты. Оптимизируйте свои операции с помощью децентрализованных приложений.",getAWallet:"Скачать кошелёк"}},uI={confirmTransaction:{header:"Подтвердите действие в {{ name }}",text:"Это займет пару секунд."},transactionSent:"$notifications.transactionSent",transactionCanceled:"$notifications.transactionCanceled"},hI={common:oI,button:sI,notifications:aI,walletItem:lI,walletModal:cI,actionModal:uI},dI={en:V5(iI),ru:V5(hI)};function V5(n){const t="$",r=l=>{Object.entries(l).forEach(([d,m])=>{if(typeof m=="object"&&m)return r(m);if(typeof m=="string"){if(m[0]===t){const x=m.slice(1).split(".");let C=n;x.forEach(a=>{if(a in C)C=C[a];else throw new Error(`Cannot parse translations: there is no property ${a} in translation`)}),l[d]=C}m.slice(0,2)===`\\${t}`&&(l[d]=m.slice(1))}})};return r(n),n}const Wm=_y(),Sx=Symbol("store-raw"),M0=Symbol("store-node"),fI=Symbol("store-name");function HC(n,t){let r=n[rc];if(!r&&(Object.defineProperty(n,rc,{value:r=new Proxy(n,gI)}),!Array.isArray(n))){const l=Object.keys(n),d=Object.getOwnPropertyDescriptors(n);for(let m=0,x=l.length;m<x;m++){const C=l[m];d[C].get&&Object.defineProperty(n,C,{enumerable:d[C].enumerable,get:d[C].get.bind(r)})}}return r}function $_(n){let t;return n!=null&&typeof n=="object"&&(n[rc]||!(t=Object.getPrototypeOf(n))||t===Object.prototype||Array.isArray(n))}function Om(n,t=new Set){let r,l,d,m;if(r=n!=null&&n[Sx])return r;if(!$_(n)||t.has(n))return n;if(Array.isArray(n)){Object.isFrozen(n)?n=n.slice(0):t.add(n);for(let x=0,C=n.length;x<C;x++)d=n[x],(l=Om(d,t))!==d&&(n[x]=l)}else{Object.isFrozen(n)?n=Object.assign({},n):t.add(n);const x=Object.keys(n),C=Object.getOwnPropertyDescriptors(n);for(let a=0,M=x.length;a<M;a++)m=x[a],!C[m].get&&(d=n[m],(l=Om(d,t))!==d&&(n[m]=l))}return n}function Ow(n){let t=n[M0];return t||Object.defineProperty(n,M0,{value:t={}}),t}function kx(n,t,r){return n[t]||(n[t]=XC(r))}function pI(n,t){const r=Reflect.getOwnPropertyDescriptor(n,t);return!r||r.get||!r.configurable||t===rc||t===M0||t===fI||(delete r.value,delete r.writable,r.get=()=>n[rc][t]),r}function KC(n){if(IC()){const t=Ow(n);(t._||(t._=XC()))()}}function mI(n){return KC(n),Reflect.ownKeys(n)}function XC(n){const[t,r]=Ir(n,{equals:!1,internal:!0});return t.$=r,t}const gI={get(n,t,r){if(t===Sx)return n;if(t===rc)return r;if(t===wx)return KC(n),r;const l=Ow(n),d=l.hasOwnProperty(t);let m=d?l[t]():n[t];if(t===M0||t==="__proto__")return m;if(!d){const x=Object.getOwnPropertyDescriptor(n,t);IC()&&(typeof m!="function"||n.hasOwnProperty(t))&&!(x&&x.get)&&(m=kx(l,t,m)())}return $_(m)?HC(m):m},has(n,t){return t===Sx||t===rc||t===wx||t===M0||t==="__proto__"?!0:(this.get(n,t,n),t in n)},set(){return!0},deleteProperty(){return!0},ownKeys:mI,getOwnPropertyDescriptor:pI};function V_(n,t,r,l=!1){if(!l&&n[t]===r)return;const d=n[t],m=n.length;r===void 0?delete n[t]:n[t]=r;let x=Ow(n),C;(C=kx(x,t,d))&&C.$(()=>r),Array.isArray(n)&&n.length!==m&&(C=kx(x,"length",m))&&C.$(n.length),(C=x._)&&C.$()}function YC(n,t){const r=Object.keys(t);for(let l=0;l<r.length;l+=1){const d=r[l];V_(n,d,t[d])}}function _I(n,t){if(typeof t=="function"&&(t=t(n)),t=Om(t),Array.isArray(t)){if(n===t)return;let r=0,l=t.length;for(;r<l;r++){const d=t[r];n[r]!==d&&V_(n,r,d)}V_(n,"length",l)}else YC(n,t)}function e0(n,t,r=[]){let l,d=n;if(t.length>1){l=t.shift();const x=typeof l,C=Array.isArray(n);if(Array.isArray(l)){for(let a=0;a<l.length;a++)e0(n,[l[a]].concat(t),r);return}else if(C&&x==="function"){for(let a=0;a<n.length;a++)l(n[a],a)&&e0(n,[a].concat(t),r);return}else if(C&&x==="object"){const{from:a=0,to:M=n.length-1,by:R=1}=l;for(let j=a;j<=M;j+=R)e0(n,[j].concat(t),r);return}else if(t.length>1){e0(n[l],t,[l].concat(r));return}d=n[l],r=[l].concat(r)}let m=t[0];typeof m=="function"&&(m=m(d,r),m===d)||l===void 0&&m==null||(m=Om(m),l===void 0||$_(d)&&$_(m)&&!Array.isArray(m)?YC(d,m):V_(n,l,m))}function Dw(...[n,t]){const r=Om(n||{}),l=Array.isArray(r),d=HC(r);function m(...x){PC(()=>{l&&x.length===1?_I(r,x[0]):e0(r,x)})}return[d,m]}const JC={constant:{black:"#000000",white:"#FFFFFF"},connectButton:{background:"#0098EA",foreground:"#FFFFFF"},accent:"#0098EA",telegramButton:"#0098EA",icon:{primary:"#0F0F0F",secondary:"#7A8999",tertiary:"#C1CAD2",success:"#29CC6A",error:"#F5A73B"},background:{primary:"#FFFFFF",secondary:"#F1F3F5",segment:"#FFFFFF",tint:"#F1F3F5",qr:"#F1F3F5"},text:{primary:"#0F0F0F",secondary:"#6A7785"}},yI={constant:{black:"#000000",white:"#FFFFFF"},connectButton:{background:"#0098EA",foreground:"#FFFFFF"},accent:"#E5E5EA",telegramButton:"#31A6F5",icon:{primary:"#E5E5EA",secondary:"#909099",tertiary:"#434347",success:"#29CC6A",error:"#F5A73B"},background:{primary:"#121214",secondary:"#18181A",segment:"#262629",tint:"#222224",qr:"#FFFFFF"},text:{primary:"#E5E5EA",secondary:"#7D7D85"}};/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function W5(n){return Object.prototype.toString.call(n)==="[object Object]"}function vI(n){var t,r;return W5(n)===!1?!1:(t=n.constructor,t===void 0?!0:(r=t.prototype,!(W5(r)===!1||r.hasOwnProperty("isPrototypeOf")===!1)))}function xd(n,t){return n?jA(t,n,{arrayMerge:(l,d,m)=>d,isMergeableObject:vI}):t}const[xI,zw]=Dw({theme:bo.LIGHT,colors:JC,borderRadius:"m"}),QC={[bo.LIGHT]:JC,[bo.DARK]:yI},Kc={[bo.LIGHT]:void 0,[bo.DARK]:void 0};function Dv(n,t){t&&(Kc[bo.DARK]=xd(t[bo.DARK],Kc[bo.DARK]),Kc[bo.LIGHT]=xd(t[bo.LIGHT],Kc[bo.LIGHT])),zw({theme:n,colors:xd(Kc[n],QC[n])})}function wI(n){zw({borderRadius:n})}function bI(n){Kc[bo.DARK]=xd(n[bo.DARK],Kc[bo.DARK]),Kc[bo.LIGHT]=xd(n[bo.LIGHT],Kc[bo.LIGHT]),zw(t=>({colors:xd(Kc[t.theme],QC[t.theme])}))}const EI=jt.div`
    background-color: ${n=>n.theme.colors.background.secondary};
`,op=n=>{let t;const[r,l]=Ir(null);return gs(()=>{const d=new window.Image;return d.src=n.src,d.alt=n.alt||"",d.setAttribute("draggable","false"),n.class&&d.classList.add(n.class),d.complete?l(d):(d.addEventListener("load",()=>l(d)),()=>d.removeEventListener("load",()=>l(d)))}),[he(jr,{get when(){return r()},get children(){return r()}}),he(jr,{get when(){return!r()},get children(){return he(EI,{get class(){return n.class},ref(d){const m=t;typeof m=="function"?m(d):t=d}})}})]};let ep={};try{let n=location.hash.toString();ep=TI(n)}catch{}let A0="unknown";ep?.tgWebAppPlatform&&(A0=(T5=ep.tgWebAppPlatform)!=null?T5:"unknown");if(A0==="unknown"){const n=gh();A0=(k5=(S5=(C5=n?.Telegram)==null?void 0:C5.WebApp)==null?void 0:S5.platform)!=null?k5:"unknown"}let W_="6.0";ep?.tgWebAppVersion&&(W_=ep.tgWebAppVersion);if(!W_){const n=gh();W_=(P5=(A5=(M5=n?.Telegram)==null?void 0:M5.WebApp)==null?void 0:A5.version)!=null?P5:"6.0"}function ch(...n){return n.includes(A0)}function ph(){var n;return A0!=="unknown"||!!((n=gh())!=null&&n.TelegramWebviewProxy)}function Bw(){tS("web_app_expand",{})}function t0(n,t){const r=new URL(n);if(r.protocol!=="http:"&&r.protocol!=="https:"){if(t)return t();throw new Bo(`Url protocol is not supported: ${r}`)}if(r.hostname!=="t.me"){if(t)return t();throw new Bo(`Url host is not supported: ${r}`)}const l=r.pathname+r.search;eS()||kI("6.1")?tS("web_app_open_tg_link",{path_full:l}):so("https://t.me"+l)}function eS(){try{const n=gh();return n?n.parent!=null&&n!==n.parent:!1}catch{return!1}}function tS(n,t){try{const r=gh();if(!r)throw new Bo("Can't post event to parent window: window is not defined");if(r.TelegramWebviewProxy!==void 0)x_("postEvent",n,t),r.TelegramWebviewProxy.postEvent(n,JSON.stringify(t));else if(r.external&&"notify"in r.external)x_("postEvent",n,t),r.external.notify(JSON.stringify({eventType:n,eventData:t}));else if(eS()){const l="*",d=JSON.stringify({eventType:n,eventData:t});x_("postEvent",n,t),r.parent.postMessage(d,l)}else throw new Bo("Can't post event to TMA")}catch(r){zP(`Can't post event to parent window: ${r}`)}}function TI(n){n=n.replace(/^#/,"");let t={};if(!n.length)return t;if(n.indexOf("=")<0&&n.indexOf("?")<0)return t._path=q_(n),t;let r=n.indexOf("?");if(r>=0){let d=n.substr(0,r);t._path=q_(d),n=n.substr(r+1)}let l=CI(n);for(let d in l)t[d]=l[d];return t}function q_(n){try{return n=n.replace(/\+/g,"%20"),decodeURIComponent(n)}catch{return n}}function CI(n){let t={};if(!n.length)return t;let r=n.split("&"),l,d,m,x;for(l=0;l<r.length;l++)d=r[l].split("="),m=q_(d[0]),x=d[1]==null?null:q_(d[1]),t[m]=x;return t}function SI(n,t){typeof n!="string"&&(n="");let r=n.replace(/^\s+|\s+$/g,"").split("."),l=t.replace(/^\s+|\s+$/g,"").split("."),d,m,x,C;for(d=Math.max(r.length,l.length),m=0;m<d;m++)if(x=parseInt(r[m])||0,C=parseInt(l[m])||0,x!==C)return x>C?1:-1;return 0}function kI(n){return SI(W_,n)>=0}const Zf={mobile:440,tablet:1020};function km(n){const t=gh();if(!t)return n==="desktop";if(ch("weba"))return!0;const r=t.innerWidth;switch(n){case"desktop":return r>Zf.tablet;case"tablet":return r>Zf.mobile;default:case"mobile":return r<=Zf.mobile||Yc("ios","android","ipad")}}function Ya(n){switch(n){case"mobile":return`@media (max-width: ${Zf.mobile}px)`;case"tablet":return`@media (max-width: ${Zf.tablet}px) (min-width: ${Zf.mobile}px)`;default:case"desktop":return`@media (min-width: ${Zf.tablet}px)`}}const H0="@media (hover: none)",K0="@media not all and (hover: none)",MI={m:"100vh",s:"8px",none:"0"},zv={s:.02,m:.04},AI=jt.button`
    display: ${n=>n.leftIcon||n.rightIcon?"flex":"inline-block"};
    gap: ${n=>n.leftIcon||n.rightIcon?"6px":"unset"};
    align-items: ${n=>n.leftIcon||n.rightIcon?"center":"unset"};
    justify-content: ${n=>n.leftIcon||n.rightIcon?"space-between":"unset"};
    background-color: ${n=>n.appearance==="flat"?"transparent":n.appearance==="secondary"?n.theme.colors.background.tint:Z0(n.theme.colors.accent,.12)};
    color: ${n=>n.appearance==="secondary"?n.theme.colors.text.primary:n.theme.colors.accent};

    padding: ${n=>n.appearance==="flat"?"0":"9px 16px"};
    padding-left: ${n=>n.leftIcon&&n.appearance!=="flat"?"12px":"16px"};
    padding-right: ${n=>n.rightIcon&&n.appearance!=="flat"?"12px":"16px"};
    border: none;
    border-radius: ${n=>MI[n.theme.borderRadius]};
    cursor: ${n=>n.disabled?"not-allowed":"pointer"};

    font-size: 14px;
    font-weight: 590;
    line-height: 18px;

    transition: transform 0.125s ease-in-out;

    ${K0} {
        &:hover {
            transform: ${n=>n.disabled?"unset":`scale(${1+zv[n.scale]})`};
        }
    }

    &:active {
        transform: ${n=>n.disabled?"unset":`scale(${1-zv[n.scale]})`};
    }

    ${H0} {
        &:active {
            transform: ${n=>n.disabled?"unset":`scale(${1-zv[n.scale]*2})`};
        }
    }
`;function X0(n){const t=_s(()=>Object.keys(n).filter(l=>l.startsWith("data-"))),[r]=Mw(n,t);return r}const jo=n=>{const t=X0(n);return he(AI,eu({get appearance(){return n.appearance||"primary"},get class(){return n.class},onClick:r=>{var l;return(l=n.onClick)==null?void 0:l.call(n,r)},onMouseEnter:r=>{var l;return(l=n.onMouseEnter)==null?void 0:l.call(n,r)},onMouseLeave:r=>{var l;return(l=n.onMouseLeave)==null?void 0:l.call(n,r)},ref(r){const l=n.ref;typeof l=="function"?l(r):n.ref=r},get disabled(){return n.disabled},get scale(){return n.scale||"m"},get leftIcon(){return!!n.leftIcon},get rightIcon(){return!!n.rightIcon},"data-tc-button":"true"},t,{get children(){return[qn(()=>n.leftIcon),qn(()=>n.children),qn(()=>n.rightIcon)]}}))};function G_(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}const jw=n=>{let t,r=!0;const[l,d]=Ir(),[m,x]=Ir(),C=yy(()=>n.children),{onBeforeEnter:a,onEnter:M,onAfterEnter:R,onBeforeExit:j,onExit:F,onAfterExit:Z}=n,Y=qn(()=>{const xe=n.name||"s";return{enterActiveClass:n.enterActiveClass||xe+"-enter-active",enterClass:n.enterClass||xe+"-enter",enterToClass:n.enterToClass||xe+"-enter-to",exitActiveClass:n.exitActiveClass||xe+"-exit-active",exitClass:n.exitClass||xe+"-exit",exitToClass:n.exitToClass||xe+"-exit-to"}});function ne(xe,Se){if(!r||n.appear){let _e=function(Ke){xe&&(!Ke||Ke.target===xe)&&(xe.removeEventListener("transitionend",_e),xe.removeEventListener("animationend",_e),xe.classList.remove(...Me),xe.classList.remove(...Ve),PC(()=>{l()!==xe&&d(xe),m()===xe&&x(void 0)}),R&&R(xe),n.mode==="inout"&&se(xe,Se))};const Ie=Y().enterClass.split(" "),Me=Y().enterActiveClass.split(" "),Ve=Y().enterToClass.split(" ");a&&a(xe),xe.classList.add(...Ie),xe.classList.add(...Me),G_(()=>{xe.classList.remove(...Ie),xe.classList.add(...Ve),M&&M(xe,()=>_e()),(!M||M.length<2)&&(xe.addEventListener("transitionend",_e),xe.addEventListener("animationend",_e))})}Se&&!n.mode?x(xe):d(xe)}function se(xe,Se){const _e=Y().exitClass.split(" "),Ie=Y().exitActiveClass.split(" "),Me=Y().exitToClass.split(" ");if(!Se.parentNode)return Ve();j&&j(Se),Se.classList.add(..._e),Se.classList.add(...Ie),G_(()=>{Se.classList.remove(..._e),Se.classList.add(...Me)}),F&&F(Se,()=>Ve()),(!F||F.length<2)&&(Se.addEventListener("transitionend",Ve),Se.addEventListener("animationend",Ve));function Ve(Ke){(!Ke||Ke.target===Se)&&(Se.removeEventListener("transitionend",Ve),Se.removeEventListener("animationend",Ve),Se.classList.remove(...Ie),Se.classList.remove(...Me),l()===Se&&d(void 0),Z&&Z(Se),n.mode==="outin"&&ne(xe,Se))}}return kw(xe=>{for(t=C();typeof t=="function";)t=t();return _s(()=>(t&&t!==xe&&(n.mode!=="outin"?ne(t,xe):r&&d(t)),xe&&xe!==t&&n.mode!=="inout"&&se(t,xe),r=!1,t))}),[l,m]};function J1(n){const{top:t,bottom:r,left:l,right:d,width:m,height:x}=n.getBoundingClientRect(),C=n.parentNode.getBoundingClientRect();return{top:t-C.top,bottom:r,left:l-C.left,right:d,width:m,height:x}}const PI=n=>{const t=yy(()=>n.children),r=qn(()=>{const Z=n.name||"s";return{enterActiveClass:n.enterActiveClass||Z+"-enter-active",enterClass:n.enterClass||Z+"-enter",enterToClass:n.enterToClass||Z+"-enter-to",exitActiveClass:n.exitActiveClass||Z+"-exit-active",exitClass:n.exitClass||Z+"-exit",exitToClass:n.exitToClass||Z+"-exit-to",moveClass:n.moveClass||Z+"-move"}}),{onBeforeEnter:l,onEnter:d,onAfterEnter:m,onBeforeExit:x,onExit:C,onAfterExit:a}=n,[M,R]=Ir();let j=[],F=!0;return kw(()=>{const Z=t(),Y=[...Z],ne=new Set(Z),se=new Set(j),xe=r().enterClass.split(" "),Se=r().enterActiveClass.split(" "),_e=r().enterToClass.split(" "),Ie=r().exitClass.split(" "),Me=r().exitActiveClass.split(" "),Ve=r().exitToClass.split(" ");for(let Ke=0;Ke<Z.length;Ke++){const et=Z[Ke];if(!F&&!se.has(et)){let qe=function(ge){et&&(!ge||ge.target===et)&&(et.removeEventListener("transitionend",qe),et.removeEventListener("animationend",qe),et.classList.remove(...Se),et.classList.remove(..._e),m&&m(et))};l&&l(et),et.classList.add(...xe),et.classList.add(...Se),G_(()=>{et.classList.remove(...xe),et.classList.add(..._e),d&&d(et,()=>qe()),(!d||d.length<2)&&(et.addEventListener("transitionend",qe),et.addEventListener("animationend",qe))})}}for(let Ke=0;Ke<j.length;Ke++){const et=j[Ke];if(!ne.has(et)&&et.parentNode){let qe=function(ge){(!ge||ge.target===et)&&(et.removeEventListener("transitionend",qe),et.removeEventListener("animationend",qe),et.classList.remove(...Me),et.classList.remove(...Ve),a&&a(et),j=j.filter(We=>We!==et),R(j))};Y.splice(Ke,0,et),x&&x(et),et.classList.add(...Ie),et.classList.add(...Me),G_(()=>{et.classList.remove(...Ie),et.classList.add(...Ve)}),C&&C(et,()=>qe()),(!C||C.length<2)&&(et.addEventListener("transitionend",qe),et.addEventListener("animationend",qe))}}j=Y,R(Y)}),gs(Z=>{const Y=M();return Y.forEach(ne=>{let se;(se=Z.get(ne))?se.new&&(se.new=!1,se.newPos=J1(ne)):Z.set(ne,se={pos:J1(ne),new:!F}),se.new&&ne.addEventListener("transitionend",()=>{se.new=!1,ne.parentNode&&(se.newPos=J1(ne))},{once:!0}),se.newPos&&(se.pos=se.newPos),se.newPos=J1(ne)}),F?(F=!1,Z):(Y.forEach(ne=>{const se=Z.get(ne),xe=se.pos,Se=se.newPos,_e=xe.left-Se.left,Ie=xe.top-Se.top;if(_e||Ie){se.moved=!0;const Me=ne.style;Me.transform=`translate(${_e}px,${Ie}px)`,Me.transitionDuration="0s"}}),document.body.offsetHeight,Y.forEach(ne=>{const se=Z.get(ne);if(se.moved){let xe=function(Ie){Ie&&Ie.target!==ne||!ne.parentNode||(!Ie||/transform$/.test(Ie.propertyName))&&(ne.removeEventListener("transitionend",xe),ne.classList.remove(..._e))};se.moved=!1;const Se=ne.style,_e=r().moveClass.split(" ");ne.classList.add(..._e),Se.transform=Se.transitionDuration="",ne.addEventListener("transitionend",xe)}}),Z)},new Map),M};function II(n,t){const r=l=>{var d;return!n.contains(l.target)&&((d=t())==null?void 0:d())};document.body.addEventListener("click",r),la(()=>document.body.removeEventListener("click",r))}function LI(n,t){const r=l=>{var d,m;l.key==="Escape"&&((d=document.activeElement)==null||d.blur(),(m=t())==null||m())};document.body.addEventListener("keydown",r),la(()=>document.body.removeEventListener("keydown",r))}function RI(n,t){const{isEnabled:r,onClose:l}=t();if(!r||!(Rw().os==="android"))return;window.history.pushState(OI,"");const m=x=>{x.preventDefault(),l()};window.addEventListener("popstate",m,{once:!0}),la(()=>{window.removeEventListener("popstate",m),qC(()=>{var x;((x=window.history.state)==null?void 0:x[nS])===!0&&window.history.back()})})}const nS="androidBackHandler",OI={[nS]:!0},DI=ei('<svg><path fill-rule="evenodd" clip-rule="evenodd" d="M10.2122 14.3407C10.5384 14.0854 10.5959 13.614 10.3406 13.2878L6.20237 8.00003L10.3406 2.71227C10.5959 2.38607 10.5384 1.91469 10.2122 1.6594C9.88604 1.40412 9.41465 1.46161 9.15937 1.7878L4.65937 7.5378C4.44688 7.80932 4.44688 8.19074 4.65937 8.46226L9.15937 14.2123C9.41465 14.5385 9.88604 14.5959 10.2122 14.3407Z"></path></svg>',4,!0),zI={left:0,top:90,right:180,bottom:270},rS=n=>{const t=Vi(),r=()=>n.fill||t.colors.icon.secondary,l=()=>n.direction||"left",d=jt("svg")`
        transform: rotate(${m=>zI[m.svgDirection]}deg);
        transition: transform 0.1s ease-in-out;
    `;return he(d,{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",get svgDirection(){return l()},get children(){const m=DI.cloneNode(!0);return Yr(()=>vr(m,"fill",r())),m}})},BI=ei('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.71966 2.71968C3.01255 2.42678 3.48743 2.42677 3.78032 2.71966L8.00002 6.93925L12.2197 2.71967C12.5126 2.42677 12.9874 2.42678 13.2803 2.71967C13.5732 3.01257 13.5732 3.48744 13.2803 3.78033L9.06068 7.99991L13.2803 12.2197C13.5732 12.5126 13.5732 12.9874 13.2803 13.2803C12.9874 13.5732 12.5126 13.5732 12.2197 13.2803L8.00002 9.06057L3.78033 13.2803C3.48744 13.5732 3.01257 13.5732 2.71967 13.2803C2.42678 12.9874 2.42677 12.5126 2.71967 12.2197L6.93936 7.99991L2.71968 3.78034C2.42678 3.48745 2.42677 3.01257 2.71966 2.71968Z"></path></svg>'),jI=n=>{const t=Vi(),r=()=>n.fill||t.colors.icon.secondary;return(()=>{const l=BI.cloneNode(!0),d=l.firstChild;return Yr(()=>vr(d,"fill",r())),l})()},NI=jt.button`
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background-color: ${n=>n.theme.colors.background.tint};
    border: none;
    cursor: pointer;

    transition: transform 0.125s ease-in-out;

    ${K0} {
        &:hover {
            transform: scale(1.04);
        }
    }

    &:active {
        transform: scale(0.96);
    }

    ${H0} {
        &:active {
            transform: scale(0.92);
        }
    }
`,sp=n=>{const t=X0(n),r=()=>n.icon||"close";return he(NI,eu({get class(){return n.class},onClick:()=>n.onClick(),"data-tc-icon-button":"true"},t,{get children(){return[he(jr,{get when(){return!!n.children},get children(){return n.children}}),he(jr,{get when(){return!n.children},get children(){return he(G0,{get children(){return[he(ks,{get when(){return r()==="close"},get children(){return he(jI,{get fill(){return n.fill}})}}),he(ks,{get when(){return r()==="arrow"},get children(){return he(rS,{get fill(){return n.fill}})}}),he(ks,{get when(){return r()==="question"},get children(){return he(V9,{get fill(){return n.fill}})}}),he(ks,{get when(){return typeof r()!="string"},get children(){return r()}})]}})}})]}}))},Am={m:"24px",s:"16px",none:"0"},FI=jt.div`
    display: flex;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.4);
    padding: 20px 0;
    overflow-y: auto;

    ${Ya("mobile")} {
        padding-bottom: 0;
    }
`,UI=fh`
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08), 0 16px 64px rgba(0, 0, 0, 0.16);
    width: fit-content;
    margin: auto;

    ${Ya("mobile")} {
        width: 100%;
        height: fit-content;
        margin: auto 0 0 0;
    }
`,$I=jt.div`
    position: relative;
    min-height: 100px;
    width: 416px;
    padding: 44px 56px 24px;

    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.04);

    background-color: ${n=>n.theme.colors.background.primary};
    border-radius: ${n=>Am[n.theme.borderRadius]};

    ${Ya("mobile")} {
        width: 100%;
    }
`,VI=jt(sp)`
    position: absolute;
    right: 16px;
    top: 16px;
`,WI=jt.div`
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 16px 16px 18px;
    border-radius: 0 0 ${n=>Am[n.theme.borderRadius]}
        ${n=>Am[n.theme.borderRadius]};
`,qI=jt(sp)`
    background-color: ${n=>Z0(n.theme.colors.icon.secondary,.12)};
`;class GI{constructor(){kr(this,"currentTime",0)}}const n0=class{constructor(){kr(this,"currentTime",0),kr(this,"playbackRate",1),kr(this,"startTime",null),kr(this,"timeline",new GI),kr(this,"finished",Promise.resolve(this)),kr(this,"effect",null),kr(this,"id",""),kr(this,"pending",!1),kr(this,"playState","finished"),kr(this,"replaceState","active"),kr(this,"ready",Promise.resolve(this)),kr(this,"oncancel",null),kr(this,"onfinish",null),kr(this,"onremove",null)}static create(){return n0._instance||(BP("Animation is not supported in this environment: please consider using the `web-animations-js` polyfill to provide a fallback implementation of the Web Animations API."),n0._instance=new n0),n0._instance}cancel(){}finish(){}pause(){}play(){}reverse(){}addEventListener(n,t,r){}dispatchEvent(n){return!1}removeEventListener(n,t,r){}updatePlaybackRate(n){}commitStyles(){}persist(){}};let iS=n0;kr(iS,"_instance",null);function Jc(n,t,r){return"animate"in n?n.animate(t,r):iS.create()}const ZI=ei("<div></div>"),HI=II,KI=LI,XI=RI,oS=n=>{const t=Vi(),r=X0(n);return gs(()=>{n.opened?FP():UP()}),he(jw,{onBeforeEnter:l=>{const d=km("mobile")?200:100;Jc(l,[{opacity:0},{opacity:1}],{duration:d}),km("mobile")&&Jc(l.firstElementChild,[{transform:"translateY(390px)"},{transform:"translateY(0)"}],{duration:d})},onExit:(l,d)=>{const m=km("mobile")?200:100,x=Jc(l,[{opacity:1},{opacity:0}],{duration:m});if(km("mobile")){const C=Jc(l.firstElementChild,[{transform:"translateY(0)"},{transform:"translateY(390px)"}],{duration:m});Promise.all([x.finished,C.finished]).then(d)}else x.finished.then(d)},get children(){return he(jr,{get when(){return n.opened},get children(){return he(FI,eu({"data-tc-modal":"true"},r,{get children(){const l=ZI.cloneNode(!0);return h0(XI,l,()=>({isEnabled:n.enableAndroidBackHandler,onClose:()=>n.onClose()})),h0(KI,l,()=>()=>n.onClose()),h0(HI,l,()=>()=>n.onClose()),Ws(l,he($I,{get class(){return n.class},get children(){return[he(VI,{icon:"close",onClick:()=>n.onClose()}),qn(()=>n.children)]}}),null),Ws(l,he(jr,{get when(){return n.onClickQuestion},get children(){return he(WI,{get children(){return[he(U9,{}),he(qI,{get onClick(){return n.onClickQuestion},icon:"question"})]}})}}),null),Yr(()=>Aw(l,v_(UI,fh`
                                border-radius: ${Am[t.borderRadius]};
                                background-color: ${t.colors.background.tint};

                                ${Ya("mobile")} {
                                    border-radius: ${Am[t.borderRadius]}
                                        ${Am[t.borderRadius]} 0 0;
                                }
                            `))),l}}))}})}})},YI={m:"22px",s:"12px",none:"0"},JI={m:"18px",s:"8px",none:"0"},QI=jt.div`
    display: grid;
    grid-template: 1fr / 1fr 1fr;
    width: fit-content;
    justify-items: center;
    gap: 4px;

    position: relative;
    padding: 4px;
    border-radius: ${n=>YI[n.theme.borderRadius]};

    background-color: ${n=>n.theme.colors.background.secondary};
`,e9=jt.div`
    position: absolute;
    top: 4px;
    left: 4px;

    height: calc(100% - 8px);
    width: calc(50% - 4px);

    border-radius: ${n=>JI[n.theme.borderRadius]};
    background-color: ${n=>n.theme.colors.background.segment};

    transform: ${n=>n.right?"translateX(100%)":"translateX(0)"};

    transition: transform 0.13s ease-in-out;
`,q5=jt.input`
    display: none;
`,G5=jt.label`
    padding: 9px 12px;
    z-index: 1;

    cursor: ${n=>n.isActive?"default":"pointer"};

    transition: transform 0.13s ease-in-out;

    &:hover {
        transform: ${n=>n.isActive?"none":"scale(1.025)"};
    }

    > * {
        ${n=>n.isActive?"":`color: ${n.theme.colors.text.secondary};`}
    }
`,t9=n=>{const t="tabBar"+Math.floor(Math.random()*1e4);return he(QI,{get class(){return n.class},"data-tc-tab-bar":"true",get children(){return[he(e9,{get right(){return n.selectedTabIndex===1}}),he(G5,{get isActive(){return n.selectedTabIndex===0},get children(){return[he(q5,{type:"radio",name:t,get checked(){return n.selectedTabIndex===0},onInput:()=>{var r;return(r=n.onSelectedTabIndexChange)==null?void 0:r.call(n,0)}}),qn(()=>n.tab1)]}}),he(G5,{get isActive(){return n.selectedTabIndex===1},get children(){return[he(q5,{type:"radio",get checked(){return n.selectedTabIndex===1},name:t,onInput:()=>{var r;return(r=n.onSelectedTabIndexChange)==null?void 0:r.call(n,1)}}),qn(()=>n.tab2)]}})]}})},n9={m:"16px",s:"12px",none:"0"},r9={m:"12px",s:"8px",none:"0"},sS=256,Mx=60,Z5=48,H5=24,w_=jt.div`
    width: 52px;
    height: 52px;
    background: transparent;
    position: absolute;
    right: 0;
    bottom: 0;

    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.125s ease-in-out;
`,i9=jt.button`
    display: flex;
    align-items: center;
    position: relative;
    background-color: ${n=>n.theme.colors.background.qr};
    border-radius: ${n=>n9[n.theme.borderRadius]};
    padding: ${tu(H5)} 0;
    height: ${tu(sS+H5*2)};
    width: 100%;

    overflow: hidden;
    cursor: pointer;
    border: none;

    ${K0} {
        &:hover {
            ${w_.class} {
                transform: scale(1.04);
            }
        }
    }

    &:active {
        ${w_.class} {
            transform: scale(0.96);
        }
    }

    ${H0} {
        &:active {
            ${w_.class} {
                transform: scale(0.92);
            }
        }
    }
`,o9=jt.div`
    position: relative;

    width: fit-content;
    margin: 0 auto;

    > div:first-child {
        display: flex;
        align-items: center;
        justify-content: center;
    }

    rect {
        fill: transparent;
    }

    path {
        fill: ${n=>n.theme.colors.constant.black};
    }
`,s9=jt.div`
    position: absolute;
    width: ${tu(Mx)};
    height: ${tu(Mx)};
    background: ${n=>n.theme.colors.background.qr};

    display: flex;
    align-items: center;
    justify-content: center;
`,a9=jt(op)`
    width: ${n=>tu(n.size)};
    height: ${n=>tu(n.size)};
    border-radius: ${n=>r9[n.theme.borderRadius]};
    background-color: ${n=>n.theme.colors.background.qr};
`,l9=jt.div`
    position: absolute;
    bottom: 14px;
    left: 50%;
    transform: translate(-50%, 0);

    display: flex;
    gap: 6px;
    align-items: center;
    border-radius: 18px;
    min-width: 126px;
    padding: 9px 16px 9px 10px;

    filter: drop-shadow(0px 2px 8px rgba(0, 0, 0, 0.08));
    background-color: ${n=>n.theme.colors.background.segment};
`;var aS={exports:{}};(function(n,t){var r=function(){var l=function(Me,Ve){var Ke=236,et=17,qe=Me,ge=m[Ve],We=null,Ue=0,lt=null,ht=[],Wt={},In=function(mt,bt){Ue=qe*4+17,We=function(xt){for(var Nt=new Array(xt),wt=0;wt<xt;wt+=1){Nt[wt]=new Array(xt);for(var hn=0;hn<xt;hn+=1)Nt[wt][hn]=null}return Nt}(Ue),Sn(0,0),Sn(Ue-7,0),Sn(0,Ue-7),je(),Bt(),sn(mt,bt),qe>=7&&At(mt),lt==null&&(lt=Mn(qe,ge,ht)),zn(lt,bt)},Sn=function(mt,bt){for(var xt=-1;xt<=7;xt+=1)if(!(mt+xt<=-1||Ue<=mt+xt))for(var Nt=-1;Nt<=7;Nt+=1)bt+Nt<=-1||Ue<=bt+Nt||(0<=xt&&xt<=6&&(Nt==0||Nt==6)||0<=Nt&&Nt<=6&&(xt==0||xt==6)||2<=xt&&xt<=4&&2<=Nt&&Nt<=4?We[mt+xt][bt+Nt]=!0:We[mt+xt][bt+Nt]=!1)},qt=function(){for(var mt=0,bt=0,xt=0;xt<8;xt+=1){In(!0,xt);var Nt=C.getLostPoint(Wt);(xt==0||mt>Nt)&&(mt=Nt,bt=xt)}return bt},Bt=function(){for(var mt=8;mt<Ue-8;mt+=1)We[mt][6]==null&&(We[mt][6]=mt%2==0);for(var bt=8;bt<Ue-8;bt+=1)We[6][bt]==null&&(We[6][bt]=bt%2==0)},je=function(){for(var mt=C.getPatternPosition(qe),bt=0;bt<mt.length;bt+=1)for(var xt=0;xt<mt.length;xt+=1){var Nt=mt[bt],wt=mt[xt];if(We[Nt][wt]==null)for(var hn=-2;hn<=2;hn+=1)for(var An=-2;An<=2;An+=1)hn==-2||hn==2||An==-2||An==2||hn==0&&An==0?We[Nt+hn][wt+An]=!0:We[Nt+hn][wt+An]=!1}},At=function(mt){for(var bt=C.getBCHTypeNumber(qe),xt=0;xt<18;xt+=1){var Nt=!mt&&(bt>>xt&1)==1;We[Math.floor(xt/3)][xt%3+Ue-8-3]=Nt}for(var xt=0;xt<18;xt+=1){var Nt=!mt&&(bt>>xt&1)==1;We[xt%3+Ue-8-3][Math.floor(xt/3)]=Nt}},sn=function(mt,bt){for(var xt=ge<<3|bt,Nt=C.getBCHTypeInfo(xt),wt=0;wt<15;wt+=1){var hn=!mt&&(Nt>>wt&1)==1;wt<6?We[wt][8]=hn:wt<8?We[wt+1][8]=hn:We[Ue-15+wt][8]=hn}for(var wt=0;wt<15;wt+=1){var hn=!mt&&(Nt>>wt&1)==1;wt<8?We[8][Ue-wt-1]=hn:wt<9?We[8][15-wt-1+1]=hn:We[8][15-wt-1]=hn}We[Ue-8][8]=!mt},zn=function(mt,bt){for(var xt=-1,Nt=Ue-1,wt=7,hn=0,An=C.getMaskFunction(bt),Fn=Ue-1;Fn>0;Fn-=2)for(Fn==6&&(Fn-=1);;){for(var Nn=0;Nn<2;Nn+=1)if(We[Nt][Fn-Nn]==null){var xr=!1;hn<mt.length&&(xr=(mt[hn]>>>wt&1)==1);var nr=An(Nt,Fn-Nn);nr&&(xr=!xr),We[Nt][Fn-Nn]=xr,wt-=1,wt==-1&&(hn+=1,wt=7)}if(Nt+=xt,Nt<0||Ue<=Nt){Nt-=xt,xt=-xt;break}}},vn=function(mt,bt){for(var xt=0,Nt=0,wt=0,hn=new Array(bt.length),An=new Array(bt.length),Fn=0;Fn<bt.length;Fn+=1){var Nn=bt[Fn].dataCount,xr=bt[Fn].totalCount-Nn;Nt=Math.max(Nt,Nn),wt=Math.max(wt,xr),hn[Fn]=new Array(Nn);for(var nr=0;nr<hn[Fn].length;nr+=1)hn[Fn][nr]=255&mt.getBuffer()[nr+xt];xt+=Nn;var Zr=C.getErrorCorrectPolynomial(xr),Br=M(hn[Fn],Zr.getLength()-1),ui=Br.mod(Zr);An[Fn]=new Array(Zr.getLength()-1);for(var nr=0;nr<An[Fn].length;nr+=1){var gi=nr+ui.getLength()-An[Fn].length;An[Fn][nr]=gi>=0?ui.getAt(gi):0}}for(var Xi=0,nr=0;nr<bt.length;nr+=1)Xi+=bt[nr].totalCount;for(var Ri=new Array(Xi),dr=0,nr=0;nr<Nt;nr+=1)for(var Fn=0;Fn<bt.length;Fn+=1)nr<hn[Fn].length&&(Ri[dr]=hn[Fn][nr],dr+=1);for(var nr=0;nr<wt;nr+=1)for(var Fn=0;Fn<bt.length;Fn+=1)nr<An[Fn].length&&(Ri[dr]=An[Fn][nr],dr+=1);return Ri},Mn=function(mt,bt,xt){for(var Nt=R.getRSBlocks(mt,bt),wt=j(),hn=0;hn<xt.length;hn+=1){var An=xt[hn];wt.put(An.getMode(),4),wt.put(An.getLength(),C.getLengthInBits(An.getMode(),mt)),An.write(wt)}for(var Fn=0,hn=0;hn<Nt.length;hn+=1)Fn+=Nt[hn].dataCount;if(wt.getLengthInBits()>Fn*8)throw"code length overflow. ("+wt.getLengthInBits()+">"+Fn*8+")";for(wt.getLengthInBits()+4<=Fn*8&&wt.put(0,4);wt.getLengthInBits()%8!=0;)wt.putBit(!1);for(;!(wt.getLengthInBits()>=Fn*8||(wt.put(Ke,8),wt.getLengthInBits()>=Fn*8));)wt.put(et,8);return vn(wt,Nt)};Wt.addData=function(mt,bt){bt=bt||"Byte";var xt=null;switch(bt){case"Numeric":xt=F(mt);break;case"Alphanumeric":xt=Z(mt);break;case"Byte":xt=Y(mt);break;case"Kanji":xt=ne(mt);break;default:throw"mode:"+bt}ht.push(xt),lt=null},Wt.isDark=function(mt,bt){if(mt<0||Ue<=mt||bt<0||Ue<=bt)throw mt+","+bt;return We[mt][bt]},Wt.getModuleCount=function(){return Ue},Wt.make=function(){if(qe<1){for(var mt=1;mt<40;mt++){for(var bt=R.getRSBlocks(mt,ge),xt=j(),Nt=0;Nt<ht.length;Nt++){var wt=ht[Nt];xt.put(wt.getMode(),4),xt.put(wt.getLength(),C.getLengthInBits(wt.getMode(),mt)),wt.write(xt)}for(var hn=0,Nt=0;Nt<bt.length;Nt++)hn+=bt[Nt].dataCount;if(xt.getLengthInBits()<=hn*8)break}qe=mt}In(!1,qt())},Wt.createTableTag=function(mt,bt){mt=mt||2,bt=typeof bt>"u"?mt*4:bt;var xt="";xt+='<table style="',xt+=" border-width: 0px; border-style: none;",xt+=" border-collapse: collapse;",xt+=" padding: 0px; margin: "+bt+"px;",xt+='">',xt+="<tbody>";for(var Nt=0;Nt<Wt.getModuleCount();Nt+=1){xt+="<tr>";for(var wt=0;wt<Wt.getModuleCount();wt+=1)xt+='<td style="',xt+=" border-width: 0px; border-style: none;",xt+=" border-collapse: collapse;",xt+=" padding: 0px; margin: 0px;",xt+=" width: "+mt+"px;",xt+=" height: "+mt+"px;",xt+=" background-color: ",xt+=Wt.isDark(Nt,wt)?"#000000":"#ffffff",xt+=";",xt+='"/>';xt+="</tr>"}return xt+="</tbody>",xt+="</table>",xt},Wt.createSvgTag=function(mt,bt,xt,Nt){var wt={};typeof arguments[0]=="object"&&(wt=arguments[0],mt=wt.cellSize,bt=wt.margin,xt=wt.alt,Nt=wt.title),mt=mt||2,bt=typeof bt>"u"?mt*4:bt,xt=typeof xt=="string"?{text:xt}:xt||{},xt.text=xt.text||null,xt.id=xt.text?xt.id||"qrcode-description":null,Nt=typeof Nt=="string"?{text:Nt}:Nt||{},Nt.text=Nt.text||null,Nt.id=Nt.text?Nt.id||"qrcode-title":null;var hn=Wt.getModuleCount()*mt+bt*2,An,Fn,Nn,xr,nr="",Zr;for(Zr="l"+mt+",0 0,"+mt+" -"+mt+",0 0,-"+mt+"z ",nr+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',nr+=wt.scalable?"":' width="'+hn+'px" height="'+hn+'px"',nr+=' viewBox="0 0 '+hn+" "+hn+'" ',nr+=' preserveAspectRatio="xMinYMin meet"',nr+=Nt.text||xt.text?' role="img" aria-labelledby="'+Yn([Nt.id,xt.id].join(" ").trim())+'"':"",nr+=">",nr+=Nt.text?'<title id="'+Yn(Nt.id)+'">'+Yn(Nt.text)+"</title>":"",nr+=xt.text?'<description id="'+Yn(xt.id)+'">'+Yn(xt.text)+"</description>":"",nr+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',nr+='<path d="',Nn=0;Nn<Wt.getModuleCount();Nn+=1)for(xr=Nn*mt+bt,An=0;An<Wt.getModuleCount();An+=1)Wt.isDark(Nn,An)&&(Fn=An*mt+bt,nr+="M"+Fn+","+xr+Zr);return nr+='" stroke="transparent" fill="black"/>',nr+="</svg>",nr},Wt.createDataURL=function(mt,bt){mt=mt||2,bt=typeof bt>"u"?mt*4:bt;var xt=Wt.getModuleCount()*mt+bt*2,Nt=bt,wt=xt-bt;return Ie(xt,xt,function(hn,An){if(Nt<=hn&&hn<wt&&Nt<=An&&An<wt){var Fn=Math.floor((hn-Nt)/mt),Nn=Math.floor((An-Nt)/mt);return Wt.isDark(Nn,Fn)?0:1}else return 1})},Wt.createImgTag=function(mt,bt,xt){mt=mt||2,bt=typeof bt>"u"?mt*4:bt;var Nt=Wt.getModuleCount()*mt+bt*2,wt="";return wt+="<img",wt+=' src="',wt+=Wt.createDataURL(mt,bt),wt+='"',wt+=' width="',wt+=Nt,wt+='"',wt+=' height="',wt+=Nt,wt+='"',xt&&(wt+=' alt="',wt+=Yn(xt),wt+='"'),wt+="/>",wt};var Yn=function(mt){for(var bt="",xt=0;xt<mt.length;xt+=1){var Nt=mt.charAt(xt);switch(Nt){case"<":bt+="&lt;";break;case">":bt+="&gt;";break;case"&":bt+="&amp;";break;case'"':bt+="&quot;";break;default:bt+=Nt;break}}return bt},ir=function(mt){var bt=1;mt=typeof mt>"u"?bt*2:mt;var xt=Wt.getModuleCount()*bt+mt*2,Nt=mt,wt=xt-mt,hn,An,Fn,Nn,xr,nr={"██":"█","█ ":"▀"," █":"▄","  ":" "},Zr={"██":"▀","█ ":"▀"," █":" ","  ":" "},Br="";for(hn=0;hn<xt;hn+=2){for(Fn=Math.floor((hn-Nt)/bt),Nn=Math.floor((hn+1-Nt)/bt),An=0;An<xt;An+=1)xr="█",Nt<=An&&An<wt&&Nt<=hn&&hn<wt&&Wt.isDark(Fn,Math.floor((An-Nt)/bt))&&(xr=" "),Nt<=An&&An<wt&&Nt<=hn+1&&hn+1<wt&&Wt.isDark(Nn,Math.floor((An-Nt)/bt))?xr+=" ":xr+="█",Br+=mt<1&&hn+1>=wt?Zr[xr]:nr[xr];Br+=`
`}return xt%2&&mt>0?Br.substring(0,Br.length-xt-1)+Array(xt+1).join("▀"):Br.substring(0,Br.length-1)};return Wt.createASCII=function(mt,bt){if(mt=mt||1,mt<2)return ir(bt);mt-=1,bt=typeof bt>"u"?mt*2:bt;var xt=Wt.getModuleCount()*mt+bt*2,Nt=bt,wt=xt-bt,hn,An,Fn,Nn,xr=Array(mt+1).join("██"),nr=Array(mt+1).join("  "),Zr="",Br="";for(hn=0;hn<xt;hn+=1){for(Fn=Math.floor((hn-Nt)/mt),Br="",An=0;An<xt;An+=1)Nn=1,Nt<=An&&An<wt&&Nt<=hn&&hn<wt&&Wt.isDark(Fn,Math.floor((An-Nt)/mt))&&(Nn=0),Br+=Nn?xr:nr;for(Fn=0;Fn<mt;Fn+=1)Zr+=Br+`
`}return Zr.substring(0,Zr.length-1)},Wt.renderTo2dContext=function(mt,bt){bt=bt||2;for(var xt=Wt.getModuleCount(),Nt=0;Nt<xt;Nt++)for(var wt=0;wt<xt;wt++)mt.fillStyle=Wt.isDark(Nt,wt)?"black":"white",mt.fillRect(Nt*bt,wt*bt,bt,bt)},Wt};l.stringToBytesFuncs={default:function(Me){for(var Ve=[],Ke=0;Ke<Me.length;Ke+=1){var et=Me.charCodeAt(Ke);Ve.push(et&255)}return Ve}},l.stringToBytes=l.stringToBytesFuncs.default,l.createStringToBytes=function(Me,Ve){var Ke=function(){for(var qe=Se(Me),ge=function(){var Bt=qe.read();if(Bt==-1)throw"eof";return Bt},We=0,Ue={};;){var lt=qe.read();if(lt==-1)break;var ht=ge(),Wt=ge(),In=ge(),Sn=String.fromCharCode(lt<<8|ht),qt=Wt<<8|In;Ue[Sn]=qt,We+=1}if(We!=Ve)throw We+" != "+Ve;return Ue}(),et=63;return function(qe){for(var ge=[],We=0;We<qe.length;We+=1){var Ue=qe.charCodeAt(We);if(Ue<128)ge.push(Ue);else{var lt=Ke[qe.charAt(We)];typeof lt=="number"?(lt&255)==lt?ge.push(lt):(ge.push(lt>>>8),ge.push(lt&255)):ge.push(et)}}return ge}};var d={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},m={L:1,M:0,Q:3,H:2},x={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},C=function(){var Me=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],Ve=1335,Ke=7973,et=21522,qe={},ge=function(We){for(var Ue=0;We!=0;)Ue+=1,We>>>=1;return Ue};return qe.getBCHTypeInfo=function(We){for(var Ue=We<<10;ge(Ue)-ge(Ve)>=0;)Ue^=Ve<<ge(Ue)-ge(Ve);return(We<<10|Ue)^et},qe.getBCHTypeNumber=function(We){for(var Ue=We<<12;ge(Ue)-ge(Ke)>=0;)Ue^=Ke<<ge(Ue)-ge(Ke);return We<<12|Ue},qe.getPatternPosition=function(We){return Me[We-1]},qe.getMaskFunction=function(We){switch(We){case x.PATTERN000:return function(Ue,lt){return(Ue+lt)%2==0};case x.PATTERN001:return function(Ue,lt){return Ue%2==0};case x.PATTERN010:return function(Ue,lt){return lt%3==0};case x.PATTERN011:return function(Ue,lt){return(Ue+lt)%3==0};case x.PATTERN100:return function(Ue,lt){return(Math.floor(Ue/2)+Math.floor(lt/3))%2==0};case x.PATTERN101:return function(Ue,lt){return Ue*lt%2+Ue*lt%3==0};case x.PATTERN110:return function(Ue,lt){return(Ue*lt%2+Ue*lt%3)%2==0};case x.PATTERN111:return function(Ue,lt){return(Ue*lt%3+(Ue+lt)%2)%2==0};default:throw"bad maskPattern:"+We}},qe.getErrorCorrectPolynomial=function(We){for(var Ue=M([1],0),lt=0;lt<We;lt+=1)Ue=Ue.multiply(M([1,a.gexp(lt)],0));return Ue},qe.getLengthInBits=function(We,Ue){if(1<=Ue&&Ue<10)switch(We){case d.MODE_NUMBER:return 10;case d.MODE_ALPHA_NUM:return 9;case d.MODE_8BIT_BYTE:return 8;case d.MODE_KANJI:return 8;default:throw"mode:"+We}else if(Ue<27)switch(We){case d.MODE_NUMBER:return 12;case d.MODE_ALPHA_NUM:return 11;case d.MODE_8BIT_BYTE:return 16;case d.MODE_KANJI:return 10;default:throw"mode:"+We}else if(Ue<41)switch(We){case d.MODE_NUMBER:return 14;case d.MODE_ALPHA_NUM:return 13;case d.MODE_8BIT_BYTE:return 16;case d.MODE_KANJI:return 12;default:throw"mode:"+We}else throw"type:"+Ue},qe.getLostPoint=function(We){for(var Ue=We.getModuleCount(),lt=0,ht=0;ht<Ue;ht+=1)for(var Wt=0;Wt<Ue;Wt+=1){for(var In=0,Sn=We.isDark(ht,Wt),qt=-1;qt<=1;qt+=1)if(!(ht+qt<0||Ue<=ht+qt))for(var Bt=-1;Bt<=1;Bt+=1)Wt+Bt<0||Ue<=Wt+Bt||qt==0&&Bt==0||Sn==We.isDark(ht+qt,Wt+Bt)&&(In+=1);In>5&&(lt+=3+In-5)}for(var ht=0;ht<Ue-1;ht+=1)for(var Wt=0;Wt<Ue-1;Wt+=1){var je=0;We.isDark(ht,Wt)&&(je+=1),We.isDark(ht+1,Wt)&&(je+=1),We.isDark(ht,Wt+1)&&(je+=1),We.isDark(ht+1,Wt+1)&&(je+=1),(je==0||je==4)&&(lt+=3)}for(var ht=0;ht<Ue;ht+=1)for(var Wt=0;Wt<Ue-6;Wt+=1)We.isDark(ht,Wt)&&!We.isDark(ht,Wt+1)&&We.isDark(ht,Wt+2)&&We.isDark(ht,Wt+3)&&We.isDark(ht,Wt+4)&&!We.isDark(ht,Wt+5)&&We.isDark(ht,Wt+6)&&(lt+=40);for(var Wt=0;Wt<Ue;Wt+=1)for(var ht=0;ht<Ue-6;ht+=1)We.isDark(ht,Wt)&&!We.isDark(ht+1,Wt)&&We.isDark(ht+2,Wt)&&We.isDark(ht+3,Wt)&&We.isDark(ht+4,Wt)&&!We.isDark(ht+5,Wt)&&We.isDark(ht+6,Wt)&&(lt+=40);for(var At=0,Wt=0;Wt<Ue;Wt+=1)for(var ht=0;ht<Ue;ht+=1)We.isDark(ht,Wt)&&(At+=1);var sn=Math.abs(100*At/Ue/Ue-50)/5;return lt+=sn*10,lt},qe}(),a=function(){for(var Me=new Array(256),Ve=new Array(256),Ke=0;Ke<8;Ke+=1)Me[Ke]=1<<Ke;for(var Ke=8;Ke<256;Ke+=1)Me[Ke]=Me[Ke-4]^Me[Ke-5]^Me[Ke-6]^Me[Ke-8];for(var Ke=0;Ke<255;Ke+=1)Ve[Me[Ke]]=Ke;var et={};return et.glog=function(qe){if(qe<1)throw"glog("+qe+")";return Ve[qe]},et.gexp=function(qe){for(;qe<0;)qe+=255;for(;qe>=256;)qe-=255;return Me[qe]},et}();function M(Me,Ve){if(typeof Me.length>"u")throw Me.length+"/"+Ve;var Ke=function(){for(var qe=0;qe<Me.length&&Me[qe]==0;)qe+=1;for(var ge=new Array(Me.length-qe+Ve),We=0;We<Me.length-qe;We+=1)ge[We]=Me[We+qe];return ge}(),et={};return et.getAt=function(qe){return Ke[qe]},et.getLength=function(){return Ke.length},et.multiply=function(qe){for(var ge=new Array(et.getLength()+qe.getLength()-1),We=0;We<et.getLength();We+=1)for(var Ue=0;Ue<qe.getLength();Ue+=1)ge[We+Ue]^=a.gexp(a.glog(et.getAt(We))+a.glog(qe.getAt(Ue)));return M(ge,0)},et.mod=function(qe){if(et.getLength()-qe.getLength()<0)return et;for(var ge=a.glog(et.getAt(0))-a.glog(qe.getAt(0)),We=new Array(et.getLength()),Ue=0;Ue<et.getLength();Ue+=1)We[Ue]=et.getAt(Ue);for(var Ue=0;Ue<qe.getLength();Ue+=1)We[Ue]^=a.gexp(a.glog(qe.getAt(Ue))+ge);return M(We,0).mod(qe)},et}var R=function(){var Me=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],Ve=function(qe,ge){var We={};return We.totalCount=qe,We.dataCount=ge,We},Ke={},et=function(qe,ge){switch(ge){case m.L:return Me[(qe-1)*4+0];case m.M:return Me[(qe-1)*4+1];case m.Q:return Me[(qe-1)*4+2];case m.H:return Me[(qe-1)*4+3];default:return}};return Ke.getRSBlocks=function(qe,ge){var We=et(qe,ge);if(typeof We>"u")throw"bad rs block @ typeNumber:"+qe+"/errorCorrectionLevel:"+ge;for(var Ue=We.length/3,lt=[],ht=0;ht<Ue;ht+=1)for(var Wt=We[ht*3+0],In=We[ht*3+1],Sn=We[ht*3+2],qt=0;qt<Wt;qt+=1)lt.push(Ve(In,Sn));return lt},Ke}(),j=function(){var Me=[],Ve=0,Ke={};return Ke.getBuffer=function(){return Me},Ke.getAt=function(et){var qe=Math.floor(et/8);return(Me[qe]>>>7-et%8&1)==1},Ke.put=function(et,qe){for(var ge=0;ge<qe;ge+=1)Ke.putBit((et>>>qe-ge-1&1)==1)},Ke.getLengthInBits=function(){return Ve},Ke.putBit=function(et){var qe=Math.floor(Ve/8);Me.length<=qe&&Me.push(0),et&&(Me[qe]|=128>>>Ve%8),Ve+=1},Ke},F=function(Me){var Ve=d.MODE_NUMBER,Ke=Me,et={};et.getMode=function(){return Ve},et.getLength=function(We){return Ke.length},et.write=function(We){for(var Ue=Ke,lt=0;lt+2<Ue.length;)We.put(qe(Ue.substring(lt,lt+3)),10),lt+=3;lt<Ue.length&&(Ue.length-lt==1?We.put(qe(Ue.substring(lt,lt+1)),4):Ue.length-lt==2&&We.put(qe(Ue.substring(lt,lt+2)),7))};var qe=function(We){for(var Ue=0,lt=0;lt<We.length;lt+=1)Ue=Ue*10+ge(We.charAt(lt));return Ue},ge=function(We){if("0"<=We&&We<="9")return We.charCodeAt(0)-48;throw"illegal char :"+We};return et},Z=function(Me){var Ve=d.MODE_ALPHA_NUM,Ke=Me,et={};et.getMode=function(){return Ve},et.getLength=function(ge){return Ke.length},et.write=function(ge){for(var We=Ke,Ue=0;Ue+1<We.length;)ge.put(qe(We.charAt(Ue))*45+qe(We.charAt(Ue+1)),11),Ue+=2;Ue<We.length&&ge.put(qe(We.charAt(Ue)),6)};var qe=function(ge){if("0"<=ge&&ge<="9")return ge.charCodeAt(0)-48;if("A"<=ge&&ge<="Z")return ge.charCodeAt(0)-65+10;switch(ge){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+ge}};return et},Y=function(Me){var Ve=d.MODE_8BIT_BYTE,Ke=l.stringToBytes(Me),et={};return et.getMode=function(){return Ve},et.getLength=function(qe){return Ke.length},et.write=function(qe){for(var ge=0;ge<Ke.length;ge+=1)qe.put(Ke[ge],8)},et},ne=function(Me){var Ve=d.MODE_KANJI,Ke=l.stringToBytesFuncs.SJIS;if(!Ke)throw"sjis not supported.";(function(ge,We){var Ue=Ke(ge);if(Ue.length!=2||(Ue[0]<<8|Ue[1])!=We)throw"sjis not supported."})("友",38726);var et=Ke(Me),qe={};return qe.getMode=function(){return Ve},qe.getLength=function(ge){return~~(et.length/2)},qe.write=function(ge){for(var We=et,Ue=0;Ue+1<We.length;){var lt=(255&We[Ue])<<8|255&We[Ue+1];if(33088<=lt&&lt<=40956)lt-=33088;else if(57408<=lt&&lt<=60351)lt-=49472;else throw"illegal char at "+(Ue+1)+"/"+lt;lt=(lt>>>8&255)*192+(lt&255),ge.put(lt,13),Ue+=2}if(Ue<We.length)throw"illegal char at "+(Ue+1)},qe},se=function(){var Me=[],Ve={};return Ve.writeByte=function(Ke){Me.push(Ke&255)},Ve.writeShort=function(Ke){Ve.writeByte(Ke),Ve.writeByte(Ke>>>8)},Ve.writeBytes=function(Ke,et,qe){et=et||0,qe=qe||Ke.length;for(var ge=0;ge<qe;ge+=1)Ve.writeByte(Ke[ge+et])},Ve.writeString=function(Ke){for(var et=0;et<Ke.length;et+=1)Ve.writeByte(Ke.charCodeAt(et))},Ve.toByteArray=function(){return Me},Ve.toString=function(){var Ke="";Ke+="[";for(var et=0;et<Me.length;et+=1)et>0&&(Ke+=","),Ke+=Me[et];return Ke+="]",Ke},Ve},xe=function(){var Me=0,Ve=0,Ke=0,et="",qe={},ge=function(Ue){et+=String.fromCharCode(We(Ue&63))},We=function(Ue){if(!(Ue<0)){if(Ue<26)return 65+Ue;if(Ue<52)return 97+(Ue-26);if(Ue<62)return 48+(Ue-52);if(Ue==62)return 43;if(Ue==63)return 47}throw"n:"+Ue};return qe.writeByte=function(Ue){for(Me=Me<<8|Ue&255,Ve+=8,Ke+=1;Ve>=6;)ge(Me>>>Ve-6),Ve-=6},qe.flush=function(){if(Ve>0&&(ge(Me<<6-Ve),Me=0,Ve=0),Ke%3!=0)for(var Ue=3-Ke%3,lt=0;lt<Ue;lt+=1)et+="="},qe.toString=function(){return et},qe},Se=function(Me){var Ve=Me,Ke=0,et=0,qe=0,ge={};ge.read=function(){for(;qe<8;){if(Ke>=Ve.length){if(qe==0)return-1;throw"unexpected end of file./"+qe}var Ue=Ve.charAt(Ke);if(Ke+=1,Ue=="=")return qe=0,-1;if(Ue.match(/^\s$/))continue;et=et<<6|We(Ue.charCodeAt(0)),qe+=6}var lt=et>>>qe-8&255;return qe-=8,lt};var We=function(Ue){if(65<=Ue&&Ue<=90)return Ue-65;if(97<=Ue&&Ue<=122)return Ue-97+26;if(48<=Ue&&Ue<=57)return Ue-48+52;if(Ue==43)return 62;if(Ue==47)return 63;throw"c:"+Ue};return ge},_e=function(Me,Ve){var Ke=Me,et=Ve,qe=new Array(Me*Ve),ge={};ge.setPixel=function(ht,Wt,In){qe[Wt*Ke+ht]=In},ge.write=function(ht){ht.writeString("GIF87a"),ht.writeShort(Ke),ht.writeShort(et),ht.writeByte(128),ht.writeByte(0),ht.writeByte(0),ht.writeByte(0),ht.writeByte(0),ht.writeByte(0),ht.writeByte(255),ht.writeByte(255),ht.writeByte(255),ht.writeString(","),ht.writeShort(0),ht.writeShort(0),ht.writeShort(Ke),ht.writeShort(et),ht.writeByte(0);var Wt=2,In=Ue(Wt);ht.writeByte(Wt);for(var Sn=0;In.length-Sn>255;)ht.writeByte(255),ht.writeBytes(In,Sn,255),Sn+=255;ht.writeByte(In.length-Sn),ht.writeBytes(In,Sn,In.length-Sn),ht.writeByte(0),ht.writeString(";")};var We=function(ht){var Wt=ht,In=0,Sn=0,qt={};return qt.write=function(Bt,je){if(Bt>>>je)throw"length over";for(;In+je>=8;)Wt.writeByte(255&(Bt<<In|Sn)),je-=8-In,Bt>>>=8-In,Sn=0,In=0;Sn=Bt<<In|Sn,In=In+je},qt.flush=function(){In>0&&Wt.writeByte(Sn)},qt},Ue=function(ht){for(var Wt=1<<ht,In=(1<<ht)+1,Sn=ht+1,qt=lt(),Bt=0;Bt<Wt;Bt+=1)qt.add(String.fromCharCode(Bt));qt.add(String.fromCharCode(Wt)),qt.add(String.fromCharCode(In));var je=se(),At=We(je);At.write(Wt,Sn);var sn=0,zn=String.fromCharCode(qe[sn]);for(sn+=1;sn<qe.length;){var vn=String.fromCharCode(qe[sn]);sn+=1,qt.contains(zn+vn)?zn=zn+vn:(At.write(qt.indexOf(zn),Sn),qt.size()<4095&&(qt.size()==1<<Sn&&(Sn+=1),qt.add(zn+vn)),zn=vn)}return At.write(qt.indexOf(zn),Sn),At.write(In,Sn),At.flush(),je.toByteArray()},lt=function(){var ht={},Wt=0,In={};return In.add=function(Sn){if(In.contains(Sn))throw"dup key:"+Sn;ht[Sn]=Wt,Wt+=1},In.size=function(){return Wt},In.indexOf=function(Sn){return ht[Sn]},In.contains=function(Sn){return typeof ht[Sn]<"u"},In};return ge},Ie=function(Me,Ve,Ke){for(var et=_e(Me,Ve),qe=0;qe<Ve;qe+=1)for(var ge=0;ge<Me;ge+=1)et.setPixel(ge,qe,Ke(ge,qe));var We=se();et.write(We);for(var Ue=xe(),lt=We.toByteArray(),ht=0;ht<lt.length;ht+=1)Ue.writeByte(lt[ht]);return Ue.flush(),"data:image/gif;base64,"+Ue};return l}();(function(){r.stringToBytesFuncs["UTF-8"]=function(l){function d(m){for(var x=[],C=0;C<m.length;C++){var a=m.charCodeAt(C);a<128?x.push(a):a<2048?x.push(192|a>>6,128|a&63):a<55296||a>=57344?x.push(224|a>>12,128|a>>6&63,128|a&63):(C++,a=65536+((a&1023)<<10|m.charCodeAt(C)&1023),x.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|a&63))}return x}return d(l)}})(),function(l){n.exports=l()}(function(){return r})})(aS);const c9=aS.exports;function Nw(n){return bi(this,null,function*(){try{if(!navigator?.clipboard)throw new Bo("Clipboard API not available");return yield navigator.clipboard.writeText(n)}catch{}u9(n)})}function u9(n){const t=document.createElement("textarea");t.value=n,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")}finally{document.body.removeChild(t)}}const h9=ei("<div></div>"),wy=n=>{let t,r,l;const[d,m]=Ir(!1),[x,C]=Ir(Z5);gs(()=>{const F=c9(0,"L");F.addData(n.sourceUrl),F.make(),t.innerHTML=F.createSvgTag(4,0);const Z=t.firstElementChild.clientWidth,Y=Math.round(sS/Z*1e5)/1e5;if(l){const ne=Math.ceil(Mx/(Y*4))*4,se=tu(Math.ceil((Z-ne)/(2*4))*4);l.style.top=se,l.style.left=se,l.style.height=tu(ne),l.style.width=tu(ne),C(Math.round(Z5/Y))}r.style.transform=`scale(${Y})`});let a=null;return he(i9,{get class(){return n.class},onClick:()=>{m(!0),Nw(n.sourceUrl),a!=null&&clearTimeout(a),a=setTimeout(()=>m(!1),1500)},get children(){return[he(o9,{ref(R){const j=r;typeof j=="function"?j(R):r=R},get children(){return[(()=>{const R=h9.cloneNode(!0),j=t;return typeof j=="function"?h0(j,R):t=R,R})(),he(jr,{get when(){return n.imageUrl},get children(){return he(s9,{ref(R){const j=l;typeof j=="function"?j(R):l=R},get children(){return he(a9,{get src(){return n.imageUrl},alt:"",get size(){return x()}})}})}})]}}),he(jw,{onBeforeEnter:R=>{Jc(R,[{opacity:0,transform:"translate(-50%, 44px)"},{opacity:1,transform:"translate(-50%, 0)"}],{duration:150,easing:"ease-out"})},onExit:(R,j)=>{Jc(R,[{opacity:1,transform:"translate(-50%, 0)"},{opacity:0,transform:"translate(-50%, 44px)"}],{duration:150,easing:"ease-out"}).finished.then(()=>{j()})},get children(){return he(jr,{get when(){return d()&&!n.disableCopy},get children(){return he(l9,{get children(){return[he(Uw,{size:"xs"}),he(Xa,{translationKey:"common.linkCopied",children:"Link Copied"})]}})}})}}),he(jr,{get when(){return!n.disableCopy},get children(){return he(w_,{get children(){return he(uS,{})}})}})]}})};var Ax=(n,t,r)=>{const l=t.trim().split(".").reduce((d,m)=>d?d[m]:void 0,n);return l!==void 0?l:r},d9=(n,t,r=/{{(.*?)}}/g)=>n.replace(r,(l,d)=>Ax(t,d,"")),f9=(n={},t=navigator.language in n?navigator.language:Object.keys(n)[0])=>{const[r,l]=Ir(t),[d,m]=Dw(n);return[(a,M,R)=>{const j=Ax(d[r()],a,R||"");return typeof j=="function"?j(M):typeof j=="string"?d9(j,M||{}):j},{add(a,M){m(a,R=>Object.assign(R||{},M))},locale:a=>a?l(a):r(),dict:a=>Ax(d,a)}]},lS=_y({}),fu=()=>ca(lS);const p9=jt.div`
    font-style: normal;
    font-weight: ${n=>n.fontWeight};
    font-size: ${n=>n.fontSize};
    line-height: ${n=>n.lineHeight};

    color: ${n=>n.color};
`,Xa=n=>{const t=Vi(),[r]=fu();let l;const d=()=>n.color||t.colors.text.primary,m=eu({fontSize:"14px",fontWeight:"510",lineHeight:"130%"},n);return gs(()=>{l&&m.cursor!=="unset"&&getComputedStyle(l).cursor!=="pointer"&&(l.style.cursor="default")}),he(p9,{get fontSize(){return m.fontSize},get fontWeight(){return m.fontWeight},get lineHeight(){return m.lineHeight},get color(){return d()},get class(){return m.class},ref(x){const C=l;typeof C=="function"?C(x):l=x},"data-tc-text":"true",get children(){var x;return qn(()=>!!m.translationKey)()?r(m.translationKey,m.translationValues,(x=m.children)==null?void 0:x.toString()):m.children}})},m9=jt.div`
    position: relative;

    &::after {
        content: '';
        display: block;
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        border: 0.5px solid rgba(0, 0, 0, 0.08);

        border-radius: inherit;
    }
`,g9=jt(op)`
    width: 100%;
    height: 100%;
    border-radius: inherit;
`,cS=n=>he(m9,{get class(){return n.class},get children(){return he(g9,{get src(){return n.src}})}}),_9={m:"16px",s:"12px",none:"0"},y9={m:"6px",s:"6px",none:"0"},v9=jt.button`
    position: relative;
    cursor: pointer;
    border: none;
    background-color: unset;
    padding: 8px 4px;
    width: 92px;
    display: flex;
    flex-direction: column;
    align-items: center;

    transition: transform 0.125s ease-in-out;

    ${K0} {
        &:hover {
            transform: scale(1.04);
        }
    }

    &:active {
        transform: scale(0.96);
    }

    ${Ya("mobile")} {
        padding: 8px 4px;
        width: 82px;
    }

    ${H0} {
        &:active {
            transform: scale(0.92);
        }
    }
`,x9=jt(cS)`
    width: 60px;
    height: 60px;
    border-radius: ${n=>_9[n.theme.borderRadius]};

    margin-bottom: 8px;
`,w9=jt(op)`
    position: absolute;
    right: 10px;
    top: 50px;
    width: 24px;
    height: 24px;
    border-radius: ${n=>y9[n.theme.borderRadius]};
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.08);
`,b9=jt(Xa)`
    max-width: 90px;
    font-weight: 590;
    white-space: nowrap;
    text-overflow: ellipsis;
    overflow: hidden;

    ${Ya("mobile")} {
        max-width: 80px;
    }
`,E9=jt(Xa)`
    font-weight: 510;
    max-width: 90px;
    white-space: nowrap;
    text-overflow: ellipsis;
    overflow: hidden;
    color: ${n=>n.colorPrimary?n.theme.colors.text.primary:n.theme.colors.text.secondary};

    ${Ya("mobile")} {
        max-width: 80px;
    }
`,Z_=n=>he(v9,{get class(){return n.class},onClick:()=>n.onClick(),"data-tc-wallet-item":"true",get children(){return[qn(()=>qn(()=>typeof n.icon=="string")()?he(x9,{get src(){return n.icon}}):n.icon),qn(()=>qn(()=>!!n.badgeUrl)()&&he(w9,{get src(){return n.badgeUrl}})),he(b9,{get children(){return n.name}}),qn(()=>qn(()=>!!n.secondLine)()&&he(E9,{get colorPrimary(){var t;return(t=n.secondLineColorPrimary)!=null?t:!0},get children(){return n.secondLine}}))]}}),T9=jt.h1`
    font-style: normal;
    font-weight: 700;
    font-size: 20px;
    line-height: 28px;

    text-align: center;

    color: ${n=>n.theme.colors.text.primary};

    margin-top: 0;
    margin-bottom: 0;

    cursor: default;
`,pu=n=>{const[t]=fu();return he(T9,{get class(){return n.class},"data-tc-h1":"true",get children(){var r;return qn(()=>!!n.translationKey)()?t(n.translationKey,n.translationValues,(r=n.children)==null?void 0:r.toString()):n.children}})},C9=jt.h2`
    font-style: normal;
    font-weight: 510;
    font-size: 16px;
    line-height: 22px;

    text-align: center;

    color: ${n=>n.theme.colors.text.secondary};

    margin-top: 0;
    margin-bottom: 32px;

    cursor: default;
`,Id=n=>{const[t]=fu();return he(C9,{get class(){return n.class},"data-tc-h2":"true",get children(){var r;return qn(()=>!!n.translationKey)()?t(n.translationKey,n.translationValues,(r=n.children)==null?void 0:r.toString()):n.children}})},S9=jt.h3`
    font-style: normal;
    font-weight: 590;
    font-size: 16px;
    line-height: 20px;

    color: ${n=>n.theme.colors.text.primary};

    margin-top: 0;
    margin-bottom: 0;

    cursor: default;
`,Fw=n=>{const[t]=fu();return he(S9,{"data-tc-h3":"true",get class(){return n.class},get children(){var r;return qn(()=>!!n.translationKey)()?t(n.translationKey,n.translationValues,(r=n.children)==null?void 0:r.toString()):n.children}})},k9=ei('<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.75 7.5C9.33579 7.5 9 7.16421 9 6.75C9 6.33579 9.33579 6 9.75 6H21.25C21.6642 6 22 6.33579 22 6.75V18.25C22 18.6642 21.6642 19 21.25 19C20.8358 19 20.5 18.6642 20.5 18.25V8.56066L6.28033 22.7803C5.98744 23.0732 5.51256 23.0732 5.21967 22.7803C4.92678 22.4874 4.92678 22.0126 5.21967 21.7197L19.4393 7.5H9.75Z"></path></svg>'),M9=n=>{const t=Vi(),r=()=>n.fill||t.colors.icon.secondary;return(()=>{const l=k9.cloneNode(!0),d=l.firstChild;return Yr(m=>{const x=r(),C=r();return x!==m._v$&&vr(l,"fill",m._v$=x),C!==m._v$2&&vr(d,"fill",m._v$2=C),m},{_v$:void 0,_v$2:void 0}),l})()},A9=ei('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M14.1839 17.7069C13.6405 18.6507 13.3688 19.1226 13.0591 19.348C12.4278 19.8074 11.5723 19.8074 10.941 19.348C10.6312 19.1226 10.3595 18.6507 9.81613 17.7069L5.52066 10.2464C4.76864 8.94024 4.39263 8.28717 4.33762 7.75894C4.2255 6.68236 4.81894 5.65591 5.80788 5.21589C6.29309 5 7.04667 5 8.55383 5H15.4462C16.9534 5 17.7069 5 18.1922 5.21589C19.1811 5.65591 19.7745 6.68236 19.6624 7.75894C19.6074 8.28717 19.2314 8.94024 18.4794 10.2464L14.1839 17.7069ZM11.1 16.3412L6.56139 8.48002C6.31995 8.06185 6.19924 7.85276 6.18146 7.68365C6.14523 7.33896 6.33507 7.01015 6.65169 6.86919C6.80703 6.80002 7.04847 6.80002 7.53133 6.80002H7.53134L11.1 6.80002V16.3412ZM12.9 16.3412L17.4387 8.48002C17.6801 8.06185 17.8008 7.85276 17.8186 7.68365C17.8548 7.33896 17.665 7.01015 17.3484 6.86919C17.193 6.80002 16.9516 6.80002 16.4687 6.80002L12.9 6.80002V16.3412Z"></path></svg>'),P9=n=>{const t=Vi(),r=()=>n.fill||t.colors.icon.primary;return(()=>{const l=A9.cloneNode(!0),d=l.firstChild;return Yr(()=>vr(d,"fill",r())),l})()},I9=ei('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none"><g clip-path="url(#clip0_3783_2045)"><circle cx="8" cy="8.00098" r="8"></circle><path d="M4.75 8.50098L7 10.751L11.75 6.00098" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></g><defs><clipPath id="clip0_3783_2045"><rect width="16" height="16" fill="white" transform="translate(0 0.000976562)"></rect></clipPath></defs></svg>'),L9=ei('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="11"></circle><path d="M17.1364 9.6364C17.4879 9.28493 17.4879 8.71508 17.1364 8.36361C16.7849 8.01214 16.2151 8.01214 15.8636 8.36361L10 14.2272L8.1364 12.3636C7.78493 12.0121 7.21508 12.0121 6.86361 12.3636C6.51214 12.7151 6.51214 13.2849 6.86361 13.6364L9.36361 16.1364C9.71508 16.4879 10.2849 16.4879 10.6364 16.1364L17.1364 9.6364Z"></path></svg>'),R9=ei('<svg width="72" height="72" viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="36" cy="36" r="33"></circle><path d="M50.9142 28.4142C51.6953 27.6332 51.6953 26.3668 50.9142 25.5858C50.1332 24.8047 48.8668 24.8047 48.0858 25.5858L30 43.6716L23.9142 37.5858C23.1332 36.8047 21.8668 36.8047 21.0858 37.5858C20.3047 38.3668 20.3047 39.6332 21.0858 40.4142L28.5858 47.9142C29.3668 48.6953 30.6332 48.6953 31.4142 47.9142L50.9142 28.4142Z"></path></svg>'),Uw=n=>{const t=Vi(),r=()=>n.size||"s",l=()=>n.fill||t.colors.icon.success;return qn((()=>{const d=qn(()=>r()==="xs");return()=>d()?(()=>{const m=I9.cloneNode(!0),x=m.firstChild,C=x.firstChild,a=C.nextSibling;return Yr(M=>{const R=n.class,j=l(),F=t.colors.constant.white;return R!==M._v$&&vr(m,"class",M._v$=R),j!==M._v$2&&vr(C,"fill",M._v$2=j),F!==M._v$3&&vr(a,"stroke",M._v$3=F),M},{_v$:void 0,_v$2:void 0,_v$3:void 0}),m})():(()=>{const m=qn(()=>r()==="s");return()=>m()?(()=>{const x=L9.cloneNode(!0),C=x.firstChild,a=C.nextSibling;return Yr(M=>{const R=n.class,j=l(),F=t.colors.constant.white;return R!==M._v$4&&vr(x,"class",M._v$4=R),j!==M._v$5&&vr(C,"fill",M._v$5=j),F!==M._v$6&&vr(a,"fill",M._v$6=F),M},{_v$4:void 0,_v$5:void 0,_v$6:void 0}),x})():(()=>{const x=R9.cloneNode(!0),C=x.firstChild,a=C.nextSibling;return Yr(M=>{const R=n.class,j=l(),F=t.colors.constant.white;return R!==M._v$7&&vr(x,"class",M._v$7=R),j!==M._v$8&&vr(C,"fill",M._v$8=j),F!==M._v$9&&vr(a,"fill",M._v$9=F),M},{_v$7:void 0,_v$8:void 0,_v$9:void 0}),x})()})()})())},O9=ei('<svg width="72" height="72" viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="36" cy="36" r="33"></circle><path d="M24.0858 26.9142C23.3047 26.1332 23.3047 24.8668 24.0858 24.0858C24.8668 23.3047 26.1332 23.3047 26.9142 24.0858L36 33.1716L45.0858 24.0858C45.8668 23.3047 47.1332 23.3047 47.9142 24.0858C48.6953 24.8668 48.6953 26.1332 47.9142 26.9142L38.8284 36L47.9142 45.0858C48.6953 45.8668 48.6953 47.1332 47.9142 47.9142C47.1332 48.6953 45.8668 48.6953 45.0858 47.9142L36 38.8284L26.9142 47.9142C26.1332 48.6953 24.8668 48.6953 24.0858 47.9142C23.3047 47.1332 23.3047 45.8668 24.0858 45.0858L33.1716 36L24.0858 26.9142Z"></path></svg>'),D9=ei('<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48" fill="none"><circle cx="24" cy="24.001" r="22"></circle><path d="M24 24.001L31.5 16.501M24 24.001L16.5 16.501M24 24.001L16.5 31.501M24 24.001L31.5 31.501" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path></svg>'),z9=ei('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="11"></circle><path d="M7.86361 9.1364C7.51214 8.78493 7.51214 8.21508 7.86361 7.86361C8.21508 7.51214 8.78493 7.51214 9.1364 7.86361L12 10.7272L14.8636 7.86361C15.2151 7.51214 15.7849 7.51214 16.1364 7.86361C16.4879 8.21508 16.4879 8.78493 16.1364 9.1364L13.2728 12L16.1364 14.8636C16.4879 15.2151 16.4879 15.7849 16.1364 16.1364C15.7849 16.4879 15.2151 16.4879 14.8636 16.1364L12 13.2728L9.1364 16.1364C8.78493 16.4879 8.21508 16.4879 7.86361 16.1364C7.51214 15.7849 7.51214 15.2151 7.86361 14.8636L10.7272 12L7.86361 9.1364Z"></path></svg>'),by=n=>{const t=Vi(),r=()=>n.size||"m",l=()=>n.fill||t.colors.icon.error;return qn((()=>{const d=qn(()=>r()==="m");return()=>d()?(()=>{const m=O9.cloneNode(!0),x=m.firstChild,C=x.nextSibling;return Yr(a=>{const M=n.class,R=l(),j=t.colors.constant.white;return M!==a._v$&&vr(m,"class",a._v$=M),R!==a._v$2&&vr(x,"fill",a._v$2=R),j!==a._v$3&&vr(C,"fill",a._v$3=j),a},{_v$:void 0,_v$2:void 0,_v$3:void 0}),m})():(()=>{const m=qn(()=>r()==="s");return()=>m()?(()=>{const x=D9.cloneNode(!0),C=x.firstChild,a=C.nextSibling;return Yr(M=>{const R=n.class,j=l(),F=t.colors.constant.white;return R!==M._v$4&&vr(x,"class",M._v$4=R),j!==M._v$5&&vr(C,"fill",M._v$5=j),F!==M._v$6&&vr(a,"stroke",M._v$6=F),M},{_v$4:void 0,_v$5:void 0,_v$6:void 0}),x})():(()=>{const x=z9.cloneNode(!0),C=x.firstChild,a=C.nextSibling;return Yr(M=>{const R=n.class,j=l(),F=t.colors.constant.white;return R!==M._v$7&&vr(x,"class",M._v$7=R),j!==M._v$8&&vr(C,"fill",M._v$8=j),F!==M._v$9&&vr(a,"fill",M._v$9=F),M},{_v$7:void 0,_v$8:void 0,_v$9:void 0}),x})()})()})())},B9=ei('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.55 5.85123C18.9459 7.81184 20.1094 12.1541 18.1488 15.55C16.1882 18.9459 11.8459 20.1094 8.44998 18.1488C8.01952 17.9003 7.46909 18.0478 7.22056 18.4782C6.97203 18.9087 7.11952 19.4591 7.54998 19.7076C11.8068 22.1653 17.2499 20.7068 19.7076 16.45C22.1653 12.1932 20.7068 6.75005 16.45 4.29239C12.1932 1.83472 6.75003 3.29321 4.29236 7.55001C4.04383 7.98047 4.19132 8.53091 4.62178 8.77943C5.05224 9.02796 5.60268 8.88048 5.8512 8.45001C7.81181 5.05413 12.1541 3.89062 15.55 5.85123Z"></path></svg>'),j9=ei('<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M22 2.99951C11.5066 2.99951 3 11.5061 3 21.9995C3 32.4929 11.5066 40.9995 22 40.9995C22.8284 40.9995 23.5 41.6711 23.5 42.4995C23.5 43.3279 22.8284 43.9995 22 43.9995C9.84974 43.9995 0 34.1498 0 21.9995C0 9.84925 9.84974 -0.000488281 22 -0.000488281C34.1503 -0.000488281 44 9.84925 44 21.9995C44 22.8279 43.3284 23.4995 42.5 23.4995C41.6716 23.4995 41 22.8279 41 21.9995C41 11.5061 32.4934 2.99951 22 2.99951Z"></path></svg>'),N9=ei('<svg width="72" height="72" viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M24 56.7846C35.479 63.412 50.1572 59.479 56.7846 47.9999C63.412 36.5209 59.479 21.8427 48 15.2153C36.521 8.58791 21.8428 12.5209 15.2154 23.9999" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"></path></svg>'),_h=n=>{const t=Vi(),r=()=>n.size||"xs",l=()=>n.fill||t.colors.icon.tertiary,d=IP`
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
    `,m=fh`
        animation: ${d} 1s linear infinite;
    `;return qn((()=>{const x=qn(()=>r()==="xs");return()=>x()?(()=>{const C=B9.cloneNode(!0),a=C.firstChild;return Yr(M=>{const R=v_(m,n.class),j=l();return R!==M._v$&&vr(C,"class",M._v$=R),j!==M._v$2&&vr(a,"fill",M._v$2=j),M},{_v$:void 0,_v$2:void 0}),C})():(()=>{const C=qn(()=>r()==="s");return()=>C()?(()=>{const a=j9.cloneNode(!0),M=a.firstChild;return Yr(R=>{const j=v_(m,n.class),F=l();return j!==R._v$3&&vr(a,"class",R._v$3=j),F!==R._v$4&&vr(M,"fill",R._v$4=F),R},{_v$3:void 0,_v$4:void 0}),a})():(()=>{const a=N9.cloneNode(!0),M=a.firstChild;return Yr(R=>{const j=v_(m,n.class),F=l();return j!==R._v$5&&vr(a,"class",R._v$5=j),F!==R._v$6&&vr(M,"stroke",R._v$6=F),R},{_v$5:void 0,_v$6:void 0}),a})()})()})())},F9=ei('<svg width="158" height="28" viewBox="0 0 158 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M28 14.001C28 21.733 21.732 28.001 14 28.001C6.26801 28.001 0 21.733 0 14.001C0 6.26899 6.26801 0.000976562 14 0.000976562C21.732 0.000976562 28 6.26899 28 14.001ZM9.21931 8.00098H18.7801H18.7813C20.538 8.00098 21.6522 9.89966 20.7691 11.4302L14.8672 21.6576C14.4822 22.3254 13.5172 22.3254 13.1322 21.6576L7.23158 11.4302C6.34721 9.89726 7.4614 8.00098 9.21931 8.00098ZM13.1262 18.5882V9.74806H9.21811C8.78976 9.74806 8.53708 10.2029 8.74163 10.5578L11.8423 16.1035L13.1262 18.5882ZM16.1559 16.1047L19.2554 10.5566C19.4599 10.2017 19.2073 9.74685 18.7789 9.74685H14.8709V18.5906L16.1559 16.1047Z" fill="#0098EA"></path><path d="M18.7802 8.00098H9.21936C7.46145 8.00098 6.34727 9.89726 7.23164 11.4302L13.1322 21.6576C13.5173 22.3254 14.4823 22.3254 14.8673 21.6576L20.7691 11.4302C21.6523 9.89966 20.5381 8.00098 18.7814 8.00098H18.7802ZM13.1274 18.5906L11.8424 16.1035L8.74168 10.5578C8.53714 10.2029 8.78981 9.74806 9.21816 9.74806H13.1262V18.5918L13.1274 18.5906ZM19.2555 10.5566L16.156 16.1047L14.8709 18.5906V9.74685H18.779C19.2073 9.74685 19.46 10.2017 19.2555 10.5566Z" fill="white"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M51.7483 22.1967C55.7182 22.1967 58.9609 18.954 58.9609 14.9841C58.9609 11.0142 55.7182 7.77148 51.7483 7.77148C47.7588 7.77148 44.5357 11.0142 44.5357 14.9841C44.5357 18.954 47.7588 22.1967 51.7483 22.1967ZM51.7483 19.1702C49.4686 19.1702 47.6802 17.2442 47.6802 14.9841C47.6802 12.724 49.4686 10.798 51.7483 10.798C54.0084 10.798 55.7968 12.724 55.7968 14.9841C55.7968 17.2442 54.0084 19.1702 51.7483 19.1702ZM37.0698 21.9609H40.2142V10.9946H44.2843V8.00732H33V10.9946H37.0698V21.9609ZM69.9379 8.00732H73.0823V21.9609H70.3899L63.59 13.3333V21.9609H60.4652V8.00732H63.1576L69.9379 16.6153V8.00732ZM79.2259 14.9887C79.2259 10.9202 82.351 7.77539 86.4982 7.77539C89.8592 7.77539 92.5519 9.95709 93.2202 12.6891H90.7437C90.154 11.0971 88.4637 9.9964 86.4982 9.9964C83.5893 9.9964 81.5452 12.1781 81.5452 14.9887C81.5452 17.7994 83.5893 19.9811 86.4982 19.9811C88.4637 19.9811 90.154 18.8804 90.7437 17.2884H93.2202C92.5519 20.0204 89.8592 22.2021 86.4982 22.2021C82.351 22.2021 79.2259 19.0573 79.2259 14.9887ZM104.584 17.0525C104.584 19.9025 102.343 22.1628 99.4342 22.1628C96.5253 22.1628 94.2846 19.9025 94.2846 17.0525C94.2846 14.2025 96.5253 11.9422 99.4342 11.9422C102.343 11.9422 104.584 14.2025 104.584 17.0525ZM96.4663 17.0525C96.4663 18.8018 97.6849 20.158 99.4342 20.158C101.164 20.158 102.382 18.8018 102.382 17.0525C102.382 15.3032 101.164 13.947 99.4342 13.947C97.6849 13.947 96.4663 15.3032 96.4663 17.0525ZM108.626 12.1388H106.463V21.9662H108.626V17.1311C108.626 15.0281 109.726 13.9077 111.161 13.9077C112.419 13.9077 113.205 14.8512 113.205 16.4039V21.9662H115.367V16.0501C115.367 13.5539 113.893 11.9422 111.613 11.9422C110.335 11.9422 109.215 12.4926 108.626 13.4753V12.1388ZM117.839 12.1388H120.001V13.4753C120.59 12.4926 121.711 11.9422 122.988 11.9422C125.268 11.9422 126.742 13.5539 126.742 16.0501V21.9662H124.58V16.4039C124.58 14.8512 123.794 13.9077 122.536 13.9077C121.101 13.9077 120.001 15.0281 120.001 17.1311V21.9662H117.839V12.1388ZM133.558 22.1628C136.054 22.1628 137.823 20.728 138.373 18.8804H136.113C135.661 19.8238 134.717 20.2563 133.636 20.2563C131.887 20.2563 130.747 19.077 130.668 17.5832H138.491C138.688 14.2419 136.585 11.9422 133.577 11.9422C130.551 11.9422 128.526 14.1436 128.526 17.0525C128.526 20.0007 130.629 22.1628 133.558 22.1628ZM130.747 16.0501C131.042 14.5367 132.162 13.7505 133.518 13.7505C134.717 13.7505 135.838 14.4581 136.172 16.0501H130.747ZM149.851 18.3694C149.32 20.5511 147.453 22.1628 144.859 22.1628C141.871 22.1628 139.709 19.8828 139.709 17.0525C139.709 14.2222 141.871 11.9422 144.859 11.9422C147.453 11.9422 149.32 13.5539 149.851 15.7356H147.571C147.178 14.6743 146.215 13.9077 144.859 13.9077C143.109 13.9077 141.91 15.2246 141.91 17.0525C141.91 18.8804 143.109 20.1973 144.859 20.1973C146.215 20.1973 147.178 19.4307 147.571 18.3694H149.851ZM155.75 22.0645C156.418 22.0645 156.929 21.9859 157.362 21.8483V19.9221C157.047 20.0401 156.615 20.1187 156.202 20.1187C155.082 20.1187 154.551 19.6666 154.551 18.448V14.065H157.362V12.1388H154.551V9.40675H152.389V12.1388H150.345V14.065H152.389V18.8018C152.389 21.0228 153.863 22.0645 155.75 22.0645Z"></path></svg>'),U9=()=>{const n=Vi(),t=()=>n.theme===bo.DARK?n.colors.constant.white:n.colors.constant.black;return(()=>{const r=F9.cloneNode(!0),l=r.firstChild,d=l.nextSibling,m=d.nextSibling;return Yr(()=>vr(m,"fill",t())),r})()},$9=ei('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M5.56608 4.42584C5.82527 3.32158 6.8176 2.5 8.00001 2.5C9.38072 2.5 10.5 3.61929 10.5 5C10.5 5.63026 10.3391 6.0386 10.1264 6.34455C9.90018 6.66993 9.58561 6.92478 9.18864 7.20877C9.12579 7.25372 9.05873 7.30025 8.9887 7.34883C8.27392 7.84472 7.25001 8.55507 7.25001 10V10.25C7.25001 10.6642 7.5858 11 8.00001 11C8.41422 11 8.75001 10.6642 8.75001 10.25V10C8.75001 9.36502 9.10777 9.1096 9.94554 8.51149L10.0614 8.42873C10.4769 8.13147 10.9748 7.75194 11.358 7.20076C11.7547 6.63015 12 5.91973 12 5C12 2.79086 10.2091 1 8.00001 1C6.10564 1 4.5205 2.31615 4.10577 4.08308C4.01112 4.48634 4.26129 4.88997 4.66454 4.98462C5.0678 5.07927 5.47143 4.8291 5.56608 4.42584ZM8.00001 15C8.60752 15 9.10001 14.5075 9.10001 13.9C9.10001 13.2925 8.60752 12.8 8.00001 12.8C7.39249 12.8 6.90001 13.2925 6.90001 13.9C6.90001 14.5075 7.39249 15 8.00001 15Z"></path></svg>'),V9=n=>{const t=Vi(),r=()=>n.fill||t.colors.icon.secondary;return(()=>{const l=$9.cloneNode(!0),d=l.firstChild;return Yr(()=>vr(d,"fill",r())),l})()},W9=ei('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.98156 8.75C9.84854 11.4328 9.01206 13.5 8 13.5C6.98794 13.5 6.15146 11.4328 6.01844 8.75H9.98156ZM11.4832 8.75C11.4217 10.1155 11.1929 11.3869 10.8239 12.4017C10.7734 12.5405 10.7188 12.6789 10.6595 12.8154C12.1454 11.993 13.2103 10.5029 13.4493 8.75H11.4832ZM13.4493 7.25H11.4832C11.4217 5.88453 11.1929 4.61314 10.8239 3.5983C10.7734 3.4595 10.7188 3.32111 10.6595 3.18459C12.1454 4.00697 13.2103 5.49709 13.4493 7.25ZM9.98156 7.25H6.01844C6.15144 4.56764 6.98769 2.50062 7.99955 2.5H8C9.01206 2.5 9.84854 4.56724 9.98156 7.25ZM4.51678 7.25C4.57826 5.88453 4.80706 4.61314 5.1761 3.5983C5.22657 3.4595 5.28124 3.32111 5.3405 3.18459C3.85463 4.00697 2.78972 5.49709 2.55071 7.25H4.51678ZM2.55071 8.75C2.78972 10.5029 3.85463 11.993 5.3405 12.8154C5.28124 12.6789 5.22657 12.5405 5.1761 12.4017C4.80706 11.3869 4.57826 10.1155 4.51678 8.75H2.55071ZM15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1C11.866 1 15 4.13401 15 8Z"></path></svg>'),q9=n=>{const t=Vi(),r=()=>n.fill||t.colors.icon.primary;return(()=>{const l=W9.cloneNode(!0),d=l.firstChild;return Yr(()=>vr(d,"fill",r())),l})()},G9=ei('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.5 4.8C2.5 3.11984 2.5 2.27976 2.82698 1.63803C3.1146 1.07354 3.57354 0.614601 4.13803 0.32698C4.77976 0 5.61984 0 7.3 0H8.7C10.3802 0 11.2202 0 11.862 0.32698C12.4265 0.614601 12.8854 1.07354 13.173 1.63803C13.5 2.27976 13.5 3.11984 13.5 4.8V11.2C13.5 12.8802 13.5 13.7202 13.173 14.362C12.8854 14.9265 12.4265 15.3854 11.862 15.673C11.2202 16 10.3802 16 8.7 16H7.3C5.61984 16 4.77976 16 4.13803 15.673C3.57354 15.3854 3.1146 14.9265 2.82698 14.362C2.5 13.7202 2.5 12.8802 2.5 11.2V4.8ZM4 3.9C4 3.05992 4 2.63988 4.16349 2.31901C4.3073 2.03677 4.53677 1.8073 4.81901 1.66349C5.13988 1.5 5.55992 1.5 6.4 1.5H9.6C10.4401 1.5 10.8601 1.5 11.181 1.66349C11.4632 1.8073 11.6927 2.03677 11.8365 2.31901C12 2.63988 12 3.05992 12 3.9V12.1C12 12.9401 12 13.3601 11.8365 13.681C11.6927 13.9632 11.4632 14.1927 11.181 14.3365C10.8601 14.5 10.4401 14.5 9.6 14.5H6.4C5.55992 14.5 5.13988 14.5 4.81901 14.3365C4.53677 14.1927 4.3073 13.9632 4.16349 13.681C4 13.3601 4 12.9401 4 12.1V3.9ZM7 2.5C6.58579 2.5 6.25 2.83579 6.25 3.25C6.25 3.66421 6.58579 4 7 4H9C9.41421 4 9.75 3.66421 9.75 3.25C9.75 2.83579 9.41421 2.5 9 2.5H7Z"></path></svg>'),Z9=n=>{const t=Vi(),r=()=>n.fill||t.colors.icon.primary;return(()=>{const l=G9.cloneNode(!0),d=l.firstChild;return Yr(()=>vr(d,"fill",r())),l})()},H9=ei('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.5 6.8C1.5 5.11984 1.5 4.27976 1.82698 3.63803C2.1146 3.07354 2.57354 2.6146 3.13803 2.32698C3.77976 2 4.61984 2 6.3 2H9.7C11.3802 2 12.2202 2 12.862 2.32698C13.4265 2.6146 13.8854 3.07354 14.173 3.63803C14.5 4.27976 14.5 5.11984 14.5 6.8V11.5H15.25C15.6642 11.5 16 11.8358 16 12.25C16 12.6642 15.6642 13 15.25 13H0.75C0.335786 13 0 12.6642 0 12.25C0 11.8358 0.335786 11.5 0.75 11.5H1.5V6.8ZM3 11.5H13V5.9C13 5.05992 13 4.63988 12.8365 4.31901C12.6927 4.03677 12.4632 3.8073 12.181 3.66349C11.8601 3.5 11.4401 3.5 10.6 3.5H5.4C4.55992 3.5 4.13988 3.5 3.81901 3.66349C3.53677 3.8073 3.3073 4.03677 3.16349 4.31901C3 4.63988 3 5.05992 3 5.9V11.5Z"></path></svg>'),K9=n=>{const t=Vi(),r=()=>n.fill||t.colors.icon.primary;return(()=>{const l=H9.cloneNode(!0),d=l.firstChild;return Yr(()=>vr(d,"fill",r())),l})()},X9=ei('<svg xmlns="http://www.w3.org/2000/svg" width="17" height="16" viewBox="0 0 17 16" fill="none"><g clip-path="url(#clip0_3676_1603)"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.5 1.25049C15.5 0.836275 15.1642 0.500488 14.75 0.500488C14.3358 0.500488 14 0.836275 14 1.25049V3.67012C12.7187 2.04487 10.7318 1.00049 8.5 1.00049C4.63401 1.00049 1.5 4.1345 1.5 8.00049C1.5 11.8665 4.63401 15.0005 8.5 15.0005C11.6844 15.0005 14.3703 12.8748 15.2199 9.96661C15.3361 9.56902 15.1079 9.15254 14.7103 9.03638C14.3127 8.92023 13.8962 9.14838 13.7801 9.54597C13.1123 11.8319 11 13.5005 8.5 13.5005C5.46243 13.5005 3 11.0381 3 8.00049C3 4.96292 5.46243 2.50049 8.5 2.50049C10.321 2.50049 11.9363 3.3855 12.9377 4.75049H10.5C10.0858 4.75049 9.75 5.08627 9.75 5.50049C9.75 5.9147 10.0858 6.25049 10.5 6.25049H14.75C15.1642 6.25049 15.5 5.9147 15.5 5.50049V1.25049Z"></path></g><defs><clipPath id="clip0_3676_1603"><rect width="16" height="16" fill="white" transform="translate(0.5 0.000488281)"></rect></clipPath></defs></svg>'),d0=n=>{const t=Vi(),r=()=>n.fill||t.colors.accent;return(()=>{const l=X9.cloneNode(!0),d=l.firstChild,m=d.firstChild;return Yr(()=>vr(m,"fill",r())),l})()},Y9=ei('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M13 4.06119V6.75053C13 7.16474 13.3358 7.50053 13.75 7.50053C14.1642 7.50053 14.5 7.16474 14.5 6.75053V2.75053L14.5 2.72807C14.5001 2.63191 14.5003 2.49627 14.4842 2.37627C14.4638 2.22503 14.4063 1.99261 14.2071 1.79342C14.0079 1.59423 13.7755 1.5367 13.6243 1.51637C13.5043 1.50023 13.3686 1.50039 13.2725 1.50051L13.25 1.50053H9.25C8.83579 1.50053 8.5 1.83631 8.5 2.25053C8.5 2.66474 8.83579 3.00053 9.25 3.00053H11.9393L7.21967 7.7202C6.92678 8.01309 6.92678 8.48796 7.21967 8.78086C7.51256 9.07375 7.98744 9.07375 8.28033 8.78086L13 4.06119ZM5.85 1.50053H5.81903H5.81899C5.21528 1.50052 4.71702 1.50051 4.31113 1.53367C3.88956 1.56812 3.50203 1.64204 3.13803 1.82751C2.57354 2.11513 2.1146 2.57407 1.82698 3.13856C1.64151 3.50256 1.56759 3.89009 1.53315 4.31166C1.49998 4.71755 1.49999 5.21581 1.5 5.81953V5.81955V5.85053V10.1505V10.1815V10.1815C1.49999 10.7852 1.49998 11.2835 1.53315 11.6894C1.56759 12.111 1.64151 12.4985 1.82698 12.8625C2.1146 13.427 2.57354 13.8859 3.13803 14.1735C3.50203 14.359 3.88956 14.4329 4.31113 14.4674C4.71702 14.5005 5.21527 14.5005 5.81897 14.5005H5.81901H5.85H10.15H10.181H10.181C10.7847 14.5005 11.283 14.5005 11.6889 14.4674C12.1104 14.4329 12.498 14.359 12.862 14.1735C13.4265 13.8859 13.8854 13.427 14.173 12.8625C14.3585 12.4985 14.4324 12.111 14.4669 11.6894C14.5 11.2835 14.5 10.7853 14.5 10.1816V10.1815V10.1505V9.75053C14.5 9.33631 14.1642 9.00053 13.75 9.00053C13.3358 9.00053 13 9.33631 13 9.75053V10.1505C13 10.793 12.9994 11.2297 12.9718 11.5672C12.945 11.8961 12.8963 12.0642 12.8365 12.1815C12.6927 12.4638 12.4632 12.6932 12.181 12.837C12.0637 12.8968 11.8955 12.9455 11.5667 12.9724C11.2292 12.9999 10.7924 13.0005 10.15 13.0005H5.85C5.20757 13.0005 4.77085 12.9999 4.43328 12.9724C4.10447 12.9455 3.93632 12.8968 3.81902 12.837C3.53677 12.6932 3.3073 12.4638 3.16349 12.1815C3.10372 12.0642 3.05503 11.8961 3.02816 11.5672C3.00058 11.2297 3 10.793 3 10.1505V5.85053C3 5.20809 3.00058 4.77137 3.02816 4.43381C3.05503 4.10499 3.10372 3.93684 3.16349 3.81954C3.3073 3.5373 3.53677 3.30783 3.81902 3.16402C3.93632 3.10425 4.10447 3.05556 4.43328 3.02869C4.77085 3.00111 5.20757 3.00053 5.85 3.00053H6.25C6.66422 3.00053 7 2.66474 7 2.25053C7 1.83631 6.66422 1.50053 6.25 1.50053H5.85Z"></path></svg>'),K5=n=>{const t=Vi(),r=()=>n.fill||t.colors.accent;return(()=>{const l=Y9.cloneNode(!0),d=l.firstChild;return Yr(()=>vr(d,"fill",r())),l})()},J9=ei('<svg xmlns="http://www.w3.org/2000/svg" width="17" height="16" viewBox="0 0 17 16" fill="none"><g clip-path="url(#clip0_3676_1274)"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.82698 2.63901C1.5 3.28074 1.5 4.12082 1.5 5.80098V8.80098V9.00098V10.201C1.5 11.8811 1.5 12.7212 1.82698 13.3629C2.1146 13.9274 2.57354 14.3864 3.13803 14.674C3.77976 15.001 4.61984 15.001 6.3 15.001H11.7C13.3802 15.001 14.2202 15.001 14.862 14.674C15.4265 14.3864 15.8854 13.9274 16.173 13.3629C16.5 12.7212 16.5 11.8811 16.5 10.201V8.80098C16.5 7.12082 16.5 6.28074 16.173 5.63901C15.8854 5.07452 15.4265 4.61558 14.862 4.32796C14.743 4.26733 14.6172 4.21795 14.4805 4.17772C14.4501 3.49449 14.3722 3.02994 14.173 2.63901C13.8854 2.07452 13.4265 1.61558 12.862 1.32796C12.2202 1.00098 11.3802 1.00098 9.7 1.00098H6.3C4.61984 1.00098 3.77976 1.00098 3.13803 1.32796C2.57354 1.61558 2.1146 2.07452 1.82698 2.63901ZM12.9861 4.00942C12.9684 3.7108 12.9281 3.49982 12.8365 3.31999C12.6927 3.03775 12.4632 2.80828 12.181 2.66447C11.8601 2.50098 11.4401 2.50098 10.6 2.50098H5.4C4.55992 2.50098 4.13988 2.50098 3.81901 2.66447C3.53677 2.80828 3.3073 3.03775 3.16349 3.31999C3.03615 3.56991 3.00799 3.88 3.00177 4.40188C3.04646 4.37612 3.09189 4.35146 3.13803 4.32796C3.77976 4.00098 4.61984 4.00098 6.3 4.00098H11.7C12.1966 4.00098 12.6197 4.00098 12.9861 4.00942ZM3 7.90098V8.10098C3 8.47468 3 8.76527 3.01439 9.00098H3V11.101C3 11.9411 3 12.3611 3.16349 12.682C3.3073 12.9642 3.53677 13.1937 3.81901 13.3375C4.13988 13.501 4.55992 13.501 5.4 13.501H12.6C13.4401 13.501 13.8601 13.501 14.181 13.3375C14.4632 13.1937 14.6927 12.9642 14.8365 12.682C15 12.3611 15 11.9411 15 11.101V7.90098C15 7.0609 15 6.64086 14.8365 6.31999C14.6927 6.03775 14.4632 5.80828 14.181 5.66447C13.8601 5.50098 13.4401 5.50098 12.6 5.50098H5.4C4.55992 5.50098 4.13988 5.50098 3.81901 5.66447C3.53677 5.80828 3.3073 6.03775 3.16349 6.31999C3 6.64086 3 7.0609 3 7.90098ZM10.5 9.75098C10.5 9.33676 10.8358 9.00098 11.25 9.00098H12.75C13.1642 9.00098 13.5 9.33676 13.5 9.75098C13.5 10.1652 13.1642 10.501 12.75 10.501H11.25C10.8358 10.501 10.5 10.1652 10.5 9.75098Z"></path></g><defs><clipPath id="clip0_3676_1274"><rect width="16" height="16" fill="white" transform="translate(0.5 0.000976562)"></rect></clipPath></defs></svg>'),Q9=n=>{const t=Vi(),r=()=>n.fill||t.colors.accent;return(()=>{const l=J9.cloneNode(!0),d=l.firstChild,m=d.firstChild;return Yr(()=>vr(m,"fill",r())),l})()},e7=ei('<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M39.6319 16.8719C38.3212 16.2041 36.7002 16.0478 34 16.0112V11C34 5.47715 29.5228 1 24 1C18.4772 1 14 5.47715 14 11V16.0112C11.2998 16.0478 9.6788 16.2041 8.36808 16.8719C6.86278 17.6389 5.63893 18.8628 4.87195 20.3681C4 22.0794 4 24.3196 4 28.8V32.2C4 36.6804 4 38.9206 4.87195 40.6319C5.63893 42.1372 6.86278 43.3611 8.36808 44.1281C10.0794 45 12.3196 45 16.8 45H31.2C35.6804 45 37.9206 45 39.6319 44.1281C41.1372 43.3611 42.3611 42.1372 43.1281 40.6319C44 38.9206 44 36.6804 44 32.2V28.8C44 24.3196 44 22.0794 43.1281 20.3681C42.3611 18.8628 41.1372 17.6389 39.6319 16.8719ZM31 11V16H17V11C17 7.13401 20.134 4 24 4C27.866 4 31 7.13401 31 11ZM7.54497 21.73C7 22.7996 7 24.1997 7 27V34C7 36.8003 7 38.2004 7.54497 39.27C8.02433 40.2108 8.78924 40.9757 9.73005 41.455C10.7996 42 12.1997 42 15 42H33C35.8003 42 37.2004 42 38.27 41.455C39.2108 40.9757 39.9757 40.2108 40.455 39.27C41 38.2004 41 36.8003 41 34V27C41 24.1997 41 22.7996 40.455 21.73C39.9757 20.7892 39.2108 20.0243 38.27 19.545C37.2004 19 35.8003 19 33 19H15C12.1997 19 10.7996 19 9.73005 19.545C8.78924 20.0243 8.02433 20.7892 7.54497 21.73ZM24 24C23.1716 24 22.5 24.6716 22.5 25.5V29.5C22.5 30.3284 23.1716 31 24 31C24.8284 31 25.5 30.3284 25.5 29.5V25.5C25.5 24.6716 24.8284 24 24 24Z"></path></svg>'),t7=n=>{const t=Vi(),r=()=>n.fill||t.colors.icon.secondary;return(()=>{const l=e7.cloneNode(!0),d=l.firstChild;return Yr(m=>{const x=n.class,C=r();return x!==m._v$&&vr(l,"class",m._v$=x),C!==m._v$2&&vr(d,"fill",m._v$2=C),m},{_v$:void 0,_v$2:void 0}),l})()},n7=ei('<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M37.485 37.3849C40.894 33.9506 43 29.2212 43 24C43 13.5066 34.4934 5 24 5C13.5066 5 5 13.5066 5 24C5 29.2213 7.1061 33.9507 10.5151 37.385C13.3583 32.9438 18.3354 30 24.0001 30C29.6647 30 34.6418 32.9437 37.485 37.3849ZM35.1809 39.3635C32.9143 35.5532 28.7554 33 24.0001 33C19.2448 33 15.0858 35.5533 12.8193 39.3636C15.9564 41.6506 19.8206 43 24 43C28.1795 43 32.0437 41.6505 35.1809 39.3635ZM24 46C36.1503 46 46 36.1503 46 24C46 11.8497 36.1503 2 24 2C11.8497 2 2 11.8497 2 24C2 36.1503 11.8497 46 24 46ZM24 24C26.7614 24 29 21.7614 29 19C29 16.2386 26.7614 14 24 14C21.2386 14 19 16.2386 19 19C19 21.7614 21.2386 24 24 24ZM24 27C28.4183 27 32 23.4183 32 19C32 14.5817 28.4183 11 24 11C19.5817 11 16 14.5817 16 19C16 23.4183 19.5817 27 24 27Z"></path></svg>'),r7=n=>{const t=Vi(),r=()=>n.fill||t.colors.icon.secondary;return(()=>{const l=n7.cloneNode(!0),d=l.firstChild;return Yr(m=>{const x=n.class,C=r();return x!==m._v$&&vr(l,"class",m._v$=x),C!==m._v$2&&vr(d,"fill",m._v$2=C),m},{_v$:void 0,_v$2:void 0}),l})()},i7=ei('<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M34.5607 4.43934C33.9749 3.85355 33.0251 3.85355 32.4393 4.43934C31.8536 5.02513 31.8536 5.97487 32.4393 6.56066L37.8787 12H10.5C9.67157 12 9 12.6716 9 13.5C9 14.3284 9.67157 15 10.5 15H37.8787L32.4393 20.4393C31.8536 21.0251 31.8536 21.9749 32.4393 22.5607C33.0251 23.1464 33.9749 23.1464 34.5607 22.5607L42.5607 14.5607C43.1464 13.9749 43.1464 13.0251 42.5607 12.4393L34.5607 4.43934ZM13.4393 25.4393C14.0251 24.8536 14.9749 24.8536 15.5607 25.4393C16.1464 26.0251 16.1464 26.9749 15.5607 27.5607L10.1213 33H37.5C38.3284 33 39 33.6716 39 34.5C39 35.3284 38.3284 36 37.5 36H10.1213L15.5607 41.4393C16.1464 42.0251 16.1464 42.9749 15.5607 43.5607C14.9749 44.1464 14.0251 44.1464 13.4393 43.5607L5.43934 35.5607C4.85355 34.9749 4.85355 34.0251 5.43934 33.4393L13.4393 25.4393Z"></path></svg>'),o7=n=>{const t=Vi(),r=()=>n.fill||t.colors.icon.secondary;return(()=>{const l=i7.cloneNode(!0),d=l.firstChild;return Yr(m=>{const x=n.class,C=r();return x!==m._v$&&vr(l,"class",m._v$=x),C!==m._v$2&&vr(d,"fill",m._v$2=C),m},{_v$:void 0,_v$2:void 0}),l})()},s7=ei('<svg xmlns="http://www.w3.org/2000/svg" width="28" height="29" viewBox="0 0 28 29" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.75 12.002C1.75 9.20169 1.75 7.80156 2.29497 6.732C2.77433 5.79119 3.53924 5.02629 4.48005 4.54692C5.54961 4.00195 6.94974 4.00195 9.75 4.00195H17.25C20.0503 4.00195 21.4504 4.00195 22.52 4.54692C23.4608 5.02629 24.2257 5.79119 24.705 6.732C24.8256 6.96861 24.9195 7.2214 24.9926 7.50195H21.5C19.6377 7.50195 18.7065 7.50195 17.9609 7.77334C16.711 8.22828 15.7263 9.21291 15.2714 10.4629C15 11.2085 15 12.1396 15 14.002C15 15.8643 15 16.7954 15.2714 17.541C15.7263 18.791 16.711 19.7756 17.9609 20.2306C18.7065 20.502 19.6377 20.502 21.5 20.502H24.9926C24.9195 20.7825 24.8256 21.0353 24.705 21.2719C24.2257 22.2127 23.4608 22.9776 22.52 23.457C21.4504 24.002 20.0503 24.002 17.25 24.002H9.75C6.94974 24.002 5.54961 24.002 4.48005 23.457C3.53924 22.9776 2.77433 22.2127 2.29497 21.2719C1.75 20.2023 1.75 18.8022 1.75 16.002V12.002ZM16.4999 13.802C16.4999 12.1218 16.4999 11.2817 16.8269 10.64C17.1145 10.0755 17.5735 9.61656 18.138 9.32894C18.7797 9.00196 19.6198 9.00196 21.2999 9.00196H23.1999C24.8801 9.00196 25.7202 9.00196 26.3619 9.32894C26.9264 9.61656 27.3853 10.0755 27.673 10.64C27.9999 11.2817 27.9999 12.1218 27.9999 13.802V14.202C27.9999 15.8821 27.9999 16.7222 27.673 17.3639C27.3853 17.9284 26.9264 18.3874 26.3619 18.675C25.7202 19.002 24.8801 19.002 23.1999 19.002H21.2999C19.6198 19.002 18.7797 19.002 18.138 18.675C17.5735 18.3874 17.1145 17.9284 16.8269 17.3639C16.4999 16.7222 16.4999 15.8821 16.4999 14.202V13.802ZM22.4999 14.002C22.4999 14.9685 21.7164 15.752 20.7499 15.752C19.7834 15.752 18.9999 14.9685 18.9999 14.002C18.9999 13.0355 19.7834 12.252 20.7499 12.252C21.7164 12.252 22.4999 13.0355 22.4999 14.002Z"></path></svg>'),a7=n=>{const t=Vi(),r=()=>n.fill||t.colors.constant.white;return(()=>{const l=s7.cloneNode(!0),d=l.firstChild;return Yr(m=>{const x=n.class,C=r();return x!==m._v$&&vr(l,"class",m._v$=x),C!==m._v$2&&vr(d,"fill",m._v$2=C),m},{_v$:void 0,_v$2:void 0}),l})()},l7=ei('<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M24.7803 7.21967C25.0732 7.51256 25.0732 7.98744 24.7803 8.28033L11.5303 21.5303C11.2374 21.8232 10.7626 21.8232 10.4697 21.5303L4.21967 15.2803C3.92678 14.9874 3.92678 14.5126 4.21967 14.2197C4.51256 13.9268 4.98744 13.9268 5.28033 14.2197L11 19.9393L23.7197 7.21967C24.0126 6.92678 24.4874 6.92678 24.7803 7.21967Z"></path></svg>'),c7=n=>{const t=Vi(),r=()=>n.fill||t.colors.icon.secondary;return(()=>{const l=l7.cloneNode(!0),d=l.firstChild;return Yr(m=>{const x=n.class,C=r();return x!==m._v$&&vr(l,"class",m._v$=x),C!==m._v$2&&vr(d,"fill",m._v$2=C),m},{_v$:void 0,_v$2:void 0}),l})()},u7=ei('<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.0001 10.0001C10.0016 8.02333 10.0267 6.98719 10.436 6.18404C10.8195 5.43139 11.4314 4.81947 12.184 4.43597C13.0397 4 14.1598 4 16.4 4H17.6C19.8402 4 20.9603 4 21.816 4.43597C22.5686 4.81947 23.1805 5.43139 23.564 6.18404C24 7.03969 24 8.15979 24 10.4V11.6C24 13.8402 24 14.9603 23.564 15.816C23.1805 16.5686 22.5686 17.1805 21.816 17.564C21.0128 17.9733 19.9767 17.9984 17.9999 17.9999C17.9984 19.9767 17.9733 21.0128 17.564 21.816C17.1805 22.5686 16.5686 23.1805 15.816 23.564C14.9603 24 13.8402 24 11.6 24H10.4C8.15979 24 7.03969 24 6.18404 23.564C5.43139 23.1805 4.81947 22.5686 4.43597 21.816C4 20.9603 4 19.8402 4 17.6V16.4C4 14.1598 4 13.0397 4.43597 12.184C4.81947 11.4314 5.43139 10.8195 6.18404 10.436C6.98719 10.0267 8.02333 10.0016 10.0001 10.0001ZM10 11.5H9.5C8.09987 11.5 7.3998 11.5 6.86502 11.7725C6.39462 12.0122 6.01217 12.3946 5.77248 12.865C5.5 13.3998 5.5 14.0999 5.5 15.5V18.5C5.5 19.9001 5.5 20.6002 5.77248 21.135C6.01217 21.6054 6.39462 21.9878 6.86502 22.2275C7.3998 22.5 8.09987 22.5 9.5 22.5H12.5C13.9001 22.5 14.6002 22.5 15.135 22.2275C15.6054 21.9878 15.9878 21.6054 16.2275 21.135C16.5 20.6002 16.5 19.9001 16.5 18.5V18H16.4C14.1598 18 13.0397 18 12.184 17.564C11.4314 17.1805 10.8195 16.5686 10.436 15.816C10 14.9603 10 13.8402 10 11.6V11.5ZM11.5 9.5C11.5 8.09987 11.5 7.3998 11.7725 6.86502C12.0122 6.39462 12.3946 6.01217 12.865 5.77248C13.3998 5.5 14.0999 5.5 15.5 5.5H18.5C19.9001 5.5 20.6002 5.5 21.135 5.77248C21.6054 6.01217 21.9878 6.39462 22.2275 6.86502C22.5 7.3998 22.5 8.09987 22.5 9.5V12.5C22.5 13.9001 22.5 14.6002 22.2275 15.135C21.9878 15.6054 21.6054 15.9878 21.135 16.2275C20.6002 16.5 19.9001 16.5 18.5 16.5H15.5C14.0999 16.5 13.3998 16.5 12.865 16.2275C12.3946 15.9878 12.0122 15.6054 11.7725 15.135C11.5 14.6002 11.5 13.9001 11.5 12.5V9.5Z"></path></svg>'),uS=n=>{const t=Vi(),r=()=>n.fill||t.colors.icon.secondary;return(()=>{const l=u7.cloneNode(!0),d=l.firstChild;return Yr(m=>{const x=r(),C=r();return x!==m._v$&&vr(l,"fill",m._v$=x),C!==m._v$2&&vr(d,"fill",m._v$2=C),m},{_v$:void 0,_v$2:void 0}),l})()},h7=ei('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 4.12695C1 3.07754 1 2.55284 1.19202 2.14684C1.38986 1.72856 1.7266 1.39181 2.14489 1.19397C2.55088 1.00195 3.07559 1.00195 4.125 1.00195C5.17441 1.00195 5.69912 1.00195 6.10511 1.19397C6.5234 1.39181 6.86014 1.72856 7.05798 2.14684C7.25 2.55284 7.25 3.07754 7.25 4.12695C7.25 5.17636 7.25 5.70107 7.05798 6.10706C6.86014 6.52535 6.5234 6.8621 6.10511 7.05993C5.69912 7.25195 5.17441 7.25195 4.125 7.25195C3.07559 7.25195 2.55088 7.25195 2.14489 7.05993C1.7266 6.8621 1.38986 6.52535 1.19202 6.10706C1 5.70107 1 5.17636 1 4.12695ZM2.5 3.30195C2.5 3.02193 2.5 2.88191 2.5545 2.77496C2.60243 2.68088 2.67892 2.60439 2.773 2.55645C2.87996 2.50195 3.01997 2.50195 3.3 2.50195H4.95C5.23003 2.50195 5.37004 2.50195 5.477 2.55645C5.57108 2.60439 5.64757 2.68088 5.6955 2.77496C5.75 2.88191 5.75 3.02193 5.75 3.30195V4.95195C5.75 5.23198 5.75 5.37199 5.6955 5.47895C5.64757 5.57303 5.57108 5.64952 5.477 5.69746C5.37004 5.75195 5.23003 5.75195 4.95 5.75195H3.3C3.01997 5.75195 2.87996 5.75195 2.773 5.69746C2.67892 5.64952 2.60243 5.57303 2.5545 5.47895C2.5 5.37199 2.5 5.23198 2.5 4.95195V3.30195ZM1 11.877C1 10.8275 1 10.3028 1.19202 9.89684C1.38986 9.47856 1.7266 9.14181 2.14489 8.94397C2.55088 8.75195 3.07559 8.75195 4.125 8.75195C5.17441 8.75195 5.69912 8.75195 6.10511 8.94397C6.5234 9.14181 6.86014 9.47856 7.05798 9.89684C7.25 10.3028 7.25 10.8275 7.25 11.877C7.25 12.9264 7.25 13.4511 7.05798 13.8571C6.86014 14.2753 6.5234 14.6121 6.10511 14.8099C5.69912 15.002 5.17441 15.002 4.125 15.002C3.07559 15.002 2.55088 15.002 2.14489 14.8099C1.7266 14.6121 1.38986 14.2753 1.19202 13.8571C1 13.4511 1 12.9264 1 11.877ZM2.5 11.052C2.5 10.7719 2.5 10.6319 2.5545 10.525C2.60243 10.4309 2.67892 10.3544 2.773 10.3064C2.87996 10.252 3.01997 10.252 3.3 10.252H4.95C5.23003 10.252 5.37004 10.252 5.477 10.3064C5.57108 10.3544 5.64757 10.4309 5.6955 10.525C5.75 10.6319 5.75 10.7719 5.75 11.052V12.702C5.75 12.982 5.75 13.122 5.6955 13.2289C5.64757 13.323 5.57108 13.3995 5.477 13.4475C5.37004 13.502 5.23003 13.502 4.95 13.502H3.3C3.01997 13.502 2.87996 13.502 2.773 13.4475C2.67892 13.3995 2.60243 13.323 2.5545 13.2289C2.5 13.122 2.5 12.982 2.5 12.702V11.052ZM8.94202 2.14684C8.75 2.55284 8.75 3.07754 8.75 4.12695C8.75 5.17636 8.75 5.70107 8.94202 6.10706C9.13986 6.52535 9.4766 6.8621 9.89489 7.05993C10.3009 7.25195 10.8256 7.25195 11.875 7.25195C12.9244 7.25195 13.4491 7.25195 13.8551 7.05993C14.2734 6.8621 14.6101 6.52535 14.808 6.10706C15 5.70107 15 5.17636 15 4.12695C15 3.07754 15 2.55284 14.808 2.14684C14.6101 1.72856 14.2734 1.39181 13.8551 1.19397C13.4491 1.00195 12.9244 1.00195 11.875 1.00195C10.8256 1.00195 10.3009 1.00195 9.89489 1.19397C9.4766 1.39181 9.13986 1.72856 8.94202 2.14684ZM10.3045 2.77496C10.25 2.88191 10.25 3.02193 10.25 3.30195V4.95195C10.25 5.23198 10.25 5.37199 10.3045 5.47895C10.3524 5.57303 10.4289 5.64952 10.523 5.69746C10.63 5.75195 10.77 5.75195 11.05 5.75195H12.7C12.98 5.75195 13.12 5.75195 13.227 5.69746C13.3211 5.64952 13.3976 5.57303 13.4455 5.47895C13.5 5.37199 13.5 5.23198 13.5 4.95195V3.30195C13.5 3.02193 13.5 2.88191 13.4455 2.77496C13.3976 2.68088 13.3211 2.60439 13.227 2.55645C13.12 2.50195 12.98 2.50195 12.7 2.50195H11.05C10.77 2.50195 10.63 2.50195 10.523 2.55645C10.4289 2.60439 10.3524 2.68088 10.3045 2.77496ZM8.80727 9.13518C8.75 9.26242 8.75 9.4256 8.75 9.75195C8.75 10.0783 8.75 10.2415 8.80727 10.3687C8.87245 10.5136 8.9884 10.6295 9.13323 10.6947C9.26047 10.752 9.42365 10.752 9.75 10.752C10.0764 10.752 10.2395 10.752 10.3668 10.6947C10.5116 10.6295 10.6276 10.5136 10.6927 10.3687C10.75 10.2415 10.75 10.0783 10.75 9.75195C10.75 9.4256 10.75 9.26242 10.6927 9.13518C10.6276 8.99035 10.5116 8.8744 10.3668 8.80922C10.2395 8.75195 10.0764 8.75195 9.75 8.75195C9.42365 8.75195 9.26047 8.75195 9.13323 8.80922C8.9884 8.8744 8.87245 8.99035 8.80727 9.13518ZM10.87 11.8771C10.87 11.546 10.87 11.3805 10.9289 11.2517C10.9938 11.1098 11.1077 10.9959 11.2497 10.931C11.3784 10.8721 11.5439 10.8721 11.875 10.8721C12.2061 10.8721 12.3716 10.8721 12.5003 10.931C12.6423 10.9959 12.7562 11.1098 12.8211 11.2517C12.88 11.3805 12.88 11.546 12.88 11.8771C12.88 12.2081 12.88 12.3737 12.8211 12.5024C12.7562 12.6444 12.6423 12.7583 12.5003 12.8232C12.3716 12.8821 12.2061 12.8821 11.875 12.8821C11.5439 12.8821 11.3784 12.8821 11.2497 12.8232C11.1077 12.7583 10.9938 12.6444 10.9289 12.5024C10.87 12.3737 10.87 12.2081 10.87 11.8771ZM8.80727 13.3852C8.75 13.5124 8.75 13.6756 8.75 14.002C8.75 14.3283 8.75 14.4915 8.80727 14.6187C8.87245 14.7636 8.9884 14.8795 9.13323 14.9447C9.26047 15.002 9.42365 15.002 9.75 15.002C10.0764 15.002 10.2395 15.002 10.3668 14.9447C10.5116 14.8795 10.6276 14.7636 10.6927 14.6187C10.75 14.4915 10.75 14.3283 10.75 14.002C10.75 13.6756 10.75 13.5124 10.6927 13.3852C10.6276 13.2404 10.5116 13.1244 10.3668 13.0592C10.2395 13.002 10.0764 13.002 9.75 13.002C9.42365 13.002 9.26047 13.002 9.13323 13.0592C8.9884 13.1244 8.87245 13.2404 8.80727 13.3852ZM13 9.75195C13 9.4256 13 9.26242 13.0573 9.13518C13.1224 8.99035 13.2384 8.8744 13.3832 8.80922C13.5105 8.75195 13.6736 8.75195 14 8.75195C14.3264 8.75195 14.4895 8.75195 14.6168 8.80922C14.7616 8.8744 14.8776 8.99035 14.9427 9.13518C15 9.26242 15 9.4256 15 9.75195C15 10.0783 15 10.2415 14.9427 10.3687C14.8776 10.5136 14.7616 10.6295 14.6168 10.6947C14.4895 10.752 14.3264 10.752 14 10.752C13.6736 10.752 13.5105 10.752 13.3832 10.6947C13.2384 10.6295 13.1224 10.5136 13.0573 10.3687C13 10.2415 13 10.0783 13 9.75195ZM13.0573 13.3852C13 13.5124 13 13.6756 13 14.002C13 14.3283 13 14.4915 13.0573 14.6187C13.1224 14.7636 13.2384 14.8795 13.3832 14.9447C13.5105 15.002 13.6736 15.002 14 15.002C14.3264 15.002 14.4895 15.002 14.6168 14.9447C14.7616 14.8795 14.8776 14.7636 14.9427 14.6187C15 14.4915 15 14.3283 15 14.002C15 13.6756 15 13.5124 14.9427 13.3852C14.8776 13.2404 14.7616 13.1244 14.6168 13.0592C14.4895 13.002 14.3264 13.002 14 13.002C13.6736 13.002 13.5105 13.002 13.3832 13.0592C13.2384 13.1244 13.1224 13.2404 13.0573 13.3852Z"></path></svg>'),Px=n=>{const t=Vi(),r=()=>n.fill||t.colors.icon.secondary;return(()=>{const l=h7.cloneNode(!0),d=l.firstChild;return Yr(()=>vr(d,"fill",r())),l})()},d7={m:"16px",s:"12px",none:"0"},f7={m:"6px",s:"6px",none:"0"},p7=jt.div`
    width: 60px;
    height: 60px;
    padding: 8px;
    margin-bottom: 8px;
    border-radius: ${n=>d7[n.theme.borderRadius]};
    background-color: ${n=>n.theme.colors.background.tint};
    display: grid;
    grid-template: 1fr 1fr / 1fr 1fr;
    gap: 4px;
`,m7=jt(cS)`
    width: 20px;
    height: 20px;
    border-radius: ${n=>f7[n.theme.borderRadius]};
`,hS=n=>he(Z_,{get name(){return n.labelLine1},get secondLine(){return n.labelLine2},get icon(){return he(p7,{get children(){return he(q0,{each:[0,1,2,3],children:t=>he(m7,{get src(){return n.images[t]}})})}})},onClick:()=>n.onClick()}),dh="telegram-wallet",Y0={TON:"https://raw.githubusercontent.com/ton-connect/sdk/main/assets/ton-icon-48.png",TG:"https://raw.githubusercontent.com/ton-connect/sdk/main/assets/tg.png"},dS=n=>{const[t]=fu(),r=()=>{if(n.wallet.appName!==dh){if("isPreferred"in n.wallet&&n.wallet.isPreferred)return t("walletItem.recent",{},"Recent");if(Jf(n.wallet))return t("walletItem.installed",{},"Installed");if(n.wallet.name==="Tonkeeper")return t("walletItem.popular",{},"Popular")}};return qn((()=>{const l=qn(()=>n.wallet.appName===dh);return()=>l()?he(Z_,{get icon(){return n.wallet.imageUrl},get name(){return t("walletItem.walletOn",{},"Wallet On")},secondLine:"Telegram",get badgeUrl(){return Y0.TG},onClick:()=>n.onClick()}):he(Z_,{get icon(){return n.wallet.imageUrl},get name(){return n.wallet.name},get secondLine(){return r()},secondLineColorPrimary:!1,onClick:()=>n.onClick()})})())},g7=jt.div`
    width: 100%;
    overflow-y: auto;
    max-height: ${n=>n.maxHeight};

    scrollbar-width: none;
    &&::-webkit-scrollbar {
        display: none;
    }

    &&::-webkit-scrollbar-track {
        background: transparent;
    }

    &&::-webkit-scrollbar-thumb {
        display: none;
    }
`,_7=jt.div`
    height: 1px;
    margin: 0 -24px;
    width: calc(100% + 48px);
    opacity: 0.08;
    background: ${n=>n.isShown?n.theme.colors.icon.secondary:"transparent"};
    transition: background 0.15s ease-in-out;

    ${Ya("mobile")} {
        width: 100%;
        margin: 0;
    }
`,[y7,v7]=Ir(((I5=gh())==null?void 0:I5.innerHeight)||0);gh()&&window.addEventListener("resize",()=>v7(window.innerHeight));const[Dm,x7]=Ir(km("mobile")),H_=()=>x7(km("mobile"));gh()&&(window.addEventListener("resize",()=>H_()),window.addEventListener("load",()=>H_(),{once:!0}));const fS=n=>{const[t,r]=Ir(!1),l=x=>{r(x.target.scrollTop>0)},d=()=>Dm()?150:200,m=()=>n.maxHeight!==void 0?`${n.maxHeight}px`:`${y7()-d()}px`;return[he(_7,{get isShown(){return t()}}),he(g7,{get maxHeight(){return m()},onScroll:l,get class(){return n.class},get children(){return n.children}})]},w7=jt.a`
    display: block;
    text-decoration: unset;
`,K_=n=>he(w7,eu({get href(){return n.href},get target(){return n.blank?"_blank":"_self"},get class(){return n.class}},()=>n.blank?{rel:"noreferrer noopener"}:{},{get children(){return n.children}})),Ld=_y(),b7=ei('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.76228 2.09998H10.2378C11.0458 2.09997 11.7067 2.09996 12.2438 2.14384C12.7997 2.18926 13.3017 2.28614 13.7706 2.52505C14.5045 2.89896 15.1011 3.49558 15.475 4.22941C15.7139 4.6983 15.8108 5.20038 15.8562 5.75629C15.9001 6.29337 15.9001 6.95422 15.9001 7.76227V8.1H16.2377C17.0457 8.09999 17.7066 8.09998 18.2437 8.14386C18.7996 8.18928 19.3017 8.28616 19.7705 8.52507C20.5044 8.89898 21.101 9.4956 21.4749 10.2294C21.7138 10.6983 21.8107 11.2004 21.8561 11.7563C21.9 12.2934 21.9 12.9542 21.9 13.7623V16.2377C21.9 17.0458 21.9 17.7066 21.8561 18.2437C21.8107 18.7996 21.7138 19.3017 21.4749 19.7706C21.101 20.5044 20.5044 21.101 19.7705 21.4749C19.3017 21.7138 18.7996 21.8107 18.2437 21.8561C17.7066 21.9 17.0458 21.9 16.2378 21.9H13.7623C12.9543 21.9 12.2934 21.9 11.7563 21.8561C11.2004 21.8107 10.6983 21.7138 10.2294 21.4749C9.49561 21.101 8.89898 20.5044 8.52508 19.7706C8.28616 19.3017 8.18928 18.7996 8.14386 18.2437C8.09998 17.7066 8.09999 17.0458 8.1 16.2377V15.9H7.76227C6.95426 15.9 6.29335 15.9 5.75629 15.8561C5.20038 15.8107 4.6983 15.7138 4.22941 15.4749C3.49558 15.101 2.89896 14.5044 2.52505 13.7705C2.28614 13.3017 2.18926 12.7996 2.14384 12.2437C2.09996 11.7066 2.09997 11.0458 2.09998 10.2377V7.76228C2.09997 6.95424 2.09996 6.29336 2.14384 5.75629C2.18926 5.20038 2.28614 4.6983 2.52505 4.22941C2.89896 3.49558 3.49558 2.89896 4.22941 2.52505C4.6983 2.28614 5.20038 2.18926 5.75629 2.14384C6.29336 2.09996 6.95425 2.09997 7.76228 2.09998ZM8.1 14.1V13.7623C8.09999 12.9542 8.09998 12.2934 8.14386 11.7563C8.18928 11.2004 8.28616 10.6983 8.52508 10.2294C8.89898 9.4956 9.49561 8.89898 10.2294 8.52507C10.6983 8.28616 11.2004 8.18928 11.7563 8.14386C12.2934 8.09998 12.9542 8.09999 13.7623 8.1H14.1001V7.79998C14.1001 6.94505 14.0994 6.35798 14.0622 5.90287C14.0259 5.45827 13.9593 5.21944 13.8712 5.0466C13.6699 4.65146 13.3486 4.3302 12.9535 4.12886C12.7806 4.04079 12.5418 3.97419 12.0972 3.93786C11.6421 3.90068 11.055 3.89998 10.2001 3.89998H7.79998C6.94505 3.89998 6.35798 3.90068 5.90287 3.93786C5.45827 3.97419 5.21944 4.04079 5.0466 4.12886C4.65146 4.3302 4.3302 4.65146 4.12886 5.0466C4.04079 5.21944 3.97419 5.45827 3.93786 5.90287C3.90068 6.35798 3.89998 6.94505 3.89998 7.79998V10.2C3.89998 11.0549 3.90068 11.642 3.93786 12.0971C3.97419 12.5417 4.04079 12.7805 4.12886 12.9534C4.3302 13.3485 4.65146 13.6698 5.0466 13.8711C5.21944 13.9592 5.45827 14.0258 5.90287 14.0621C6.35798 14.0993 6.94505 14.1 7.79998 14.1H8.1ZM11.0466 10.1289C11.2195 10.0408 11.4583 9.97421 11.9029 9.93788C12.358 9.9007 12.9451 9.9 13.8 9.9H16.2C17.0549 9.9 17.642 9.9007 18.0971 9.93788C18.5417 9.97421 18.7805 10.0408 18.9534 10.1289C19.3485 10.3302 19.6698 10.6515 19.8711 11.0466C19.9592 11.2195 20.0258 11.4583 20.0621 11.9029C20.0993 12.358 20.1 12.9451 20.1 13.8V16.2C20.1 17.0549 20.0993 17.642 20.0621 18.0971C20.0258 18.5417 19.9592 18.7805 19.8711 18.9534C19.6698 19.3485 19.3485 19.6698 18.9534 19.8711C18.7805 19.9592 18.5417 20.0258 18.0971 20.0621C17.642 20.0993 17.0549 20.1 16.2 20.1H13.8C12.9451 20.1 12.358 20.0993 11.9029 20.0621C11.4583 20.0258 11.2195 19.9592 11.0466 19.8711C10.6515 19.6698 10.3302 19.3485 10.1289 18.9534C10.0408 18.7805 9.97421 18.5417 9.93788 18.0971C9.9007 17.642 9.9 17.0549 9.9 16.2V13.8C9.9 12.9451 9.9007 12.358 9.93788 11.9029C9.97421 11.4583 10.0408 11.2195 10.1289 11.0466C10.3302 10.6515 10.6515 10.3302 11.0466 10.1289Z"></path></svg>'),E7=n=>{const t=Vi(),r=()=>n.fill||t.colors.icon.primary;return(()=>{const l=b7.cloneNode(!0),d=l.firstChild;return Yr(m=>{const x=n.class,C=r();return x!==m._v$&&vr(l,"class",m._v$=x),C!==m._v$2&&vr(d,"fill",m._v$2=C),m},{_v$:void 0,_v$2:void 0}),l})()},T7=ei('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.7624 3.10001C7.95435 3.1 7.29349 3.09999 6.75642 3.14387C6.2005 3.18929 5.69842 3.28617 5.22954 3.52508C4.4957 3.89899 3.89908 4.49561 3.52517 5.22944C3.28626 5.69833 3.18938 6.20041 3.14396 6.75632C3.10008 7.2934 3.10009 7.95424 3.1001 8.76229V15.2377C3.10009 16.0458 3.10008 16.7066 3.14396 17.2437C3.18938 17.7996 3.28626 18.3017 3.52517 18.7706C3.89908 19.5044 4.4957 20.101 5.22954 20.4749C5.69842 20.7138 6.2005 20.8107 6.75642 20.8561C7.29349 20.9 7.95434 20.9 8.76239 20.9H12.0001C12.4972 20.9 12.9001 20.4971 12.9001 20C12.9001 19.503 12.4972 19.1 12.0001 19.1H8.8001C7.94517 19.1 7.3581 19.0993 6.90299 19.0621C6.45839 19.0258 6.21956 18.9592 6.04672 18.8711C5.65158 18.6698 5.33032 18.3485 5.12898 17.9534C5.04092 17.7805 4.97431 17.5417 4.93798 17.0971C4.9008 16.642 4.9001 16.0549 4.9001 15.2V8.80001C4.9001 7.94508 4.9008 7.35801 4.93798 6.9029C4.97431 6.4583 5.04092 6.21947 5.12898 6.04663C5.33032 5.65149 5.65158 5.33023 6.04672 5.12889C6.21956 5.04082 6.45839 4.97422 6.90299 4.93789C7.3581 4.90071 7.94517 4.90001 8.8001 4.90001H12.0001C12.4972 4.90001 12.9001 4.49706 12.9001 4.00001C12.9001 3.50295 12.4972 3.10001 12.0001 3.10001H8.7624Z"></path><path d="M17.6364 7.3636C17.2849 7.01212 16.7151 7.01212 16.3636 7.3636C16.0121 7.71507 16.0121 8.28492 16.3636 8.63639L18.8272 11.1H9.00001C8.50295 11.1 8.10001 11.5029 8.10001 12C8.10001 12.497 8.50295 12.9 9.00001 12.9H18.8272L16.3636 15.3636C16.0121 15.7151 16.0121 16.2849 16.3636 16.6364C16.7151 16.9879 17.2849 16.9879 17.6364 16.6364L21.6364 12.6364C21.9879 12.2849 21.9879 11.7151 21.6364 11.3636L17.6364 7.3636Z"></path></svg>'),C7=n=>{const t=Vi(),r=()=>n.fill||t.colors.icon.primary;return(()=>{const l=T7.cloneNode(!0),d=l.firstChild,m=d.nextSibling;return Yr(x=>{const C=r(),a=r();return C!==x._v$&&vr(d,"fill",x._v$=C),a!==x._v$2&&vr(m,"fill",x._v$2=a),x},{_v$:void 0,_v$2:void 0}),l})()},S7={m:"8px",s:"4px",none:"0"},k7={m:"16px",s:"8px",none:"0"},M7=jt.div`
    width: 256px;
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.16);
    border-radius: ${n=>k7[n.theme.borderRadius]};

    background-color: ${n=>n.theme.colors.background.primary}
           
    color: ${n=>n.theme.colors.text.primary}
`,A7=jt.ul`
    background-color: ${n=>n.theme.colors.background.primary};
    padding: 8px;
`,X5=jt.button`
    display: flex;
    align-items: center;
    gap: 8px;
    height: 40px;
    padding-left: 8px;
    width: 100%;

    background-color: ${n=>n.theme.colors.background.primary};
    border: none;
    border-radius: ${n=>S7[n.theme.borderRadius]};
    cursor: pointer;

    transition: background-color, transform 0.1s ease-in-out;

    &:hover {
        background-color: ${n=>n.theme.colors.background.secondary};
    }

    &:active {
        transform: scale(0.96);
    }
`,Y5=ei("<li></li>"),Bv=n=>he(Xa,{get translationKey(){return n.translationKey},fontSize:"15px",fontWeight:"590",get children(){return n.children}}),P7=n=>{const t=ca(Ld),[r,l]=Ir(!1),d=()=>bi(void 0,null,function*(){const x=kC(t.account.address,t.account.chain===I_.TESTNET);yield Nw(x),l(!0),setTimeout(()=>l(!1),1e3)}),m=()=>{t.disconnect(),n.onClose()};return he(M7,{ref(x){const C=n.ref;typeof C=="function"?C(x):n.ref=x},get class(){return n.class},"data-tc-dropdown":"true",get children(){return he(A7,{get children(){return[(()=>{const x=Y5.cloneNode(!0);return Ws(x,he(X5,{onClick:()=>d(),get children(){return[he(E7,{}),he(jr,{get when(){return!r()},get children(){return he(Bv,{translationKey:"button.dropdown.copy",children:"Copy address"})}}),he(jr,{get when(){return r()},get children(){return he(Bv,{translationKey:"button.dropdown.copied",children:"Address copied!"})}})]}})),x})(),(()=>{const x=Y5.cloneNode(!0);return Ws(x,he(X5,{onClick:()=>m(),get children(){return[he(C7,{}),he(Bv,{translationKey:"button.dropdown.disconnect",children:"Disconnect"})]}})),x})()]}})}})},I7={m:"16px",s:"8px",none:"0"},L7=jt.div`
    width: 256px;
    padding: 12px 16px;
    display: flex;
    gap: 9px;

    background-color: ${n=>n.theme.colors.background.primary};
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.16);
    border-radius: ${n=>I7[n.theme.borderRadius]};
`,R7=jt.div`
    width: 192px;

    > h3 {
        font-size: 15px;
    }
`,O7=jt(Xa)`
    margin-top: 4px;
    color: ${n=>n.theme.colors.text.secondary};
`,$w=n=>{const t=X0(n);return he(L7,eu({get class(){return n.class},"data-tc-notification":"true"},t,{get children(){return[he(R7,{get children(){return[he(Fw,{get translationKey(){return n.header.translationKey},get translationValues(){return n.header.translationValues},get children(){return n.children}}),he(jr,{get when(){return n.text},get children(){return he(O7,{get translationKey(){return n.text.translationKey},get translationValues(){return n.text.translationValues}})}})]}}),qn(()=>n.icon)]}}))},D7=jt(_h)`
    align-self: center;
`,z7=n=>{const t=ca(Ld),[r]=fu(),l=()=>t.wallet&&"name"in t.wallet?t.wallet.name:r("common.yourWallet",{},"Your wallet");return he($w,{get header(){return{translationKey:"notifications.confirm.header",translationValues:{name:l()}}},get class(){return n.class},get icon(){return he(D7,{})},"data-tc-notification-confirm":"true",children:"Confirm operation in your wallet"})},B7=jt(by)`
    margin-top: 2px;
`,j7=n=>he($w,{header:{translationKey:"notifications.transactionCanceled.header"},text:{translationKey:"notifications.transactionCanceled.text"},get icon(){return he(B7,{size:"xs"})},get class(){return n.class},"data-tc-notification-tx-cancelled":"true",children:"Transaction cancelled"}),N7=jt(Uw)`
    margin-top: 2px;
`,F7=n=>he($w,{header:{translationKey:"notifications.transactionSent.header"},text:{translationKey:"notifications.transactionSent.text"},get icon(){return he(N7,{})},get class(){return n.class},"data-tc-notification-tx-sent":"true",children:"Transaction sent"}),jv=fh`
    transform: translateY(-8px);
    margin-bottom: 12px;
`,U7={timeout:4500},[J5,$7]=Ir(null);function V7(n){const{timeout:t}=Ai(Ai({},U7),n),[r,l]=Ir([]),[d,m]=Ir([]);return gs(KA(ah,x=>{var C;if(!x||!x.showNotification||J5()===x||((C=J5())==null?void 0:C.name)==="confirm-transaction"&&x.name==="confirm-transaction")return;$7(x),l(R=>R.filter(j=>j.action!=="confirm-transaction"));const a={action:x.name};l(R=>[...R,a]);const M=setTimeout(()=>{l(R=>R.filter(j=>j!==a)),m(R=>R.filter(j=>j!==M))},t);m(R=>[...R,M])})),la(()=>{d().forEach(x=>clearTimeout(x))}),r}const W7=ei('<div data-tc-list-notifications="true"></div>'),q7=n=>{const t=V7();return(()=>{const r=W7.cloneNode(!0);return Ws(r,he(PI,{onBeforeEnter:l=>{Jc(l,[{opacity:0,transform:"translateY(0)"},{opacity:1,transform:"translateY(-8px)"}],{duration:200})},onExit:(l,d)=>{Jc(l,[{opacity:1,transform:"translateY(-8px)"},{opacity:0,transform:"translateY(-30px)"}],{duration:200}).finished.then(d)},get children(){return he(q0,{get each(){return t()},children:l=>he(G0,{get children(){return[he(ks,{get when(){return l.action==="transaction-sent"},get children(){return he(F7,{class:jv})}}),he(ks,{get when(){return l.action==="transaction-canceled"},get children(){return he(j7,{class:jv})}}),he(ks,{get when(){return l.action==="confirm-transaction"},get children(){return he(z7,{class:jv})}})]}})})}})),Yr(()=>Aw(r,n.class)),r})()},pS=jt(jo)`
    background-color: ${n=>n.theme.colors.connectButton.background};
    color: ${n=>n.theme.colors.connectButton.foreground};
    box-shadow: ${n=>`0 4px 24px ${Z0(n.theme.colors.constant.black,.16)}`};
    padding: 8px 16px 8px 12px;

    display: flex;
    align-items: center;
    gap: 4px;
    height: 40px;
`,G7=jt(pS)`
    padding: 12px 16px;
    min-width: 148px;
    justify-content: center;
    background-color: ${n=>n.theme.colors.background.primary};
`,Z7=jt(jo)`
    min-width: 148px;
    height: 40px;

    background-color: ${n=>n.theme.colors.background.primary};
    color: ${n=>n.theme.colors.connectButton.foreground};
    box-shadow: ${n=>`0 4px 24px ${Z0(n.theme.colors.constant.black,.16)}`};

    display: flex;
    align-items: center;
    justify-content: center;
`,H7=jt(_h)`
    height: 18px;
    width: 18px;
`,K7=jt.div`
    width: fit-content;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
`,X7=jt(P7)`
    box-sizing: border-box;
    overflow: hidden;
    margin-top: 12px;
`,Y7=jt(q7)`
    > div:first-child {
        margin-top: 20px;
    }
`;function mS(n){return n.split("-")[0]}function J7(n){return n.split("-")[1]}function Q7(n){return["top","bottom"].includes(mS(n))?"x":"y"}function eL(n){return n==="y"?"height":"width"}function Q5(n,t,r){let{reference:l,floating:d}=n;const m=l.x+l.width/2-d.width/2,x=l.y+l.height/2-d.height/2,C=Q7(t),a=eL(C),M=l[a]/2-d[a]/2,R=mS(t),j=C==="x";let F;switch(R){case"top":F={x:m,y:l.y-d.height};break;case"bottom":F={x:m,y:l.y+l.height};break;case"right":F={x:l.x+l.width,y:x};break;case"left":F={x:l.x-d.width,y:x};break;default:F={x:l.x,y:l.y}}switch(J7(t)){case"start":F[C]-=M*(r&&j?-1:1);break;case"end":F[C]+=M*(r&&j?-1:1);break}return F}const tL=(n,t,r)=>bi(void 0,null,function*(){const{placement:l="bottom",strategy:d="absolute",middleware:m=[],platform:x}=r,C=m.filter(Boolean),a=yield x.isRTL==null?void 0:x.isRTL(t);let M=yield x.getElementRects({reference:n,floating:t,strategy:d}),{x:R,y:j}=Q5(M,l,a),F=l,Z={},Y=0;for(let ne=0;ne<C.length;ne++){const{name:se,fn:xe}=C[ne],{x:Se,y:_e,data:Ie,reset:Me}=yield xe({x:R,y:j,initialPlacement:l,placement:F,strategy:d,middlewareData:Z,rects:M,platform:x,elements:{reference:n,floating:t}});if(R=Se??R,j=_e??j,Z=Ha(Ai({},Z),{[se]:Ai(Ai({},Z[se]),Ie)}),Me&&Y<=50){Y++,typeof Me=="object"&&(Me.placement&&(F=Me.placement),Me.rects&&(M=Me.rects===!0?yield x.getElementRects({reference:n,floating:t,strategy:d}):Me.rects),{x:R,y:j}=Q5(M,F,a)),ne=-1;continue}}return{x:R,y:j,placement:F,strategy:d,middlewareData:Z}});function e4(n){return Ha(Ai({},n),{top:n.y,left:n.x,right:n.x+n.width,bottom:n.y+n.height})}function yh(n){var t;return((t=n.ownerDocument)==null?void 0:t.defaultView)||window}function su(n){return yh(n).getComputedStyle(n)}function kd(n){return _S(n)?(n.nodeName||"").toLowerCase():""}let Q1;function gS(){if(Q1)return Q1;const n=navigator.userAgentData;return n&&Array.isArray(n.brands)?(Q1=n.brands.map(t=>t.brand+"/"+t.version).join(" "),Q1):navigator.userAgent}function au(n){return n instanceof yh(n).HTMLElement}function vl(n){return n instanceof yh(n).Element}function _S(n){return n instanceof yh(n).Node}function t4(n){if(typeof ShadowRoot>"u")return!1;const t=yh(n).ShadowRoot;return n instanceof t||n instanceof ShadowRoot}function Ey(n){const{overflow:t,overflowX:r,overflowY:l,display:d}=su(n);return/auto|scroll|overlay|hidden/.test(t+l+r)&&!["inline","contents"].includes(d)}function nL(n){return["table","td","th"].includes(kd(n))}function Vw(n){const t=/firefox/i.test(gS()),r=su(n),l=r.backdropFilter||r.WebkitBackdropFilter;return r.transform!=="none"||r.perspective!=="none"||(l?l!=="none":!1)||t&&r.willChange==="filter"||t&&(r.filter?r.filter!=="none":!1)||["transform","perspective"].some(d=>r.willChange.includes(d))||["paint","layout","strict","content"].some(d=>{const m=r.contain;return m!=null?m.includes(d):!1})}function yS(){return!/^((?!chrome|android).)*safari/i.test(gS())}function Ww(n){return["html","body","#document"].includes(kd(n))}const n4=Math.min,f0=Math.max,r4=Math.round,Ix={x:1,y:1};function P0(n){const t=!vl(n)&&n.contextElement?n.contextElement:vl(n)?n:null;if(!t)return Ix;const r=t.getBoundingClientRect(),l=su(t);if(l.boxSizing!=="border-box")return au(t)?{x:t.offsetWidth>0&&r4(r.width)/t.offsetWidth||1,y:t.offsetHeight>0&&r4(r.height)/t.offsetHeight||1}:Ix;let d=r.width/parseFloat(l.width),m=r.height/parseFloat(l.height);return(!d||!Number.isFinite(d))&&(d=1),(!m||!Number.isFinite(m))&&(m=1),{x:d,y:m}}function Md(n,t,r,l){var d,m,x,C;t===void 0&&(t=!1),r===void 0&&(r=!1);const a=n.getBoundingClientRect();let M=Ix;t&&(l?vl(l)&&(M=P0(l)):M=P0(n));const R=vl(n)?yh(n):window,j=!yS()&&r,F=(a.left+(j&&(d=(m=R.visualViewport)==null?void 0:m.offsetLeft)!=null?d:0))/M.x,Z=(a.top+(j&&(x=(C=R.visualViewport)==null?void 0:C.offsetTop)!=null?x:0))/M.y,Y=a.width/M.x,ne=a.height/M.y;return{width:Y,height:ne,top:Z,right:F+Y,bottom:Z+ne,left:F,x:F,y:Z}}function Rd(n){return((_S(n)?n.ownerDocument:n.document)||window.document).documentElement}function Ty(n){return vl(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.pageXOffset,scrollTop:n.pageYOffset}}function vS(n){return Md(Rd(n)).left+Ty(n).scrollLeft}function rL(n,t,r){const l=au(t),d=Rd(t),m=Md(n,!0,r==="fixed",t);let x={scrollLeft:0,scrollTop:0};const C={x:0,y:0};if(l||!l&&r!=="fixed")if((kd(t)!=="body"||Ey(d))&&(x=Ty(t)),au(t)){const a=Md(t,!0);C.x=a.x+t.clientLeft,C.y=a.y+t.clientTop}else d&&(C.x=vS(d));return{x:m.left+x.scrollLeft-C.x,y:m.top+x.scrollTop-C.y,width:m.width,height:m.height}}function I0(n){if(kd(n)==="html")return n;const t=n.assignedSlot||n.parentNode||(t4(n)?n.host:null)||Rd(n);return t4(t)?t.host:t}function i4(n){return!au(n)||su(n).position==="fixed"?null:n.offsetParent}function iL(n){let t=I0(n);for(;au(t)&&!Ww(t);){if(Vw(t))return t;t=I0(t)}return null}function o4(n){const t=yh(n);let r=i4(n);for(;r&&nL(r)&&su(r).position==="static";)r=i4(r);return r&&(kd(r)==="html"||kd(r)==="body"&&su(r).position==="static"&&!Vw(r))?t:r||iL(n)||t}function oL(n){if(au(n))return{width:n.offsetWidth,height:n.offsetHeight};const t=Md(n);return{width:t.width,height:t.height}}function sL(n){let{rect:t,offsetParent:r,strategy:l}=n;const d=au(r),m=Rd(r);if(r===m)return t;let x={scrollLeft:0,scrollTop:0},C={x:1,y:1};const a={x:0,y:0};if((d||!d&&l!=="fixed")&&((kd(r)!=="body"||Ey(m))&&(x=Ty(r)),au(r))){const M=Md(r);C=P0(r),a.x=M.x+r.clientLeft,a.y=M.y+r.clientTop}return{width:t.width*C.x,height:t.height*C.y,x:t.x*C.x-x.scrollLeft*C.x+a.x,y:t.y*C.y-x.scrollTop*C.y+a.y}}function aL(n,t){const r=yh(n),l=Rd(n),d=r.visualViewport;let m=l.clientWidth,x=l.clientHeight,C=0,a=0;if(d){m=d.width,x=d.height;const M=yS();(M||!M&&t==="fixed")&&(C=d.offsetLeft,a=d.offsetTop)}return{width:m,height:x,x:C,y:a}}function lL(n){var t;const r=Rd(n),l=Ty(n),d=(t=n.ownerDocument)==null?void 0:t.body,m=f0(r.scrollWidth,r.clientWidth,d?d.scrollWidth:0,d?d.clientWidth:0),x=f0(r.scrollHeight,r.clientHeight,d?d.scrollHeight:0,d?d.clientHeight:0);let C=-l.scrollLeft+vS(n);const a=-l.scrollTop;return su(d||r).direction==="rtl"&&(C+=f0(r.clientWidth,d?d.clientWidth:0)-m),{width:m,height:x,x:C,y:a}}function xS(n){const t=I0(n);return Ww(t)?n.ownerDocument.body:au(t)&&Ey(t)?t:xS(t)}function p0(n,t){var r;t===void 0&&(t=[]);const l=xS(n),d=l===((r=n.ownerDocument)==null?void 0:r.body),m=yh(l);return d?t.concat(m,m.visualViewport||[],Ey(l)?l:[]):t.concat(l,p0(l))}function cL(n,t){const r=Md(n,!0,t==="fixed"),l=r.top+n.clientTop,d=r.left+n.clientLeft,m=au(n)?P0(n):{x:1,y:1},x=n.clientWidth*m.x,C=n.clientHeight*m.y,a=d*m.x,M=l*m.y;return{top:M,left:a,right:a+x,bottom:M+C,x:a,y:M,width:x,height:C}}function s4(n,t,r){return t==="viewport"?e4(aL(n,r)):vl(t)?cL(t,r):e4(lL(Rd(n)))}function uL(n,t){const r=t.get(n);if(r)return r;let l=p0(n).filter(C=>vl(C)&&kd(C)!=="body"),d=null;const m=su(n).position==="fixed";let x=m?I0(n):n;for(;vl(x)&&!Ww(x);){const C=su(x),a=Vw(x);(m?!a&&!d:!a&&C.position==="static"&&!!d&&["absolute","fixed"].includes(d.position))?l=l.filter(R=>R!==x):d=C,x=I0(x)}return t.set(n,l),l}function hL(n){let{element:t,boundary:r,rootBoundary:l,strategy:d}=n;const x=[...r==="clippingAncestors"?uL(t,this._c):[].concat(r),l],C=x[0],a=x.reduce((M,R)=>{const j=s4(t,R,d);return M.top=f0(j.top,M.top),M.right=n4(j.right,M.right),M.bottom=n4(j.bottom,M.bottom),M.left=f0(j.left,M.left),M},s4(t,C,d));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}const dL={getClippingRect:hL,convertOffsetParentRelativeRectToViewportRelativeRect:sL,isElement:vl,getDimensions:oL,getOffsetParent:o4,getDocumentElement:Rd,getScale:P0,getElementRects(n){return bi(this,null,function*(){let{reference:t,floating:r,strategy:l}=n;const d=this.getOffsetParent||o4,m=this.getDimensions;return{reference:rL(t,yield d(r),l),floating:Ai({x:0,y:0},yield m(r))}})},getClientRects:n=>Array.from(n.getClientRects()),isRTL:n=>su(n).direction==="rtl"};function fL(n,t,r,l){l===void 0&&(l={});const{ancestorScroll:d=!0,ancestorResize:m=!0,elementResize:x=!0,animationFrame:C=!1}=l,a=d&&!C,M=a||m?[...vl(n)?p0(n):n.contextElement?p0(n.contextElement):[],...p0(t)]:[];M.forEach(Y=>{a&&Y.addEventListener("scroll",r,{passive:!0}),m&&Y.addEventListener("resize",r)});let R=null;if(x){let Y=!0;R=new ResizeObserver(()=>{Y||r(),Y=!1}),vl(n)&&!C&&R.observe(n),!vl(n)&&n.contextElement&&!C&&R.observe(n.contextElement),R.observe(t)}let j,F=C?Md(n):null;C&&Z();function Z(){const Y=Md(n);F&&(Y.x!==F.x||Y.y!==F.y||Y.width!==F.width||Y.height!==F.height)&&r(),F=Y,j=requestAnimationFrame(Z)}return r(),()=>{var Y;M.forEach(ne=>{a&&ne.removeEventListener("scroll",r),m&&ne.removeEventListener("resize",r)}),(Y=R)==null||Y.disconnect(),R=null,C&&cancelAnimationFrame(j)}}const pL=(n,t,r)=>{const l=new Map,d=Ai({platform:dL},r),m=Ha(Ai({},d.platform),{_c:l});return tL(n,t,Ha(Ai({},d),{platform:m}))};function mL(n,t,r){let l=()=>{var j;return(j=r?.placement)!=null?j:"bottom"},d=()=>{var j;return(j=r?.strategy)!=null?j:"absolute"},[m,x]=Ir({x:null,y:null,placement:l(),strategy:d(),middlewareData:{}}),[C,a]=Ir();gs(()=>{let j=C();if(j)throw j.value});let M=qn(()=>(n(),t(),{}));function R(){let j=n(),F=t();if(j&&F){let Z=M();pL(j,F,{middleware:r?.middleware,placement:l(),strategy:d()}).then(Y=>{Z===M()&&x(Y)},Y=>{a(Y)})}}return gs(()=>{let j=n(),F=t();if(l(),d(),j&&F)if(r!=null&&r.whileElementsMounted){let Z=r.whileElementsMounted(j,F,R);Z&&la(Z)}else R()}),{get x(){return m().x},get y(){return m().y},get placement(){return m().placement},get strategy(){return m().strategy},get middlewareData(){return m().middlewareData},update:R}}const gL=ei('<tc-root data-tc-dropdown-container="true"></tc-root>'),_L=()=>{const n=Vi(),t=ca(Wm),r=ca(Ld),[l,d]=Ir(!1),[m,x]=Ir(t.account),[C,a]=Ir(!t.account);let M;const[R,j]=Ir(),[F,Z]=Ir(),Y=mL(F,R,{whileElementsMounted:fL,placement:"bottom-end"}),ne=()=>{const Se=m();if(Se){const _e=kC(Se.address,Se.chain===I_.TESTNET);return _e.slice(0,4)+"…"+_e.slice(-4)}return""};r.connectionRestored.then(()=>a(!1));const se=t.onStatusChange(Se=>{if(!Se){d(!1),x(null),a(!1);return}x(Se.account),a(!1)}),xe=Se=>{if(!m()||!l())return;const _e=F().contains(Se.target),Ie=M.contains(Se.target);!_e&&!Ie&&d(!1)};return XA(()=>{document.body.addEventListener("click",xe)}),la(()=>{document.body.removeEventListener("click",xe),se()}),he(Rm,{component:oh,get children(){return[he(jr,{get when(){return C()},get children(){return he(Z7,{disabled:!0,"data-tc-connect-button-loading":"true",get children(){return he(H7,{})}})}}),he(jr,{get when(){return!C()},get children(){return[he(jr,{get when(){return!m()},get children(){return he(pS,{onClick:()=>r.openModal(),"data-tc-connect-button":"true",scale:"s",get children(){return[he(P9,{get fill(){return n.colors.connectButton.foreground}}),he(Xa,{translationKey:"button.connectWallet",fontSize:"15px",lineHeight:"18px",fontWeight:"590",get color(){return n.colors.connectButton.foreground},children:"Connect wallet"})]}})}}),he(jr,{get when(){return m()},get children(){return he(K7,{get children(){return[he(G7,{onClick:()=>d(Se=>!Se),ref:Z,"data-tc-dropdown-button":"true",scale:"s",get children(){return[he(Xa,{fontSize:"15px",fontWeight:"590",lineHeight:"18px",get children(){return ne()}}),he(rS,{direction:"bottom"})]}}),he(UC,{get children(){const Se=_s(()=>document.importNode(gL,!0));return h0(j,Se),Se.style.setProperty("z-index","999"),Se._$owner=YA(),Ws(Se,he(jw,{onBeforeEnter:_e=>{Jc(_e,[{opacity:0,transform:"translateY(-8px)"},{opacity:1,transform:"translateY(0)"}],{duration:150})},onExit:(_e,Ie)=>{Jc(_e,[{opacity:1,transform:"translateY(0)"},{opacity:0,transform:"translateY(-8px)"}],{duration:150}).finished.then(Ie)},get children(){return he(jr,{get when(){return l()},get children(){return he(X7,{get hidden(){return!l()},onClose:()=>d(!1),ref(_e){const Ie=M;typeof Ie=="function"?Ie(_e):M=_e}})}})}}),null),Ws(Se,he(Y7,{}),null),Yr(_e=>{var Ie,Me;const Ve=Y.strategy,Ke=`${(Ie=Y.y)!=null?Ie:0}px`,et=`${(Me=Y.x)!=null?Me:0}px`;return Ve!==_e._v$&&Se.style.setProperty("position",_e._v$=Ve),Ke!==_e._v$2&&Se.style.setProperty("top",_e._v$2=Ke),et!==_e._v$3&&Se.style.setProperty("left",_e._v$3=et),_e},{_v$:void 0,_v$2:void 0,_v$3:void 0}),Se}})]}})}})]}})]}})},wS=jt(oS)`
    padding-left: 24px;
    padding-right: 24px;
    padding-top: 18px;
    padding-bottom: 0;

    ${Ya("mobile")} {
        padding-left: 0;
        padding-right: 0;

        min-height: 364px;
    }
`,bS=jt(pu)`
    margin-top: 12px;

    ${Ya("mobile")} {
        padding: 0 10px;
    }
`,ES=jt.div`
    margin: 30px 0;
    width: 100%;
    display: flex;
    justify-content: center;

    ${Ya("mobile")} {
        height: 160px;
        align-items: center;
    }
`;jt(Xa)`
    min-width: 84px;
    text-align: center;
    font-weight: 590;
`;jt(t9)`
    margin: 0 auto 22px;
`;const[mi,e_]=Dw({buttonRootId:null,language:"en",returnStrategy:"back",twaReturnUrl:void 0,walletsListConfiguration:{},enableAndroidBackHandler:!0});function yL(n){return[...new Set(n)]}function vL(n,t,r){return t.map(l=>{const d=r.find(m=>m[n]===l[n]);return r=r.filter(m=>m[n]!==l[n]),d===void 0?l:d}).concat(r)}function xL(n){return"jsBridgeKey"in n?Ha(Ai({},n),{injected:rp.isWalletInjected(n.jsBridgeKey),embedded:rp.isInsideWalletBrowser(n.jsBridgeKey)}):n}function qw(n,t){var r;return t&&(r=t.includeWallets)!=null&&r.length&&(n=vL("name",n,t.includeWallets.map(xL))),n}function a4(n){return n.platforms.some(t=>["macos","linux","windows"].includes(t))}function m0(n){return n.platforms.some(t=>["ios","android"].includes(t))}function l4(n){return n.platforms.some(t=>["chrome","firefox","safari"].includes(t))}function pd(n,t){return t?n.name.toLowerCase()===t.toLowerCase()||n.appName.toLowerCase()===t.toLowerCase():!1}const wL=jt.div`
    display: flex;
    flex-direction: column;
    align-items: center;
`,bL=jt(pu)`
    margin-bottom: 18px;
`;jt.div`
    height: 1px;
    margin: 0 -24px;
    width: calc(100% + 48px);
    opacity: 0.12;
    background: ${n=>n.isShown?n.theme.colors.icon.secondary:"transparent"};
    transition: background 0.15s ease-in-out;

    ${Ya("mobile")} {
        width: 100%;
    }
`;const EL=jt.ul`
    display: grid;
    grid-template-columns: repeat(auto-fit, 92px);
    grid-template-rows: auto;
    align-content: flex-start;
    justify-content: center;
    row-gap: 8px;
    width: 100%;
    padding: 0 0 16px;
    align-self: flex-start;
    max-width: 400px;
    margin: 0 auto;

    > li {
        display: block;
        height: fit-content;
    }

    ${Ya("mobile")} {
        grid-template-columns: repeat(auto-fit, 82px);
    }
`;jt(jo)`
    display: block;
    margin: 0 auto 1px;
    font-size: 15px;
`;const TL=jt(sp)`
    position: absolute;
    top: 16px;
    left: 16px;
`,CL=jt(dS)`
    height: 100%;
`,SL=ei("<li></li>"),kL=n=>{const t=()=>Dm()?void 0:510,r=()=>Dm()?n.walletsList.filter(m0):n.walletsList;return he(wL,{"data-tc-wallets-modal-list":"true",get children(){return[he(TL,{icon:"arrow",onClick:()=>n.onBack()}),he(bL,{translationKey:"walletModal.wallets",children:"Wallets"}),he(fS,{get maxHeight(){return t()},get children(){return he(EL,{get children(){return he(q0,{get each(){return r()},children:l=>(()=>{const d=SL.cloneNode(!0);return Ws(d,he(CL,{wallet:l,onClick:()=>n.onSelect(l)})),d})()})}})}})]}})},ML={m:"16px",s:"12px",none:"0"},AL={m:"6px",s:"6px",none:"0"},PL=jt.div`
    display: flex;
    flex-direction: column;
`,IL=jt.div`
    flex: 1;
    margin-top: ${n=>n.qr?"0":"18px"};
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 232px;
`,LL=jt(wy)`
    margin-bottom: 24px;
`,RL=jt(pu)`
    max-width: 288px;
    margin: 0 auto 2px;
`,OL=jt(Id)`
    max-width: 288px;
    text-align: center;
    margin: 0 auto 20px;
`,DL=jt(sp)`
    position: absolute;
    top: 16px;
    left: 16px;
`,r0=jt.div`
    display: flex;
    justify-content: center;
    gap: 8px;
    padding-bottom: 16px;
`,zL=jt(r0)`
    padding-bottom: 0;
`,Nv=jt(jo)`
    margin-bottom: 24px;
`,BL=jt(_h)`
    margin-bottom: 18px;
    margin-top: 2px;
`,jL=jt(by)`
    margin-bottom: 16px;
`,t_=jt(Id)`
    color: ${n=>n.theme.colors.text.secondary};
    text-align: center;
    margin-bottom: 20px;
`,NL=jt(jo)`
    margin-top: -8px;
    margin-bottom: 24px;
    width: 100%;
    padding: 12px 12px 12px 20px;
    border-radius: ${n=>ML[n.theme.borderRadius]};
    font-size: 16px;
    line-height: 20px;
`,FL=jt(op)`
    width: 32px;
    height: 32px;
    border-radius: ${n=>AL[n.theme.borderRadius]};
`,ms=n=>{const[t]=fu();return qn(()=>{var r;return t(n.translationKey,n.translationValues,(r=n.children)==null?void 0:r.toString())})};function Li(n,t){let r;typeof t=="string"?r=t:r=ph()?t.twaReturnUrl||t.returnStrategy:"none";const l=UL(n,"ret",r);if(!Yf(n))return l;const d=l.slice(l.lastIndexOf("&")+1);return l.slice(0,l.lastIndexOf("&"))+"-"+uC(d)}function J0(n,t){t=Ai({},t);const r=$L(n),l=new URL(r);if(l.searchParams.has("startapp")||l.searchParams.append("startapp","tonconnect"),ph())ch("ios","android","macos")?(t.returnStrategy="back",t.twaReturnUrl=void 0,t0(Li(l.toString(),t))):ch("tdesktop")||ch("weba")?t0(Li(l.toString(),t)):ch("web")?(t.returnStrategy="back",t.twaReturnUrl=void 0,t0(Li(l.toString(),t))):so(Li(l.toString(),t));else if(Yc("ios")){t.returnStrategy==="back"&&(Xr("safari")?t.returnStrategy="back":Xr("chrome")?t.returnStrategy="googlechrome://":Xr("firefox")?t.returnStrategy="firefox://":Xr("opera")?t.returnStrategy="opera-http://":t.returnStrategy=location.href);const d=Xr("chrome"),m=Xr("firefox");if((d||m)&&!t.forceRedirect){const C=Li(l.toString(),t.returnStrategy),a=n_(C);gd(a,()=>so(C))}else{const C=Li(l.toString(),t.returnStrategy);so(C)}}else if(Yc("android")){t.returnStrategy="none";const d=Xr("chrome"),m=Xr("firefox");if((d||m)&&!t.forceRedirect){const C=Li(l.toString(),t.returnStrategy),a=n_(C);gd(a,()=>so(C))}else{const C=Li(l.toString(),t.returnStrategy);so(C)}}else if(Yc("ipad")){t.returnStrategy==="back"&&(Xr("safari")?t.returnStrategy="back":Xr("chrome")?t.returnStrategy="googlechrome://":Xr("firefox")?t.returnStrategy="firefox://":Xr("opera")?t.returnStrategy="opera-http://":t.returnStrategy=location.href);const d=Xr("chrome"),m=Xr("firefox");if((d||m)&&!t.forceRedirect){const C=Li(l.toString(),t.returnStrategy),a=n_(C);gd(a,()=>so(C))}else{const C=Li(l.toString(),t.returnStrategy);so(C)}}else if(Yc("macos","windows","linux"))if(t.returnStrategy="none",t.twaReturnUrl=void 0,t.forceRedirect)so(Li(l.toString(),t));else{const d=Li(l.toString(),t),m=n_(d);gd(m,()=>so(d))}else so(Li(l.toString(),t))}function Q0(n,t,r,l){if(r=Ai({},r),ph())if(ch("ios","android")){r.returnStrategy==="back"&&(r.returnStrategy="tg://resolve"),l("universal-link");const d=Li(n,r.returnStrategy);t0(d,()=>{l("universal-link"),so(d)})}else if(ch("macos","tdesktop")){r.returnStrategy==="back"&&(r.returnStrategy="tg://resolve");const d=Li(n,r.returnStrategy);!!t&&!r.forceRedirect?(l("custom-deeplink"),gd(Y1(d,t),()=>{l("universal-link"),so(d)})):(l("universal-link"),so(d))}else if(ch("weba")){r.returnStrategy==="back"&&(Xr("safari")?r.returnStrategy=location.href:Xr("chrome")?r.returnStrategy="googlechrome://":Xr("firefox")?r.returnStrategy="firefox://":Xr("opera")?r.returnStrategy="opera-http://":r.returnStrategy=location.href);const d=Li(n,r.returnStrategy);!!t&&!r.forceRedirect?(l("custom-deeplink"),gd(Y1(d,t),()=>{l("universal-link"),so(d)})):(l("universal-link"),so(d))}else if(ch("web")){r.returnStrategy==="back"&&(Xr("safari")?r.returnStrategy=location.href:Xr("chrome")?r.returnStrategy="googlechrome://":Xr("firefox")?r.returnStrategy="firefox://":Xr("opera")?r.returnStrategy="opera-http://":r.returnStrategy=location.href);const d=Li(n,r.returnStrategy);!!t&&!r.forceRedirect?(l("custom-deeplink"),gd(Y1(d,t),()=>{l("universal-link"),so(d)})):(l("universal-link"),so(d))}else{l("universal-link");const d=Li(n,r.returnStrategy);so(d)}else if(Yc("ios"))r.returnStrategy==="back"&&(Xr("safari")?r.returnStrategy="none":Xr("chrome")?r.returnStrategy="googlechrome://":Xr("firefox")?r.returnStrategy="firefox://":Xr("opera")?r.returnStrategy="opera-http://":r.returnStrategy=location.href),Xr("chrome")?(l("universal-link"),F_(Li(n,r.returnStrategy),"_self")):(l("universal-link"),so(Li(n,r.returnStrategy)));else if(Yc("android"))r.returnStrategy==="back"&&(Xr("chrome")?r.returnStrategy="googlechrome://":Xr("firefox")?r.returnStrategy="firefox://":Xr("opera")?r.returnStrategy="opera-http://":r.returnStrategy=location.href),l("universal-link"),so(Li(n,r.returnStrategy));else if(Yc("ipad"))r.returnStrategy==="back"&&(Xr("safari")?r.returnStrategy="none":Xr("chrome")?r.returnStrategy="googlechrome://":Xr("firefox")?r.returnStrategy="firefox://":Xr("opera")?r.returnStrategy="opera-http://":r.returnStrategy=location.href),Xr("chrome")?(l("universal-link"),F_(Li(n,r.returnStrategy),"_self")):(l("universal-link"),so(Li(n,r.returnStrategy)));else if(Yc("macos","windows","linux")){r.returnStrategy==="back"&&(Xr("safari")?r.returnStrategy="none":Xr("chrome")?r.returnStrategy="googlechrome://":Xr("firefox")?r.returnStrategy="firefox://":Xr("opera")?r.returnStrategy="opera-http://":r.returnStrategy="none");const d=Li(n,r.returnStrategy);!!t&&!r.forceRedirect?(l("custom-deeplink"),gd(Y1(d,t),()=>{l("universal-link"),so(d)})):(l("universal-link"),so(d))}else l("universal-link"),so(Li(n,r.returnStrategy))}function UL(n,t,r){const l=new URL(n);return l.searchParams.append(t,r),l.toString()}function $L(n){const t=new URL(n);return t.searchParams.has("attach")&&(t.searchParams.delete("attach"),t.pathname+="/start"),t.toString()}function n_(n){const t=new URL(n),[,r,l]=t.pathname.split("/"),d=t.searchParams.get("startapp");return`tg://resolve?domain=${r}&appname=${l}&startapp=${d}`}const TS=n=>{const[t,r]=Ir("mobile"),[l,d]=Ir(!1),[m,x]=Ir(),[C,a]=Ir(!0),M=ca(Wm),R=M.onStatusChange(()=>{},()=>{n.wallet.appName!==dh&&d(!0)});la(R);const j=()=>{try{const se=M.connect({universalLink:n.wallet.universalLink,bridgeUrl:n.wallet.bridgeUrl},n.additionalRequest);x(se)}catch{}};gs(()=>{_s(t)!=="extension"&&(m0(n.wallet)||a4(n.wallet))&&j()});const F=()=>{d(!1),t()==="extension"&&j(),r("mobile"),Ms(Ha(Ai({},n.wallet),{openMethod:"qrcode"}))},Z=()=>{d(!1),t()==="extension"&&j(),r("desktop");const se=!C();a(!1),Q0(m(),n.wallet.deepLink,{returnStrategy:mi.returnStrategy,forceRedirect:se},xe=>{Ms(Ha(Ai({},n.wallet),{openMethod:xe}))})},Y=()=>{const se=!C();a(!1),Ms(Ha(Ai({},n.wallet),{openMethod:"universal-link"})),J0(m(),{returnStrategy:mi.returnStrategy,twaReturnUrl:mi.twaReturnUrl,forceRedirect:se})},ne=()=>{d(!1),r("extension"),Jf(n.wallet)&&(Ms(n.wallet),M.connect({jsBridgeKey:n.wallet.jsBridgeKey},n.additionalRequest))};return m0(n.wallet)?F():l4(n.wallet)?ne():Z(),he(PL,{"data-tc-wallets-modal-connection-desktop":"true",get children(){return[he(jr,{get when(){return!n.backDisabled},get children(){return he(DL,{icon:"arrow",onClick:()=>n.onBackClick()})}}),he(RL,{get children(){return n.wallet.name}}),he(jr,{get when(){return t()==="mobile"},get children(){return he(OL,{translationKey:"walletModal.desktopConnectionModal.scanQR",get translationValues(){return{name:n.wallet.name}},get children(){return["Scan the QR code below with your phone’s or ",qn(()=>n.wallet.name),"’s camera"]}})}}),he(IL,{get qr(){return t()==="mobile"},get children(){return he(G0,{get children(){return[he(ks,{get when(){return t()==="mobile"},get children(){return he(LL,{disableCopy:!1,get sourceUrl(){return Li(m(),"none")},get imageUrl(){return n.wallet.imageUrl}})}}),he(ks,{get when(){return l()},get children(){return[he(jL,{size:"s"}),he(t_,{translationKey:"walletModal.desktopConnectionModal.connectionDeclined",children:"Connection declined"}),he(r0,{get children(){return he(jo,{get leftIcon(){return he(d0,{})},get onClick(){return t()==="extension"?ne:Z},get children(){return he(ms,{translationKey:"common.retry",children:"Retry"})}})}})]}}),he(ks,{get when(){return t()==="extension"},get children(){return[he(jr,{get when(){return Jf(n.wallet)},get children(){return[he(BL,{size:"s"}),he(t_,{translationKey:"walletModal.desktopConnectionModal.continueInExtension",get translationValues(){return{name:n.wallet.name}},get children(){return["Continue in ",qn(()=>n.wallet.name)," browser extension…"]}}),he(r0,{get children(){return he(jo,{get leftIcon(){return he(d0,{})},onClick:ne,get children(){return he(ms,{translationKey:"common.retry",children:"Retry"})}})}})]}}),he(jr,{get when(){return!Jf(n.wallet)},get children(){return[he(t_,{translationKey:"walletModal.desktopConnectionModal.dontHaveExtension",get translationValues(){return{name:n.wallet.name}},get children(){return["Seems you don't have installed ",qn(()=>n.wallet.name)," browser extension"]}}),he(r0,{get children(){return he(K_,{get href(){return n.wallet.aboutUrl},blank:!0,get children(){return he(jo,{get rightIcon(){return he(K5,{})},onClick:ne,get children(){return he(ms,{translationKey:"walletModal.desktopConnectionModal.getWallet",get translationValues(){return{name:n.wallet.name}},get children(){return["Get ",qn(()=>n.wallet.name)]}})}})}})}})]}})]}}),he(ks,{get when(){return t()==="desktop"},get children(){return[he(_h,{size:"m"}),he(t_,{translationKey:"walletModal.desktopConnectionModal.continueOnDesktop",get translationValues(){return{name:n.wallet.name}},get children(){return["Continue in ",qn(()=>n.wallet.name)," on desktop…"]}}),he(r0,{get children(){return[he(jo,{get leftIcon(){return he(d0,{})},onClick:Z,get children(){return he(ms,{translationKey:"common.retry",children:"Retry"})}}),he(K_,{get href(){return n.wallet.aboutUrl},blank:!0,get children(){return he(jo,{get rightIcon(){return he(K5,{})},get children(){return he(ms,{translationKey:"walletModal.desktopConnectionModal.getWallet",get translationValues(){return{name:n.wallet.name}},get children(){return["Get ",qn(()=>n.wallet.name)]}})}})}})]}})]}})]}})}}),he(jr,{get when(){return n.wallet.appName===dh},get children(){return he(NL,{get rightIcon(){return he(FL,{get src(){return Y0.TG}})},scale:"s",onClick:Y,get children(){return he(ms,{translationKey:"walletModal.desktopConnectionModal.openWalletOnTelegram",children:"Open Wallet in Telegram on desktop"})}})}}),he(jr,{get when(){return n.wallet.appName!==dh},get children(){return he(zL,{get children(){return[he(jr,{get when(){return qn(()=>t()!=="mobile")()&&m0(n.wallet)},get children(){return he(Nv,{appearance:"secondary",get leftIcon(){return he(Z9,{})},onClick:F,get children(){return he(ms,{translationKey:"common.mobile",children:"Mobile"})}})}}),he(jr,{get when(){return qn(()=>t()!=="extension")()&&l4(n.wallet)},get children(){return he(Nv,{appearance:"secondary",get leftIcon(){return he(q9,{})},onClick:ne,get children(){return he(ms,{translationKey:"common.browserExtension",children:"Browser Extension"})}})}}),he(jr,{get when(){return qn(()=>t()!=="desktop")()&&a4(n.wallet)},get children(){return he(Nv,{appearance:"secondary",get leftIcon(){return he(K9,{})},onClick:Z,get children(){return he(ms,{translationKey:"common.desktop",children:"Desktop"})}})}})]}})}})]}})},VL=jt.div``,WL=jt(sp)`
    position: absolute;
    top: 16px;
    left: 16px;
`,qL=jt(pu)`
    margin-bottom: 18px;
`,Fv=jt.div`
    padding: 16px 0;
    display: flex;
    flex-direction: column;
    align-items: center;
`,Uv=fh`
    margin-bottom: 12px;
`,$v=jt(Fw)`
    text-align: center;
    margin-bottom: 4px;
`,Vv=jt(Xa)`
    text-align: center;
    max-width: 352px;
    color: ${n=>n.theme.colors.text.secondary};
`,GL=jt.div`
    padding: 16px 24px 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
`,ZL={GET_A_WALLET:"https://ton.org/wallets?filters[wallet_features][slug][$in]=dapp-auth&pagination[limit]=-1"},CS=n=>he(VL,{"data-tc-wallets-modal-info":"true",get children(){return[he(WL,{icon:"arrow",onClick:()=>n.onBackClick()}),he(qL,{translationKey:"walletModal.infoModal.whatIsAWallet",children:"What is a wallet"}),he(fS,{get children(){return[he(Fv,{get children(){return[he(t7,{class:Uv}),he($v,{translationKey:"walletModal.infoModal.secureDigitalAssets",children:"Secure digital assets storage"}),he(Vv,{translationKey:"walletModal.infoModal.walletProtects",children:"A wallet protects and manages your digital assets including TON, tokens and collectables."})]}}),he(Fv,{get children(){return[he(r7,{class:Uv}),he($v,{translationKey:"walletModal.infoModal.controlIdentity",children:"Control your Web3 identity"}),he(Vv,{translationKey:"walletModal.infoModal.manageIdentity",children:"Manage your digital identity and access decentralized applications with ease. Maintain control over your data and engage securely in the blockchain ecosystem."})]}}),he(Fv,{get children(){return[he(o7,{class:Uv}),he($v,{translationKey:"walletModal.infoModal.effortlessCryptoTransactions",children:"Effortless crypto transactions"}),he(Vv,{translationKey:"walletModal.infoModal.easilySend",children:"Easily send, receive, monitor your cryptocurrencies. Streamline your operations with decentralized applications."})]}}),he(GL,{get children(){return he(K_,{get href(){return ZL.GET_A_WALLET},blank:!0,get children(){return he(jo,{get rightIcon(){return he(Q9,{})},get children(){return he(ms,{translationKey:"walletModal.infoModal.getAWallet",children:"Get a Wallet"})}})}})}})]}})]}}),HL=jt.div``,KL=jt.div`
    flex: 1;
    margin-top: 18px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 232px;
`,XL=jt(pu)`
    max-width: 262px;
    margin: 0 auto 8px;
`,YL=jt(sp)`
    position: absolute;
    top: 16px;
    left: 16px;
`,JL=jt.div`
    padding: 16px;
    display: flex;
    align-items: center;
    gap: 12px;
    border-top: 0.5px solid ${n=>Z0(n.theme.colors.icon.secondary,.2)};
`,QL=jt(op)`
    width: 36px;
    height: 36px;
    border-radius: 10px;
`,eR=jt(K_)`
    margin-left: auto;
`,tR=jt(_h)`
    margin-bottom: 18px;
    margin-top: 2px;
`,nR=jt(by)`
    margin-bottom: 16px;
`,c4=jt(Id)`
    color: ${n=>n.theme.colors.text.secondary};
    text-align: center;
    margin-bottom: 20px;
`,u4=jt.div`
    display: flex;
    justify-content: center;
    gap: 8px;
    padding-bottom: 16px;
`,rR=jt(pu)`
    margin-bottom: 2px;
    padding: 0 64px;
`,iR=jt(Id)`
    margin-bottom: 20px;
    padding: 0 64px;
    min-height: 44px;
`,oR=jt.div`
    padding: 0 24px 24px;
`,sR=n=>[he(rR,{get children(){return n.walletInfo.name}}),he(iR,{translationKey:"walletModal.mobileConnectionModal.scanQR",get translationValues(){return{name:n.walletInfo.name}},get children(){return["Scan the QR code below with your phone’s or ",qn(()=>n.walletInfo.name),"’s camera"]}}),he(oR,{get children(){return he(wy,{get imageUrl(){return n.walletInfo.imageUrl},get sourceUrl(){return Li(n.universalLink,"none")},disableCopy:!0})}})],SS=n=>{const t=Vi(),[r,l]=Ir(!0),[d,m]=Ir(!1),[x,C]=Ir(!1),a=ca(Wm),M=a.onStatusChange(()=>{},()=>{C(!0)}),R=qn(()=>a.connect({universalLink:n.wallet.universalLink,bridgeUrl:n.wallet.bridgeUrl},n.additionalRequest)),j=()=>{Ms(Ha(Ai({},n.wallet),{openMethod:"universal-link"})),J0(R(),{returnStrategy:mi.returnStrategy,twaReturnUrl:mi.twaReturnUrl,forceRedirect:!0})},F=()=>{const se=R();if(Yf(se))return j();C(!1);const xe=!r();l(!1),Q0(R(),n.wallet.deepLink,{returnStrategy:mi.returnStrategy,forceRedirect:xe},Se=>{Ms(Ha(Ai({},n.wallet),{openMethod:Se}))})},Z=()=>{C(!1),m(!0),Ms(Ha(Ai({},n.wallet),{openMethod:"qrcode"}))},Y=()=>{m(!1),Ms(Ha(Ai({},n.wallet),{openMethod:"universal-link"}))},ne=()=>{d()?Y():n.onBackClick()};return la(M),F(),he(HL,{"data-tc-wallets-modal-connection-mobile":"true",get children(){return[he(jr,{get when(){return!n.backDisabled||d()},get children(){return he(YL,{icon:"arrow",onClick:ne})}}),he(jr,{get when(){return d()},get children(){return he(sR,{get universalLink(){return R()},get walletInfo(){return n.wallet}})}}),he(jr,{get when(){return!d()},get children(){return[he(XL,{get children(){return n.wallet.name}}),he(KL,{get children(){return[he(jr,{get when(){return x()},get children(){return[he(nR,{size:"s"}),he(c4,{translationKey:"walletModal.mobileConnectionModal.connectionDeclined",children:"Connection declined"}),he(u4,{get children(){return[he(jo,{get leftIcon(){return he(d0,{})},onClick:F,get children(){return he(ms,{translationKey:"common.retry",children:"Retry"})}}),he(jo,{get leftIcon(){return he(Px,{get fill(){return t.colors.accent}})},onClick:Z,get children(){return he(ms,{translationKey:"walletModal.mobileConnectionModal.showQR",children:"Show QR Code"})}})]}})]}}),he(jr,{get when(){return!x()},get children(){return[he(tR,{size:"s"}),he(c4,{translationKey:"walletModal.mobileConnectionModal.continueIn",get translationValues(){return{name:n.wallet.name}},get children(){return["Continue in ",qn(()=>n.wallet.name),"…"]}}),he(u4,{get children(){return[he(jo,{get leftIcon(){return he(d0,{})},onClick:F,get children(){return he(ms,{translationKey:"common.retry",children:"Retry"})}}),he(jo,{get leftIcon(){return he(Px,{get fill(){return t.colors.accent}})},onClick:Z,get children(){return he(ms,{translationKey:"walletModal.mobileConnectionModal.showQR",children:"Show QR Code"})}})]}})]}})]}}),he(JL,{get children(){return[he(QL,{get src(){return n.wallet.imageUrl}}),he(Fw,{get children(){return n.wallet.name}}),he(eR,{get href(){return n.wallet.aboutUrl},blank:!0,get children(){return he(jo,{get children(){return he(ms,{translationKey:"common.get",children:"GET"})}})}})]}})]}})]}})},kS={m:"16px",s:"12px",none:"0"},aR={m:"6px",s:"6px",none:"0"},lR=jt.ul`
    display: flex;
    justify-content: space-between;
    margin: 0 auto;
    width: fit-content;
    max-width: 100%;
    min-width: 100%;
    height: fit-content;
    overflow-x: auto;
    overflow-y: hidden;
    padding: 0 13px 24px;

    &&::-webkit-scrollbar {
        display: none;
    }

    -ms-overflow-style: none;
    scrollbar-width: none;

    > li {
        height: fit-content;
    }
`,h4=jt.li`
    width: 82px;
    min-width: 82px;
    height: 124px;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 8px 4px;

    text-align: center;
    cursor: pointer;

    transition: transform 0.1s ease-in-out;

    ${K0} {
        &:hover {
            transform: scale(1.04);
        }
    }

    &:active {
        transform: scale(0.96);
    }

    ${H0} {
        &:active {
            transform: scale(0.92);
        }
    }
`,cR=jt.div`
    width: 1px;
    margin: 0 10px;
    height: 24px;
    position: relative;
    top: 26px;

    background-color: ${n=>n.theme.colors.icon.secondary};
    opacity: 0.2;
`,d4=jt.div`
    width: 60px;
    height: 60px;
    border-radius: ${n=>kS[n.theme.borderRadius]};
    display: flex;
    align-items: center;
    justify-content: center;

    background-color: ${n=>n.theme.colors.background.tint};
    margin-bottom: 8px;
`,uR=jt(pu)`
    margin-top: 38px;
    margin-bottom: 4px;
    padding: 0 24px;
`,hR=jt(Id)`
    margin-bottom: 24px;
    padding: 0 24px;
    min-height: 44px;
`;jt(jo)`
    display: block;
    margin: 0 auto;
`;const dR=jt(jo)`
    margin: 0 24px 24px;
    width: calc(100% - 48px);
    border-radius: ${n=>kS[n.theme.borderRadius]};
    padding: 14px 16px 14px 14px;
    background-color: ${n=>n.theme.colors.telegramButton};

    color: ${n=>n.theme.colors.constant.white};
    font-weight: 590;
    font-size: 16px;
    line-height: 20px;
`,fR=jt(op)`
    border-radius: ${n=>aR[n.theme.borderRadius]};
    width: 24px;
    height: 24px;
`,f4=jt(sp)`
    position: absolute;
    top: 16px;
    left: 16px;
`,pR=jt(pu)`
    margin-bottom: 2px;
    padding: 0 64px;
`,mR=jt(Id)`
    margin-bottom: 20px;
    padding: 0 64px;
`,gR=jt.div`
    padding: 0 24px 24px;
`,_R=n=>[he(pR,{translationKey:"walletModal.mobileUniversalModal.connectYourWallet",children:"Connect your wallet"}),he(mR,{translationKey:"walletModal.mobileUniversalModal.scan",children:"Scan with your mobile wallet"}),he(gR,{get children(){return he(wy,{get imageUrl(){return Y0.TON},get sourceUrl(){return Li(n.universalLink,"none")},disableCopy:!0})}})];function MS(n){const t=new Set(n.filter(Tw).map(r=>r.bridgeUrl));return Array.from(t).map(r=>({bridgeUrl:r}))}function AS(n,t){const r=new Set(n?.map(d=>d.bridgeUrl)),l=new Set(t?.map(d=>d.bridgeUrl));return r.size===l.size&&[...r].every(d=>l.has(d))}const p4=ei("<li></li>"),yR=ei('<div data-tc-wallets-modal-universal-mobile="true"></div>'),vR=n=>{const[t,r]=Ir(!1),[l,d]=Ir(!0),[m,x]=Ir(null),C=mi.connector,a=()=>n.walletsList.filter(_e=>m0(_e)&&_e.appName!==dh),M=()=>a().length>7,R=qn(()=>MS(n.walletsList),null,{equals:AS}),j=()=>(m()||x(C.connect(R(),n.additionalRequest)),m());Ms({openMethod:"universal-link"});const[F,Z]=Ir(void 0),Y=()=>bi(void 0,null,function*(){F()!==void 0&&clearTimeout(F()),yield Nw(j());const _e=setTimeout(()=>Z(void 0),1500);Z(_e)}),ne=()=>{const _e=!l();d(!1),Q0(j(),void 0,{returnStrategy:mi.returnStrategy,forceRedirect:_e},Ie=>{Ms({openMethod:Ie})})},se=()=>{x(null);const _e=n.walletsList.find(Ve=>Ve.appName===dh);if(!_e||!Tw(_e))throw new Bo("@wallet bot not found in the wallets list");const Ie=C.connect({bridgeUrl:_e.bridgeUrl,universalLink:_e.universalLink},n.additionalRequest),Me=!l();d(!1),J0(Ie,{returnStrategy:mi.returnStrategy,twaReturnUrl:mi.twaReturnUrl,forceRedirect:Me})},xe=()=>{r(!0),Ms({openMethod:"qrcode"})},Se=()=>{r(!1),Ms({openMethod:"universal-link"})};return(()=>{const _e=yR.cloneNode(!0);return Ws(_e,he(jr,{get when(){return t()},get children(){return[he(f4,{icon:"arrow",onClick:Se}),he(_R,{get universalLink(){return j()}})]}}),null),Ws(_e,he(jr,{get when(){return!t()},get children(){return[he(f4,{get icon(){return he(Px,{})},onClick:xe}),he(uR,{translationKey:"walletModal.mobileUniversalModal.connectYourWallet",children:"Connect your wallet"}),he(hR,{translationKey:"walletModal.mobileUniversalModal.openWalletOnTelegramOrSelect",children:"Open Wallet in Telegram or select your wallet to connect"}),he(dR,{get leftIcon(){return he(a7,{})},get rightIcon(){return he(fR,{get src(){return Y0.TG}})},onClick:se,scale:"s",get children(){return he(ms,{translationKey:"walletModal.mobileUniversalModal.openWalletOnTelegram",children:"Open Wallet in Telegram"})}}),he(lR,{get children(){return[he(q0,{get each(){return qn(()=>!!M())()?a().slice(0,4):a()},children:Ie=>(()=>{const Me=p4.cloneNode(!0);return Ws(Me,he(Z_,{get icon(){return Ie.imageUrl},get name(){return Ie.name},onClick:()=>n.onSelect(Ie)})),Me})()}),he(jr,{get when(){return M()},get children(){const Ie=p4.cloneNode(!0);return Ws(Ie,he(hS,{labelLine1:"View all",labelLine2:"wallets",get images(){return a().slice(3,7).map(Me=>Me.imageUrl)},onClick:()=>n.onSelectAllWallets()})),Ie}}),he(cR,{children:" "}),he(h4,{onClick:ne,get children(){return[he(d4,{get children(){return he(M9,{})}}),he(Xa,{fontWeight:590,translationKey:"walletModal.mobileUniversalModal.openLink",children:"Open Link"})]}}),he(h4,{onClick:Y,get children(){return[he(d4,{get children(){return qn(()=>F()!==void 0)()?he(c7,{}):he(uS,{})}}),he(Xa,{fontWeight:590,get translationKey(){return F()!==void 0?"common.copied":"common.copyLink"},get children(){return F()!==void 0?"Copied":"Copy Link"}})]}})]}})]}}),null),_e})()},PS={m:"16px",s:"8px",none:"0"},xR={m:"8px",s:"4px",none:"0"},wR=jt.div`
    display: flex;
    flex-direction: column;
    align-items: center;
    padding-bottom: 16px;
`,bR=jt(Id)`
    max-width: 320px;
    margin-top: 2px;
    margin-bottom: 20px;
`,ER=jt(Id)`
    margin-bottom: 16px;
`,TR=jt(wy)`
    margin-bottom: 24px;
`,CR=jt.ul`
    display: flex;
`;jt.div`
    display: flex;
    gap: 16px;
    width: 100%;
`;jt(jo)`
    position: relative;
    font-size: 16px;
    line-height: 20px;
    width: 100%;
    padding: 0 16px;
    height: 56px;
    border-radius: ${n=>PS[n.theme.borderRadius]};

    &:hover {
        ${n=>n.disableEventsAnimation?"transform: unset;":""}
    }

    &:active {
        ${n=>n.disableEventsAnimation?"transform: unset;":""}
    }
`;jt.ul`
    position: absolute;
    bottom: 100%;
    left: 0;
    margin: 0;
    padding: 8px;
    width: 188px;
    transform: translateY(-16px);

    background-color: ${n=>n.theme.colors.background.primary};
    border-radius: ${n=>PS[n.theme.borderRadius]};
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.16);
`;jt.li`
    padding: 8px;

    display: flex;
    align-items: center;
    gap: 8px;

    cursor: pointer;
    border-radius: ${n=>xR[n.theme.borderRadius]};

    transition: background-color, transform 0.1s ease-in-out;

    &:hover {
        background-color: ${n=>n.theme.colors.background.secondary};
    }

    &:active {
        transform: scale(0.96);
    }
`;jt(op)`
    width: 24px;
    height: 24px;

    border-radius: 6px;
`;jt.div`
    margin-top: 23px;
    margin-bottom: 1px;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
`;jt(Xa)`
    color: ${n=>n.theme.colors.text.secondary};
    font-size: 16px;
`;const SR=ei("<li></li>"),kR=n=>{const[t,r]=Ir(!1),l=mi.connector,d=qn(()=>MS(n.walletsList),null,{equals:AS});Ms({openMethod:"qrcode"});const m=qn(()=>l.connect(d(),n.additionalRequest));return he(wR,{onClick:()=>r(!1),"data-tc-wallets-modal-universal-desktop":"true",get children(){return[he(pu,{translationKey:"walletModal.desktopUniversalModal.connectYourWallet",children:"Connect your wallet"}),he(bR,{translationKey:"walletModal.desktopUniversalModal.scan",children:"Scan with your mobile wallet"}),he(TR,{get sourceUrl(){return Li(m(),"none")},get disableCopy(){return t()},get imageUrl(){return Y0.TON}}),he(ER,{translationKey:"walletModal.desktopUniversalModal.availableWallets",children:"Available wallets"}),he(CR,{get children(){return[he(q0,{get each(){return n.walletsList.slice(0,3)},children:x=>(()=>{const C=SR.cloneNode(!0);return Ws(C,he(dS,{wallet:x,onClick:()=>n.onSelect(x)})),C})()}),he(hS,{labelLine1:"View all",labelLine2:"wallets",get images(){return n.walletsList.slice(3,7).map(x=>x.imageUrl)},onClick:()=>n.onSelectAllWallets()})]}})]}})},MR=()=>{const{locale:n}=fu()[1];gs(()=>n(mi.language)),gs(()=>{F5()?H_():(m(null),C("universal"),M(!1))});const t=ca(Wm),r=ca(Ld),[l]=HA(()=>r.getWallets()),[d,m]=Ir(null),[x,C]=Ir("universal"),[a,M]=Ir(!1),R=qn(()=>{if(l.state!=="ready")return null;let Se=qw(l(),mi.walletsListConfiguration);const _e=Se.filter(Jf),Ie=Se.filter(qe=>!Jf(qe));Se=(_e||[]).concat(Ie);const Me=mi.preferredWalletAppName,Ve=Se.find(qe=>pd(qe,Me)),Ke=Se.filter(qe=>pd(qe,Me)).length>=2;Me&&Ve&&!Ke&&(Se=[Ha(Ai({},Ve),{isPreferred:!0})].concat(Se.filter(qe=>!pd(qe,Me))));const et=Se.find(qe=>pd(qe,dh));return et&&(Se=[et].concat(Se.filter(qe=>!pd(qe,dh)))),Se}),j=()=>{var Se;return((Se=mi.connectRequestParameters)==null?void 0:Se.state)==="loading"},F=qn(()=>{var Se;if(!j())return(Se=mi.connectRequestParameters)==null?void 0:Se.value}),Z=Se=>{r.closeModal(Se)},Y=t.onStatusChange(Se=>{Se&&Z("wallet-selected")}),ne=()=>{C("all-wallets")},se=()=>{C("universal")},xe=()=>{m(null)};return la(()=>{m(null),M(!1)}),la(Y),he(wS,{get opened(){return F5()},get enableAndroidBackHandler(){return mi.enableAndroidBackHandler},onClose:()=>Z("action-cancelled"),onClickQuestion:()=>M(Se=>!Se),"data-tc-wallets-modal-container":"true",get children(){return[he(jr,{get when(){return a()},get children(){return he(CS,{onBackClick:()=>M(!1)})}}),he(jr,{get when(){return!a()},get children(){return[he(jr,{get when(){return j()||!R()},get children(){return[he(bS,{translationKey:"walletModal.loading",children:"Wallets list is loading"}),he(ES,{get children(){return he(_h,{size:"m"})}})]}}),he(jr,{get when(){return qn(()=>!j())()&&R()},get children(){return he(G0,{get children(){return[he(ks,{get when(){return d()},get children(){return he(Rm,{get component(){return Dm()?SS:TS},get wallet(){return d()},get additionalRequest(){return F()},onBackClick:xe})}}),he(ks,{get when(){return x()==="universal"},get children(){return he(Rm,{get component(){return Dm()?vR:kR},onSelect:m,get walletsList(){return R()},get additionalRequest(){return F()},onSelectAllWallets:ne})}}),he(ks,{get when(){return x()==="all-wallets"},get children(){return he(kL,{get walletsList(){return R()},onBack:se,onSelect:m})}})]}})}})]}})]}})},AR=jt.div`
    display: flex;
    flex-direction: column;
    align-items: center;
    padding-bottom: 8px;
`,PR=jt(pu)`
    margin-top: 16px;
`,IR=jt(Xa)`
    font-weight: 510;
    font-size: 16px;
    line-height: 20px;
    text-align: center;
    max-width: 250px;

    color: ${n=>n.theme.colors.text.secondary};
`,LR=jt(jo)`
    min-width: 112px;
    margin-top: 32px;
`,RR=jt(_h)`
    height: 16px;
    width: 16px;
`,m4=jt(jo)`
    margin-top: 32px;
`,Gw=n=>{const t=X0(n),r=ca(Ld),[l,d]=Ir(!0),[m,x]=Ir(!1);gs(()=>{const R=ah();x(!!R&&"sent"in R&&R.sent)});let C;r?.wallet&&"universalLink"in r.wallet&&(r.wallet.openMethod==="universal-link"||Yf(r.wallet.universalLink)&&ph())&&(C=r.wallet.universalLink);let a;r?.wallet&&"deepLink"in r.wallet&&(r.wallet.openMethod==="custom-deeplink"||Yf(r.wallet.deepLink)&&ph())&&(a=r.wallet.deepLink);const M=()=>{const R=ah(),j="returnStrategy"in R?R.returnStrategy:mi.returnStrategy,F=!l();d(!1),Yf(C)?J0(C,{returnStrategy:j,twaReturnUrl:"twaReturnUrl"in R?R.twaReturnUrl:mi.twaReturnUrl,forceRedirect:F}):Q0(C,a,{returnStrategy:j,forceRedirect:F},()=>{})};return he(AR,eu(t,{get children(){return[qn(()=>n.icon),he(PR,{get translationKey(){return n.headerTranslationKey},get translationValues(){return n.headerTranslationValues}}),he(IR,{get translationKey(){return n.textTranslationKey},get translationValues(){return n.textTranslationValues}}),he(jr,{get when(){return!m()&&(n.showButton==="open-wallet"&&C||n.showButton!=="open-wallet")},get children(){return he(LR,{disabled:!0,"data-tc-connect-button-loading":"true",get children(){return he(RR,{})}})}}),he(jr,{get when(){return m()},get children(){return[he(jr,{get when(){return n.showButton!=="open-wallet"},get children(){return he(m4,{onClick:()=>n.onClose(),get children(){return he(ms,{translationKey:"common.close",children:"Close"})}})}}),he(jr,{get when(){return n.showButton==="open-wallet"&&C},get children(){return he(m4,{onClick:M,get children(){return he(ms,{translationKey:"common.openWallet",children:"Open wallet"})}})}})]}})]}}))},OR=n=>{const t=ca(Ld),[r]=fu(),l=()=>t.wallet&&"name"in t.wallet?t.wallet.name:r("common.yourWallet",{},"Your wallet");return he(Gw,{headerTranslationKey:"actionModal.confirmTransaction.header",get headerTranslationValues(){return{name:l()}},textTranslationKey:"actionModal.confirmTransaction.text",get icon(){return he(_h,{size:"m"})},onClose:()=>n.onClose(),showButton:"open-wallet","data-tc-confirm-modal":"true"})},DR=n=>he(Gw,{headerTranslationKey:"actionModal.transactionCanceled.header",textTranslationKey:"actionModal.transactionCanceled.text",get icon(){return he(by,{size:"m"})},onClose:()=>n.onClose(),"data-tc-transaction-canceled-modal":"true"}),zR=n=>he(Gw,{headerTranslationKey:"actionModal.transactionSent.header",textTranslationKey:"actionModal.transactionSent.text",get icon(){return he(Uw,{size:"m"})},onClose:()=>n.onClose(),"data-tc-transaction-sent-modal":"true"}),BR=()=>he(oS,{get opened(){var n;return qn(()=>ah()!==null)()&&((n=ah())==null?void 0:n.openModal)===!0},get enableAndroidBackHandler(){return mi.enableAndroidBackHandler},onClose:()=>Sm(null),"data-tc-actions-modal-container":"true",get children(){return he(G0,{get children(){return[he(ks,{get when(){return ah().name==="transaction-sent"},get children(){return he(zR,{onClose:()=>Sm(null)})}}),he(ks,{get when(){return ah().name==="transaction-canceled"},get children(){return he(DR,{onClose:()=>Sm(null)})}}),he(ks,{get when(){return ah().name==="confirm-transaction"},get children(){return he(OR,{onClose:()=>Sm(null)})}})]}})}}),jR=()=>{const{locale:n}=fu()[1];gs(()=>n(mi.language)),gs(()=>{$5()&&H_()});const t=ca(Wm),r=ca(Ld),[l,d]=Ir(!1),m=()=>{var M;return((M=mi.connectRequestParameters)==null?void 0:M.state)==="loading"},x=qn(()=>{var M;if(!m())return(M=mi.connectRequestParameters)==null?void 0:M.value}),C=M=>{r.closeSingleWalletModal(M)},a=t.onStatusChange(M=>{M&&C("wallet-selected")});return la(a),la(()=>{d(!1)}),he(wS,{get opened(){return $5()},get enableAndroidBackHandler(){return mi.enableAndroidBackHandler},onClose:()=>C("action-cancelled"),onClickQuestion:()=>d(M=>!M),"data-tc-wallets-modal-container":"true",get children(){return[he(jr,{get when(){return l()},get children(){return he(CS,{onBackClick:()=>d(!1)})}}),he(jr,{get when(){return!l()},get children(){return[he(jr,{get when(){return m()},get children(){return[he(bS,{translationKey:"walletModal.loading",children:"Wallets list is loading"}),he(ES,{get children(){return he(_h,{size:"m"})}})]}}),he(jr,{get when(){return!m()},get children(){return he(Rm,{get component(){return Dm()?SS:TS},get wallet(){return KP()},get additionalRequest(){return x()},onBackClick:()=>{},backDisabled:!0})}})]}})]}})},NR=n=>{const t=f9(dI,mi.language);return VP(),$P(),he(lS.Provider,{value:t,get children(){return he(Ld.Provider,{get value(){return n.tonConnectUI},get children(){return he(Wm.Provider,{get value(){return mi.connector},get children(){return[he(OP,{}),he(LP,{theme:xI,get children(){return[he(jr,{get when(){return mi.buttonRootId},get children(){return he(UC,{get mount(){return document.getElementById(mi.buttonRootId)},get children(){return he(_L,{})}})}}),he(Rm,{component:oh,get children(){return[he(MR,{}),he(jR,{}),he(BR,{})]}})]}})]}})}})}})},Za={openWalletsModal:()=>void setTimeout(()=>N5({status:"opened",closeReason:null})),closeWalletsModal:n=>void setTimeout(()=>N5({status:"closed",closeReason:n})),openSingleWalletModal:n=>{setTimeout(()=>U5({status:"opened",closeReason:null,walletInfo:n}))},closeSingleWalletModal:n=>void setTimeout(()=>U5({status:"closed",closeReason:n})),setAction:n=>void setTimeout(()=>Sm(n)),clearAction:()=>void setTimeout(()=>Sm(null)),getSelectedWalletInfo:()=>XP(),removeSelectedWalletInfo:()=>Ms(null),renderApp:(n,t)=>fP(()=>he(NR,{tonConnectUI:t}),document.getElementById(n))};class FR{constructor(t){kr(this,"connector"),kr(this,"setConnectRequestParametersCallback"),kr(this,"consumers",[]),kr(this,"tracker"),kr(this,"state",Cx()),this.connector=t.connector,this.tracker=t.tracker,this.setConnectRequestParametersCallback=t.setConnectRequestParametersCallback,gs(()=>{const r=Cx();this.state=r,this.consumers.forEach(l=>l(r))})}open(){return bi(this,null,function*(){this.tracker.trackConnectionStarted();const r=(yield this.connector.getWallets()).find(gy);return r?this.connectEmbeddedWallet(r):this.openWalletsModal()})}close(t="action-cancelled"){t==="action-cancelled"&&this.tracker.trackConnectionError("Connection was cancelled"),Za.closeWalletsModal(t)}onStateChange(t){return this.consumers.push(t),()=>{this.consumers=this.consumers.filter(r=>r!==t)}}connectEmbeddedWallet(t){const r=d=>{Ms(t),this.connector.connect({jsBridgeKey:t.jsBridgeKey},d)},l=mi.connectRequestParameters;l?.state==="loading"?this.setConnectRequestParametersCallback(r):r(l?.value)}openWalletsModal(){return bi(this,null,function*(){return ph()&&Bw(),Za.openWalletsModal(),new Promise(t=>{const r=this.onStateChange(l=>{const{status:d}=l;d==="opened"&&(r(),t())})})})}}class UR{constructor(t){kr(this,"connector"),kr(this,"consumers",[]),this.connector=t.connector,gs(()=>{const r=ah();this.consumers.forEach(l=>l(r))})}onStateChange(t){return this.consumers.push(t),()=>{this.consumers=this.consumers.filter(r=>r!==t)}}}class $R{constructor(t){kr(this,"connector"),kr(this,"setConnectRequestParametersCallback"),kr(this,"consumers",[]),kr(this,"tracker"),kr(this,"state",U_()),this.connector=t.connector,this.tracker=t.tracker,this.setConnectRequestParametersCallback=t.setConnectRequestParametersCallback,gs(()=>{const r=U_();this.state=r,this.consumers.forEach(l=>l(r))})}open(t){return bi(this,null,function*(){this.tracker.trackConnectionStarted();const r=yield this.connector.getWallets(),l=qw(r,mi.walletsListConfiguration),d=l.find(gy);if(!!d)return this.connectEmbeddedWallet(d);const C=l.filter(Tw).find(R=>pd(R,t));if(!!C)return this.openSingleWalletModal(C);const M=`Trying to open modal window with unknown wallet "${t}".`;throw this.tracker.trackConnectionError(M),new Bo(M)})}close(t="action-cancelled"){t==="action-cancelled"&&this.tracker.trackConnectionError("Connection was cancelled"),Za.closeSingleWalletModal("action-cancelled")}onStateChange(t){return this.consumers.push(t),()=>{this.consumers=this.consumers.filter(r=>r!==t)}}connectEmbeddedWallet(t){const r=d=>{Ms(t),this.connector.connect({jsBridgeKey:t.jsBridgeKey},d)},l=mi.connectRequestParameters;l?.state==="loading"?this.setConnectRequestParametersCallback(r):r(l?.value)}openSingleWalletModal(t){return bi(this,null,function*(){return ph()&&Bw(),Za.openSingleWalletModal(t),new Promise(r=>{const l=this.onStateChange(d=>{const{status:m}=d;m==="opened"&&(l(),r())})})})}}class VR{constructor(t){kr(this,"eventPrefix","ton-connect-ui-"),kr(this,"tonConnectUiVersion"),kr(this,"tonConnectSdkVersion",null),kr(this,"eventDispatcher");var r;this.eventDispatcher=(r=t?.eventDispatcher)!=null?r:new SC,this.tonConnectUiVersion=t.tonConnectUiVersion,this.init().catch()}get version(){return ip({ton_connect_sdk_lib:this.tonConnectSdkVersion,ton_connect_ui_lib:this.tonConnectUiVersion})}init(){return bi(this,null,function*(){try{yield this.setRequestVersionHandler(),this.tonConnectSdkVersion=yield this.requestTonConnectSdkVersion()}catch{}})}setRequestVersionHandler(){return bi(this,null,function*(){yield this.eventDispatcher.addEventListener("ton-connect-ui-request-version",()=>bi(this,null,function*(){yield this.eventDispatcher.dispatchEvent("ton-connect-ui-response-version",mC(this.tonConnectUiVersion))}))})}requestTonConnectSdkVersion(){return bi(this,null,function*(){return new Promise((t,r)=>bi(this,null,function*(){try{yield this.eventDispatcher.addEventListener("ton-connect-response-version",l=>{t(l.detail.version)},{once:!0}),yield this.eventDispatcher.dispatchEvent("ton-connect-request-version",pC())}catch(l){r(l)}}))})}dispatchUserActionEvent(t){var r;try{(r=this.eventDispatcher)==null||r.dispatchEvent(`${this.eventPrefix}${t.type}`,t).catch()}catch{}}trackConnectionStarted(...t){try{const r=gC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackConnectionCompleted(...t){try{const r=_C(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackConnectionError(...t){try{const r=yC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackConnectionRestoringStarted(...t){try{const r=vC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackConnectionRestoringCompleted(...t){try{const r=xC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackConnectionRestoringError(...t){try{const r=wC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackDisconnection(...t){try{const r=CC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackTransactionSentForSignature(...t){try{const r=bC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackTransactionSigned(...t){try{const r=EC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}trackTransactionSigningFailed(...t){try{const r=TC(this.version,...t);this.dispatchUserActionEvent(r)}catch{}}}const WR="2.0.5";class qR{constructor(t){if(kr(this,"walletInfoStorage",new ZP),kr(this,"preferredWalletStorage",new HP),kr(this,"tracker"),kr(this,"walletInfo",null),kr(this,"systemThemeChangeUnsubscribe",null),kr(this,"actionsConfiguration"),kr(this,"walletsList"),kr(this,"connectRequestParametersCallback"),kr(this,"connector"),kr(this,"modal"),kr(this,"singleWalletModal"),kr(this,"transactionModal"),kr(this,"connectionRestored",Promise.resolve(!1)),t&&"connector"in t&&t.connector)this.connector=t.connector;else if(t&&"manifestUrl"in t&&t.manifestUrl)this.connector=new rp({manifestUrl:t.manifestUrl,eventDispatcher:t?.eventDispatcher});else throw new Bo("You have to specify a `manifestUrl` or a `connector` in the options.");this.tracker=new VR({eventDispatcher:t?.eventDispatcher,tonConnectUiVersion:WR}),this.modal=new FR({connector:this.connector,tracker:this.tracker,setConnectRequestParametersCallback:d=>{this.connectRequestParametersCallback=d}}),this.singleWalletModal=new $R({connector:this.connector,tracker:this.tracker,setConnectRequestParametersCallback:d=>{this.connectRequestParametersCallback=d}}),this.transactionModal=new UR({connector:this.connector}),this.walletsList=this.getWallets(),this.walletsList.then(d=>GC(yL(d.map(m=>m.imageUrl))));const r=this.normalizeWidgetRoot(t?.widgetRootId);this.subscribeToWalletChange(),t?.restoreConnection!==!1&&(this.connectionRestored=WP(()=>bi(this,null,function*(){return this.tracker.trackConnectionRestoringStarted(),yield this.connector.restoreConnection(),this.connector.connected?this.tracker.trackConnectionRestoringCompleted(this.wallet):(this.tracker.trackConnectionRestoringError("Connection was not restored"),this.walletInfoStorage.removeWalletInfo()),this.connector.connected}))),this.uiOptions=xd(t,{uiPreferences:{theme:"SYSTEM"}});const l=this.preferredWalletStorage.getPreferredWalletAppName();e_({connector:this.connector,preferredWalletAppName:l}),Za.renderApp(r,this)}static getWallets(){return rp.getWallets()}get connected(){return this.connector.connected}get account(){return this.connector.account}get wallet(){return this.connector.wallet?Ai(Ai({},this.connector.wallet),this.walletInfo):null}set uiOptions(t){var r,l,d,m,x;this.checkButtonRootExist(t.buttonRootId),this.actionsConfiguration=t.actionsConfiguration,(r=t.uiPreferences)!=null&&r.theme?((l=t.uiPreferences)==null?void 0:l.theme)!=="SYSTEM"?((d=this.systemThemeChangeUnsubscribe)==null||d.call(this),Dv(t.uiPreferences.theme,t.uiPreferences.colorsSet)):(Dv(jP(),t.uiPreferences.colorsSet),this.systemThemeChangeUnsubscribe||(this.systemThemeChangeUnsubscribe=NP(Dv))):(m=t.uiPreferences)!=null&&m.colorsSet&&bI(t.uiPreferences.colorsSet),(x=t.uiPreferences)!=null&&x.borderRadius&&wI(t.uiPreferences.borderRadius),e_(C=>{var a,M;const R=xd(Ai(Ai(Ai(Ai({},t.language&&{language:t.language}),!!((a=t.actionsConfiguration)!=null&&a.returnStrategy)&&{returnStrategy:t.actionsConfiguration.returnStrategy}),!!((M=t.actionsConfiguration)!=null&&M.twaReturnUrl)&&{twaReturnUrl:t.actionsConfiguration.twaReturnUrl}),!!t.walletsListConfiguration&&{walletsListConfiguration:t.walletsListConfiguration}),Om(C));return t.buttonRootId!==void 0&&(R.buttonRootId=t.buttonRootId),t.enableAndroidBackHandler!==void 0&&(R.enableAndroidBackHandler=t.enableAndroidBackHandler),R})}setConnectRequestParameters(t){var r;e_({connectRequestParameters:t}),(t?.state==="ready"||!t)&&((r=this.connectRequestParametersCallback)==null||r.call(this,t?.value))}getWallets(){return bi(this,null,function*(){return this.connector.getWallets()})}onStatusChange(t,r){return this.connector.onStatusChange(l=>bi(this,null,function*(){if(l){const d=yield this.getSelectedWalletInfo(l);t(Ai(Ai({},l),d||this.walletInfoStorage.getWalletInfo()))}else t(l)}),r)}openModal(){return bi(this,null,function*(){return this.modal.open()})}closeModal(t){this.modal.close(t)}onModalStateChange(t){return this.modal.onStateChange(t)}get modalState(){return this.modal.state}openSingleWalletModal(t){return bi(this,null,function*(){return this.singleWalletModal.open(t)})}closeSingleWalletModal(t){this.singleWalletModal.close(t)}onSingleWalletModalStateChange(t){return this.singleWalletModal.onStateChange(t)}get singleWalletModalState(){return this.singleWalletModal.state}connectWallet(){return bi(this,null,function*(){const r=(yield this.getWallets()).find(gy);return r?yield this.connectEmbeddedWallet(r):yield this.connectExternalWallet()})}disconnect(){return this.tracker.trackDisconnection(this.wallet,"dapp"),Za.clearAction(),Za.removeSelectedWalletInfo(),this.walletInfoStorage.removeWalletInfo(),this.connector.disconnect()}sendTransaction(t,r){return bi(this,null,function*(){if(this.tracker.trackTransactionSentForSignature(this.wallet,t),!this.connected)throw this.tracker.trackTransactionSigningFailed(this.wallet,t,"Wallet was not connected"),new Bo("Connect wallet to send a transaction.");ph()&&Bw();const{notifications:l,modals:d,returnStrategy:m,twaReturnUrl:x,skipRedirectToWallet:C}=this.getModalsAndNotificationsConfiguration(r);Za.setAction({name:"confirm-transaction",showNotification:l.includes("before"),openModal:d.includes("before"),sent:!1});const a=()=>{M.signal.aborted||(Za.setAction({name:"confirm-transaction",showNotification:l.includes("before"),openModal:d.includes("before"),sent:!0}),this.walletInfo&&"universalLink"in this.walletInfo&&(this.walletInfo.openMethod==="universal-link"||this.walletInfo.openMethod==="custom-deeplink")&&(Yf(this.walletInfo.universalLink)?J0(this.walletInfo.universalLink,{returnStrategy:m,twaReturnUrl:x||mi.twaReturnUrl,forceRedirect:!1}):Q0(this.walletInfo.universalLink,this.walletInfo.deepLink,{returnStrategy:m,forceRedirect:!1},()=>{})))},M=new AbortController,R=this.onTransactionModalStateChange(j=>{j?.openModal||(R(),j||M.abort())});try{const j=yield this.waitForSendTransaction({transaction:t,signal:M.signal},a);return this.tracker.trackTransactionSigned(this.wallet,t,j),Za.setAction({name:"transaction-sent",showNotification:l.includes("success"),openModal:d.includes("success")}),j}catch(j){throw Za.setAction({name:"transaction-canceled",showNotification:l.includes("error"),openModal:d.includes("error")}),j instanceof br?j:(console.error(j),new Bo("Unhandled error:"+j))}finally{R()}})}connectEmbeddedWallet(t){return bi(this,null,function*(){const r=d=>{Ms(t),this.connector.connect({jsBridgeKey:t.jsBridgeKey},d)},l=mi.connectRequestParameters;return l?.state==="loading"?this.connectRequestParametersCallback=r:r(l?.value),yield this.waitForWalletConnection({ignoreErrors:!1})})}connectExternalWallet(){return bi(this,null,function*(){const t=new AbortController;Za.openWalletsModal();const r=this.onModalStateChange(l=>{const{status:d,closeReason:m}=l;d!=="opened"&&(r(),m==="action-cancelled"&&t.abort())});return yield this.waitForWalletConnection({ignoreErrors:!0,signal:t.signal})})}waitForWalletConnection(t){return bi(this,null,function*(){return new Promise((r,l)=>{this.tracker.trackConnectionStarted();const{ignoreErrors:d=!1,signal:m=null}=t;if(m&&m.aborted)return this.tracker.trackConnectionError("Connection was cancelled"),l(new Bo("Wallet was not connected"));const x=M=>bi(this,null,function*(){if(M)this.tracker.trackConnectionCompleted(M),a(),r(M);else{if(this.tracker.trackConnectionError("Connection was cancelled"),d)return;a(),l(new Bo("Wallet was not connected"))}}),C=M=>{this.tracker.trackConnectionError(M.message),!d&&(a(),l(M))},a=this.onStatusChange(M=>x(M),M=>C(M));m&&m.addEventListener("abort",()=>{a(),l(new Bo("Wallet was not connected"))},{once:!0})})})}waitForSendTransaction(t,r){return bi(this,null,function*(){return new Promise((l,d)=>{const{transaction:m,signal:x}=t;if(x.aborted)return this.tracker.trackTransactionSigningFailed(this.wallet,m,"Transaction was cancelled"),d(new Bo("Transaction was not sent"));const C=R=>bi(this,null,function*(){l(R)}),a=R=>{d(R)},M=()=>{this.tracker.trackTransactionSigningFailed(this.wallet,m,"Transaction was cancelled"),d(new Bo("Transaction was not sent"))};x.addEventListener("abort",M,{once:!0}),this.connector.sendTransaction(m,{onRequestSent:r,signal:x}).then(R=>(x.removeEventListener("abort",M),C(R))).catch(R=>(x.removeEventListener("abort",M),a(R)))})})}onTransactionModalStateChange(t){return this.transactionModal.onStateChange(t)}subscribeToWalletChange(){this.connector.onStatusChange(t=>bi(this,null,function*(){var r;t?(yield this.updateWalletInfo(t),this.setPreferredWalletAppName(((r=this.walletInfo)==null?void 0:r.appName)||t.device.appName)):this.walletInfoStorage.removeWalletInfo()}))}setPreferredWalletAppName(t){this.preferredWalletStorage.setPreferredWalletAppName(t),e_({preferredWalletAppName:t})}getSelectedWalletInfo(t){return bi(this,null,function*(){let r=Za.getSelectedWalletInfo();if(!r)return null;let l;if("name"in r)l=r;else{const m=qw(yield this.walletsList,mi.walletsListConfiguration).find(x=>pd(x,t.device.appName));if(!m)throw new Bo(`Cannot find WalletInfo for the '${t.device.appName}' wallet`);l=Ai(Ai({},m),r)}return l})}updateWalletInfo(t){return bi(this,null,function*(){const r=yield this.getSelectedWalletInfo(t);if(r){this.walletInfo=r,this.walletInfoStorage.setWalletInfo(r);return}const l=this.walletInfoStorage.getWalletInfo();if(l){this.walletInfo=l;return}this.walletInfo=(yield this.walletsList).find(d=>pd(d,t.device.appName))||null})}normalizeWidgetRoot(t){if(!t||!document.getElementById(t)){t="tc-widget-root";const r=document.createElement("div");r.id=t,document.body.appendChild(r)}return t}checkButtonRootExist(t){if(t!=null&&!document.getElementById(t))throw new Bo(`${t} element not found in the document.`)}getModalsAndNotificationsConfiguration(t){var r,l,d,m,x,C;const a=["before","success","error"];let M=a;(r=this.actionsConfiguration)!=null&&r.notifications&&((l=this.actionsConfiguration)==null?void 0:l.notifications)!=="all"&&(M=this.actionsConfiguration.notifications),t?.notifications&&(t.notifications==="all"?M=a:M=t.notifications);let R=["before"];(d=this.actionsConfiguration)!=null&&d.modals&&(this.actionsConfiguration.modals==="all"?R=a:R=this.actionsConfiguration.modals),t?.modals&&(t.modals==="all"?R=a:R=t.modals);const j=t?.returnStrategy||((m=this.actionsConfiguration)==null?void 0:m.returnStrategy)||"back",F=t?.twaReturnUrl||((x=this.actionsConfiguration)==null?void 0:x.twaReturnUrl);let Z=t?.skipRedirectToWallet||((C=this.actionsConfiguration)==null?void 0:C.skipRedirectToWallet)||"ios";return ph()&&(Z="never"),{notifications:M,modals:R,returnStrategy:j,twaReturnUrl:F,skipRedirectToWallet:Z}}}var GR=Object.defineProperty,X_=Object.getOwnPropertySymbols,IS=Object.prototype.hasOwnProperty,LS=Object.prototype.propertyIsEnumerable,g4=(n,t,r)=>t in n?GR(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,ZR=(n,t)=>{for(var r in t||(t={}))IS.call(t,r)&&g4(n,r,t[r]);if(X_)for(var r of X_(t))LS.call(t,r)&&g4(n,r,t[r]);return n},HR=(n,t)=>{var r={};for(var l in n)IS.call(n,l)&&t.indexOf(l)<0&&(r[l]=n[l]);if(n!=null&&X_)for(var l of X_(n))t.indexOf(l)<0&&LS.call(n,l)&&(r[l]=n[l]);return r},RS={exports:{}},Gg={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _4;function KR(){if(_4)return Gg;_4=1;var n=pT,t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,d=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,m={key:!0,ref:!0,__self:!0,__source:!0};function x(C,a,M){var R,j={},F=null,Z=null;M!==void 0&&(F=""+M),a.key!==void 0&&(F=""+a.key),a.ref!==void 0&&(Z=a.ref);for(R in a)l.call(a,R)&&!m.hasOwnProperty(R)&&(j[R]=a[R]);if(C&&C.defaultProps)for(R in a=C.defaultProps,a)j[R]===void 0&&(j[R]=a[R]);return{$$typeof:t,type:C,key:F,ref:Z,props:j,_owner:d.current}}return Gg.Fragment=r,Gg.jsx=x,Gg.jsxs=x,Gg}(function(n){n.exports=KR()})(RS);const OS=RS.exports.jsx;function DS(){return typeof window<"u"}function XR(){return!DS()}const zS=He.createContext(null);let Wv=null;const YR=n=>{var t=n,{children:r}=t,l=HR(t,["children"]);return DS()&&!Wv&&(Wv=new qR(l)),OS(zS.Provider,{value:Wv,children:r})},JR=He.memo(YR);class Zw extends Bo{constructor(...t){super(...t),Object.setPrototypeOf(this,Zw.prototype)}}class Hw extends Zw{constructor(...t){super(...t),Object.setPrototypeOf(this,Hw.prototype)}}function QR(n){if(!n)throw new Hw("You should add <TonConnectUIProvider> on the top of the app to use TonConnect");return!0}function eO(){const n=He.useContext(zS),t=He.useCallback(r=>{n&&(n.uiOptions=r)},[n]);return XR()?[null,()=>{}]:(QR(n),[n,t])}const y4="ton-connect-button",tO=({className:n,style:t})=>{const[r,l]=eO();return He.useEffect(()=>(l({buttonRootId:y4}),()=>l({buttonRootId:null})),[l]),OS("div",{id:y4,className:n,style:ZR({width:"fit-content"},t)})};He.memo(tO);const r_=n=>typeof n=="object"&&n!==null,BS=(n,t)=>{if(n===t)return!0;if(n==null||t==null||!r_(n)&&!r_(t))return!1;if(r_(n)&&r_(t)){if(Object.keys(n).length!==Object.keys(t).length)return!1;for(const r in n)if(Object.prototype.hasOwnProperty.call(n,r)&&Object.prototype.hasOwnProperty.call(t,r)){if(!BS(n[r],t[r]))return!1}else return!1;return!0}return!1},nO=n=>{const t=He.useRef(n);return BS(t.current,n)||(t.current=n),t.current};function rO(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function fi(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{},l=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(r).filter(function(d){return Object.getOwnPropertyDescriptor(r,d).enumerable}))),l.forEach(function(d){rO(n,d,r[d])})}return n}function iO(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);r.push.apply(r,l)}return r}function No(n,t){return t=t??{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):iO(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))}),n}function oO(n,t){if(n==null)return{};var r={},l=Object.keys(n),d,m;for(m=0;m<l.length;m++)d=l[m],!(t.indexOf(d)>=0)&&(r[d]=n[d]);return r}function mo(n,t){if(n==null)return{};var r=oO(n,t),l,d;if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(n);for(d=0;d<m.length;d++)l=m[d],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(n,l)&&(r[l]=n[l])}return r}function As(...n){const t=[];return n.forEach(r=>{if(r)switch(typeof r){case"string":t.push(r);break;case"object":Object.keys(r).forEach(l=>{r[l]&&t.push(l)});break;default:t.push(`${r}`)}}),t.join(" ")}function L0(){return L0=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var l=arguments[r];for(var d in l)Object.prototype.hasOwnProperty.call(l,d)&&(t[d]=l[d])}return t},L0.apply(this,arguments)}function Kw(n){if(n==null)throw new TypeError("Cannot destructure "+n);return n}const sh=n=>n!==void 0&&n!==!1&&n!==null&&n!=="",e1=He.createContext({isRendered:!1}),sO=()=>{const n=He.useContext(e1);if(!n.isRendered)throw new Error("[TGUI] Wrap your app with <AppRoot> component");return n},t1=()=>sO().platform||"base",Cy=!!(typeof window<"u"&&window.document&&window.document.createElement),aO=Cy?He.useLayoutEffect:He.useEffect,lO=(n,t)=>{const r=He.useRef({callbackFunction:n,duration:t});aO(()=>{r.current.callbackFunction=n,r.current.duration=t},[n,t]);const l=He.useRef(),d=He.useCallback(()=>clearTimeout(l?.current),[]);return{set:He.useCallback(()=>{d(),l.current=setTimeout(r.current.callbackFunction,r.current.duration)},[d]),clear:d}},cO=70,v4=225,uO=()=>{const[n,t]=He.useState([]),r=He.useMemo(()=>new Map,[]),l=lO(()=>t([]),v4);function d(C,a,M){const R=Date.now(),j=n.filter(F=>F.date+v4>R);t([...j,{x:C,y:a,date:R,pointerId:M}]),l.set(),r.delete(M)}return{clicks:n,onPointerDown:C=>{const{top:a,left:M}=C.currentTarget.getBoundingClientRect(),R=C.clientX-(M??0),j=C.clientY-(a??0);r.set(C.pointerId,setTimeout(()=>d(R,j,C.pointerId),cO))},onPointerCancel:C=>{const a=r.get(C.pointerId);clearTimeout(a),r.delete(C.pointerId)}}},hO=({clicks:n})=>we.jsx("span",{"aria-hidden":!0,className:"tgui-8071f6e38c77bc0b",children:n.map(t=>we.jsx("span",{className:"tgui-e156954daf886976",style:{top:t.y,left:t.x}},t.date))}),jS=He.forwardRef((n,t)=>{var{Component:r="div",children:l,className:d,interactiveAnimation:m="background",readOnly:x}=n,C=mo(n,["Component","children","className","interactiveAnimation","readOnly"]);const a=t1(),{clicks:M,onPointerCancel:R,onPointerDown:j}=uO(),F=a==="base"&&m==="background"&&!x;return we.jsxs(r,No(fi({ref:t,className:As("tgui-b5d680db78c4cc2e",a==="ios"&&"tgui-34eb6f8b96874d40",m==="opacity"&&"tgui-7c5d6c1f6bbe3eaf",d),onPointerCancel:R,onPointerDown:j,readOnly:x},C),{children:[F&&we.jsx(hO,{clicks:M}),l]}))}),dO={1:"tgui-5c92f90c2701fa17",2:"tgui-809f1f8a3f64154d",3:"tgui-5b8bdfbd2af10f59"},qm=He.forwardRef((n,t)=>{var{weight:r="3",Component:l="span",plain:d=!0,caps:m,className:x}=n,C=mo(n,["weight","Component","plain","caps","className"]);return we.jsx(l,fi({ref:t,className:As("tgui-c3e2e598bd70eee6",d&&"tgui-080a44e6ac3f4d27",r&&dO[r],m&&"tgui-c602097b30e4ede9",x)},C))}),fO={1:"tgui-30064fce0d501f17",2:"tgui-8f63cd31b2513281"},R0=He.forwardRef((n,t)=>{var{level:r="1",className:l,Component:d}=n,m=mo(n,["level","className","Component"]);return we.jsx(qm,No(fi({},m),{ref:t,className:As("tgui-266b6ffdbad2b90e",fO[r],l),Component:d||"h6"}))}),pO={1:"tgui-2916d621b0ea5857",2:"tgui-937d123c23df98b3"},O0=n=>{var{level:t="1",className:r,Component:l}=n,d=mo(n,["level","className","Component"]);return we.jsx(qm,No(fi({},d),{className:As("tgui-f37a43dcc29ade55",pO[t],r),Component:l||"span"}))},Xw=He.forwardRef((n,t)=>{var{weight:r,className:l,Component:d}=n,m=mo(n,["weight","className","Component"]);return we.jsx(qm,No(fi({ref:t},m),{weight:r,className:As("tgui-65c206f0fd891b6b",l),Component:d||"span"}))}),mO=n=>n<40?4:n<96?8:12,gO={number:"tgui-562f7459d74103ea",dot:"tgui-4f69ed647e40e245"},_O={primary:"tgui-6e63faaa2b33f4ae",critical:"tgui-4b52474c713ffa7c",secondary:"tgui-0278f262d68294f0",gray:"tgui-0883e451f3707277",white:"tgui-6b3dbcedd9052940"},NS=n=>{var{type:t,mode:r="primary",large:l,className:d,children:m}=n,x=mo(n,["type","mode","large","className","children"]);const C=t==="number";return we.jsx("span",No(fi({className:As("tgui-c8f4bcd1606fb026",gO[t],_O[r],C&&l&&"tgui-c1a5e9170826a773",d)},x),{children:sh(m)&&C&&we.jsxs(we.Fragment,{children:[l&&we.jsx(R0,{Component:"span",level:"2",weight:"2",children:m}),!l&&we.jsx(O0,{weight:"2",children:m})]})}))},yO=n=>{var{type:t,className:r}=n,l=mo(n,["type","className"]);return t!=="number"?(console.error('[ImageBadge]: Component supports only type="number"'),null):we.jsx(NS,fi({type:"number",className:As("tgui-e3bcc434a6ee9317",r)},l))},Yw=n=>{var{size:t=40,className:r,alt:l,crossOrigin:d,decoding:m,loading:x,referrerPolicy:C,sizes:a,src:M,srcSet:R,useMap:j,style:F,fallbackIcon:Z,children:Y,onLoad:ne,onError:se}=n,xe=mo(n,["size","className","alt","crossOrigin","decoding","loading","referrerPolicy","sizes","src","srcSet","useMap","style","fallbackIcon","children","onLoad","onError"]);const[Se,_e]=He.useState(!1),[Ie,Me]=He.useState(!1),Ve=M||R,Ke=(Ie||!Ve)&&He.isValidElement(Z),et=ge=>{Se||(_e(!0),Me(!1),ne?.(ge))},qe=ge=>{_e(!1),Me(!0),se?.(ge)};return we.jsxs("div",No(fi({style:fi({width:t,minWidth:t,height:t,borderRadius:F?.borderRadius||mO(t)},F),className:As("tgui-30d8642662534eb5",Se&&"tgui-72bd4140eca37f53",r)},xe),{children:[Ve&&we.jsx("img",{alt:l,className:"tgui-1191c597a64dbd25",crossOrigin:d,decoding:m,loading:x,referrerPolicy:C,sizes:a,src:M,srcSet:R,useMap:j,onLoad:et,onError:qe}),Ke&&we.jsx("div",{className:"tgui-5ee2f1c6e1da49b5",children:Z}),Y]}))};Yw.Badge=yO;const FS=n=>{var{className:t,Component:r}=n,l=mo(n,["className","Component"]);return we.jsx(qm,No(fi({},l),{className:As("tgui-e05fce4753086879",t),Component:r||"h5"}))},vO=n=>{var{className:t,Component:r}=n,l=mo(n,["className","Component"]);return we.jsx(qm,No(fi({},l),{Component:r||"h1",className:As("tgui-c6d7432a5c12debe",t)}))},xO={1:"h2",2:"h3",3:"h4"},wO={1:"tgui-2fc52ee93e8068a6",2:"tgui-72c2a480384c4fb1",3:"tgui-45c5f45d3e9105f4"},bO=n=>{var{level:t="2",className:r,Component:l}=n,d=mo(n,["level","className","Component"]);return we.jsx(qm,No(fi({},d),{className:As("tgui-da537051a4a87aec",wO[t],r),Component:l||xO[t]}))},EO=n=>{var{size:t}=n,r=mo(n,["size"]);return t?t<=28?we.jsx(O0,fi({level:t<=24?"2":"1",weight:"1",caps:!0},r)):t===40?we.jsx(FS,fi({weight:"2",caps:!0},r)):t===48?we.jsx(bO,fi({weight:"1",level:"3",caps:!0},r)):we.jsx(vO,fi({weight:"1",caps:!0},r)):null},TO=n=>{var{type:t,className:r}=n,l=mo(n,["type","className"]);if(t!=="number")throw new Error('[ImageBadge]: Component supports only type="number"');return we.jsx(NS,fi({type:"number",className:As("tgui-54214e0db34f53c3",r)},l))},US=n=>{var{className:t,style:r,acronym:l,fallbackIcon:d,size:m}=n,x=mo(n,["className","style","acronym","fallbackIcon","size"]);return we.jsx(Yw,fi({style:fi({borderRadius:"50%"},r),className:As("tgui-91c5537b51b490a7",l&&"tgui-305551eb3f5abb68",t),fallbackIcon:l?we.jsx(EO,{size:m,children:l}):d,size:m},x))};US.Badge=TO;const CO=n=>{var t=L0({},Kw(n));return we.jsx("svg",No(fi({width:"24",height:"24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),{children:we.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.5 4.44a.9.9 0 0 1 1.27 0L12 10.56l6.22-6.14a.9.9 0 0 1 1.27 1.28l-6.21 6.13 6.2 6.13a.9.9 0 0 1-1.26 1.28L12 13.1l-6.23 6.15a.9.9 0 1 1-1.26-1.28l6.2-6.13-6.2-6.13a.9.9 0 0 1-.01-1.27Z",fill:"#A2ACB0"})}))},SO=n=>{var t=L0({},Kw(n));return we.jsxs("svg",No(fi({width:"28",height:"28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),{children:[we.jsxs("g",{clipPath:"url(#close_a)",fill:"currentColor",children:[we.jsx("path",{d:"M14 28c7.66 0 14-6.35 14-14 0-7.66-6.35-14-14.01-14A14.1 14.1 0 0 0 0 14c0 7.65 6.35 14 14 14Z",fillOpacity:".04"}),we.jsx("path",{opacity:".5",d:"M9.17 20C8.51 20 8 19.47 8 18.81c0-.31.11-.61.34-.83L12.31 14l-3.97-3.97A1.15 1.15 0 0 1 8 9.2c0-.67.51-1.17 1.17-1.17.33 0 .59.11.82.33l3.99 3.98 4.02-4c.24-.24.5-.34.81-.34.66 0 1.19.52 1.19 1.17 0 .33-.1.6-.36.85L15.67 14l3.96 3.97c.24.21.36.51.36.84 0 .66-.53 1.19-1.2 1.19-.33 0-.64-.11-.85-.34l-3.96-3.98-3.95 3.98c-.23.23-.53.34-.86.34Z",fillOpacity:".8"})]}),we.jsx("defs",{children:we.jsx("clipPath",{id:"close_a",children:we.jsx("path",{fill:"#fff",d:"M0 0h28v28H0z"})})})]}))},kO=n=>{var t=L0({},Kw(n));return we.jsxs("svg",No(fi({width:"28",height:"28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),{children:[we.jsxs("g",{clipPath:"url(#close_ambient_a)",children:[we.jsx("path",{d:"M14 28c7.66 0 14-6.35 14-14 0-7.66-6.35-14-14.01-14A14.1 14.1 0 0 0 0 14c0 7.65 6.35 14 14 14Z",fill:"#000",fillOpacity:".1"}),we.jsx("path",{d:"M9.17 20C8.51 20 8 19.47 8 18.81c0-.31.11-.61.34-.83L12.31 14l-3.97-3.97A1.15 1.15 0 0 1 8 9.2c0-.67.51-1.17 1.17-1.17.33 0 .59.11.82.33l3.99 3.98 4.02-4c.24-.24.5-.34.81-.34.66 0 1.19.52 1.19 1.17 0 .33-.1.6-.36.85L15.67 14l3.96 3.97c.24.21.36.51.36.84 0 .66-.53 1.19-1.2 1.19-.33 0-.64-.11-.85-.34l-3.96-3.98-3.95 3.98c-.23.23-.53.34-.86.34Z",fill:"#fff"})]}),we.jsx("defs",{children:we.jsx("clipPath",{id:"close_ambient_a",children:we.jsx("path",{fill:"#fff",d:"M0 0h28v28H0z"})})})]}))},MO=n=>t1()==="ios"?we.jsx(O0,fi({level:"1"},n)):we.jsx(R0,fi({level:"2"},n)),$S=n=>{var{type:t,before:r,callout:l,header:d,subheader:m,description:x,background:C,className:a,children:M,onCloseIcon:R}=n,j=mo(n,["type","before","callout","header","subheader","description","background","className","children","onCloseIcon"]);const F=t1(),Z=sh(C);return we.jsxs("section",No(fi({className:As("tgui-c3d21871b48e0ba3",F==="ios"&&"tgui-cefdf70a2d9648ea",F==="base"&&"tgui-7b260d7ad33f3ba0",Z&&"tgui-f80265c401d577b0",t==="inline"&&"tgui-d67d90bbcab86e14",a)},j),{children:[Z&&we.jsx("div",{className:"tgui-11921b54915b369c",children:C}),r,we.jsxs("div",{className:"tgui-a04b768cea14d789",children:[sh(l)&&we.jsx(R0,{className:"tgui-62a759a0c54c3667",level:"2",children:l}),sh(d)&&we.jsx(Xw,{className:"tgui-2646957e5c9379f3",weight:"2",children:d}),sh(m)&&we.jsx(R0,{className:"tgui-62a759a0c54c3667",level:"2",children:m}),sh(x)&&we.jsx(MO,{className:"tgui-1e638bcb841cdfbc",children:x}),sh(M)&&we.jsx("div",{className:"tgui-5e0d89b3bc8342d8",children:M})]}),R&&we.jsxs(jS,{onClick:R,className:"tgui-fa2f2ea4a4ffc035",Component:"div",children:[!Z&&(F==="ios"?we.jsx(CO,{}):we.jsx(SO,{})),Z&&we.jsx(kO,{})]})]}))},AO=n=>{var{children:t}=n,r=mo(n,["children"]);return we.jsxs("svg",No(fi({width:"44",height:"44",viewBox:"0 0 44 44",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r),{children:[we.jsx("use",{xlinkHref:"#spinner_44",fill:"none",children:t}),we.jsx("symbol",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 44 44",id:"spinner_44",children:we.jsx("path",{d:"M22 4C25.1288 4 28.2036 4.81556 30.9211 6.36624C33.6386 7.91693 35.9049 10.1492 37.4967 12.8429C39.0884 15.5365 39.9505 18.5986 39.9979 21.727C40.0454 24.8555 39.2765 27.9423 37.7672 30.683C36.258 33.4237 34.0603 35.7236 31.3911 37.356C28.7219 38.9884 25.6733 39.8968 22.5459 39.9917C19.4185 40.0866 16.3204 39.3647 13.5571 37.8971C10.7939 36.4296 8.46085 34.2671 6.78817 31.6229",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})})]}))},PO=n=>{var{children:t}=n,r=mo(n,["children"]);return we.jsxs("svg",No(fi({width:"36",height:"36",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r),{children:[we.jsx("use",{xlinkHref:"#spinner_36",fill:"none",children:t}),we.jsx("symbol",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36",id:"spinner_36",children:we.jsx("path",{d:"M18 4c2.4335 0 4.825.63432 6.9386 1.84041S28.815 8.7827 30.053 10.8778c1.238 2.0951 1.9085 4.4766 1.9454 6.9099.0369 2.4332-.5611 4.8341-1.735 6.9657-1.1739 2.1317-2.8831 3.9205-4.9592 5.1902-2.0761 1.2696-4.4472 1.9762-6.8796 2.05-2.4324.0738-4.842-.4877-6.9913-1.6292-2.14918-1.1414-3.96375-2.8234-5.26472-4.8799",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"})})]}))},IO=n=>{var{children:t}=n,r=mo(n,["children"]);return we.jsxs("svg",No(fi({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r),{children:[we.jsx("use",{xlinkHref:"#spinner_24",fill:"none",children:t}),we.jsx("symbol",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",id:"spinner_24",children:we.jsx("path",{d:"M12 3c1.5644 0 3.1018.40778 4.4605 1.18312 1.3588.77535 2.492 1.89147 3.2878 3.23831.7959 1.34683 1.2269 2.87787 1.2507 4.44207.0237 1.5642-.3607 3.1076-1.1154 4.478-.7546 1.3703-1.8534 2.5203-3.188 3.3365-1.3347.8162-2.859 1.2704-4.4227 1.3179-1.5636.0474-3.11269-.3136-4.49433-1.0473-1.38163-.7338-2.54815-1.8151-3.38448-3.1371",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round"})})]}))},LO={s:IO,m:PO,l:AO},RO={s:12,m:18,l:22},OO=({size:n})=>{const t=LO[n],r=RO[n];return we.jsx(t,{children:we.jsx("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",from:`0 ${r} ${r}`,to:`360 ${r} ${r}`,dur:"0.7s",repeatCount:"indefinite"})})},DO=n=>{var{children:t}=n,r=mo(n,["children"]);return we.jsxs("svg",No(fi({id:"l151:1947",width:"44",height:"44",viewBox:"0 0 44 44",xmlns:"http://www.w3.org/2000/svg"},r),{children:[we.jsx("g",{transform:"matrix(1,0,0,1,0,0)",children:we.jsx("g",{id:"l151:1947",opacity:"1",style:{mixBlendMode:"normal"},children:we.jsxs("g",{children:[we.jsx("defs",{children:we.jsx("clipPath",{id:"l151:1947_clipPath",x:"-50%",y:"-50%",width:"200%",height:"200%",children:we.jsx("path",{d:"M0,0h44v0v44v0h-44v0v-44z",fill:"white",clipRule:"nonzero"})})}),we.jsxs("g",{clipPath:"url(#l151:1947_clipPath)",children:[we.jsx("g",{transform:"matrix(-0.7071067811865475,-0.7071067811865476,0.7071067811865476,-0.7071067811865475,9.2715,37.5564)",children:we.jsx("g",{id:"l151:1985",opacity:"0.837",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"l151:1985_fill_path",d:"M2,0v0c1.10457,0 2,0.89543 2,2v10c0,1.10457 -0.89543,2 -2,2v0c-1.10457,0 -2,-0.89543 -2,-2v-10c0,-1.10457 0.89543,-2 2,-2z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(1,0,0,1,20,29)",children:we.jsx("g",{id:"l151:1980",opacity:"0.467",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"l151:1980_fill_path",d:"M2,0v0c1.10457,0 2,0.89543 2,2v9c0,1.10457 -0.89543,2 -2,2v0c-1.10457,0 -2,-0.89543 -2,-2v-9c0,-1.10457 0.89543,-2 2,-2z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(0.7071067811865476,-0.7071067811865475,0.7071067811865475,0.7071067811865476,24.8291,27.6569)",children:we.jsx("g",{id:"l151:1982",opacity:"0.153",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"l151:1982_fill_path",d:"M2,0v0c1.10457,0 2,0.89543 2,2v10c0,1.10457 -0.89543,2 -2,2v0c-1.10457,0 -2,-0.89543 -2,-2v-10c0,-1.10457 0.89543,-2 2,-2z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(6.123233995736766e-17,-1,1,6.123233995736766e-17,29,24)",children:we.jsx("g",{id:"l151:1984",opacity:"0.049",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"l151:1984_fill_path",d:"M2,0v0c1.10457,0 2,0.89543 2,2v9c0,1.10457 -0.89543,2 -2,2v0c-1.10457,0 -2,-0.89543 -2,-2v-9c0,-1.10457 0.89543,-2 2,-2z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(-0.7071067811865475,-0.7071067811865476,0.7071067811865476,-0.7071067811865475,27.6592,19.1716)",children:we.jsx("g",{id:"l151:1986",opacity:"0.01",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"l151:1986_fill_path",d:"M2,0v0c1.10457,0 2,0.89543 2,2v10c0,1.10457 -0.89543,2 -2,2v0c-1.10457,0 -2,-0.89543 -2,-2v-10c0,-1.10457 0.89543,-2 2,-2z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(1,0,0,1,20,2)",children:we.jsx("g",{id:"l151:1979",opacity:"0",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"l151:1979_fill_path",d:"M2,0v0c1.10457,0 2,0.89543 2,2v9c0,1.10457 -0.89543,2 -2,2v0c-1.10457,0 -2,-0.89543 -2,-2v-9c0,-1.10457 0.89543,-2 2,-2z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(0.7071067811865476,-0.7071067811865475,0.7071067811865475,0.7071067811865476,6.4473,9.2721)",children:we.jsx("g",{id:"l151:1981",opacity:"0",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"l151:1981_fill_path",d:"M2,0v0c1.10457,0 2,0.89543 2,2v10c0,1.10457 -0.89543,2 -2,2v0c-1.10457,0 -2,-0.89543 -2,-2v-10c0,-1.10457 0.89543,-2 2,-2z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(6.123233995736766e-17,-1,1,6.123233995736766e-17,2,24)",children:we.jsx("g",{id:"l151:1983",opacity:"1",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"l151:1983_fill_path",d:"M2,0v0c1.10457,0 2,0.89543 2,2v9c0,1.10457 -0.89543,2 -2,2v0c-1.10457,0 -2,-0.89543 -2,-2v-9c0,-1.10457 0.89543,-2 2,-2z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})})]})]})})}),we.jsx("animate",{href:"#l151:1985",attributeName:"opacity",values:"0.837;0;1;0.8366;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.75;0.87;1;1;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#l151:1980",attributeName:"opacity",values:"0.467;0;1;0.4669;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.63;0.75;1;1;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#l151:1982",attributeName:"opacity",values:"0.153;0.05;1;0.1534;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.5;0.63;1;1;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#l151:1984",attributeName:"opacity",values:"0.049;0;1;0.0493;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.37;0.5;1;1;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#l151:1986",attributeName:"opacity",values:"0.01;0;1;0.0099;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.25;0.37;1;1;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#l151:1979",attributeName:"opacity",values:"0;0;1;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.13;0.25;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#l151:1981",attributeName:"opacity",values:"0;1;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.13;0.89;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#l151:1983",attributeName:"opacity",values:"1;0;1",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.89;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"})]}))},zO=n=>{var{children:t}=n,r=mo(n,["children"]);return we.jsxs("svg",No(fi({xmlns:"http://www.w3.org/2000/svg",id:"m151:1947",width:"32",height:"32",viewBox:"0 0 32 32"},r),{children:[we.jsx("g",{transform:"matrix(1,0,0,1,0,0)",children:we.jsx("g",{id:"m151:1947",opacity:"1",style:{mixBlendMode:"normal"},children:we.jsxs("g",{children:[we.jsx("defs",{children:we.jsx("clipPath",{id:"m151:1947_clipPath",x:"-50%",y:"-50%",width:"200%",height:"200%",children:we.jsx("path",{d:"M0,0h32v0v32v0h-32v0v-32z",fill:"white",clipRule:"nonzero"})})}),we.jsxs("g",{clipPath:"url(#151:1947_clipPath)",children:[we.jsx("g",{transform:"matrix(-0.7071067811865475,-0.7071067811865476,0.7071067811865476,-0.7071067811865475,6.7429,27.3137)",children:we.jsx("g",{id:"m151:1985",opacity:"0.837",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"m151:1985_fill_path",d:"M1.5,0v0c0.82843,0 1.5,0.67157 1.5,1.5v7.1818c0,0.82843 -0.67157,1.5 -1.5,1.5v0c-0.82843,0 -1.5,-0.67157 -1.5,-1.5v-7.1818c0,-0.82843 0.67157,-1.5 1.5,-1.5z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(1,0,0,1,14.5454,21.0909)",children:we.jsx("g",{id:"m151:1980",opacity:"0.467",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"m151:1980_fill_path",d:"M1.5,0v0c0.82843,0 1.5,0.67157 1.5,1.5v6.4545c0,0.82843 -0.67157,1.5 -1.5,1.5v0c-0.82843,0 -1.5,-0.67157 -1.5,-1.5v-6.4545c0,-0.82843 0.67157,-1.5 1.5,-1.5z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(0.7071067811865476,-0.7071067811865475,0.7071067811865475,0.7071067811865476,18.0575,20.1141)",children:we.jsx("g",{id:"m151:1982",opacity:"0.153",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"m151:1982_fill_path",d:"M1.5,0v0c0.82843,0 1.5,0.67157 1.5,1.5v7.1818c0,0.82843 -0.67157,1.5 -1.5,1.5v0c-0.82843,0 -1.5,-0.67157 -1.5,-1.5v-7.1818c0,-0.82843 0.67157,-1.5 1.5,-1.5z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(6.123233995736766e-17,-1,1,6.123233995736766e-17,21.0909,17.4545)",children:we.jsx("g",{id:"m151:1984",opacity:"0.049",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"m151:1984_fill_path",d:"M1.5,0v0c0.82843,0 1.5,0.67157 1.5,1.5v6.4545c0,0.82843 -0.67157,1.5 -1.5,1.5v0c-0.82843,0 -1.5,-0.67157 -1.5,-1.5v-6.4545c0,-0.82843 0.67157,-1.5 1.5,-1.5z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(-0.7071067811865475,-0.7071067811865476,0.7071067811865476,-0.7071067811865475,20.1157,13.943)",children:we.jsx("g",{id:"m151:1986",opacity:"0.01",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"m151:1986_fill_path",d:"M1.5,0v0c0.82843,0 1.5,0.67157 1.5,1.5v7.1818c0,0.82843 -0.67157,1.5 -1.5,1.5v0c-0.82843,0 -1.5,-0.67157 -1.5,-1.5v-7.1818c0,-0.82843 0.67157,-1.5 1.5,-1.5z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(1,0,0,1,14.5454,1.4545)",children:we.jsx("g",{id:"m151:1979",opacity:"0",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"m151:1979_fill_path",d:"M1.5,0v0c0.82843,0 1.5,0.67157 1.5,1.5v6.4545c0,0.82843 -0.67157,1.5 -1.5,1.5v0c-0.82843,0 -1.5,-0.67157 -1.5,-1.5v-6.4545c0,-0.82843 0.67157,-1.5 1.5,-1.5z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(0.7071067811865476,-0.7071067811865475,0.7071067811865475,0.7071067811865476,4.6889,6.7433)",children:we.jsx("g",{id:"m151:1981",opacity:"0",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"m151:1981_fill_path",d:"M1.5,0v0c0.82843,0 1.5,0.67157 1.5,1.5v7.1818c0,0.82843 -0.67157,1.5 -1.5,1.5v0c-0.82843,0 -1.5,-0.67157 -1.5,-1.5v-7.1818c0,-0.82843 0.67157,-1.5 1.5,-1.5z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(6.123233995736766e-17,-1,1,6.123233995736766e-17,1.4545,17.4545)",children:we.jsx("g",{id:"m151:1983",opacity:"1",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"m151:1983_fill_path",d:"M1.5,0v0c0.82843,0 1.5,0.67157 1.5,1.5v6.4545c0,0.82843 -0.67157,1.5 -1.5,1.5v0c-0.82843,0 -1.5,-0.67157 -1.5,-1.5v-6.4545c0,-0.82843 0.67157,-1.5 1.5,-1.5z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})})]})]})})}),we.jsx("animate",{href:"#m151:1985",attributeName:"opacity",values:"0.837;0;1;0.8366;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.75;0.87;1;1;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#m151:1980",attributeName:"opacity",values:"0.467;0;1;0.4669;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.63;0.75;1;1;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#m151:1982",attributeName:"opacity",values:"0.153;0.05;1;0.1534;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.5;0.63;1;1;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#m151:1984",attributeName:"opacity",values:"0.049;0;1;0.0493;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.37;0.5;1;1;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#m151:1986",attributeName:"opacity",values:"0.01;0;1;0.0099;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.25;0.37;1;1;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#m151:1979",attributeName:"opacity",values:"0;0;1;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.13;0.25;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#m151:1981",attributeName:"opacity",values:"0;1;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.13;0.89;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#m151:1983",attributeName:"opacity",values:"1;0;1",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.89;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"})]}))},BO=n=>{var{children:t}=n,r=mo(n,["children"]);return we.jsxs("svg",No(fi({id:"s151:1947",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},r),{children:[we.jsx("g",{transform:"matrix(1,0,0,1,0,0)",children:we.jsx("g",{id:"s151:1947",opacity:"1",style:{mixBlendMode:"normal"},children:we.jsxs("g",{children:[we.jsx("defs",{children:we.jsx("clipPath",{id:"s151:1947_clipPath",x:"-50%",y:"-50%",width:"200%",height:"200%",children:we.jsx("path",{d:"M0,0h24v0v24v0h-24v0v-24z",fill:"white",clipRule:"nonzero"})})}),we.jsxs("g",{clipPath:"url(#151:1947_clipPath)",children:[we.jsx("g",{transform:"matrix(-0.7071067811865475,-0.7071067811865476,0.7071067811865476,-0.7071067811865475,5.64,19.78)",children:we.jsx("g",{id:"s151:1985",opacity:"0.837",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"s151:1985_fill_path",d:"M1,0v0c0.55228,0 1,0.44772 1,1v5c0,0.55228 -0.44772,1 -1,1v0c-0.55228,0 -1,-0.44772 -1,-1v-5c0,-0.55228 0.44772,-1 1,-1z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(1,0,0,1,11,15)",children:we.jsx("g",{id:"s151:1980",opacity:"0.467",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"s151:1980_fill_path",d:"M1,0v0c0.55228,0 1,0.44772 1,1v5c0,0.55228 -0.44772,1 -1,1v0c-0.55228,0 -1,-0.44772 -1,-1v-5c0,-0.55228 0.44772,-1 1,-1z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(0.7071067811865476,-0.7071067811865475,0.7071067811865475,0.7071067811865476,13.41,14.83)",children:we.jsx("g",{id:"s151:1982",opacity:"0.153",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"s151:1982_fill_path",d:"M1,0v0c0.55228,0 1,0.44772 1,1v5c0,0.55228 -0.44772,1 -1,1v0c-0.55228,0 -1,-0.44772 -1,-1v-5c0,-0.55228 0.44772,-1 1,-1z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(6.123233995736766e-17,-1,1,6.123233995736766e-17,15,13)",children:we.jsx("g",{id:"s151:1984",opacity:"0.049",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"s151:1984_fill_path",d:"M1,0v0c0.55228,0 1,0.44772 1,1v5c0,0.55228 -0.44772,1 -1,1v0c-0.55228,0 -1,-0.44772 -1,-1v-5c0,-0.55228 0.44772,-1 1,-1z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(1,0,0,1,13.41,4.22)",children:we.jsx("g",{id:"s597:11660",opacity:"0",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"s597:11660_fill_path",d:"M2.0341,6.01101c-0.46533,0.46533 -1.21977,0.46533 -1.6851,0c-0.46533,-0.46533 -0.46533,-1.21977 0,-1.6851l3.97691,-3.97691c0.46533,-0.46533 1.21977,-0.46533 1.6851,0c0.46533,0.46533 0.46533,1.21977 0,1.6851z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(1,0,0,1,11,1.9998)",children:we.jsx("g",{id:"s151:1979",opacity:"0",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"s151:1979_fill_path",d:"M1,0v0c0.55228,0 1,0.44772 1,1v5c0,0.55228 -0.44772,1 -1,1v0c-0.55228,0 -1,-0.44772 -1,-1v-5c0,-0.55228 0.44772,-1 1,-1z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(0.7071067811865476,-0.7071067811865475,0.7071067811865475,0.7071067811865476,4.22,5.64)",children:we.jsx("g",{id:"s151:1981",opacity:"0",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"s151:1981_fill_path",d:"M1,0v0c0.55228,0 1,0.44772 1,1v5c0,0.55228 -0.44772,1 -1,1v0c-0.55228,0 -1,-0.44772 -1,-1v-5c0,-0.55228 0.44772,-1 1,-1z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})}),we.jsx("g",{transform:"matrix(6.123233995736766e-17,-1,1,6.123233995736766e-17,2.0003,13)",children:we.jsx("g",{id:"s151:1983",opacity:"1",style:{mixBlendMode:"normal"},children:we.jsx("g",{children:we.jsx("g",{children:we.jsx("path",{id:"s151:1983_fill_path",d:"M1,0v0c0.55228,0 1,0.44772 1,1v5c0,0.55228 -0.44772,1 -1,1v0c-0.55228,0 -1,-0.44772 -1,-1v-5c0,-0.55228 0.44772,-1 1,-1z",fillRule:"nonzero",fill:"currentColor",fillOpacity:"1",style:{mixBlendMode:"normal"}})})})})})]})]})})}),we.jsx("animate",{href:"#s151:1985",attributeName:"opacity",values:"0.837;0;1;0.8366;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.75;0.87;1;1;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#s151:1980",attributeName:"opacity",values:"0.467;0;1;0.4669;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.63;0.75;1;1;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#s151:1982",attributeName:"opacity",values:"0.153;0.05;1;0.1534;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.5;0.63;1;1;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#s151:1984",attributeName:"opacity",values:"0.049;0;1;0.0493;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.37;0.5;1;1;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#s597:11660",attributeName:"opacity",values:"0;0;1;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.25;0.37;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#s151:1979",attributeName:"opacity",values:"0;0;1;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.13;0.25;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#s151:1981",attributeName:"opacity",values:"0;1;0;0",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.13;0.89;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"}),we.jsx("animate",{href:"#s151:1983",attributeName:"opacity",values:"1;0;1",dur:"0.8s",repeatCount:"indefinite",calcMode:"spline",keyTimes:"0;0.89;1",keySplines:"0.5 0.35 0.15 1;0.5 0.35 0.15 1",additive:"replace",fill:"freeze"})]}))},jO=({size:n})=>{switch(n){case"l":return we.jsx(DO,{});case"m":return we.jsx(zO,{});default:return we.jsx(BO,{})}},NO={s:"tgui-421d6dab8d2c78c1",m:"tgui-a636342f03bb5c08",l:"tgui-a53583a4b6d8fde0"},FO=({size:n="m",className:t})=>{const r=t1(),l=r==="ios"?jO:OO;return we.jsx("div",{role:"status",className:As("tgui-0ac8c3540e603b63",r==="ios"&&"tgui-562a3eae646b486d",NO[n],t),children:we.jsx(l,{size:n})})},UO=n=>{var{size:t}=n,r=mo(n,["size"]);return t==="l"?we.jsx(Xw,fi({weight:"2"},r)):we.jsx(R0,fi({level:"2",weight:"2"},r))},$O={filled:"tgui-8a1ca9efa24f4809",bezeled:"tgui-91bda9a36246a33c",plain:"tgui-48956537c34690db",gray:"tgui-93106efd6b6d66ee",outline:"tgui-e884e36ff1faa596",white:"tgui-ba6d30cc81e39ae5"},VO={s:"tgui-13f23a224303ddaa",m:"tgui-1a16a49d89076ff4",l:"tgui-9cef742a22f195c9"},Hf=He.forwardRef((n,t)=>{var{type:r,size:l="m",before:d,after:m,stretched:x,children:C,className:a,mode:M="filled",loading:R,Component:j="button"}=n,F=mo(n,["type","size","before","after","stretched","children","className","mode","loading","Component"]);const Z=t1();return we.jsxs(jS,No(fi({ref:t,type:r||"button",Component:j,className:As("tgui-117e77cd385a9c8d",M&&$O[M],l&&VO[l],Z==="ios"&&"tgui-55e8aa7f5cea2280",x&&"tgui-726846958fe7f4a0",R&&"tgui-490cb0f5ec4998f3",a)},F),{children:[R&&we.jsx(FO,{className:"tgui-014f2b7d196b090d",size:"s"}),sh(d)&&we.jsx("div",{className:"tgui-06cc94d03a7c4dd7",children:d}),we.jsx(UO,{className:"tgui-5f6014c0f063b6de",size:l,children:C}),sh(m)&&we.jsx("div",{className:"tgui-8310172a5320ab71",children:m})]}))});fT();const WO=(n,t)=>{t&&(typeof t=="function"?t(n):t.current=n)},qO=(...n)=>{let t=null;return{get current(){return t},set current(r){t=r,n.forEach(l=>l&&WO(r,l))}}},Lx=()=>{var n;if(Cy)return(n=window.Telegram)===null||n===void 0?void 0:n.WebApp},GO=n=>{if(!Cy||!window.matchMedia)return()=>{};const t=window.matchMedia("(prefers-color-scheme: dark)"),r=()=>{n(t.matches?"dark":"light")};return t.addEventListener("change",r),()=>t.removeEventListener("change",r)},ZO=()=>Cy&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",HO=n=>{const{appearance:t}=He.useContext(e1),[r,l]=He.useState(n||t||ZO()),d=He.useCallback(()=>{const m=Lx();m&&l(m.colorScheme)},[]);return He.useEffect(()=>{if(n!==void 0)return l(n),()=>{};const m=Lx();return m?(m.onEvent("themeChanged",d),()=>m.offEvent("themeChanged",d)):GO(l)},[n]),r},KO=()=>{const n=Lx();return n&&["ios","macos"].includes(n.platform)?"ios":"base"},XO=n=>{if(n!==void 0)return n;const t=He.useContext(e1);return t.isRendered&&t.platform!==void 0?t.platform:KO()},YO=n=>{if(n!==void 0)return n;const t=He.useContext(e1);return t.isRendered&&t.portalContainer!==void 0?t.portalContainer:He.useRef(null)},JO=He.forwardRef((n,t)=>{var{platform:r,appearance:l,portalContainer:d,children:m,className:x}=n,C=mo(n,["platform","appearance","portalContainer","children","className"]);const a=HO(l),M=YO(d),R=XO(r),j=nO({platform:R,appearance:a,portalContainer:M,isRendered:!0});return we.jsx("div",No(fi({ref:qO(t,M),className:As("tgui-6a12827a138e8827",R==="ios"&&"tgui-56dbb42c1dbd5e2b",a==="dark"&&"tgui-865b921add8ee075",x)},C),{children:we.jsx(e1.Provider,{value:j,children:m})}))});/**
 * @remix-run/router v1.17.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function D0(){return D0=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(n[l]=r[l])}return n},D0.apply(this,arguments)}var _d;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(_d||(_d={}));const x4="popstate";function QO(n){n===void 0&&(n={});function t(d,m){let{pathname:x="/",search:C="",hash:a=""}=ap(d.location.hash.substr(1));return!x.startsWith("/")&&!x.startsWith(".")&&(x="/"+x),Rx("",{pathname:x,search:C,hash:a},m.state&&m.state.usr||null,m.state&&m.state.key||"default")}function r(d,m){let x=d.document.querySelector("base"),C="";if(x&&x.getAttribute("href")){let a=d.location.href,M=a.indexOf("#");C=M===-1?a:a.slice(0,M)}return C+"#"+(typeof m=="string"?m:VS(m))}function l(d,m){Jw(d.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(m)+")")}return tD(t,r,l,n)}function qo(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function Jw(n,t){if(!n){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function eD(){return Math.random().toString(36).substr(2,8)}function w4(n,t){return{usr:n.state,key:n.key,idx:t}}function Rx(n,t,r,l){return r===void 0&&(r=null),D0({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof t=="string"?ap(t):t,{state:r,key:t&&t.key||l||eD()})}function VS(n){let{pathname:t="/",search:r="",hash:l=""}=n;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),l&&l!=="#"&&(t+=l.charAt(0)==="#"?l:"#"+l),t}function ap(n){let t={};if(n){let r=n.indexOf("#");r>=0&&(t.hash=n.substr(r),n=n.substr(0,r));let l=n.indexOf("?");l>=0&&(t.search=n.substr(l),n=n.substr(0,l)),n&&(t.pathname=n)}return t}function tD(n,t,r,l){l===void 0&&(l={});let{window:d=document.defaultView,v5Compat:m=!1}=l,x=d.history,C=_d.Pop,a=null,M=R();M==null&&(M=0,x.replaceState(D0({},x.state,{idx:M}),""));function R(){return(x.state||{idx:null}).idx}function j(){C=_d.Pop;let se=R(),xe=se==null?null:se-M;M=se,a&&a({action:C,location:ne.location,delta:xe})}function F(se,xe){C=_d.Push;let Se=Rx(ne.location,se,xe);r&&r(Se,se),M=R()+1;let _e=w4(Se,M),Ie=ne.createHref(Se);try{x.pushState(_e,"",Ie)}catch(Me){if(Me instanceof DOMException&&Me.name==="DataCloneError")throw Me;d.location.assign(Ie)}m&&a&&a({action:C,location:ne.location,delta:1})}function Z(se,xe){C=_d.Replace;let Se=Rx(ne.location,se,xe);r&&r(Se,se),M=R();let _e=w4(Se,M),Ie=ne.createHref(Se);x.replaceState(_e,"",Ie),m&&a&&a({action:C,location:ne.location,delta:0})}function Y(se){let xe=d.location.origin!=="null"?d.location.origin:d.location.href,Se=typeof se=="string"?se:VS(se);return Se=Se.replace(/ $/,"%20"),qo(xe,"No window.location.(origin|href) available to create URL for href: "+Se),new URL(Se,xe)}let ne={get action(){return C},get location(){return n(d,x)},listen(se){if(a)throw new Error("A history only accepts one active listener");return d.addEventListener(x4,j),a=se,()=>{d.removeEventListener(x4,j),a=null}},createHref(se){return t(d,se)},createURL:Y,encodeLocation(se){let xe=Y(se);return{pathname:xe.pathname,search:xe.search,hash:xe.hash}},push:F,replace:Z,go(se){return x.go(se)}};return ne}var b4;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(b4||(b4={}));function nD(n,t,r){return r===void 0&&(r="/"),rD(n,t,r)}function rD(n,t,r,l){let d=typeof t=="string"?ap(t):t,m=GS(d.pathname||"/",r);if(m==null)return null;let x=WS(n);iD(x);let C=null;for(let a=0;C==null&&a<x.length;++a){let M=gD(m);C=fD(x[a],M)}return C}function WS(n,t,r,l){t===void 0&&(t=[]),r===void 0&&(r=[]),l===void 0&&(l="");let d=(m,x,C)=>{let a={relativePath:C===void 0?m.path||"":C,caseSensitive:m.caseSensitive===!0,childrenIndex:x,route:m};a.relativePath.startsWith("/")&&(qo(a.relativePath.startsWith(l),'Absolute route path "'+a.relativePath+'" nested under path '+('"'+l+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),a.relativePath=a.relativePath.slice(l.length));let M=tp([l,a.relativePath]),R=r.concat(a);m.children&&m.children.length>0&&(qo(m.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+M+'".')),WS(m.children,t,R,M)),!(m.path==null&&!m.index)&&t.push({path:M,score:hD(M,m.index),routesMeta:R})};return n.forEach((m,x)=>{var C;if(m.path===""||!((C=m.path)!=null&&C.includes("?")))d(m,x);else for(let a of qS(m.path))d(m,x,a)}),t}function qS(n){let t=n.split("/");if(t.length===0)return[];let[r,...l]=t,d=r.endsWith("?"),m=r.replace(/\?$/,"");if(l.length===0)return d?[m,""]:[m];let x=qS(l.join("/")),C=[];return C.push(...x.map(a=>a===""?m:[m,a].join("/"))),d&&C.push(...x),C.map(a=>n.startsWith("/")&&a===""?"/":a)}function iD(n){n.sort((t,r)=>t.score!==r.score?r.score-t.score:dD(t.routesMeta.map(l=>l.childrenIndex),r.routesMeta.map(l=>l.childrenIndex)))}const oD=/^:[\w-]+$/,sD=3,aD=2,lD=1,cD=10,uD=-2,E4=n=>n==="*";function hD(n,t){let r=n.split("/"),l=r.length;return r.some(E4)&&(l+=uD),t&&(l+=aD),r.filter(d=>!E4(d)).reduce((d,m)=>d+(oD.test(m)?sD:m===""?lD:cD),l)}function dD(n,t){return n.length===t.length&&n.slice(0,-1).every((l,d)=>l===t[d])?n[n.length-1]-t[t.length-1]:0}function fD(n,t,r){let{routesMeta:l}=n,d={},m="/",x=[];for(let C=0;C<l.length;++C){let a=l[C],M=C===l.length-1,R=m==="/"?t:t.slice(m.length)||"/",j=pD({path:a.relativePath,caseSensitive:a.caseSensitive,end:M},R),F=a.route;if(!j)return null;Object.assign(d,j.params),x.push({params:d,pathname:tp([m,j.pathname]),pathnameBase:xD(tp([m,j.pathnameBase])),route:F}),j.pathnameBase!=="/"&&(m=tp([m,j.pathnameBase]))}return x}function pD(n,t){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[r,l]=mD(n.path,n.caseSensitive,n.end),d=t.match(r);if(!d)return null;let m=d[0],x=m.replace(/(.)\/+$/,"$1"),C=d.slice(1);return{params:l.reduce((M,R,j)=>{let{paramName:F,isOptional:Z}=R;if(F==="*"){let ne=C[j]||"";x=m.slice(0,m.length-ne.length).replace(/(.)\/+$/,"$1")}const Y=C[j];return Z&&!Y?M[F]=void 0:M[F]=(Y||"").replace(/%2F/g,"/"),M},{}),pathname:m,pathnameBase:x,pattern:n}}function mD(n,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Jw(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let l=[],d="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(x,C,a)=>(l.push({paramName:C,isOptional:a!=null}),a?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(l.push({paramName:"*"}),d+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?d+="\\/*$":n!==""&&n!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,t?void 0:"i"),l]}function gD(n){try{return n.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Jw(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),n}}function GS(n,t){if(t==="/")return n;if(!n.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,l=n.charAt(r);return l&&l!=="/"?null:n.slice(r)||"/"}function _D(n,t){t===void 0&&(t="/");let{pathname:r,search:l="",hash:d=""}=typeof n=="string"?ap(n):n;return{pathname:r?r.startsWith("/")?r:yD(r,t):t,search:wD(l),hash:bD(d)}}function yD(n,t){let r=t.replace(/\/+$/,"").split("/");return n.split("/").forEach(d=>{d===".."?r.length>1&&r.pop():d!=="."&&r.push(d)}),r.length>1?r.join("/"):"/"}function qv(n,t,r,l){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(l)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function vD(n){return n.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function ZS(n,t){let r=vD(n);return t?r.map((l,d)=>d===n.length-1?l.pathname:l.pathnameBase):r.map(l=>l.pathnameBase)}function HS(n,t,r,l){l===void 0&&(l=!1);let d;typeof n=="string"?d=ap(n):(d=D0({},n),qo(!d.pathname||!d.pathname.includes("?"),qv("?","pathname","search",d)),qo(!d.pathname||!d.pathname.includes("#"),qv("#","pathname","hash",d)),qo(!d.search||!d.search.includes("#"),qv("#","search","hash",d)));let m=n===""||d.pathname==="",x=m?"/":d.pathname,C;if(x==null)C=r;else{let j=t.length-1;if(!l&&x.startsWith("..")){let F=x.split("/");for(;F[0]==="..";)F.shift(),j-=1;d.pathname=F.join("/")}C=j>=0?t[j]:"/"}let a=_D(d,C),M=x&&x!=="/"&&x.endsWith("/"),R=(m||x===".")&&r.endsWith("/");return!a.pathname.endsWith("/")&&(M||R)&&(a.pathname+="/"),a}const tp=n=>n.join("/").replace(/\/\/+/g,"/"),xD=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),wD=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,bD=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function ED(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const KS=["post","put","patch","delete"];new Set(KS);const TD=["get",...KS];new Set(TD);/**
 * React Router v6.24.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function z0(){return z0=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(n[l]=r[l])}return n},z0.apply(this,arguments)}const Qw=He.createContext(null),CD=He.createContext(null),n1=He.createContext(null),Sy=He.createContext(null),lp=He.createContext({outlet:null,matches:[],isDataRoute:!1}),XS=He.createContext(null);function r1(){return He.useContext(Sy)!=null}function eb(){return r1()||qo(!1),He.useContext(Sy).location}function YS(n){He.useContext(n1).static||He.useLayoutEffect(n)}function JS(){let{isDataRoute:n}=He.useContext(lp);return n?jD():SD()}function SD(){r1()||qo(!1);let n=He.useContext(Qw),{basename:t,future:r,navigator:l}=He.useContext(n1),{matches:d}=He.useContext(lp),{pathname:m}=eb(),x=JSON.stringify(ZS(d,r.v7_relativeSplatPath)),C=He.useRef(!1);return YS(()=>{C.current=!0}),He.useCallback(function(M,R){if(R===void 0&&(R={}),!C.current)return;if(typeof M=="number"){l.go(M);return}let j=HS(M,JSON.parse(x),m,R.relative==="path");n==null&&t!=="/"&&(j.pathname=j.pathname==="/"?t:tp([t,j.pathname])),(R.replace?l.replace:l.push)(j,R.state,R)},[t,l,x,m,n])}function kD(n,t){return MD(n,t)}function MD(n,t,r,l){r1()||qo(!1);let{navigator:d}=He.useContext(n1),{matches:m}=He.useContext(lp),x=m[m.length-1],C=x?x.params:{};x&&x.pathname;let a=x?x.pathnameBase:"/";x&&x.route;let M=eb(),R;if(t){var j;let se=typeof t=="string"?ap(t):t;a==="/"||(j=se.pathname)!=null&&j.startsWith(a)||qo(!1),R=se}else R=M;let F=R.pathname||"/",Z=F;if(a!=="/"){let se=a.replace(/^\//,"").split("/");Z="/"+F.replace(/^\//,"").split("/").slice(se.length).join("/")}let Y=nD(n,{pathname:Z}),ne=RD(Y&&Y.map(se=>Object.assign({},se,{params:Object.assign({},C,se.params),pathname:tp([a,d.encodeLocation?d.encodeLocation(se.pathname).pathname:se.pathname]),pathnameBase:se.pathnameBase==="/"?a:tp([a,d.encodeLocation?d.encodeLocation(se.pathnameBase).pathname:se.pathnameBase])})),m,r,l);return t&&ne?He.createElement(Sy.Provider,{value:{location:z0({pathname:"/",search:"",hash:"",state:null,key:"default"},R),navigationType:_d.Pop}},ne):ne}function AD(){let n=BD(),t=ED(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),r=n instanceof Error?n.stack:null,d={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return He.createElement(He.Fragment,null,He.createElement("h2",null,"Unexpected Application Error!"),He.createElement("h3",{style:{fontStyle:"italic"}},t),r?He.createElement("pre",{style:d},r):null,null)}const PD=He.createElement(AD,null);class ID extends He.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?He.createElement(lp.Provider,{value:this.props.routeContext},He.createElement(XS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function LD(n){let{routeContext:t,match:r,children:l}=n,d=He.useContext(Qw);return d&&d.static&&d.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(d.staticContext._deepestRenderedBoundaryId=r.route.id),He.createElement(lp.Provider,{value:t},l)}function RD(n,t,r,l){var d;if(t===void 0&&(t=[]),r===void 0&&(r=null),l===void 0&&(l=null),n==null){var m;if((m=r)!=null&&m.errors)n=r.matches;else return null}let x=n,C=(d=r)==null?void 0:d.errors;if(C!=null){let R=x.findIndex(j=>j.route.id&&C?.[j.route.id]!==void 0);R>=0||qo(!1),x=x.slice(0,Math.min(x.length,R+1))}let a=!1,M=-1;if(r&&l&&l.v7_partialHydration)for(let R=0;R<x.length;R++){let j=x[R];if((j.route.HydrateFallback||j.route.hydrateFallbackElement)&&(M=R),j.route.id){let{loaderData:F,errors:Z}=r,Y=j.route.loader&&F[j.route.id]===void 0&&(!Z||Z[j.route.id]===void 0);if(j.route.lazy||Y){a=!0,M>=0?x=x.slice(0,M+1):x=[x[0]];break}}}return x.reduceRight((R,j,F)=>{let Z,Y=!1,ne=null,se=null;r&&(Z=C&&j.route.id?C[j.route.id]:void 0,ne=j.route.errorElement||PD,a&&(M<0&&F===0?(ND("route-fallback"),Y=!0,se=null):M===F&&(Y=!0,se=j.route.hydrateFallbackElement||null)));let xe=t.concat(x.slice(0,F+1)),Se=()=>{let _e;return Z?_e=ne:Y?_e=se:j.route.Component?_e=He.createElement(j.route.Component,null):j.route.element?_e=j.route.element:_e=R,He.createElement(LD,{match:j,routeContext:{outlet:R,matches:xe,isDataRoute:r!=null},children:_e})};return r&&(j.route.ErrorBoundary||j.route.errorElement||F===0)?He.createElement(ID,{location:r.location,revalidation:r.revalidation,component:ne,error:Z,children:Se(),routeContext:{outlet:null,matches:xe,isDataRoute:!0}}):Se()},null)}var QS=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(QS||{}),e6=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(e6||{});function OD(n){let t=He.useContext(Qw);return t||qo(!1),t}function DD(n){let t=He.useContext(CD);return t||qo(!1),t}function zD(n){let t=He.useContext(lp);return t||qo(!1),t}function t6(n){let t=zD(),r=t.matches[t.matches.length-1];return r.route.id||qo(!1),r.route.id}function BD(){var n;let t=He.useContext(XS),r=DD(),l=t6();return t!==void 0?t:(n=r.errors)==null?void 0:n[l]}function jD(){let{router:n}=OD(QS.UseNavigateStable),t=t6(e6.UseNavigateStable),r=He.useRef(!1);return YS(()=>{r.current=!0}),He.useCallback(function(d,m){m===void 0&&(m={}),r.current&&(typeof d=="number"?n.navigate(d):n.navigate(d,z0({fromRouteId:t},m)))},[n,t])}const T4={};function ND(n,t,r){T4[n]||(T4[n]=!0)}function FD(n){let{to:t,replace:r,state:l,relative:d}=n;r1()||qo(!1);let{future:m,static:x}=He.useContext(n1),{matches:C}=He.useContext(lp),{pathname:a}=eb(),M=JS(),R=HS(t,ZS(C,m.v7_relativeSplatPath),a,d==="path"),j=JSON.stringify(R);return He.useEffect(()=>M(JSON.parse(j),{replace:r,state:l,relative:d}),[M,j,d,r,l]),null}function Ox(n){qo(!1)}function UD(n){let{basename:t="/",children:r=null,location:l,navigationType:d=_d.Pop,navigator:m,static:x=!1,future:C}=n;r1()&&qo(!1);let a=t.replace(/^\/*/,"/"),M=He.useMemo(()=>({basename:a,navigator:m,static:x,future:z0({v7_relativeSplatPath:!1},C)}),[a,C,m,x]);typeof l=="string"&&(l=ap(l));let{pathname:R="/",search:j="",hash:F="",state:Z=null,key:Y="default"}=l,ne=He.useMemo(()=>{let se=GS(R,a);return se==null?null:{location:{pathname:se,search:j,hash:F,state:Z,key:Y},navigationType:d}},[a,R,j,F,Z,Y,d]);return ne==null?null:He.createElement(n1.Provider,{value:M},He.createElement(Sy.Provider,{children:r,value:ne}))}function $D(n){let{children:t,location:r}=n;return kD(Dx(t),r)}new Promise(()=>{});function Dx(n,t){t===void 0&&(t=[]);let r=[];return He.Children.forEach(n,(l,d)=>{if(!He.isValidElement(l))return;let m=[...t,d];if(l.type===He.Fragment){r.push.apply(r,Dx(l.props.children,m));return}l.type!==Ox&&qo(!1),!l.props.index||!l.props.children||qo(!1);let x={id:l.props.id||m.join("-"),caseSensitive:l.props.caseSensitive,element:l.props.element,Component:l.props.Component,index:l.props.index,path:l.props.path,loader:l.props.loader,action:l.props.action,errorElement:l.props.errorElement,ErrorBoundary:l.props.ErrorBoundary,hasErrorBoundary:l.props.ErrorBoundary!=null||l.props.errorElement!=null,shouldRevalidate:l.props.shouldRevalidate,handle:l.props.handle,lazy:l.props.lazy};l.props.children&&(x.children=Dx(l.props.children,m)),r.push(x)}),r}/**
 * React Router DOM v6.24.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const VD="6";try{window.__reactRouterVersion=VD}catch{}const WD="startTransition",C4=Ck[WD];function qD(n){let{basename:t,children:r,future:l,window:d}=n,m=He.useRef();m.current==null&&(m.current=QO({window:d,v5Compat:!0}));let x=m.current,[C,a]=He.useState({action:x.action,location:x.location}),{v7_startTransition:M}=l||{},R=He.useCallback(j=>{M&&C4?C4(()=>a(j)):a(j)},[a,M]);return He.useLayoutEffect(()=>x.listen(R),[x,R]),He.createElement(UD,{basename:t,children:r,location:C.location,navigationType:C.action,navigator:x,future:l})}var S4;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(S4||(S4={}));var k4;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(k4||(k4={}));function GD({children:n,back:t=!0}){const r=JS();return He.useEffect(()=>{if(t)return a0.show(),a0.onClick(()=>{r(-1)});a0.hide()},[t]),we.jsx(we.Fragment,{children:n})}function Y_(){return Y_=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var l in r)({}).hasOwnProperty.call(r,l)&&(n[l]=r[l])}return n},Y_.apply(null,arguments)}function zx(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,l=Array(t);r<t;r++)l[r]=n[r];return l}function ZD(n){if(Array.isArray(n))return zx(n)}function HD(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function n6(n,t){if(n){if(typeof n=="string")return zx(n,t);var r={}.toString.call(n).slice(8,-1);return r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set"?Array.from(n):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?zx(n,t):void 0}}function KD(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XD(n){return ZD(n)||HD(n)||n6(n)||KD()}function zm(n){"@babel/helpers - typeof";return zm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zm(n)}function YD(n,t){if(zm(n)!="object"||!n)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var l=r.call(n,t);if(zm(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}function r6(n){var t=YD(n,"string");return zm(t)=="symbol"?t:t+""}function Vn(n,t,r){return(t=r6(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}var Gv={exports:{}},Zv,M4;function JD(){if(M4)return Zv;M4=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Zv=n,Zv}var Hv,A4;function QD(){if(A4)return Hv;A4=1;var n=JD();function t(){}function r(){}return r.resetWarningCache=t,Hv=function(){function l(x,C,a,M,R,j){if(j!==n){var F=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw F.name="Invariant Violation",F}}l.isRequired=l;function d(){return l}var m={array:l,bigint:l,bool:l,func:l,number:l,object:l,string:l,symbol:l,any:l,arrayOf:d,element:l,elementType:l,instanceOf:d,node:l,objectOf:d,oneOf:d,oneOfType:d,shape:d,exact:d,checkPropTypes:r,resetWarningCache:t};return m.PropTypes=m,m},Hv}var P4;function ez(){return P4||(P4=1,Gv.exports=QD()()),Gv.exports}var pt=ez();function tz(n){if(Array.isArray(n))return n}function nz(n,t){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var l,d,m,x,C=[],a=!0,M=!1;try{if(m=(r=r.call(n)).next,t===0){if(Object(r)!==r)return;a=!1}else for(;!(a=(l=m.call(r)).done)&&(C.push(l.value),C.length!==t);a=!0);}catch(R){M=!0,d=R}finally{try{if(!a&&r.return!=null&&(x=r.return(),Object(x)!==x))return}finally{if(M)throw d}}return C}}function rz(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Go(n,t){return tz(n)||nz(n,t)||n6(n,t)||rz()}var $s=1e-6,Bm=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var n=0,t=arguments.length;t--;)n+=arguments[t]*arguments[t];return Math.sqrt(n)});function iz(){var n=new Bm(4);return Bm!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function oz(n,t,r){return n[0]=t[0]*r,n[1]=t[1]*r,n[2]=t[2]*r,n[3]=t[3]*r,n}function sz(n,t,r){var l=t[0],d=t[1],m=t[2],x=t[3];return n[0]=r[0]*l+r[4]*d+r[8]*m+r[12]*x,n[1]=r[1]*l+r[5]*d+r[9]*m+r[13]*x,n[2]=r[2]*l+r[6]*d+r[10]*m+r[14]*x,n[3]=r[3]*l+r[7]*d+r[11]*m+r[15]*x,n}(function(){var n=iz();return function(t,r,l,d,m,x){var C,a;for(r||(r=4),l||(l=0),d?a=Math.min(d*r+l,t.length):a=t.length,C=l;C<a;C+=r)n[0]=t[C],n[1]=t[C+1],n[2]=t[C+2],n[3]=t[C+3],m(n,n,x),t[C]=n[0],t[C+1]=n[1],t[C+2]=n[2],t[C+3]=n[3];return t}})();function b_(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Pm(n,t){const r=sz([],t,n);return oz(r,r,1/r[3]),r}function I4(n,t){const r=n%t;return r<0?t+r:r}function az(n,t,r){return r*t+(1-r)*n}function Bx(n,t,r){return n<t?t:n>r?r:n}function lz(n){return Math.log(n)*Math.LOG2E}const tb=Math.log2||lz;function cz(n,t){var r=t[0],l=t[1],d=t[2],m=t[3],x=t[4],C=t[5],a=t[6],M=t[7],R=t[8],j=t[9],F=t[10],Z=t[11],Y=t[12],ne=t[13],se=t[14],xe=t[15],Se=r*C-l*x,_e=r*a-d*x,Ie=r*M-m*x,Me=l*a-d*C,Ve=l*M-m*C,Ke=d*M-m*a,et=R*ne-j*Y,qe=R*se-F*Y,ge=R*xe-Z*Y,We=j*se-F*ne,Ue=j*xe-Z*ne,lt=F*xe-Z*se,ht=Se*lt-_e*Ue+Ie*We+Me*ge-Ve*qe+Ke*et;return ht?(ht=1/ht,n[0]=(C*lt-a*Ue+M*We)*ht,n[1]=(d*Ue-l*lt-m*We)*ht,n[2]=(ne*Ke-se*Ve+xe*Me)*ht,n[3]=(F*Ve-j*Ke-Z*Me)*ht,n[4]=(a*ge-x*lt-M*qe)*ht,n[5]=(r*lt-d*ge+m*qe)*ht,n[6]=(se*Ie-Y*Ke-xe*_e)*ht,n[7]=(R*Ke-F*Ie+Z*_e)*ht,n[8]=(x*Ue-C*ge+M*et)*ht,n[9]=(l*ge-r*Ue-m*et)*ht,n[10]=(Y*Ve-ne*Ie+xe*Se)*ht,n[11]=(j*Ie-R*Ve-Z*Se)*ht,n[12]=(C*qe-x*We-a*et)*ht,n[13]=(r*We-l*qe+d*et)*ht,n[14]=(ne*_e-Y*Me-se*Se)*ht,n[15]=(R*Me-j*_e+F*Se)*ht,n):null}function Kv(n,t,r){var l=t[0],d=t[1],m=t[2],x=t[3],C=t[4],a=t[5],M=t[6],R=t[7],j=t[8],F=t[9],Z=t[10],Y=t[11],ne=t[12],se=t[13],xe=t[14],Se=t[15],_e=r[0],Ie=r[1],Me=r[2],Ve=r[3];return n[0]=_e*l+Ie*C+Me*j+Ve*ne,n[1]=_e*d+Ie*a+Me*F+Ve*se,n[2]=_e*m+Ie*M+Me*Z+Ve*xe,n[3]=_e*x+Ie*R+Me*Y+Ve*Se,_e=r[4],Ie=r[5],Me=r[6],Ve=r[7],n[4]=_e*l+Ie*C+Me*j+Ve*ne,n[5]=_e*d+Ie*a+Me*F+Ve*se,n[6]=_e*m+Ie*M+Me*Z+Ve*xe,n[7]=_e*x+Ie*R+Me*Y+Ve*Se,_e=r[8],Ie=r[9],Me=r[10],Ve=r[11],n[8]=_e*l+Ie*C+Me*j+Ve*ne,n[9]=_e*d+Ie*a+Me*F+Ve*se,n[10]=_e*m+Ie*M+Me*Z+Ve*xe,n[11]=_e*x+Ie*R+Me*Y+Ve*Se,_e=r[12],Ie=r[13],Me=r[14],Ve=r[15],n[12]=_e*l+Ie*C+Me*j+Ve*ne,n[13]=_e*d+Ie*a+Me*F+Ve*se,n[14]=_e*m+Ie*M+Me*Z+Ve*xe,n[15]=_e*x+Ie*R+Me*Y+Ve*Se,n}function jx(n,t,r){var l=r[0],d=r[1],m=r[2],x,C,a,M,R,j,F,Z,Y,ne,se,xe;return t===n?(n[12]=t[0]*l+t[4]*d+t[8]*m+t[12],n[13]=t[1]*l+t[5]*d+t[9]*m+t[13],n[14]=t[2]*l+t[6]*d+t[10]*m+t[14],n[15]=t[3]*l+t[7]*d+t[11]*m+t[15]):(x=t[0],C=t[1],a=t[2],M=t[3],R=t[4],j=t[5],F=t[6],Z=t[7],Y=t[8],ne=t[9],se=t[10],xe=t[11],n[0]=x,n[1]=C,n[2]=a,n[3]=M,n[4]=R,n[5]=j,n[6]=F,n[7]=Z,n[8]=Y,n[9]=ne,n[10]=se,n[11]=xe,n[12]=x*l+R*d+Y*m+t[12],n[13]=C*l+j*d+ne*m+t[13],n[14]=a*l+F*d+se*m+t[14],n[15]=M*l+Z*d+xe*m+t[15]),n}function i6(n,t,r){var l=r[0],d=r[1],m=r[2];return n[0]=t[0]*l,n[1]=t[1]*l,n[2]=t[2]*l,n[3]=t[3]*l,n[4]=t[4]*d,n[5]=t[5]*d,n[6]=t[6]*d,n[7]=t[7]*d,n[8]=t[8]*m,n[9]=t[9]*m,n[10]=t[10]*m,n[11]=t[11]*m,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function uz(n,t,r){var l=Math.sin(r),d=Math.cos(r),m=t[4],x=t[5],C=t[6],a=t[7],M=t[8],R=t[9],j=t[10],F=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=m*d+M*l,n[5]=x*d+R*l,n[6]=C*d+j*l,n[7]=a*d+F*l,n[8]=M*d-m*l,n[9]=R*d-x*l,n[10]=j*d-C*l,n[11]=F*d-a*l,n}function hz(n,t,r){var l=Math.sin(r),d=Math.cos(r),m=t[0],x=t[1],C=t[2],a=t[3],M=t[4],R=t[5],j=t[6],F=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=m*d+M*l,n[1]=x*d+R*l,n[2]=C*d+j*l,n[3]=a*d+F*l,n[4]=M*d-m*l,n[5]=R*d-x*l,n[6]=j*d-C*l,n[7]=F*d-a*l,n}function dz(n,t,r,l,d){var m=1/Math.tan(t/2),x;return n[0]=m/r,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=m,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,d!=null&&d!==1/0?(x=1/(l-d),n[10]=(d+l)*x,n[14]=2*d*l*x):(n[10]=-1,n[14]=-2*l),n}var fz=dz;function L4(n,t){var r=n[0],l=n[1],d=n[2],m=n[3],x=n[4],C=n[5],a=n[6],M=n[7],R=n[8],j=n[9],F=n[10],Z=n[11],Y=n[12],ne=n[13],se=n[14],xe=n[15],Se=t[0],_e=t[1],Ie=t[2],Me=t[3],Ve=t[4],Ke=t[5],et=t[6],qe=t[7],ge=t[8],We=t[9],Ue=t[10],lt=t[11],ht=t[12],Wt=t[13],In=t[14],Sn=t[15];return Math.abs(r-Se)<=$s*Math.max(1,Math.abs(r),Math.abs(Se))&&Math.abs(l-_e)<=$s*Math.max(1,Math.abs(l),Math.abs(_e))&&Math.abs(d-Ie)<=$s*Math.max(1,Math.abs(d),Math.abs(Ie))&&Math.abs(m-Me)<=$s*Math.max(1,Math.abs(m),Math.abs(Me))&&Math.abs(x-Ve)<=$s*Math.max(1,Math.abs(x),Math.abs(Ve))&&Math.abs(C-Ke)<=$s*Math.max(1,Math.abs(C),Math.abs(Ke))&&Math.abs(a-et)<=$s*Math.max(1,Math.abs(a),Math.abs(et))&&Math.abs(M-qe)<=$s*Math.max(1,Math.abs(M),Math.abs(qe))&&Math.abs(R-ge)<=$s*Math.max(1,Math.abs(R),Math.abs(ge))&&Math.abs(j-We)<=$s*Math.max(1,Math.abs(j),Math.abs(We))&&Math.abs(F-Ue)<=$s*Math.max(1,Math.abs(F),Math.abs(Ue))&&Math.abs(Z-lt)<=$s*Math.max(1,Math.abs(Z),Math.abs(lt))&&Math.abs(Y-ht)<=$s*Math.max(1,Math.abs(Y),Math.abs(ht))&&Math.abs(ne-Wt)<=$s*Math.max(1,Math.abs(ne),Math.abs(Wt))&&Math.abs(se-In)<=$s*Math.max(1,Math.abs(se),Math.abs(In))&&Math.abs(xe-Sn)<=$s*Math.max(1,Math.abs(xe),Math.abs(Sn))}function pz(){var n=new Bm(2);return Bm!=Float32Array&&(n[0]=0,n[1]=0),n}function Nx(n,t,r){return n[0]=t[0]+r[0],n[1]=t[1]+r[1],n}function mz(n,t,r){return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n}function gz(n,t,r){return n[0]=t[0]*r,n[1]=t[1]*r,n}function _z(n){var t=n[0],r=n[1];return Math.hypot(t,r)}function yz(n,t){return n[0]=-t[0],n[1]=-t[1],n}function o6(n,t,r,l){var d=t[0],m=t[1];return n[0]=d+l*(r[0]-d),n[1]=m+l*(r[1]-m),n}var vz=mz;(function(){var n=pz();return function(t,r,l,d,m,x){var C,a;for(r||(r=2),l||(l=0),d?a=Math.min(d*r+l,t.length):a=t.length,C=l;C<a;C+=r)n[0]=t[C],n[1]=t[C+1],m(n,n,x),t[C]=n[0],t[C+1]=n[1];return t}})();function xz(){var n=new Bm(3);return Bm!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function wz(n,t,r){return n[0]=t[0]+r[0],n[1]=t[1]+r[1],n[2]=t[2]+r[2],n}function bz(n,t,r){return n[0]=t[0]*r[0],n[1]=t[1]*r[1],n[2]=t[2]*r[2],n}function Ez(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n}var Tz=bz;(function(){var n=xz();return function(t,r,l,d,m,x){var C,a;for(r||(r=3),l||(l=0),d?a=Math.min(d*r+l,t.length):a=t.length,C=l;C<a;C+=r)n[0]=t[C],n[1]=t[C+1],n[2]=t[C+2],m(n,n,x),t[C]=n[0],t[C+1]=n[1],t[C+2]=n[2];return t}})();function Ad(n,t){if(!n)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const nc=Math.PI,s6=nc/4,nu=nc/180,Fx=180/nc,B0=512,R4=4003e4,i_=85.051129,a6=1.5;function Ux(n){return Math.pow(2,n)}function Cz(n){return tb(n)}function yd(n){const[t,r]=n;Ad(Number.isFinite(t)),Ad(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");const l=t*nu,d=r*nu,m=B0*(l+nc)/(2*nc),x=B0*(nc+Math.log(Math.tan(s6+d*.5)))/(2*nc);return[m,x]}function wd(n){const[t,r]=n,l=t/B0*(2*nc)-nc,d=2*(Math.atan(Math.exp(r/B0*(2*nc)-nc))-s6);return[l*Fx,d*Fx]}function Sz(n){const{latitude:t,longitude:r,highPrecision:l=!1}=n;Ad(Number.isFinite(t)&&Number.isFinite(r));const d=B0,m=Math.cos(t*nu),x=d/360,C=x/m,a=d/R4/m,M={unitsPerMeter:[a,a,a],metersPerUnit:[1/a,1/a,1/a],unitsPerDegree:[x,C,a],degreesPerUnit:[1/x,1/C,1/a]};if(l){const R=nu*Math.tan(t*nu)/m,j=x*R/2,F=d/R4*R,Z=F/C*a;M.unitsPerDegree2=[0,j,F],M.unitsPerMeter2=[Z,0,Z]}return M}function kz(n){const{height:t,pitch:r,bearing:l,altitude:d,scale:m,center:x}=n,C=b_();jx(C,C,[0,0,-d]),uz(C,C,-r*nu),hz(C,C,l*nu);const a=m/t;return i6(C,C,[a,a,a]),x&&jx(C,C,Ez([],x)),C}function Mz(n){const{width:t,height:r,altitude:l,pitch:d=0,offset:m,center:x,scale:C,nearZMultiplier:a=1,farZMultiplier:M=1}=n;let{fovy:R=J_(a6)}=n;l!==void 0&&(R=J_(l));const j=R*nu,F=d*nu,Z=l6(R);let Y=Z;x&&(Y+=x[2]*C/Math.cos(F)/r);const ne=j*(.5+(m?m[1]:0)/r),se=Math.sin(ne)*Y/Math.sin(Bx(Math.PI/2-F-ne,.01,Math.PI-.01)),xe=Math.sin(F)*se+Y,Se=Y*10,_e=Math.min(xe*M,Se);return{fov:j,aspect:t/r,focalDistance:Z,near:a,far:_e}}function Az(n){const{fov:t,aspect:r,near:l,far:d}=Mz(n);return fz([],t,r,l,d)}function J_(n){return 2*Math.atan(.5/n)*Fx}function l6(n){return .5/Math.tan(.5*n*nu)}function Pz(n,t){const[r,l,d=0]=n;return Ad(Number.isFinite(r)&&Number.isFinite(l)&&Number.isFinite(d)),Pm(t,[r,l,d,1])}function O4(n,t,r=0){const[l,d,m]=n;if(Ad(Number.isFinite(l)&&Number.isFinite(d),"invalid pixel coordinate"),Number.isFinite(m))return Pm(t,[l,d,m,1]);const x=Pm(t,[l,d,0,1]),C=Pm(t,[l,d,1,1]),a=x[2],M=C[2],R=a===M?0:((r||0)-a)/(M-a);return o6([],x,C,R)}function Iz(n){const{width:t,height:r,bounds:l,minExtent:d=0,maxZoom:m=24,offset:x=[0,0]}=n,[[C,a],[M,R]]=l,j=Lz(n.padding),F=yd([C,Bx(R,-i_,i_)]),Z=yd([M,Bx(a,-i_,i_)]),Y=[Math.max(Math.abs(Z[0]-F[0]),d),Math.max(Math.abs(Z[1]-F[1]),d)],ne=[t-j.left-j.right-Math.abs(x[0])*2,r-j.top-j.bottom-Math.abs(x[1])*2];Ad(ne[0]>0&&ne[1]>0);const se=ne[0]/Y[0],xe=ne[1]/Y[1],Se=(j.right-j.left)/2/se,_e=(j.top-j.bottom)/2/xe,Ie=[(Z[0]+F[0])/2+Se,(Z[1]+F[1])/2+_e],Me=wd(Ie),Ve=Math.min(m,tb(Math.abs(Math.min(se,xe))));return Ad(Number.isFinite(Ve)),{longitude:Me[0],latitude:Me[1],zoom:Ve}}function Lz(n=0){return typeof n=="number"?{top:n,bottom:n,left:n,right:n}:(Ad(Number.isFinite(n.top)&&Number.isFinite(n.bottom)&&Number.isFinite(n.left)&&Number.isFinite(n.right)),n)}const D4=Math.PI/180;function Rz(n,t=0){const{width:r,height:l,unproject:d}=n,m={targetZ:t},x=d([0,l],m),C=d([r,l],m);let a,M;const R=n.fovy?.5*n.fovy*D4:Math.atan(.5/n.altitude),j=(90-n.pitch)*D4;return R>j-.01?(a=z4(n,0,t),M=z4(n,r,t)):(a=d([0,0],m),M=d([r,0],m)),[x,C,M,a]}function z4(n,t,r){const{pixelUnprojectionMatrix:l}=n,d=Pm(l,[t,0,1,1]),m=Pm(l,[t,n.height,1,1]),C=(r*n.distanceScales.unitsPerMeter[2]-d[2])/(m[2]-d[2]),a=o6([],d,m,C),M=wd(a);return M.push(r),M}class ru{constructor(t={width:1,height:1}){Vn(this,"latitude",void 0),Vn(this,"longitude",void 0),Vn(this,"zoom",void 0),Vn(this,"pitch",void 0),Vn(this,"bearing",void 0),Vn(this,"altitude",void 0),Vn(this,"fovy",void 0),Vn(this,"meterOffset",void 0),Vn(this,"center",void 0),Vn(this,"width",void 0),Vn(this,"height",void 0),Vn(this,"scale",void 0),Vn(this,"distanceScales",void 0),Vn(this,"viewMatrix",void 0),Vn(this,"projectionMatrix",void 0),Vn(this,"viewProjectionMatrix",void 0),Vn(this,"pixelProjectionMatrix",void 0),Vn(this,"pixelUnprojectionMatrix",void 0),Vn(this,"equals",xe=>xe instanceof ru?xe.width===this.width&&xe.height===this.height&&L4(xe.projectionMatrix,this.projectionMatrix)&&L4(xe.viewMatrix,this.viewMatrix):!1),Vn(this,"project",(xe,Se={})=>{const{topLeft:_e=!0}=Se,Ie=this.projectPosition(xe),Me=Pz(Ie,this.pixelProjectionMatrix),[Ve,Ke]=Me,et=_e?Ke:this.height-Ke;return xe.length===2?[Ve,et]:[Ve,et,Me[2]]}),Vn(this,"unproject",(xe,Se={})=>{const{topLeft:_e=!0,targetZ:Ie=void 0}=Se,[Me,Ve,Ke]=xe,et=_e?Ve:this.height-Ve,qe=Ie&&Ie*this.distanceScales.unitsPerMeter[2],ge=O4([Me,et,Ke],this.pixelUnprojectionMatrix,qe),[We,Ue,lt]=this.unprojectPosition(ge);return Number.isFinite(Ke)?[We,Ue,lt]:Number.isFinite(Ie)?[We,Ue,Ie]:[We,Ue]}),Vn(this,"projectPosition",xe=>{const[Se,_e]=yd(xe),Ie=(xe[2]||0)*this.distanceScales.unitsPerMeter[2];return[Se,_e,Ie]}),Vn(this,"unprojectPosition",xe=>{const[Se,_e]=wd(xe),Ie=(xe[2]||0)*this.distanceScales.metersPerUnit[2];return[Se,_e,Ie]});let{width:r,height:l,altitude:d=null,fovy:m=null}=t;const{latitude:x=0,longitude:C=0,zoom:a=0,pitch:M=0,bearing:R=0,position:j=null,nearZMultiplier:F=.02,farZMultiplier:Z=1.01}=t;r=r||1,l=l||1,m===null&&d===null?(d=a6,m=J_(d)):m===null?m=J_(d):d===null&&(d=l6(m));const Y=Ux(a);d=Math.max(.75,d);const ne=Sz({longitude:C,latitude:x}),se=yd([C,x]);se.push(0),j&&wz(se,se,Tz([],j,ne.unitsPerMeter)),this.projectionMatrix=Az({width:r,height:l,scale:Y,center:se,pitch:M,fovy:m,nearZMultiplier:F,farZMultiplier:Z}),this.viewMatrix=kz({height:l,scale:Y,center:se,pitch:M,bearing:R,altitude:d}),this.width=r,this.height=l,this.scale=Y,this.latitude=x,this.longitude=C,this.zoom=a,this.pitch=M,this.bearing=R,this.altitude=d,this.fovy=m,this.center=se,this.meterOffset=j||[0,0,0],this.distanceScales=ne,this._initMatrices(),Object.freeze(this)}_initMatrices(){const{width:t,height:r,projectionMatrix:l,viewMatrix:d}=this,m=b_();Kv(m,m,l),Kv(m,m,d),this.viewProjectionMatrix=m;const x=b_();i6(x,x,[t/2,-r/2,1]),jx(x,x,[1,-1,0]),Kv(x,x,m);const C=cz(b_(),x);if(!C)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=x,this.pixelUnprojectionMatrix=C}projectFlat(t){return yd(t)}unprojectFlat(t){return wd(t)}getMapCenterByLngLatPosition({lngLat:t,pos:r}){const l=O4(r,this.pixelUnprojectionMatrix),d=yd(t),m=Nx([],d,yz([],l)),x=Nx([],this.center,m);return wd(x)}fitBounds(t,r={}){const{width:l,height:d}=this,{longitude:m,latitude:x,zoom:C}=Iz(Object.assign({width:l,height:d,bounds:t},r));return new ru({width:l,height:d,longitude:m,latitude:x,zoom:C})}getBounds(t){const r=this.getBoundingRegion(t),l=Math.min(...r.map(C=>C[0])),d=Math.max(...r.map(C=>C[0])),m=Math.min(...r.map(C=>C[1])),x=Math.max(...r.map(C=>C[1]));return[[l,m],[d,x]]}getBoundingRegion(t={}){return Rz(this,t.z||0)}getLocationAtPoint({lngLat:t,pos:r}){return this.getMapCenterByLngLatPosition({lngLat:t,pos:r})}}const B4=512;function Oz(n){const{width:t,height:r,pitch:l=0}=n;let{longitude:d,latitude:m,zoom:x,bearing:C=0}=n;(d<-180||d>180)&&(d=I4(d+180,360)-180),(C<-180||C>180)&&(C=I4(C+180,360)-180);const a=tb(r/B4);if(x<=a)x=a,m=0;else{const M=r/2/Math.pow(2,x),R=wd([0,M])[1];if(m<R)m=R;else{const j=wd([0,B4-M])[1];m>j&&(m=j)}}return{width:t,height:r,longitude:d,latitude:m,zoom:x,pitch:l,bearing:C}}const c6=.01,Dz=["longitude","latitude","zoom"],u6={curve:1.414,speed:1.2};function zz(n,t,r,l){const{startZoom:d,startCenterXY:m,uDelta:x,w0:C,u1:a,S:M,rho:R,rho2:j,r0:F}=h6(n,t,l);if(a<c6){const Ie={};for(const Me of Dz){const Ve=n[Me],Ke=t[Me];Ie[Me]=az(Ve,Ke,r)}return Ie}const Z=r*M,Y=Math.cosh(F)/Math.cosh(F+R*Z),ne=C*((Math.cosh(F)*Math.tanh(F+R*Z)-Math.sinh(F))/j)/a,se=1/Y,xe=d+Cz(se),Se=gz([],x,ne);Nx(Se,Se,m);const _e=wd(Se);return{longitude:_e[0],latitude:_e[1],zoom:xe}}function Bz(n,t,r){const l={...u6,...r},{screenSpeed:d,speed:m,maxDuration:x}=l,{S:C,rho:a}=h6(n,t,l),M=1e3*C;let R;return Number.isFinite(d)?R=M/(d/a):R=M/m,Number.isFinite(x)&&R>x?0:R}function h6(n,t,r){r=Object.assign({},u6,r);const l=r.curve,d=n.zoom,m=[n.longitude,n.latitude],x=Ux(d),C=t.zoom,a=[t.longitude,t.latitude],M=Ux(C-d),R=yd(m),j=yd(a),F=vz([],j,R),Z=Math.max(n.width,n.height),Y=Z/M,ne=_z(F)*x,se=Math.max(ne,c6),xe=l*l,Se=(Y*Y-Z*Z+xe*xe*se*se)/(2*Z*xe*se),_e=(Y*Y-Z*Z-xe*xe*se*se)/(2*Y*xe*se),Ie=Math.log(Math.sqrt(Se*Se+1)-Se),Me=Math.log(Math.sqrt(_e*_e+1)-_e),Ve=(Me-Ie)/l;return{startZoom:d,startCenterXY:R,uDelta:F,w0:Z,u1:ne,S:Ve,rho:l,rho2:xe,r0:Ie,r1:Me}}var d6=function(){if(typeof Map<"u")return Map;function n(t,r){var l=-1;return t.some(function(d,m){return d[0]===r?(l=m,!0):!1}),l}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(r){var l=n(this.__entries__,r),d=this.__entries__[l];return d&&d[1]},t.prototype.set=function(r,l){var d=n(this.__entries__,r);~d?this.__entries__[d][1]=l:this.__entries__.push([r,l])},t.prototype.delete=function(r){var l=this.__entries__,d=n(l,r);~d&&l.splice(d,1)},t.prototype.has=function(r){return!!~n(this.__entries__,r)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(r,l){l===void 0&&(l=null);for(var d=0,m=this.__entries__;d<m.length;d++){var x=m[d];r.call(l,x[1],x[0])}},t}()}(),$x=typeof window<"u"&&typeof document<"u"&&window.document===document,Q_=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),jz=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Q_):function(n){return setTimeout(function(){return n(Date.now())},1e3/60)}}(),Nz=2;function Fz(n,t){var r=!1,l=!1,d=0;function m(){r&&(r=!1,n()),l&&C()}function x(){jz(m)}function C(){var a=Date.now();if(r){if(a-d<Nz)return;l=!0}else r=!0,l=!1,setTimeout(x,t);d=a}return C}var Uz=20,$z=["top","right","bottom","left","width","height","size","weight"],Vz=typeof MutationObserver<"u",Wz=function(){function n(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=Fz(this.refresh.bind(this),Uz)}return n.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},n.prototype.removeObserver=function(t){var r=this.observers_,l=r.indexOf(t);~l&&r.splice(l,1),!r.length&&this.connected_&&this.disconnect_()},n.prototype.refresh=function(){var t=this.updateObservers_();t&&this.refresh()},n.prototype.updateObservers_=function(){var t=this.observers_.filter(function(r){return r.gatherActive(),r.hasActive()});return t.forEach(function(r){return r.broadcastActive()}),t.length>0},n.prototype.connect_=function(){!$x||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Vz?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},n.prototype.disconnect_=function(){!$x||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},n.prototype.onTransitionEnd_=function(t){var r=t.propertyName,l=r===void 0?"":r,d=$z.some(function(m){return!!~l.indexOf(m)});d&&this.refresh()},n.getInstance=function(){return this.instance_||(this.instance_=new n),this.instance_},n.instance_=null,n}(),f6=function(n,t){for(var r=0,l=Object.keys(t);r<l.length;r++){var d=l[r];Object.defineProperty(n,d,{value:t[d],enumerable:!1,writable:!1,configurable:!0})}return n},jm=function(n){var t=n&&n.ownerDocument&&n.ownerDocument.defaultView;return t||Q_},p6=ky(0,0,0,0);function ey(n){return parseFloat(n)||0}function j4(n){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.reduce(function(l,d){var m=n["border-"+d+"-width"];return l+ey(m)},0)}function qz(n){for(var t=["top","right","bottom","left"],r={},l=0,d=t;l<d.length;l++){var m=d[l],x=n["padding-"+m];r[m]=ey(x)}return r}function Gz(n){var t=n.getBBox();return ky(0,0,t.width,t.height)}function Zz(n){var t=n.clientWidth,r=n.clientHeight;if(!t&&!r)return p6;var l=jm(n).getComputedStyle(n),d=qz(l),m=d.left+d.right,x=d.top+d.bottom,C=ey(l.width),a=ey(l.height);if(l.boxSizing==="border-box"&&(Math.round(C+m)!==t&&(C-=j4(l,"left","right")+m),Math.round(a+x)!==r&&(a-=j4(l,"top","bottom")+x)),!Kz(n)){var M=Math.round(C+m)-t,R=Math.round(a+x)-r;Math.abs(M)!==1&&(C-=M),Math.abs(R)!==1&&(a-=R)}return ky(d.left,d.top,C,a)}var Hz=function(){return typeof SVGGraphicsElement<"u"?function(n){return n instanceof jm(n).SVGGraphicsElement}:function(n){return n instanceof jm(n).SVGElement&&typeof n.getBBox=="function"}}();function Kz(n){return n===jm(n).document.documentElement}function Xz(n){return $x?Hz(n)?Gz(n):Zz(n):p6}function Yz(n){var t=n.x,r=n.y,l=n.width,d=n.height,m=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,x=Object.create(m.prototype);return f6(x,{x:t,y:r,width:l,height:d,top:r,right:t+l,bottom:d+r,left:t}),x}function ky(n,t,r,l){return{x:n,y:t,width:r,height:l}}var Jz=function(){function n(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=ky(0,0,0,0),this.target=t}return n.prototype.isActive=function(){var t=Xz(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},n.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},n}(),Qz=function(){function n(t,r){var l=Yz(r);f6(this,{target:t,contentRect:l})}return n}(),eB=function(){function n(t,r,l){if(this.activeObservations_=[],this.observations_=new d6,typeof t!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=r,this.callbackCtx_=l}return n.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof jm(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var r=this.observations_;r.has(t)||(r.set(t,new Jz(t)),this.controller_.addObserver(this),this.controller_.refresh())}},n.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof jm(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var r=this.observations_;r.has(t)&&(r.delete(t),r.size||this.controller_.removeObserver(this))}},n.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},n.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(r){r.isActive()&&t.activeObservations_.push(r)})},n.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,r=this.activeObservations_.map(function(l){return new Qz(l.target,l.broadcastRect())});this.callback_.call(t,r,t),this.clearActive()}},n.prototype.clearActive=function(){this.activeObservations_.splice(0)},n.prototype.hasActive=function(){return this.activeObservations_.length>0},n}(),m6=typeof WeakMap<"u"?new WeakMap:new d6,g6=function(){function n(t){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=Wz.getInstance(),l=new eB(t,r,this);m6.set(this,l)}return n}();["observe","unobserve","disconnect"].forEach(function(n){g6.prototype[n]=function(){var t;return(t=m6.get(this))[n].apply(t,arguments)}});var tB=function(){return typeof Q_.ResizeObserver<"u"?Q_.ResizeObserver:g6}();function Od(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function nB(n,t){for(var r=0;r<t.length;r++){var l=t[r];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(n,r6(l.key),l)}}function Dd(n,t,r){return t&&nB(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n}var lh=typeof document<"u"?document:{};function N4(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);t&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(n,d).enumerable})),r.push.apply(r,l)}return r}function o_(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N4(Object(r),!0).forEach(function(l){Vn(n,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):N4(Object(r)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(r,l))})}return n}function F4(n,t){var r;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(r=rB(n))||t){r&&(n=r);var l=0,d=function(){};return{s:d,n:function(){return l>=n.length?{done:!0}:{done:!1,value:n[l++]}},e:function(M){throw M},f:d}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,x=!1,C;return{s:function(){r=n[Symbol.iterator]()},n:function(){var M=r.next();return m=M.done,M},e:function(M){x=!0,C=M},f:function(){try{!m&&r.return!=null&&r.return()}finally{if(x)throw C}}}}function rB(n,t){if(n){if(typeof n=="string")return U4(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U4(n,t)}}function U4(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,l=new Array(t);r<t;r++)l[r]=n[r];return l}var iB=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Xv(n){if(!n)return null;if(typeof n=="string")return n;n.toJS&&(n=n.toJS());var t={},r=F4(n.layers),l;try{for(r.s();!(l=r.n()).done;){var d=l.value;t[d.id]=d}}catch(x){r.e(x)}finally{r.f()}var m=n.layers.map(function(x){var C=t[x.ref],a=null;if("interactive"in x&&(a=o_({},x),delete a.interactive),C){a=a||o_({},x),delete a.ref;var M=F4(iB),R;try{for(M.s();!(R=M.n()).done;){var j=R.value;j in C&&(a[j]=C[j])}}catch(F){M.e(F)}finally{M.f()}}return a||x});return o_(o_({},n),{},{layers:m})}var $4={};function oB(){}function sB(n){n&&console.error(n.error)}var _6={container:pt.object,gl:pt.object,mapboxApiAccessToken:pt.string,mapboxApiUrl:pt.string,attributionControl:pt.bool,preserveDrawingBuffer:pt.bool,reuseMaps:pt.bool,transformRequest:pt.func,mapOptions:pt.object,mapStyle:pt.oneOfType([pt.string,pt.object]),preventStyleDiffing:pt.bool,visible:pt.bool,asyncRender:pt.bool,onLoad:pt.func,onError:pt.func,width:pt.number,height:pt.number,viewState:pt.object,longitude:pt.number,latitude:pt.number,zoom:pt.number,bearing:pt.number,pitch:pt.number,altitude:pt.number},E_={container:lh.body,mapboxApiAccessToken:aB(),mapboxApiUrl:"https://api.mapbox.com",preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",preventStyleDiffing:!1,visible:!0,asyncRender:!1,onLoad:oB,onError:sB,width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0,altitude:1.5};function aB(){var n=null;if(typeof window<"u"&&window.location){var t=window.location.search.match(/access_token=([^&\/]*)/);n=t&&t[1]}return!n&&typeof process<"u"&&(n=n||$4.MapboxAccessToken||$4.REACT_APP_MAPBOX_ACCESS_TOKEN),n||"no-token"}function V4(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"component";n.debug&&pt.checkPropTypes(_6,n,"prop",t)}var cp=function(){function n(t){var r=this;if(Od(this,n),Vn(this,"props",E_),Vn(this,"width",0),Vn(this,"height",0),Vn(this,"_fireLoadEvent",function(){r.props.onLoad({type:"load",target:r._map})}),Vn(this,"_handleError",function(l){r.props.onError(l)}),!t.mapboxgl)throw new Error("Mapbox not available");this.mapboxgl=t.mapboxgl,n.initialized||(n.initialized=!0,this._checkStyleSheet(this.mapboxgl.version)),this._initialize(t)}return Dd(n,[{key:"finalize",value:function(){return this._destroy(),this}},{key:"setProps",value:function(r){return this._update(this.props,r),this}},{key:"redraw",value:function(){var r=this._map;r.style&&(r._frame&&(r._frame.cancel(),r._frame=null),r._render())}},{key:"getMap",value:function(){return this._map}},{key:"_reuse",value:function(r){this._map=n.savedMap;var l=this._map.getContainer(),d=r.container;for(d.classList.add("mapboxgl-map");l.childNodes.length>0;)d.appendChild(l.childNodes[0]);this._map._container=d,n.savedMap=null,r.mapStyle&&this._map.setStyle(Xv(r.mapStyle),{diff:!1}),this._map.isStyleLoaded()?this._fireLoadEvent():this._map.once("styledata",this._fireLoadEvent)}},{key:"_create",value:function(r){if(r.reuseMaps&&n.savedMap)this._reuse(r);else{if(r.gl){var l=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=l,r.gl}}var d={container:r.container,center:[0,0],zoom:8,pitch:0,bearing:0,maxZoom:24,style:Xv(r.mapStyle),interactive:!1,trackResize:!1,attributionControl:r.attributionControl,preserveDrawingBuffer:r.preserveDrawingBuffer};r.transformRequest&&(d.transformRequest=r.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},d,r.mapOptions)),this._map.once("load",this._fireLoadEvent),this._map.on("error",this._handleError)}return this}},{key:"_destroy",value:function(){this._map&&(this.props.reuseMaps&&!n.savedMap?(n.savedMap=this._map,this._map.off("load",this._fireLoadEvent),this._map.off("error",this._handleError),this._map.off("styledata",this._fireLoadEvent)):this._map.remove(),this._map=null)}},{key:"_initialize",value:function(r){var l=this;r=Object.assign({},E_,r),V4(r,"Mapbox"),this.mapboxgl.accessToken=r.mapboxApiAccessToken||E_.mapboxApiAccessToken,this.mapboxgl.baseApiUrl=r.mapboxApiUrl,this._create(r);var d=r,m=d.container;Object.defineProperty(m,"offsetWidth",{configurable:!0,get:function(){return l.width}}),Object.defineProperty(m,"clientWidth",{configurable:!0,get:function(){return l.width}}),Object.defineProperty(m,"offsetHeight",{configurable:!0,get:function(){return l.height}}),Object.defineProperty(m,"clientHeight",{configurable:!0,get:function(){return l.height}});var x=this._map.getCanvas();x&&(x.style.outline="none"),this._updateMapViewport({},r),this._updateMapSize({},r),this.props=r}},{key:"_update",value:function(r,l){if(this._map){l=Object.assign({},this.props,l),V4(l,"Mapbox");var d=this._updateMapViewport(r,l),m=this._updateMapSize(r,l);this._updateMapStyle(r,l),!l.asyncRender&&(d||m)&&this.redraw(),this.props=l}}},{key:"_updateMapStyle",value:function(r,l){var d=r.mapStyle!==l.mapStyle;d&&this._map.setStyle(Xv(l.mapStyle),{diff:!l.preventStyleDiffing})}},{key:"_updateMapSize",value:function(r,l){var d=r.width!==l.width||r.height!==l.height;return d&&(this.width=l.width,this.height=l.height,this._map.resize()),d}},{key:"_updateMapViewport",value:function(r,l){var d=this._getViewState(r),m=this._getViewState(l),x=m.latitude!==d.latitude||m.longitude!==d.longitude||m.zoom!==d.zoom||m.pitch!==d.pitch||m.bearing!==d.bearing||m.altitude!==d.altitude;return x&&(this._map.jumpTo(this._viewStateToMapboxProps(m)),m.altitude!==d.altitude&&(this._map.transform.altitude=m.altitude)),x}},{key:"_getViewState",value:function(r){var l=r.viewState||r,d=l.longitude,m=l.latitude,x=l.zoom,C=l.pitch,a=C===void 0?0:C,M=l.bearing,R=M===void 0?0:M,j=l.altitude,F=j===void 0?1.5:j;return{longitude:d,latitude:m,zoom:x,pitch:a,bearing:R,altitude:F}}},{key:"_checkStyleSheet",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"0.47.0";if(!(typeof lh>"u"))try{var l=lh.createElement("div");l.className="mapboxgl-map",l.style.display="none",lh.body.appendChild(l);var d=window.getComputedStyle(l).position!=="static";if(!d){var m=lh.createElement("link");m.setAttribute("rel","stylesheet"),m.setAttribute("type","text/css"),m.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(r,"/mapbox-gl.css")),lh.head.appendChild(m)}}catch{}}},{key:"_viewStateToMapboxProps",value:function(r){return{center:[r.longitude,r.latitude],zoom:r.zoom,bearing:r.bearing,pitch:r.pitch}}}]),n}();Vn(cp,"initialized",!1);Vn(cp,"propTypes",_6);Vn(cp,"defaultProps",E_);Vn(cp,"savedMap",null);var T_={exports:{}},lB=T_.exports,W4;function cB(){return W4||(W4=1,function(n,t){var r={};(function(l,d){n.exports=d()})(lB,function(){var l,d,m;function x(a,M){if(!l)l=M;else if(!d)d=M;else{var R="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+l+")(sharedChunk); ("+d+")(sharedChunk); self.onerror = null;",j={};l(j),m=M(j),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(m.workerUrl=window.URL.createObjectURL(new Blob([R],{type:"text/javascript"})))}}x(["exports"],function(a){var M=typeof self<"u"?self:{},R="2.15.0";let j;const F={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(j==null){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{j=r.API_URL_REGEX!=null?new RegExp(r.API_URL_REGEX):i}catch{j=i}}return j},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!F.API_URL)return null;try{const i=new URL(F.API_URL);return i.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":i.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Z={supported:!1,testSupport:function(i){!se&&ne&&(xe?Se(i):Y=i)}};let Y,ne,se=!1,xe=!1;function Se(i){const e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,ne),i.isContextLost())return;Z.supported=!0}catch{}i.deleteTexture(e),se=!0}M.document&&(ne=M.document.createElement("img"),ne.onload=function(){Y&&Se(Y),Y=null,xe=!0},ne.onerror=function(){se=!0,Y=null},ne.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const _e="01";function Ie(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Me=Ve;function Ve(i,e,o,c){this.cx=3*i,this.bx=3*(o-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(c-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=e,this.p2x=o,this.p2y=c}Ve.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,e){if(e===void 0&&(e=1e-6),i<0)return 0;if(i>1)return 1;for(var o=i,c=0;c<8;c++){var f=this.sampleCurveX(o)-i;if(Math.abs(f)<e)return o;var _=this.sampleCurveDerivativeX(o);if(Math.abs(_)<1e-6)break;o-=f/_}var v=0,E=1;for(o=i,c=0;c<20&&(f=this.sampleCurveX(o),!(Math.abs(f-i)<e));c++)i>f?v=o:E=o,o=.5*(E-v)+v;return o},solve:function(i,e){return this.sampleCurveY(this.solveCurveX(i,e))}};var Ke=Ie(Me),et=qe;function qe(i,e){this.x=i,this.y=e}qe.prototype={clone:function(){return new qe(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,e){return this.clone()._rotateAround(i,e)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var e=i.x-this.x,o=i.y-this.y;return e*e+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,e){return Math.atan2(this.x*e-this.y*i,this.x*i+this.y*e)},_matMult:function(i){var e=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=e,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var e=Math.cos(i),o=Math.sin(i),c=o*this.x+e*this.y;return this.x=e*this.x-o*this.y,this.y=c,this},_rotateAround:function(i,e){var o=Math.cos(i),c=Math.sin(i),f=e.y+c*(this.x-e.x)+o*(this.y-e.y);return this.x=e.x+o*(this.x-e.x)-c*(this.y-e.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},qe.convert=function(i){return i instanceof qe?i:Array.isArray(i)?new qe(i[0],i[1]):i};var ge=Ie(et);const We=Math.PI/180,Ue=180/Math.PI;function lt(i){return i*We}function ht(i){return i*Ue}const Wt=[[0,0],[1,0],[1,1],[0,1]];function In(i){if(i<=0)return 0;if(i>=1)return 1;const e=i*i,o=e*i;return 4*(i<.5?o:3*(i-e)+o-.75)}function Sn(i,e,o,c){const f=new Ke(i,e,o,c);return function(_){return f.solve(_)}}const qt=Sn(.25,.1,.25,1);function Bt(i,e,o){return Math.min(o,Math.max(e,i))}function je(i,e,o){return(o=Bt((o-i)/(e-i),0,1))*o*(3-2*o)}function At(i,e,o){const c=o-e,f=((i-e)%c+c)%c+e;return f===e?o:f}function sn(i,e,o){if(!i.length)return o(null,[]);let c=i.length;const f=new Array(i.length);let _=null;i.forEach((v,E)=>{e(v,(S,k)=>{S&&(_=S),f[E]=k,--c==0&&o(_,f)})})}function zn(i){const e=[];for(const o in i)e.push(i[o]);return e}function vn(i,...e){for(const o of e)for(const c in o)i[c]=o[c];return i}let Mn=1;function Yn(){return Mn++}function ir(){return function i(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function mt(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function bt(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function xt(i,e){i.forEach(o=>{e[o]&&(e[o]=e[o].bind(e))})}function Nt(i,e){return i.indexOf(e,i.length-e.length)!==-1}function wt(i,e,o){const c={};for(const f in i)c[f]=e.call(this,i[f],f,i);return c}function hn(i,e,o){const c={};for(const f in i)e.call(o||this,i[f],f,i)&&(c[f]=i[f]);return c}function An(i){return Array.isArray(i)?i.map(An):typeof i=="object"&&i?wt(i,An):i}const Fn={};function Nn(i){Fn[i]||(typeof console<"u"&&console.warn(i),Fn[i]=!0)}function xr(i,e,o){return(o.y-i.y)*(e.x-i.x)>(e.y-i.y)*(o.x-i.x)}function nr(i){let e=0;for(let o,c,f=0,_=i.length,v=_-1;f<_;v=f++)o=i[f],c=i[v],e+=(c.x-o.x)*(o.y+c.y);return e}function Zr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Br(i){const e={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,c,f,_)=>{const v=f||_;return e[c]=!v||v.toLowerCase(),""}),e["max-age"]){const o=parseInt(e["max-age"],10);isNaN(o)?delete e["max-age"]:e["max-age"]=o}return e}let ui=null;function gi(i){if(ui==null){const e=i.navigator?i.navigator.userAgent:null;ui=!!i.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return ui}function Xi(i){try{const e=M[i];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ri(i,e){return[i[4*e],i[4*e+1],i[4*e+2],i[4*e+3]]}const dr="mapbox-tiles";let Nr=500,cr=50,Cr,Oi;function Di(){try{return M.caches}catch{}}function wr(){Di()&&!Cr&&(Cr=M.caches.open(dr))}function rr(i){const e=i.indexOf("?");if(e<0)return i;const o=function(f){const _=f.indexOf("?");return _>0?f.slice(_+1).split("&"):[]}(i),c=o.filter(f=>{const _=f.split("=");return _[0]==="language"||_[0]==="worldview"});return c.length?`${i.slice(0,e)}?${c.join("&")}`:i.slice(0,e)}let Fi=1/0;const ao={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ao);class lo extends Error{constructor(e,o,c){o===401&&rt(c)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=o,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Ao=Zr()?()=>self.worker&&self.worker.referrer:()=>(M.location.protocol==="blob:"?M.parent:M).location.href,Fo=function(i,e){if(!(/^file:/.test(o=i.url)||/^file:/.test(Ao())&&!/^\w+:/.test(o))){if(M.fetch&&M.Request&&M.AbortController&&M.Request.prototype.hasOwnProperty("signal"))return function(c,f){const _=new M.AbortController,v=new M.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Ao(),referrerPolicy:c.referrerPolicy,signal:_.signal});let E=!1,S=!1;const k=(L=v.url).indexOf("sku=")>0&&rt(L);var L;c.type==="json"&&v.headers.set("Accept","application/json");const z=(W,q,X)=>{if(S)return;if(W&&W.message!=="SecurityError"&&Nn(W.toString()),q&&X)return N(q);const le=Date.now();M.fetch(v).then(ve=>{if(ve.ok){const Re=k?ve.clone():null;return N(ve,Re,le)}return f(new lo(ve.statusText,ve.status,c.url))}).catch(ve=>{ve.name!=="AbortError"&&f(new Error(`${ve.message} ${c.url}`))})},N=(W,q,X)=>{(c.type==="arrayBuffer"?W.arrayBuffer():c.type==="json"?W.json():W.text()).then(le=>{S||(q&&X&&function(ve,Re,be){if(wr(),!Cr)return;const Pe={status:Re.status,statusText:Re.statusText,headers:new M.Headers};Re.headers.forEach((ft,ct)=>Pe.headers.set(ct,ft));const Be=Br(Re.headers.get("Cache-Control")||"");if(Be["no-store"])return;Be["max-age"]&&Pe.headers.set("Expires",new Date(be+1e3*Be["max-age"]).toUTCString());const ze=Pe.headers.get("Expires");ze&&(new Date(ze).getTime()-be<42e4||function(ft,ct){if(Oi===void 0)try{new Response(new ReadableStream),Oi=!0}catch{Oi=!1}Oi?ct(ft.body):ft.blob().then(ct)}(Re,ft=>{const ct=new M.Response(ft,Pe);wr(),Cr&&Cr.then(Pt=>Pt.put(rr(ve.url),ct)).catch(Pt=>Nn(Pt.message))}))}(v,q,X),E=!0,f(null,le,W.headers.get("Cache-Control"),W.headers.get("Expires")))}).catch(le=>{S||f(new Error(le.message))})};return k?function(W,q){if(wr(),!Cr)return q(null);const X=rr(W.url);Cr.then(le=>{le.match(X).then(ve=>{const Re=function(be){if(!be)return!1;const Pe=new Date(be.headers.get("Expires")||0),Be=Br(be.headers.get("Cache-Control")||"");return Pe>Date.now()&&!Be["no-cache"]}(ve);le.delete(X),Re&&le.put(X,ve.clone()),q(null,ve,Re)}).catch(q)}).catch(q)}(v,z):z(null,null),{cancel:()=>{S=!0,E||_.abort()}}}(i,e);if(Zr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,e,void 0,!0)}var o;return function(c,f){const _=new M.XMLHttpRequest;_.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(_.responseType="arraybuffer");for(const v in c.headers)_.setRequestHeader(v,c.headers[v]);return c.type==="json"&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials=c.credentials==="include",_.onerror=()=>{f(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||_.status===0)&&_.response!==null){let v=_.response;if(c.type==="json")try{v=JSON.parse(_.response)}catch(E){return f(E)}f(null,v,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else f(new lo(_.statusText,_.status,c.url))},_.send(c.body),{cancel:()=>_.abort()}}(i,e)},go=function(i,e){return Fo(vn(i,{type:"arrayBuffer"}),e)};function rs(i){const e=M.document.createElement("a");return e.href=i,e.protocol===M.document.location.protocol&&e.host===M.document.location.host}const Ae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let J,te;J=[],te=0;const ke=function(i,e){if(Z.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),te>=F.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:i,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return J.push(_),_}te++;let o=!1;const c=()=>{if(!o)for(o=!0,te--;J.length&&te<F.MAX_PARALLEL_IMAGE_REQUESTS;){const _=J.shift(),{requestParameters:v,callback:E,cancelled:S}=_;S||(_.cancel=ke(v,E).cancel)}},f=go(i,(_,v,E,S)=>{c(),_?e(_):v&&(M.createImageBitmap?function(k,L){const z=new M.Blob([new Uint8Array(k)],{type:"image/png"});M.createImageBitmap(z).then(N=>{L(null,N)}).catch(N=>{L(new Error(`Could not load image because of ${N.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(k,L)=>e(k,L,E,S)):function(k,L){const z=new M.Image,N=M.URL;z.onload=()=>{L(null,z),N.revokeObjectURL(z.src),z.onload=null,M.requestAnimationFrame(()=>{z.src=Ae})},z.onerror=()=>L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const W=new M.Blob([new Uint8Array(k)],{type:"image/png"});z.src=k.byteLength?N.createObjectURL(W):Ae}(v,(k,L)=>e(k,L,E,S)))});return{cancel:()=>{f.cancel(),c()}}},Oe="NO_ACCESS_TOKEN";function Ge(i){return i.indexOf("mapbox:")===0}function rt(i){return F.API_URL_REGEX.test(i)}function it(i){return F.API_CDN_URL_REGEX.test(i)}function Ze(i){return F.API_STYLE_REGEX.test(i)&&!dt(i)}function dt(i){return F.API_SPRITE_REGEX.test(i)}const Xt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Gt(i){const e=i.match(Xt);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function $t(i){const e=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${e}`}const G="mapbox.eventData";function ee(i){if(!i)return null;const e=i.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(M.atob(e[1]).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Q{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const o=ee(F.ACCESS_TOKEN);let c="";return c=o&&o.u?M.btoa(encodeURIComponent(o.u).replace(/%([0-9A-F]{2})/g,(f,_)=>String.fromCharCode(+("0x"+_)))):F.ACCESS_TOKEN||"",e?`${G}.${e}:${c}`:`${G}:${c}`}fetchEventData(){const e=Xi("localStorage"),o=this.getStorageKey(),c=this.getStorageKey("uuid");if(e)try{const f=M.localStorage.getItem(o);f&&(this.eventData=JSON.parse(f));const _=M.localStorage.getItem(c);_&&(this.anonId=_)}catch{Nn("Unable to read from LocalStorage")}}saveEventData(){const e=Xi("localStorage"),o=this.getStorageKey(),c=this.getStorageKey("uuid");if(e)try{M.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&M.localStorage.setItem(o,JSON.stringify(this.eventData))}catch{Nn("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,o,c,f){if(!F.EVENTS_URL)return;const _=Gt(F.EVENTS_URL);_.params.push(`access_token=${f||F.ACCESS_TOKEN||""}`);const v={event:this.type,created:new Date(e).toISOString()},E=o?vn(v,o):v,S={url:$t(_),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};this.pendingRequest=function(k,L){return Fo(vn(k,{method:"POST"}),L)}(S,k=>{this.pendingRequest=null,c(k),this.saveEventData(),this.processRequests(f)})}queueRequest(e,o){this.queue.push(e),this.processRequests(o)}}const B=new class extends Q{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,e){F.EVENTS_URL&&F.ACCESS_TOKEN&&Array.isArray(i)&&i.some(o=>Ge(o)||rt(o))&&this.queueRequest(Date.now(),e)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=ee(F.ACCESS_TOKEN),o=e?e.u:F.ACCESS_TOKEN;let c=o!==this.eventData.tokenU;bt(this.anonId)||(this.anonId=ir(),c=!0);const f=this.queue.shift();if(this.eventData.lastSuccess){const _=new Date(this.eventData.lastSuccess),v=new Date(f),E=(f-this.eventData.lastSuccess)/864e5;c=c||E>=1||E<-1||_.getDate()!==v.getDate()}else c=!0;c?this.postEvent(f,{sdkIdentifier:"mapbox-gl-js",sdkVersion:R,skuId:_e,"enabled.telemetry":!1,userId:this.anonId},_=>{_||(this.eventData.lastSuccess=f,this.eventData.tokenU=o)},i):this.processRequests()}},ce=B.postTurnstileEvent.bind(B),Qe=new class extends Q{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,e,o,c){this.skuToken=e,this.errorCb=c,F.EVENTS_URL&&(o||F.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},o):this.errorCb(new Error(Oe)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:o}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),bt(this.anonId)||(this.anonId=ir()),this.postEvent(o,{sdkIdentifier:"mapbox-gl-js",sdkVersion:R,skuId:_e,skuToken:this.skuToken,userId:this.anonId},c=>{c?this.errorCb(c):e&&(this.success[e]=!0)},i))}},ot=Qe.postMapLoadEvent.bind(Qe),Lt=new class extends Q{constructor(){super("gljs.performance")}postPerformanceEvent(i,e){F.EVENTS_URL&&(i||F.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},i)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:o}=this.queue.shift(),c=function(f){const _=M.performance.getEntriesByType("resource"),v=M.performance.getEntriesByType("mark"),E=function(N){const W={};if(N){for(const q in N)if(q!=="other")for(const X of N[q]){const le=`${q}ResolveRangeMin`,ve=`${q}ResolveRangeMax`,Re=`${q}RequestCount`,be=`${q}RequestCachedCount`;W[le]=Math.min(W[le]||1/0,X.startTime),W[ve]=Math.max(W[ve]||-1/0,X.responseEnd);const Pe=Be=>{W[Be]===void 0&&(W[Be]=0),++W[Be]};X.transferSize!==void 0&&X.transferSize===0&&Pe(be),Pe(Re)}}return W}(function(N,W){const q={};if(N)for(const X of N){const le=W(X);q[le]===void 0&&(q[le]=[]),q[le].push(X)}return q}(_,hr)),S=M.devicePixelRatio,k=M.navigator.connection||M.navigator.mozConnection||M.navigator.webkitConnection,L={counters:[],metadata:[],attributes:[]},z=(N,W,q)=>{q!=null&&N.push({name:W,value:q.toString()})};for(const N in E)z(L.counters,N,E[N]);if(f.interactionRange[0]!==1/0&&f.interactionRange[1]!==-1/0&&(z(L.counters,"interactionRangeMin",f.interactionRange[0]),z(L.counters,"interactionRangeMax",f.interactionRange[1])),v)for(const N of Object.keys(Cn)){const W=Cn[N],q=v.find(X=>X.name===W);q&&z(L.counters,W,q.startTime)}return z(L.counters,"visibilityHidden",f.visibilityHidden),z(L.attributes,"style",function(N){if(N)for(const W of N){const q=W.name.split("?")[0];if(Ze(q)){const X=q.split("/").slice(-2);if(X.length===2)return`mapbox://styles/${X[0]}/${X[1]}`}}}(_)),z(L.attributes,"terrainEnabled",f.terrainEnabled?"true":"false"),z(L.attributes,"fogEnabled",f.fogEnabled?"true":"false"),z(L.attributes,"projection",f.projection),z(L.attributes,"zoom",f.zoom),z(L.metadata,"devicePixelRatio",S),z(L.metadata,"connectionEffectiveType",k?k.effectiveType:void 0),z(L.metadata,"navigatorUserAgent",M.navigator.userAgent),z(L.metadata,"screenWidth",M.screen.width),z(L.metadata,"screenHeight",M.screen.height),z(L.metadata,"windowWidth",M.innerWidth),z(L.metadata,"windowHeight",M.innerHeight),z(L.metadata,"mapWidth",f.width/S),z(L.metadata,"mapHeight",f.height/S),z(L.metadata,"webglRenderer",f.renderer),z(L.metadata,"webglVendor",f.vendor),z(L.metadata,"sdkVersion",R),z(L.metadata,"sdkIdentifier","mapbox-gl-js"),L}(o);for(const f of c.metadata);for(const f of c.counters);for(const f of c.attributes);this.postEvent(e,c,()=>{},i)}},Ut=Lt.postPerformanceEvent.bind(Lt),Ln=new class extends Q{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,e,o,c){if(!F.API_URL||!F.SESSION_PATH)return;const f=Gt(F.API_URL+F.SESSION_PATH);f.params.push(`sku=${e||""}`),f.params.push(`access_token=${c||F.ACCESS_TOKEN||""}`);const _={url:$t(f),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(v,E){return Fo(vn(v,{method:"GET"}),E)}(_,v=>{this.pendingRequest=null,o(v),this.saveEventData(),this.processRequests(c)})}getSessionAPI(i,e,o,c){this.skuToken=e,this.errorCb=c,F.SESSION_PATH&&F.API_URL&&(o||F.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},o):this.errorCb(new Error(Oe)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:o}=this.queue.shift();e&&this.success[e]||this.getSession(o,this.skuToken,c=>{c?this.errorCb(c):e&&(this.success[e]=!0)},i)}},ln=Ln.getSessionAPI.bind(Ln),or=new Set,Cn={create:"create",load:"load",fullLoad:"fullLoad"},ur={mark(i){M.performance.mark(i)},measure(i,e,o){M.performance.measure(i,e,o)}};function hr(i){const e=i.name.split("?")[0];return it(e)&&e.includes("mapbox-gl.js")?"javascript":it(e)&&e.includes("mapbox-gl.css")?"css":function(o){return F.API_FONTS_REGEX.test(o)}(e)?"fontRange":dt(e)?"sprite":Ze(e)?"style":function(o){return F.API_TILEJSON_REGEX.test(o)}(e)?"tilejson":"other"}const bn=M.performance;function Sr(i){const e=i?i.url.toString():void 0;return bn.getEntriesByName(e)}let fr,On,Gn,yn;const Pn={now:()=>Gn!==void 0?Gn:M.performance.now(),setNow(i){Gn=i},restoreNow(){Gn=void 0},frame(i){const e=M.requestAnimationFrame(i);return{cancel:()=>M.cancelAnimationFrame(e)}},getImageData(i,e=0){const{width:o,height:c}=i;yn||(yn=M.document.createElement("canvas"));const f=yn.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return(o>yn.width||c>yn.height)&&(yn.width=o,yn.height=c),f.clearRect(-e,-e,o+2*e,c+2*e),f.drawImage(i,0,0,o,c),f.getImageData(-e,-e,o+2*e,c+2*e)},resolveURL:i=>(fr||(fr=M.document.createElement("a")),fr.href=i,fr.href),get devicePixelRatio(){return M.devicePixelRatio},get prefersReducedMotion(){return!!M.matchMedia&&(On==null&&(On=M.matchMedia("(prefers-reduced-motion: reduce)")),On.matches)}};function mn(i,e,o){o[i]&&o[i].indexOf(e)!==-1||(o[i]=o[i]||[],o[i].push(e))}function Dn(i,e,o){if(o&&o[i]){const c=o[i].indexOf(e);c!==-1&&o[i].splice(c,1)}}class En{constructor(e,o={}){vn(this,o),this.type=e}}class cn extends En{constructor(e,o={}){super("error",vn({error:e},o))}}class yt{on(e,o){return this._listeners=this._listeners||{},mn(e,o,this._listeners),this}off(e,o){return Dn(e,o,this._listeners),Dn(e,o,this._oneTimeListeners),this}once(e,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},mn(e,o,this._oneTimeListeners),this):new Promise(c=>this.once(e,c))}fire(e,o){typeof e=="string"&&(e=new En(e,o||{}));const c=e.type;if(this.listens(c)){e.target=this;const f=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const E of f)E.call(this,e);const _=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const E of _)Dn(c,E,this._oneTimeListeners),E.call(this,e);const v=this._eventedParent;v&&(vn(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(e))}else e instanceof cn&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,o){return this._eventedParent=e,this._eventedParentData=o,this}}var Te=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Dt(i,...e){for(const o of e)for(const c in o)i[c]=o[c];return i}function Tt(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function It(i){if(Array.isArray(i))return i.map(It);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const e={};for(const o in i)e[o]=It(i[o]);return e}return Tt(i)}class tn extends Error{constructor(e,o){super(o),this.message=o,this.key=e}}var Bn=tn;class pr{constructor(e,o=[]){this.parent=e,this.bindings={};for(const[c,f]of o)this.bindings[c]=f}concat(e){return new pr(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var _r=pr;const sr={kind:"null"},pe={kind:"number"},wn={kind:"string"},Tn={kind:"boolean"},yr={kind:"color"},ar={kind:"object"},xn={kind:"value"},Er={kind:"collator"},ie={kind:"formatted"},ae={kind:"resolvedImage"};function Le(i,e){return{kind:"array",itemType:i,N:e}}function tt(i){if(i.kind==="array"){const e=tt(i.itemType);return typeof i.N=="number"?`array<${e}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${e}>`}return i.kind}const zt=[sr,pe,wn,Tn,yr,ie,ar,Le(xn),ae];function an(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!an(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(const o of zt)if(!an(o,e))return null}}return`Expected ${tt(i)} but found ${tt(e)} instead.`}function Qn(i,e){return e.some(o=>o.kind===i.kind)}function Fr(i,e){return e.some(o=>o==="null"?i===null:o==="array"?Array.isArray(i):o==="object"?i&&!Array.isArray(i)&&typeof i=="object":o===typeof i)}var Vr,ro={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Wi(i){return(i=Math.round(i))<0?0:i>255?255:i}function Ps(i){return Wi(i[i.length-1]==="%"?parseFloat(i)/100*255:parseInt(i))}function Gs(i){return(e=i[i.length-1]==="%"?parseFloat(i)/100:parseFloat(i))<0?0:e>1?1:e;var e}function ha(i,e,o){return o<0?o+=1:o>1&&(o-=1),6*o<1?i+(e-i)*o*6:2*o<1?e:3*o<2?i+(e-i)*(2/3-o)*6:i}try{Vr={}.parseCSSColor=function(i){var e,o=i.replace(/ /g,"").toLowerCase();if(o in ro)return ro[o].slice();if(o[0]==="#")return o.length===4?(e=parseInt(o.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:o.length===7&&(e=parseInt(o.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var c=o.indexOf("("),f=o.indexOf(")");if(c!==-1&&f+1===o.length){var _=o.substr(0,c),v=o.substr(c+1,f-(c+1)).split(","),E=1;switch(_){case"rgba":if(v.length!==4)return null;E=Gs(v.pop());case"rgb":return v.length!==3?null:[Ps(v[0]),Ps(v[1]),Ps(v[2]),E];case"hsla":if(v.length!==4)return null;E=Gs(v.pop());case"hsl":if(v.length!==3)return null;var S=(parseFloat(v[0])%360+360)%360/360,k=Gs(v[1]),L=Gs(v[2]),z=L<=.5?L*(k+1):L+k-L*k,N=2*L-z;return[Wi(255*ha(N,z,S+1/3)),Wi(255*ha(N,z,S)),Wi(255*ha(N,z,S-1/3)),E];default:return null}}return null}}catch{}class Eo{constructor(e,o,c,f=1){this.r=e,this.g=o,this.b=c,this.a=f}static parse(e){if(!e)return;if(e instanceof Eo)return e;if(typeof e!="string")return;const o=Vr(e);return o?new Eo(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toString(){const[e,o,c,f]=this.toArray();return`rgba(${Math.round(e)},${Math.round(o)},${Math.round(c)},${f})`}toArray(){const{r:e,g:o,b:c,a:f}=this;return f===0?[0,0,0,0]:[255*e/f,255*o/f,255*c/f,f]}toArray01(){const{r:e,g:o,b:c,a:f}=this;return f===0?[0,0,0,0]:[e/f,o/f,c/f,f]}toArray01PremultipliedAlpha(){const{r:e,g:o,b:c,a:f}=this;return[e,o,c,f]}}Eo.black=new Eo(0,0,0,1),Eo.white=new Eo(1,1,1,1),Eo.transparent=new Eo(0,0,0,0),Eo.red=new Eo(1,0,0,1),Eo.blue=new Eo(0,0,1,1);var _i=Eo;class Fd{constructor(e,o,c){this.sensitivity=e?o?"variant":"case":o?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,o){return this.collator.compare(e,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class vh{constructor(e,o,c,f,_){this.text=e.normalize?e.normalize():e,this.image=o,this.scale=c,this.fontStack=f,this.textColor=_}}class To{constructor(e){this.sections=e}static fromString(e){return new To([new vh(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof To?e:To.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const o of this.sections){if(o.image){e.push(["image",o.image.name]);continue}e.push(o.text);const c={};o.fontStack&&(c["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(c["font-scale"]=o.scale),o.textColor&&(c["text-color"]=["rgba"].concat(o.textColor.toArray())),e.push(c)}return e}}class Is{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Is({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Ud(i,e,o,c){return typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof o=="number"&&o>=0&&o<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[i,e,o,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[i,e,o,c]:[i,e,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ja(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof _i||i instanceof Fd||i instanceof To||i instanceof Is)return!0;if(Array.isArray(i)){for(const e of i)if(!Ja(e))return!1;return!0}if(typeof i=="object"){for(const e in i)if(!Ja(i[e]))return!1;return!0}return!1}function Ui(i){if(i===null)return sr;if(typeof i=="string")return wn;if(typeof i=="boolean")return Tn;if(typeof i=="number")return pe;if(i instanceof _i)return yr;if(i instanceof Fd)return Er;if(i instanceof To)return ie;if(i instanceof Is)return ae;if(Array.isArray(i)){const e=i.length;let o;for(const c of i){const f=Ui(c);if(o){if(o===f)continue;o=xn;break}o=f}return Le(o||xn,e)}return ar}function mu(i){const e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof _i||i instanceof To||i instanceof Is?i.toString():JSON.stringify(i)}class xl{constructor(e,o){this.type=e,this.value=o}static parse(e,o){if(e.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Ja(e[1]))return o.error("invalid value");const c=e[1];let f=Ui(c);const _=o.expectedType;return f.kind!=="array"||f.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(f=_),new xl(f,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof _i?["rgba"].concat(this.value.toArray()):this.value instanceof To?this.value.serialize():this.value}}var Zs=xl,Yi=class{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}};const oc={string:wn,number:pe,boolean:Tn,object:ar};class $d{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");let c,f=1;const _=e[0];if(_==="array"){let E,S;if(e.length>2){const k=e[1];if(typeof k!="string"||!(k in oc)||k==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);E=oc[k],f++}else E=xn;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return o.error('The length argument to "array" must be a positive integer literal',2);S=e[2],f++}c=Le(E,S)}else c=oc[_];const v=[];for(;f<e.length;f++){const E=o.parse(e[f],f,xn);if(!E)return null;v.push(E)}return new $d(c,v)}evaluate(e){for(let o=0;o<this.args.length;o++){const c=this.args[o].evaluate(e);if(!an(this.type,Ui(c)))return c;if(o===this.args.length-1)throw new Yi(`Expected value to be of type ${tt(this.type)}, but found ${tt(Ui(c))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,o=[e.kind];if(e.kind==="array"){const c=e.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){o.push(c.kind);const f=e.N;(typeof f=="number"||this.args.length>1)&&o.push(f)}}return o.concat(this.args.map(c=>c.serialize()))}}var Pa=$d;class da{constructor(e){this.type=ie,this.sections=e}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");const c=e[1];if(!Array.isArray(c)&&typeof c=="object")return o.error("First argument must be an image or text section.");const f=[];let _=!1;for(let v=1;v<=e.length-1;++v){const E=e[v];if(_&&typeof E=="object"&&!Array.isArray(E)){_=!1;let S=null;if(E["font-scale"]&&(S=o.parse(E["font-scale"],1,pe),!S))return null;let k=null;if(E["text-font"]&&(k=o.parse(E["text-font"],1,Le(wn)),!k))return null;let L=null;if(E["text-color"]&&(L=o.parse(E["text-color"],1,yr),!L))return null;const z=f[f.length-1];z.scale=S,z.font=k,z.textColor=L}else{const S=o.parse(e[v],1,xn);if(!S)return null;const k=S.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,f.push({content:S,scale:null,font:null,textColor:null})}}return new da(f)}evaluate(e){return new To(this.sections.map(o=>{const c=o.content.evaluate(e);return Ui(c)===ae?new vh("",c,null,null,null):new vh(mu(c),null,o.scale?o.scale.evaluate(e):null,o.font?o.font.evaluate(e).join(","):null,o.textColor?o.textColor.evaluate(e):null)}))}eachChild(e){for(const o of this.sections)e(o.content),o.scale&&e(o.scale),o.font&&e(o.font),o.textColor&&e(o.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const o of this.sections){e.push(o.content.serialize());const c={};o.scale&&(c["font-scale"]=o.scale.serialize()),o.font&&(c["text-font"]=o.font.serialize()),o.textColor&&(c["text-color"]=o.textColor.serialize()),e.push(c)}return e}}class wl{constructor(e){this.type=ae,this.input=e}static parse(e,o){if(e.length!==2)return o.error("Expected two arguments.");const c=o.parse(e[1],1,wn);return c?new wl(c):o.error("No image name provided.")}evaluate(e){const o=this.input.evaluate(e),c=Is.fromString(o);return c&&e.availableImages&&(c.available=e.availableImages.indexOf(o)>-1),c}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Vd={"to-boolean":Tn,"to-color":yr,"to-number":pe,"to-string":wn};class xh{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");const c=e[0];if((c==="to-boolean"||c==="to-string")&&e.length!==2)return o.error("Expected one argument.");const f=Vd[c],_=[];for(let v=1;v<e.length;v++){const E=o.parse(e[v],v,xn);if(!E)return null;_.push(E)}return new xh(f,_)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let o,c;for(const f of this.args){if(o=f.evaluate(e),c=null,o instanceof _i)return o;if(typeof o=="string"){const _=e.parseColor(o);if(_)return _}else if(Array.isArray(o)&&(c=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Ud(o[0],o[1],o[2],o[3]),!c))return new _i(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Yi(c||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const c of this.args){if(o=c.evaluate(e),o===null)return 0;const f=Number(o);if(!isNaN(f))return f}throw new Yi(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?To.fromString(mu(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Is.fromString(mu(this.args[0].evaluate(e))):mu(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new da([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new wl(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(o=>{e.push(o.serialize())}),e}}var ys=xh;const Ls=["Unknown","Point","LineString","Polygon"];var sc=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ls[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:o,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(o*e-i[0])+this.featureDistanceData.bearing[1]*(c*e-i[1])}return 0}parseColor(i){let e=this._parseColorCache[i];return e||(e=this._parseColorCache[i]=_i.parse(i)),e}};class Qa{constructor(e,o,c,f){this.name=e,this.type=o,this._evaluate=c,this.args=f}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,o){const c=e[0],f=Qa.definitions[c];if(!f)return o.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(f)?f[0]:f.type,v=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,E=v.filter(([k])=>!Array.isArray(k)||k.length===e.length-1);let S=null;for(const[k,L]of E){S=new Zd(o.registry,o.path,null,o.scope);const z=[];let N=!1;for(let W=1;W<e.length;W++){const q=e[W],X=Array.isArray(k)?k[W-1]:k.type,le=S.parse(q,1+z.length,X);if(!le){N=!0;break}z.push(le)}if(!N)if(Array.isArray(k)&&k.length!==z.length)S.error(`Expected ${k.length} arguments, but found ${z.length} instead.`);else{for(let W=0;W<z.length;W++){const q=Array.isArray(k)?k[W]:k.type,X=z[W];S.concat(W+1).checkSubtype(q,X.type)}if(S.errors.length===0)return new Qa(c,_,L,z)}}if(E.length===1)o.errors.push(...S.errors);else{const k=(E.length?E:v).map(([z])=>{return N=z,Array.isArray(N)?`(${N.map(tt).join(", ")})`:`(${tt(N.type)}...)`;var N}).join(" | "),L=[];for(let z=1;z<e.length;z++){const N=o.parse(e[z],1+L.length);if(!N)return null;L.push(tt(N.type))}o.error(`Expected arguments of type ${k}, but found (${L.join(", ")}) instead.`)}return null}static register(e,o){Qa.definitions=o;for(const c in o)e[c]=Qa}}var Rs=Qa;class el{constructor(e,o,c){this.type=Er,this.locale=c,this.caseSensitive=e,this.diacriticSensitive=o}static parse(e,o){if(e.length!==2)return o.error("Expected one argument.");const c=e[1];if(typeof c!="object"||Array.isArray(c))return o.error("Collator options argument must be an object.");const f=o.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,Tn);if(!f)return null;const _=o.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,Tn);if(!_)return null;let v=null;return c.locale&&(v=o.parse(c.locale,1,wn),!v)?null:new el(f,_,v)}evaluate(e){return new Fd(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const fa=8192;function Uo(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}function Hs(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}function bl(i,e){const o=(180+i[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,f=Math.pow(2,e.z);return[Math.round(o*f*fa),Math.round(c*f*fa)]}function ac(i,e,o){const c=i[0]-e[0],f=i[1]-e[1],_=i[0]-o[0],v=i[1]-o[1];return c*v-_*f==0&&c*_<=0&&f*v<=0}function wh(i,e){let o=!1;for(let v=0,E=e.length;v<E;v++){const S=e[v];for(let k=0,L=S.length;k<L-1;k++){if(ac(i,S[k],S[k+1]))return!1;(f=S[k])[1]>(c=i)[1]!=(_=S[k+1])[1]>c[1]&&c[0]<(_[0]-f[0])*(c[1]-f[1])/(_[1]-f[1])+f[0]&&(o=!o)}}var c,f,_;return o}function gu(i,e){for(let o=0;o<e.length;o++)if(wh(i,e[o]))return!0;return!1}function _u(i,e,o,c){const f=c[0]-o[0],_=c[1]-o[1],v=(i[0]-o[0])*_-f*(i[1]-o[1]),E=(e[0]-o[0])*_-f*(e[1]-o[1]);return v>0&&E<0||v<0&&E>0}function pa(i,e,o){for(const k of o)for(let L=0;L<k.length-1;++L)if((E=[(v=k[L+1])[0]-(_=k[L])[0],v[1]-_[1]])[0]*(S=[(f=e)[0]-(c=i)[0],f[1]-c[1]])[1]-E[1]*S[0]!=0&&_u(c,f,_,v)&&_u(_,v,c,f))return!0;var c,f,_,v,E,S;return!1}function Hr(i,e){for(let o=0;o<i.length;++o)if(!wh(i[o],e))return!1;for(let o=0;o<i.length-1;++o)if(pa(i[o],i[o+1],e))return!1;return!0}function hp(i,e){for(let o=0;o<e.length;o++)if(Hr(i,e[o]))return!0;return!1}function Wd(i,e,o){const c=[];for(let f=0;f<i.length;f++){const _=[];for(let v=0;v<i[f].length;v++){const E=bl(i[f][v],o);Uo(e,E),_.push(E)}c.push(_)}return c}function dp(i,e,o){const c=[];for(let f=0;f<i.length;f++){const _=Wd(i[f],e,o);c.push(_)}return c}function qd(i,e,o,c){if(i[0]<o[0]||i[0]>o[2]){const f=.5*c;let _=i[0]-o[0]>f?-c:o[0]-i[0]>f?c:0;_===0&&(_=i[0]-o[2]>f?-c:o[2]-i[0]>f?c:0),i[0]+=_}Uo(e,i)}function bh(i,e,o,c){const f=Math.pow(2,c.z)*fa,_=[c.x*fa,c.y*fa],v=[];if(!i)return v;for(const E of i)for(const S of E){const k=[S.x+_[0],S.y+_[1]];qd(k,e,o,f),v.push(k)}return v}function Gd(i,e,o,c){const f=Math.pow(2,c.z)*fa,_=[c.x*fa,c.y*fa],v=[];if(!i)return v;for(const S of i){const k=[];for(const L of S){const z=[L.x+_[0],L.y+_[1]];Uo(e,z),k.push(z)}v.push(k)}if(e[2]-e[0]<=f/2){(E=e)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const S of v)for(const k of S)qd(k,e,o,f)}var E;return v}class lc{constructor(e,o){this.type=Tn,this.geojson=e,this.geometries=o}static parse(e,o){if(e.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ja(e[1])){const c=e[1];if(c.type==="FeatureCollection")for(let f=0;f<c.features.length;++f){const _=c.features[f].geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new lc(c,c.features[f].geometry)}else if(c.type==="Feature"){const f=c.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new lc(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new lc(c,c)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(o,c){const f=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=o.canonicalID();if(!v)return!1;if(c.type==="Polygon"){const E=Wd(c.coordinates,_,v),S=bh(o.geometry(),f,_,v);if(!Hs(f,_))return!1;for(const k of S)if(!wh(k,E))return!1}if(c.type==="MultiPolygon"){const E=dp(c.coordinates,_,v),S=bh(o.geometry(),f,_,v);if(!Hs(f,_))return!1;for(const k of S)if(!gu(k,E))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(o,c){const f=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=o.canonicalID();if(!v)return!1;if(c.type==="Polygon"){const E=Wd(c.coordinates,_,v),S=Gd(o.geometry(),f,_,v);if(!Hs(f,_))return!1;for(const k of S)if(!Hr(k,E))return!1}if(c.type==="MultiPolygon"){const E=dp(c.coordinates,_,v),S=Gd(o.geometry(),f,_,v);if(!Hs(f,_))return!1;for(const k of S)if(!hp(k,E))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Eh=lc;function cc(i){if(i instanceof Rs&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Eh)return!1;let e=!0;return i.eachChild(o=>{e&&!cc(o)&&(e=!1)}),e}function Ia(i){if(i instanceof Rs&&i.name==="feature-state")return!1;let e=!0;return i.eachChild(o=>{e&&!Ia(o)&&(e=!1)}),e}function tl(i,e){if(i instanceof Rs&&e.indexOf(i.name)>=0)return!1;let o=!0;return i.eachChild(c=>{o&&!tl(c,e)&&(o=!1)}),o}class Th{constructor(e,o){this.type=o.type,this.name=e,this.boundExpression=o}static parse(e,o){if(e.length!==2||typeof e[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const c=e[1];return o.scope.has(c)?new Th(c,o.scope.get(c)):o.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var fp=Th;class yu{constructor(e,o=[],c,f=new _r,_=[]){this.registry=e,this.path=o,this.key=o.map(v=>`[${v}]`).join(""),this.scope=f,this.errors=_,this.expectedType=c}parse(e,o,c,f,_={}){return o?this.concat(o,c,f)._parse(e,_):this._parse(e,_)}_parse(e,o){function c(f,_,v){return v==="assert"?new Pa(_,[f]):v==="coerce"?new ys(_,[f]):f}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=e[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[f];if(_){let v=_.parse(e,this);if(!v)return null;if(this.expectedType){const E=this.expectedType,S=v.type;if(E.kind!=="string"&&E.kind!=="number"&&E.kind!=="boolean"&&E.kind!=="object"&&E.kind!=="array"||S.kind!=="value")if(E.kind!=="color"&&E.kind!=="formatted"&&E.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string"){if(this.checkSubtype(E,S))return null}else v=c(v,E,o.typeAnnotation||"coerce");else v=c(v,E,o.typeAnnotation||"assert")}if(!(v instanceof Zs)&&v.type.kind!=="resolvedImage"&&vu(v)){const E=new sc;try{v=new Zs(v.type,v.evaluate(E))}catch(S){return this.error(S.message),null}}return v}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,o,c){const f=typeof e=="number"?this.path.concat(e):this.path,_=c?this.scope.concat(c):this.scope;return new yu(this.registry,f,o||null,_,this.errors)}error(e,...o){const c=`${this.key}${o.map(f=>`[${f}]`).join("")}`;this.errors.push(new Bn(c,e))}checkSubtype(e,o){const c=an(e,o);return c&&this.error(c),c}}var Zd=yu;function vu(i){if(i instanceof fp)return vu(i.boundExpression);if(i instanceof Rs&&i.name==="error"||i instanceof el||i instanceof Eh)return!1;const e=i instanceof ys||i instanceof Pa;let o=!0;return i.eachChild(c=>{o=e?o&&vu(c):o&&c instanceof Zs}),!!o&&cc(i)&&tl(i,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Ch(i,e){const o=i.length-1;let c,f,_=0,v=o,E=0;for(;_<=v;)if(E=Math.floor((_+v)/2),c=i[E],f=i[E+1],c<=e){if(E===o||e<f)return E;_=E+1}else{if(!(c>e))throw new Yi("Input is not a number.");v=E-1}return 0}class Sh{constructor(e,o,c){this.type=e,this.input=o,this.labels=[],this.outputs=[];for(const[f,_]of c)this.labels.push(f),this.outputs.push(_)}static parse(e,o){if(e.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return o.error("Expected an even number of arguments.");const c=o.parse(e[1],1,pe);if(!c)return null;const f=[];let _=null;o.expectedType&&o.expectedType.kind!=="value"&&(_=o.expectedType);for(let v=1;v<e.length;v+=2){const E=v===1?-1/0:e[v],S=e[v+1],k=v,L=v+1;if(typeof E!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(f.length&&f[f.length-1][0]>=E)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const z=o.parse(S,L,_);if(!z)return null;_=_||z.type,f.push([E,z])}return new Sh(_,c,f)}evaluate(e){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(e);const f=this.input.evaluate(e);if(f<=o[0])return c[0].evaluate(e);const _=o.length;return f>=o[_-1]?c[_-1].evaluate(e):c[Ch(o,f)].evaluate(e)}eachChild(e){e(this.input);for(const o of this.outputs)e(o)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&e.push(this.labels[o]),e.push(this.outputs[o].serialize());return e}}var Hd=Sh;function qr(i,e,o){return i*(1-o)+e*o}var xu=Object.freeze({__proto__:null,array:function(i,e,o){return i.map((c,f)=>qr(c,e[f],o))},color:function(i,e,o){return new _i(qr(i.r,e.r,o),qr(i.g,e.g,o),qr(i.b,e.b,o),qr(i.a,e.a,o))},number:qr});const pp=.95047,Kd=1.08883,mp=4/29,El=6/29,Xd=3*El*El,Km=El*El*El,Yd=Math.PI/180,wu=180/Math.PI;function Jd(i){return i>Km?Math.pow(i,1/3):i/Xd+mp}function kh(i){return i>El?i*i*i:Xd*(i-mp)}function Mh(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function bu(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Qd(i){const e=bu(i.r),o=bu(i.g),c=bu(i.b),f=Jd((.4124564*e+.3575761*o+.1804375*c)/pp),_=Jd((.2126729*e+.7151522*o+.072175*c)/1);return{l:116*_-16,a:500*(f-_),b:200*(_-Jd((.0193339*e+.119192*o+.9503041*c)/Kd)),alpha:i.a}}function ef(i){let e=(i.l+16)/116,o=isNaN(i.a)?e:e+i.a/500,c=isNaN(i.b)?e:e-i.b/200;return e=1*kh(e),o=pp*kh(o),c=Kd*kh(c),new _i(Mh(3.2404542*o-1.5371385*e-.4985314*c),Mh(-.969266*o+1.8760108*e+.041556*c),Mh(.0556434*o-.2040259*e+1.0572252*c),i.alpha)}function uc(i,e,o){const c=e-i;return i+o*(c>180||c<-180?c-360*Math.round(c/360):c)}const Eu={forward:Qd,reverse:ef,interpolate:function(i,e,o){return{l:qr(i.l,e.l,o),a:qr(i.a,e.a,o),b:qr(i.b,e.b,o),alpha:qr(i.alpha,e.alpha,o)}}},hc={forward:function(i){const{l:e,a:o,b:c}=Qd(i),f=Math.atan2(c,o)*wu;return{h:f<0?f+360:f,c:Math.sqrt(o*o+c*c),l:e,alpha:i.a}},reverse:function(i){const e=i.h*Yd,o=i.c;return ef({l:i.l,a:Math.cos(e)*o,b:Math.sin(e)*o,alpha:i.alpha})},interpolate:function(i,e,o){return{h:uc(i.h,e.h,o),c:qr(i.c,e.c,o),l:qr(i.l,e.l,o),alpha:qr(i.alpha,e.alpha,o)}}};var tf=Object.freeze({__proto__:null,hcl:hc,lab:Eu});class dc{constructor(e,o,c,f,_){this.type=e,this.operator=o,this.interpolation=c,this.input=f,this.labels=[],this.outputs=[];for(const[v,E]of _)this.labels.push(v),this.outputs.push(E)}static interpolationFactor(e,o,c,f){let _=0;if(e.name==="exponential")_=Ah(o,e.base,c,f);else if(e.name==="linear")_=Ah(o,1,c,f);else if(e.name==="cubic-bezier"){const v=e.controlPoints;_=new Ke(v[0],v[1],v[2],v[3]).solve(Ah(o,1,c,f))}return _}static parse(e,o){let[c,f,_,...v]=e;if(!Array.isArray(f)||f.length===0)return o.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const k=f[1];if(typeof k!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:k}}else{if(f[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const k=f.slice(1);if(k.length!==4||k.some(L=>typeof L!="number"||L<0||L>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:k}}}if(e.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(_=o.parse(_,2,pe),!_)return null;const E=[];let S=null;c==="interpolate-hcl"||c==="interpolate-lab"?S=yr:o.expectedType&&o.expectedType.kind!=="value"&&(S=o.expectedType);for(let k=0;k<v.length;k+=2){const L=v[k],z=v[k+1],N=k+3,W=k+4;if(typeof L!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',N);if(E.length&&E[E.length-1][0]>=L)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',N);const q=o.parse(z,W,S);if(!q)return null;S=S||q.type,E.push([L,q])}return S.kind==="number"||S.kind==="color"||S.kind==="array"&&S.itemType.kind==="number"&&typeof S.N=="number"?new dc(S,c,f,_,E):o.error(`Type ${tt(S)} is not interpolatable.`)}evaluate(e){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(e);const f=this.input.evaluate(e);if(f<=o[0])return c[0].evaluate(e);const _=o.length;if(f>=o[_-1])return c[_-1].evaluate(e);const v=Ch(o,f),E=dc.interpolationFactor(this.interpolation,f,o[v],o[v+1]),S=c[v].evaluate(e),k=c[v+1].evaluate(e);return this.operator==="interpolate"?xu[this.type.kind.toLowerCase()](S,k,E):this.operator==="interpolate-hcl"?hc.reverse(hc.interpolate(hc.forward(S),hc.forward(k),E)):Eu.reverse(Eu.interpolate(Eu.forward(S),Eu.forward(k),E))}eachChild(e){e(this.input);for(const o of this.outputs)e(o)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const o=[this.operator,e,this.input.serialize()];for(let c=0;c<this.labels.length;c++)o.push(this.labels[c],this.outputs[c].serialize());return o}}function Ah(i,e,o,c){const f=c-o,_=i-o;return f===0?0:e===1?_/f:(Math.pow(e,_)-1)/(Math.pow(e,f)-1)}var is=dc;class nl{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expectected at least one argument.");let c=null;const f=o.expectedType;f&&f.kind!=="value"&&(c=f);const _=[];for(const E of e.slice(1)){const S=o.parse(E,1+_.length,c,void 0,{typeAnnotation:"omit"});if(!S)return null;c=c||S.type,_.push(S)}const v=f&&_.some(E=>an(f,E.type));return new nl(v?xn:c,_)}evaluate(e){let o,c=null,f=0;for(const _ of this.args){if(f++,c=_.evaluate(e),c&&c instanceof Is&&!c.available&&(o||(o=c),c=null,f===this.args.length))return o;if(c!==null)break}return c}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(o=>{e.push(o.serialize())}),e}}var nf=nl;class Tl{constructor(e,o){this.type=o.type,this.bindings=[].concat(e),this.result=o}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const o of this.bindings)e(o[1]);e(this.result)}static parse(e,o){if(e.length<4)return o.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const c=[];for(let _=1;_<e.length-1;_+=2){const v=e[_];if(typeof v!="string")return o.error(`Expected string, but found ${typeof v} instead.`,_);if(/[^a-zA-Z0-9_]/.test(v))return o.error("Variable names must contain only alphanumeric characters or '_'.",_);const E=o.parse(e[_+1],_+1);if(!E)return null;c.push([v,E])}const f=o.parse(e[e.length-1],e.length-1,o.expectedType,c);return f?new Tl(c,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[o,c]of this.bindings)e.push(o,c.serialize());return e.push(this.result.serialize()),e}}var gp=Tl;class Ph{constructor(e,o,c){this.type=e,this.index=o,this.input=c}static parse(e,o){if(e.length!==3)return o.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const c=o.parse(e[1],1,pe),f=o.parse(e[2],2,Le(o.expectedType||xn));return c&&f?new Ph(f.type.itemType,c,f):null}evaluate(e){const o=this.index.evaluate(e),c=this.input.evaluate(e);if(o<0)throw new Yi(`Array index out of bounds: ${o} < 0.`);if(o>=c.length)throw new Yi(`Array index out of bounds: ${o} > ${c.length-1}.`);if(o!==Math.floor(o))throw new Yi(`Array index must be an integer, but found ${o} instead.`);return c[o]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var rf=Ph;class Tu{constructor(e,o){this.type=Tn,this.needle=e,this.haystack=o}static parse(e,o){if(e.length!==3)return o.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const c=o.parse(e[1],1,xn),f=o.parse(e[2],2,xn);return c&&f?Qn(c.type,[Tn,wn,pe,sr,xn])?new Tu(c,f):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${tt(c.type)} instead`):null}evaluate(e){const o=this.needle.evaluate(e),c=this.haystack.evaluate(e);if(c==null)return!1;if(!Fr(o,["boolean","string","number","null"]))throw new Yi(`Expected first argument to be of type boolean, string, number or null, but found ${tt(Ui(o))} instead.`);if(!Fr(c,["string","array"]))throw new Yi(`Expected second argument to be of type array or string, but found ${tt(Ui(c))} instead.`);return c.indexOf(o)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Cu=Tu;class fc{constructor(e,o,c){this.type=pe,this.needle=e,this.haystack=o,this.fromIndex=c}static parse(e,o){if(e.length<=2||e.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const c=o.parse(e[1],1,xn),f=o.parse(e[2],2,xn);if(!c||!f)return null;if(!Qn(c.type,[Tn,wn,pe,sr,xn]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${tt(c.type)} instead`);if(e.length===4){const _=o.parse(e[3],3,pe);return _?new fc(c,f,_):null}return new fc(c,f)}evaluate(e){const o=this.needle.evaluate(e),c=this.haystack.evaluate(e);if(!Fr(o,["boolean","string","number","null"]))throw new Yi(`Expected first argument to be of type boolean, string, number or null, but found ${tt(Ui(o))} instead.`);if(!Fr(c,["string","array"]))throw new Yi(`Expected second argument to be of type array or string, but found ${tt(Ui(c))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(e);return c.indexOf(o,f)}return c.indexOf(o)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var of=fc;class sf{constructor(e,o,c,f,_,v){this.inputType=e,this.type=o,this.input=c,this.cases=f,this.outputs=_,this.otherwise=v}static parse(e,o){if(e.length<5)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return o.error("Expected an even number of arguments.");let c,f;o.expectedType&&o.expectedType.kind!=="value"&&(f=o.expectedType);const _={},v=[];for(let k=2;k<e.length-1;k+=2){let L=e[k];const z=e[k+1];Array.isArray(L)||(L=[L]);const N=o.concat(k);if(L.length===0)return N.error("Expected at least one branch label.");for(const q of L){if(typeof q!="number"&&typeof q!="string")return N.error("Branch labels must be numbers or strings.");if(typeof q=="number"&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return N.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof q=="number"&&Math.floor(q)!==q)return N.error("Numeric branch labels must be integer values.");if(c){if(N.checkSubtype(c,Ui(q)))return null}else c=Ui(q);if(_[String(q)]!==void 0)return N.error("Branch labels must be unique.");_[String(q)]=v.length}const W=o.parse(z,k,f);if(!W)return null;f=f||W.type,v.push(W)}const E=o.parse(e[1],1,xn);if(!E)return null;const S=o.parse(e[e.length-1],e.length-1,f);return S?E.type.kind!=="value"&&o.concat(1).checkSubtype(c,E.type)?null:new sf(c,f,E,_,v,S):null}evaluate(e){const o=this.input.evaluate(e);return(Ui(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),c=[],f={};for(const v of o){const E=f[this.cases[v]];E===void 0?(f[this.cases[v]]=c.length,c.push([this.cases[v],[v]])):c[E][1].push(v)}const _=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,E]of c)e.push(E.length===1?_(E[0]):E.map(_)),e.push(this.outputs[v].serialize());return e.push(this.otherwise.serialize()),e}}var Xm=sf;class af{constructor(e,o,c){this.type=e,this.branches=o,this.otherwise=c}static parse(e,o){if(e.length<4)return o.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return o.error("Expected an odd number of arguments.");let c;o.expectedType&&o.expectedType.kind!=="value"&&(c=o.expectedType);const f=[];for(let v=1;v<e.length-1;v+=2){const E=o.parse(e[v],v,Tn);if(!E)return null;const S=o.parse(e[v+1],v+1,c);if(!S)return null;f.push([E,S]),c=c||S.type}const _=o.parse(e[e.length-1],e.length-1,c);return _?new af(c,f,_):null}evaluate(e){for(const[o,c]of this.branches)if(o.evaluate(e))return c.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[o,c]of this.branches)e(o),e(c);e(this.otherwise)}outputDefined(){return this.branches.every(([e,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(o=>{e.push(o.serialize())}),e}}var _p=af;class Su{constructor(e,o,c,f){this.type=e,this.input=o,this.beginIndex=c,this.endIndex=f}static parse(e,o){if(e.length<=2||e.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const c=o.parse(e[1],1,xn),f=o.parse(e[2],2,pe);if(!c||!f)return null;if(!Qn(c.type,[Le(xn),wn,xn]))return o.error(`Expected first argument to be of type array or string, but found ${tt(c.type)} instead`);if(e.length===4){const _=o.parse(e[3],3,pe);return _?new Su(c.type,c,f,_):null}return new Su(c.type,c,f)}evaluate(e){const o=this.input.evaluate(e),c=this.beginIndex.evaluate(e);if(!Fr(o,["string","array"]))throw new Yi(`Expected first argument to be of type array or string, but found ${tt(Ui(o))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(e);return o.slice(c,f)}return o.slice(c)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Os=Su;function rl(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function lf(i,e,o,c){return c.compare(e,o)===0}function Cl(i,e,o){const c=i!=="=="&&i!=="!=";return class y6{constructor(_,v,E){this.type=Tn,this.lhs=_,this.rhs=v,this.collator=E,this.hasUntypedArgument=_.type.kind==="value"||v.type.kind==="value"}static parse(_,v){if(_.length!==3&&_.length!==4)return v.error("Expected two or three arguments.");const E=_[0];let S=v.parse(_[1],1,xn);if(!S)return null;if(!rl(E,S.type))return v.concat(1).error(`"${E}" comparisons are not supported for type '${tt(S.type)}'.`);let k=v.parse(_[2],2,xn);if(!k)return null;if(!rl(E,k.type))return v.concat(2).error(`"${E}" comparisons are not supported for type '${tt(k.type)}'.`);if(S.type.kind!==k.type.kind&&S.type.kind!=="value"&&k.type.kind!=="value")return v.error(`Cannot compare types '${tt(S.type)}' and '${tt(k.type)}'.`);c&&(S.type.kind==="value"&&k.type.kind!=="value"?S=new Pa(k.type,[S]):S.type.kind!=="value"&&k.type.kind==="value"&&(k=new Pa(S.type,[k])));let L=null;if(_.length===4){if(S.type.kind!=="string"&&k.type.kind!=="string"&&S.type.kind!=="value"&&k.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(L=v.parse(_[3],3,Er),!L)return null}return new y6(S,k,L)}evaluate(_){const v=this.lhs.evaluate(_),E=this.rhs.evaluate(_);if(c&&this.hasUntypedArgument){const S=Ui(v),k=Ui(E);if(S.kind!==k.kind||S.kind!=="string"&&S.kind!=="number")throw new Yi(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${S.kind}, ${k.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const S=Ui(v),k=Ui(E);if(S.kind!=="string"||k.kind!=="string")return e(_,v,E)}return this.collator?o(_,v,E,this.collator.evaluate(_)):e(_,v,E)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[i];return this.eachChild(v=>{_.push(v.serialize())}),_}}}const yp=Cl("==",function(i,e,o){return e===o},lf),vp=Cl("!=",function(i,e,o){return e!==o},function(i,e,o,c){return!lf(0,e,o,c)}),cf=Cl("<",function(i,e,o){return e<o},function(i,e,o,c){return c.compare(e,o)<0}),Ym=Cl(">",function(i,e,o){return e>o},function(i,e,o,c){return c.compare(e,o)>0}),Jm=Cl("<=",function(i,e,o){return e<=o},function(i,e,o,c){return c.compare(e,o)<=0}),Sl=Cl(">=",function(i,e,o){return e>=o},function(i,e,o,c){return c.compare(e,o)>=0});class pc{constructor(e,o,c,f,_,v){this.type=wn,this.number=e,this.locale=o,this.currency=c,this.unit=f,this.minFractionDigits=_,this.maxFractionDigits=v}static parse(e,o){if(e.length!==3)return o.error("Expected two arguments.");const c=o.parse(e[1],1,pe);if(!c)return null;const f=e[2];if(typeof f!="object"||Array.isArray(f))return o.error("NumberFormat options argument must be an object.");let _=null;if(f.locale&&(_=o.parse(f.locale,1,wn),!_))return null;let v=null;if(f.currency&&(v=o.parse(f.currency,1,wn),!v))return null;let E=null;if(f.unit&&(E=o.parse(f.unit,1,wn),!E))return null;let S=null;if(f["min-fraction-digits"]&&(S=o.parse(f["min-fraction-digits"],1,pe),!S))return null;let k=null;return f["max-fraction-digits"]&&(k=o.parse(f["max-fraction-digits"],1,pe),!k)?null:new pc(c,_,v,E,S,k)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class ma{constructor(e){this.type=pe,this.input=e}static parse(e,o){if(e.length!==2)return o.error(`Expected 1 argument, but found ${e.length-1} instead.`);const c=o.parse(e[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${tt(c.type)} instead.`):new ma(c):null}evaluate(e){const o=this.input.evaluate(e);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Yi(`Expected value to be of type string or array, but found ${tt(Ui(o))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(o=>{e.push(o.serialize())}),e}}const Ih={"==":yp,"!=":vp,">":Ym,"<":cf,">=":Sl,"<=":Jm,array:Pa,at:rf,boolean:Pa,case:_p,coalesce:nf,collator:el,format:da,image:wl,in:Cu,"index-of":of,interpolate:is,"interpolate-hcl":is,"interpolate-lab":is,length:ma,let:gp,literal:Zs,match:Xm,number:Pa,"number-format":pc,object:Pa,slice:Os,step:Hd,string:Pa,"to-boolean":ys,"to-color":ys,"to-number":ys,"to-string":ys,var:fp,within:Eh};function uf(i,[e,o,c,f]){e=e.evaluate(i),o=o.evaluate(i),c=c.evaluate(i);const _=f?f.evaluate(i):1,v=Ud(e,o,c,_);if(v)throw new Yi(v);return new _i(e/255*_,o/255*_,c/255*_,_)}function Ds(i,e){return i in e}function La(i,e){const o=e[i];return o===void 0?null:o}function os(i){return{type:i}}Rs.register(Ih,{error:[{kind:"error"},[wn],(i,[e])=>{throw new Yi(e.evaluate(i))}],typeof:[wn,[xn],(i,[e])=>tt(Ui(e.evaluate(i)))],"to-rgba":[Le(pe,4),[yr],(i,[e])=>e.evaluate(i).toArray()],rgb:[yr,[pe,pe,pe],uf],rgba:[yr,[pe,pe,pe,pe],uf],has:{type:Tn,overloads:[[[wn],(i,[e])=>Ds(e.evaluate(i),i.properties())],[[wn,ar],(i,[e,o])=>Ds(e.evaluate(i),o.evaluate(i))]]},get:{type:xn,overloads:[[[wn],(i,[e])=>La(e.evaluate(i),i.properties())],[[wn,ar],(i,[e,o])=>La(e.evaluate(i),o.evaluate(i))]]},"feature-state":[xn,[wn],(i,[e])=>La(e.evaluate(i),i.featureState||{})],properties:[ar,[],i=>i.properties()],"geometry-type":[wn,[],i=>i.geometryType()],id:[xn,[],i=>i.id()],zoom:[pe,[],i=>i.globals.zoom],pitch:[pe,[],i=>i.globals.pitch||0],"distance-from-center":[pe,[],i=>i.distanceFromCenter()],"heatmap-density":[pe,[],i=>i.globals.heatmapDensity||0],"line-progress":[pe,[],i=>i.globals.lineProgress||0],"sky-radial-progress":[pe,[],i=>i.globals.skyRadialProgress||0],accumulated:[xn,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[pe,os(pe),(i,e)=>{let o=0;for(const c of e)o+=c.evaluate(i);return o}],"*":[pe,os(pe),(i,e)=>{let o=1;for(const c of e)o*=c.evaluate(i);return o}],"-":{type:pe,overloads:[[[pe,pe],(i,[e,o])=>e.evaluate(i)-o.evaluate(i)],[[pe],(i,[e])=>-e.evaluate(i)]]},"/":[pe,[pe,pe],(i,[e,o])=>e.evaluate(i)/o.evaluate(i)],"%":[pe,[pe,pe],(i,[e,o])=>e.evaluate(i)%o.evaluate(i)],ln2:[pe,[],()=>Math.LN2],pi:[pe,[],()=>Math.PI],e:[pe,[],()=>Math.E],"^":[pe,[pe,pe],(i,[e,o])=>Math.pow(e.evaluate(i),o.evaluate(i))],sqrt:[pe,[pe],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[pe,[pe],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[pe,[pe],(i,[e])=>Math.log(e.evaluate(i))],log2:[pe,[pe],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[pe,[pe],(i,[e])=>Math.sin(e.evaluate(i))],cos:[pe,[pe],(i,[e])=>Math.cos(e.evaluate(i))],tan:[pe,[pe],(i,[e])=>Math.tan(e.evaluate(i))],asin:[pe,[pe],(i,[e])=>Math.asin(e.evaluate(i))],acos:[pe,[pe],(i,[e])=>Math.acos(e.evaluate(i))],atan:[pe,[pe],(i,[e])=>Math.atan(e.evaluate(i))],min:[pe,os(pe),(i,e)=>Math.min(...e.map(o=>o.evaluate(i)))],max:[pe,os(pe),(i,e)=>Math.max(...e.map(o=>o.evaluate(i)))],abs:[pe,[pe],(i,[e])=>Math.abs(e.evaluate(i))],round:[pe,[pe],(i,[e])=>{const o=e.evaluate(i);return o<0?-Math.round(-o):Math.round(o)}],floor:[pe,[pe],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[pe,[pe],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[Tn,[wn,xn],(i,[e,o])=>i.properties()[e.value]===o.value],"filter-id-==":[Tn,[xn],(i,[e])=>i.id()===e.value],"filter-type-==":[Tn,[wn],(i,[e])=>i.geometryType()===e.value],"filter-<":[Tn,[wn,xn],(i,[e,o])=>{const c=i.properties()[e.value],f=o.value;return typeof c==typeof f&&c<f}],"filter-id-<":[Tn,[xn],(i,[e])=>{const o=i.id(),c=e.value;return typeof o==typeof c&&o<c}],"filter->":[Tn,[wn,xn],(i,[e,o])=>{const c=i.properties()[e.value],f=o.value;return typeof c==typeof f&&c>f}],"filter-id->":[Tn,[xn],(i,[e])=>{const o=i.id(),c=e.value;return typeof o==typeof c&&o>c}],"filter-<=":[Tn,[wn,xn],(i,[e,o])=>{const c=i.properties()[e.value],f=o.value;return typeof c==typeof f&&c<=f}],"filter-id-<=":[Tn,[xn],(i,[e])=>{const o=i.id(),c=e.value;return typeof o==typeof c&&o<=c}],"filter->=":[Tn,[wn,xn],(i,[e,o])=>{const c=i.properties()[e.value],f=o.value;return typeof c==typeof f&&c>=f}],"filter-id->=":[Tn,[xn],(i,[e])=>{const o=i.id(),c=e.value;return typeof o==typeof c&&o>=c}],"filter-has":[Tn,[xn],(i,[e])=>e.value in i.properties()],"filter-has-id":[Tn,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Tn,[Le(wn)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[Tn,[Le(xn)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[Tn,[wn,Le(xn)],(i,[e,o])=>o.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[Tn,[wn,Le(xn)],(i,[e,o])=>function(c,f,_,v){for(;_<=v;){const E=_+v>>1;if(f[E]===c)return!0;f[E]>c?v=E-1:_=E+1}return!1}(i.properties()[e.value],o.value,0,o.value.length-1)],all:{type:Tn,overloads:[[[Tn,Tn],(i,[e,o])=>e.evaluate(i)&&o.evaluate(i)],[os(Tn),(i,e)=>{for(const o of e)if(!o.evaluate(i))return!1;return!0}]]},any:{type:Tn,overloads:[[[Tn,Tn],(i,[e,o])=>e.evaluate(i)||o.evaluate(i)],[os(Tn),(i,e)=>{for(const o of e)if(o.evaluate(i))return!0;return!1}]]},"!":[Tn,[Tn],(i,[e])=>!e.evaluate(i)],"is-supported-script":[Tn,[wn],(i,[e])=>{const o=i.globals&&i.globals.isSupportedScript;return!o||o(e.evaluate(i))}],upcase:[wn,[wn],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[wn,[wn],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[wn,os(xn),(i,e)=>e.map(o=>mu(o.evaluate(i))).join("")],"resolved-locale":[wn,[Er],(i,[e])=>e.evaluate(i).resolvedLocale()]});var mc=Ih;function ku(i){return{result:"success",value:i}}function il(i){return{result:"error",value:i}}function kl(i){return i["property-type"]==="data-driven"}function Mu(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Au(i){return!!i.expression&&i.expression.interpolated}function Kr(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function gc(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Ra(i){return i}function _c(i,e){const o=e.type==="color",c=i.stops&&typeof i.stops[0][0]=="object",f=c||!(c||i.property!==void 0),_=i.type||(Au(e)?"exponential":"interval");if(o&&((i=Dt({},i)).stops&&(i.stops=i.stops.map(k=>[k[0],_i.parse(k[1])])),i.default=_i.parse(i.default?i.default:e.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!tf[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let v,E,S;if(_==="exponential")v=vs;else if(_==="interval")v=Lh;else if(_==="categorical"){v=xp,E=Object.create(null);for(const k of i.stops)E[k[0]]=k[1];S=typeof i.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);v=wp}if(c){const k={},L=[];for(let W=0;W<i.stops.length;W++){const q=i.stops[W],X=q[0].zoom;k[X]===void 0&&(k[X]={zoom:X,type:i.type,property:i.property,default:i.default,stops:[]},L.push(X)),k[X].stops.push([q[0].value,q[1]])}const z=[];for(const W of L)z.push([k[W].zoom,_c(k[W],e)]);const N={name:"linear"};return{kind:"composite",interpolationType:N,interpolationFactor:is.interpolationFactor.bind(void 0,N),zoomStops:z.map(W=>W[0]),evaluate:({zoom:W},q)=>vs({stops:z,base:i.base},e,W).evaluate(W,q)}}if(f){const k=_==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:is.interpolationFactor.bind(void 0,k),zoomStops:i.stops.map(L=>L[0]),evaluate:({zoom:L})=>v(i,e,L,E,S)}}return{kind:"source",evaluate(k,L){const z=L&&L.properties?L.properties[i.property]:void 0;return z===void 0?ol(i.default,e.default):v(i,e,z,E,S)}}}function ol(i,e,o){return i!==void 0?i:e!==void 0?e:o!==void 0?o:void 0}function xp(i,e,o,c,f){return ol(typeof o===f?c[o]:void 0,i.default,e.default)}function Lh(i,e,o){if(Kr(o)!=="number")return ol(i.default,e.default);const c=i.stops.length;if(c===1||o<=i.stops[0][0])return i.stops[0][1];if(o>=i.stops[c-1][0])return i.stops[c-1][1];const f=Ch(i.stops.map(_=>_[0]),o);return i.stops[f][1]}function vs(i,e,o){const c=i.base!==void 0?i.base:1;if(Kr(o)!=="number")return ol(i.default,e.default);const f=i.stops.length;if(f===1||o<=i.stops[0][0])return i.stops[0][1];if(o>=i.stops[f-1][0])return i.stops[f-1][1];const _=Ch(i.stops.map(L=>L[0]),o),v=function(L,z,N,W){const q=W-N,X=L-N;return q===0?0:z===1?X/q:(Math.pow(z,X)-1)/(Math.pow(z,q)-1)}(o,c,i.stops[_][0],i.stops[_+1][0]),E=i.stops[_][1],S=i.stops[_+1][1];let k=xu[e.type]||Ra;if(i.colorSpace&&i.colorSpace!=="rgb"){const L=tf[i.colorSpace];k=(z,N)=>L.reverse(L.interpolate(L.forward(z),L.forward(N),v))}return typeof E.evaluate=="function"?{evaluate(...L){const z=E.evaluate.apply(void 0,L),N=S.evaluate.apply(void 0,L);if(z!==void 0&&N!==void 0)return k(z,N,v)}}:k(E,S,v)}function wp(i,e,o){return e.type==="color"?o=_i.parse(o):e.type==="formatted"?o=To.fromString(o.toString()):e.type==="resolvedImage"?o=Is.fromString(o.toString()):Kr(o)===e.type||e.type==="enum"&&e.values[o]||(o=void 0),ol(o,i.default,e.default)}class Pu{constructor(e,o){this.expression=e,this._warningHistory={},this._evaluator=new sc,this._defaultValue=o?function(c){return c.type==="color"&&(gc(c.default)||Array.isArray(c.default))?new _i(0,0,0,0):c.type==="color"?_i.parse(c.default)||null:c.default===void 0?null:c.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(e,o,c,f,_,v,E,S){return this._evaluator.globals=e,this._evaluator.feature=o,this._evaluator.featureState=c,this._evaluator.canonical=f||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=S||null,this.expression.evaluate(this._evaluator)}evaluate(e,o,c,f,_,v,E,S){this._evaluator.globals=e,this._evaluator.feature=o||null,this._evaluator.featureState=c||null,this._evaluator.canonical=f||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=S||null;try{const k=this.expression.evaluate(this._evaluator);if(k==null||typeof k=="number"&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new Yi(`Expected value to be one of ${Object.keys(this._enumValues).map(L=>JSON.stringify(L)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}}}function Ml(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in mc}function pi(i,e){const o=new Zd(mc,[],e?function(f){const _={color:yr,string:wn,number:pe,enum:wn,boolean:Tn,formatted:ie,resolvedImage:ae};return f.type==="array"?Le(_[f.value]||xn,f.length):_[f.type]}(e):void 0),c=o.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?ku(new Pu(c,e)):il(o.errors)}class Iu{constructor(e,o){this.kind=e,this._styleExpression=o,this.isStateDependent=e!=="constant"&&!Ia(o.expression)}evaluateWithoutErrorHandling(e,o,c,f,_,v){return this._styleExpression.evaluateWithoutErrorHandling(e,o,c,f,_,v)}evaluate(e,o,c,f,_,v){return this._styleExpression.evaluate(e,o,c,f,_,v)}}class sl{constructor(e,o,c,f){this.kind=e,this.zoomStops=c,this._styleExpression=o,this.isStateDependent=e!=="camera"&&!Ia(o.expression),this.interpolationType=f}evaluateWithoutErrorHandling(e,o,c,f,_,v){return this._styleExpression.evaluateWithoutErrorHandling(e,o,c,f,_,v)}evaluate(e,o,c,f,_,v){return this._styleExpression.evaluate(e,o,c,f,_,v)}interpolationFactor(e,o,c){return this.interpolationType?is.interpolationFactor(this.interpolationType,e,o,c):0}}function Oa(i,e){if((i=pi(i,e)).result==="error")return i;const o=i.value.expression,c=cc(o);if(!c&&!kl(e))return il([new Bn("","data expressions not supported")]);const f=tl(o,["zoom","pitch","distance-from-center"]);if(!f&&!Mu(e))return il([new Bn("","zoom expressions not supported")]);const _=yc(o);return _||f?_ instanceof Bn?il([_]):_ instanceof is&&!Au(e)?il([new Bn("",'"interpolate" expressions cannot be used with this property')]):ku(_?new sl(c?"camera":"composite",i.value,_.labels,_ instanceof is?_.interpolation:void 0):new Iu(c?"constant":"source",i.value)):il([new Bn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Lu{constructor(e,o){this._parameters=e,this._specification=o,Dt(this,_c(this._parameters,this._specification))}static deserialize(e){return new Lu(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function yc(i){let e=null;if(i instanceof gp)e=yc(i.result);else if(i instanceof nf){for(const o of i.args)if(e=yc(o),e)break}else(i instanceof Hd||i instanceof is)&&i.input instanceof Rs&&i.input.name==="zoom"&&(e=i);return e instanceof Bn||i.eachChild(o=>{const c=yc(o);c instanceof Bn?e=c:!e&&c?e=new Bn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&c&&e!==c&&(e=new Bn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class fn{constructor(e,o,c,f){this.message=(e?`${e}: `:"")+c,f&&(this.identifier=f),o!=null&&o.__line__&&(this.line=o.__line__)}}function ss(i){const e=i.key,o=i.value,c=i.valueSpec||{},f=i.objectElementValidators||{},_=i.style,v=i.styleSpec;let E=[];const S=Kr(o);if(S!=="object")return[new fn(e,o,`object expected, ${S} found`)];for(const k in o){const L=k.split(".")[0];let z;f[L]?z=f[L]:c[L]?z=Ur:f["*"]?z=f["*"]:c["*"]&&(z=Ur),z?E=E.concat(z({key:(e&&`${e}.`)+k,value:o[k],valueSpec:c[L]||c["*"],style:_,styleSpec:v,object:o,objectKey:k},o)):E.push(new fn(e,o[k],`unknown property "${k}"`))}for(const k in c)f[k]||c[k].required&&c[k].default===void 0&&o[k]===void 0&&E.push(new fn(e,o,`missing required property "${k}"`));return E}function Al(i){const e=i.value,o=i.valueSpec,c=i.style,f=i.styleSpec,_=i.key,v=i.arrayElementValidator||Ur;if(Kr(e)!=="array")return[new fn(_,e,`array expected, ${Kr(e)} found`)];if(o.length&&e.length!==o.length)return[new fn(_,e,`array length ${o.length} expected, length ${e.length} found`)];if(o["min-length"]&&e.length<o["min-length"])return[new fn(_,e,`array length at least ${o["min-length"]} expected, length ${e.length} found`)];let E={type:o.value,values:o.values,minimum:o.minimum,maximum:o.maximum,function:void 0};f.$version<7&&(E.function=o.function),Kr(o.value)==="object"&&(E=o.value);let S=[];for(let k=0;k<e.length;k++)S=S.concat(v({array:e,arrayIndex:k,value:e[k],valueSpec:E,style:c,styleSpec:f,key:`${_}[${k}]`}));return S}function vc(i){const e=i.key,o=i.value,c=i.valueSpec;let f=Kr(o);if(f==="number"&&o!=o&&(f="NaN"),f!=="number")return[new fn(e,o,`number expected, ${f} found`)];if("minimum"in c){let _=c.minimum;if(Kr(c.minimum)==="array"&&(_=c.minimum[i.arrayIndex]),o<_)return[new fn(e,o,`${o} is less than the minimum value ${_}`)]}if("maximum"in c){let _=c.maximum;if(Kr(c.maximum)==="array"&&(_=c.maximum[i.arrayIndex]),o>_)return[new fn(e,o,`${o} is greater than the maximum value ${_}`)]}return[]}function Ru(i){const e=i.valueSpec,o=Tt(i.value.type);let c,f,_,v={};const E=o!=="categorical"&&i.value.property===void 0,S=!E,k=Kr(i.value.stops)==="array"&&Kr(i.value.stops[0])==="array"&&Kr(i.value.stops[0][0])==="object",L=ss({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(W){if(o==="identity")return[new fn(W.key,W.value,'identity function may not have a "stops" property')];let q=[];const X=W.value;return q=q.concat(Al({key:W.key,value:X,valueSpec:W.valueSpec,style:W.style,styleSpec:W.styleSpec,arrayElementValidator:z})),Kr(X)==="array"&&X.length===0&&q.push(new fn(W.key,X,"array must have at least one stop")),q},default:function(W){return Ur({key:W.key,value:W.value,valueSpec:e,style:W.style,styleSpec:W.styleSpec})}}});return o==="identity"&&E&&L.push(new fn(i.key,i.value,'missing required property "property"')),o==="identity"||i.value.stops||L.push(new fn(i.key,i.value,'missing required property "stops"')),o==="exponential"&&i.valueSpec.expression&&!Au(i.valueSpec)&&L.push(new fn(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(S&&!kl(i.valueSpec)?L.push(new fn(i.key,i.value,"property functions not supported")):E&&!Mu(i.valueSpec)&&L.push(new fn(i.key,i.value,"zoom functions not supported"))),o!=="categorical"&&!k||i.value.property!==void 0||L.push(new fn(i.key,i.value,'"property" property is required')),L;function z(W){let q=[];const X=W.value,le=W.key;if(Kr(X)!=="array")return[new fn(le,X,`array expected, ${Kr(X)} found`)];if(X.length!==2)return[new fn(le,X,`array length 2 expected, length ${X.length} found`)];if(k){if(Kr(X[0])!=="object")return[new fn(le,X,`object expected, ${Kr(X[0])} found`)];if(X[0].zoom===void 0)return[new fn(le,X,"object stop key must have zoom")];if(X[0].value===void 0)return[new fn(le,X,"object stop key must have value")];const ve=Tt(X[0].zoom);if(typeof ve!="number")return[new fn(le,X[0].zoom,"stop zoom values must be numbers")];if(_&&_>ve)return[new fn(le,X[0].zoom,"stop zoom values must appear in ascending order")];ve!==_&&(_=ve,f=void 0,v={}),q=q.concat(ss({key:`${le}[0]`,value:X[0],valueSpec:{zoom:{}},style:W.style,styleSpec:W.styleSpec,objectElementValidators:{zoom:vc,value:N}}))}else q=q.concat(N({key:`${le}[0]`,value:X[0],style:W.style,styleSpec:W.styleSpec},X));return Ml(It(X[1]))?q.concat([new fn(`${le}[1]`,X[1],"expressions are not allowed in function stops.")]):q.concat(Ur({key:`${le}[1]`,value:X[1],valueSpec:e,style:W.style,styleSpec:W.styleSpec}))}function N(W,q){const X=Kr(W.value),le=Tt(W.value),ve=W.value!==null?W.value:q;if(c){if(X!==c)return[new fn(W.key,ve,`${X} stop domain type must match previous stop domain type ${c}`)]}else c=X;if(X!=="number"&&X!=="string"&&X!=="boolean"&&typeof le!="number"&&typeof le!="string"&&typeof le!="boolean")return[new fn(W.key,ve,"stop domain value must be a number, string, or boolean")];if(X!=="number"&&o!=="categorical"){let Re=`number expected, ${X} found`;return kl(e)&&o===void 0&&(Re+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new fn(W.key,ve,Re)]}return o!=="categorical"||X!=="number"||typeof le=="number"&&isFinite(le)&&Math.floor(le)===le?o!=="categorical"&&X==="number"&&typeof le=="number"&&typeof f=="number"&&f!==void 0&&le<f?[new fn(W.key,ve,"stop domain values must appear in ascending order")]:(f=le,o==="categorical"&&le in v?[new fn(W.key,ve,"stop domain values must be unique")]:(v[le]=!0,[])):[new fn(W.key,ve,`integer expected, found ${String(le)}`)]}}function Co(i){const e=(i.expressionContext==="property"?Oa:pi)(It(i.value),i.valueSpec);if(e.result==="error")return e.value.map(c=>new fn(`${i.key}${c.key}`,i.value,c.message));const o=e.value.expression||e.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!o.outputDefined())return[new fn(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Ia(o))return[new fn(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter")return xc(o,i);if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!tl(o,["zoom","feature-state"]))return[new fn(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!cc(o))return[new fn(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function xc(i,e){const o=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const f of e.valueSpec.expression.parameters)o.delete(f);if(o.size===0)return[];const c=[];return i instanceof Rs&&o.has(i.name)?[new fn(e.key,e.value,`["${i.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(i.eachChild(f=>{c.push(...xc(f,e))}),c)}function Pl(i){const e=i.key,o=i.value,c=i.valueSpec,f=[];return Array.isArray(c.values)?c.values.indexOf(Tt(o))===-1&&f.push(new fn(e,o,`expected one of [${c.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(c.values).indexOf(Tt(o))===-1&&f.push(new fn(e,o,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(o)} found`)),f}function wc(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const e of i.slice(1))if(!wc(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function bc(i,e="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};wc(i)||(i=Tc(i));const o=i;let c=!0;try{c=function(k){if(!al(k))return k;let L=It(k);return Ec(L),L=Rh(L),L}(o)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(o,null,2)}
        `)}const f=Te[`filter_${e}`],_=pi(c,f);let v=null;if(_.result==="error")throw new Error(_.value.map(k=>`${k.key}: ${k.message}`).join(", "));v=(k,L,z)=>_.value.evaluate(k,L,{},z);let E=null,S=null;if(c!==o){const k=pi(o,f);if(k.result==="error")throw new Error(k.value.map(L=>`${L.key}: ${L.message}`).join(", "));E=(L,z,N,W,q)=>k.value.evaluate(L,z,{},N,void 0,void 0,W,q),S=!cc(k.value.expression)}return{filter:v,dynamicFilter:E||void 0,needGeometry:Ep(c),needFeature:!!S}}function Rh(i){if(!Array.isArray(i))return i;const e=function(o){if(hf.has(o[0])){for(let c=1;c<o.length;c++)if(al(o[c]))return!0}return o}(i);return e===!0?e:e.map(o=>Rh(o))}function Ec(i){let e=!1;const o=[];if(i[0]==="case"){for(let c=1;c<i.length-1;c+=2)e=e||al(i[c]),o.push(i[c+1]);o.push(i[i.length-1])}else if(i[0]==="match"){e=e||al(i[1]);for(let c=2;c<i.length-1;c+=2)o.push(i[c+1]);o.push(i[i.length-1])}else if(i[0]==="step"){e=e||al(i[1]);for(let c=1;c<i.length-1;c+=2)o.push(i[c+1])}e&&(i.length=0,i.push("any",...o));for(let c=1;c<i.length;c++)Ec(i[c])}function al(i){if(!Array.isArray(i))return!1;if((e=i[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let o=1;o<i.length;o++)if(al(i[o]))return!0;return!1}const hf=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function bp(i,e){return i<e?-1:i>e?1:0}function Ep(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let e=1;e<i.length;e++)if(Ep(i[e]))return!0;return!1}function Tc(i){if(!i)return!0;const e=i[0];return i.length<=1?e!=="any":e==="=="?Ou(i[1],i[2],"=="):e==="!="?Da(Ou(i[1],i[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Ou(i[1],i[2],e):e==="any"?(o=i.slice(1),["any"].concat(o.map(Tc))):e==="all"?["all"].concat(i.slice(1).map(Tc)):e==="none"?["all"].concat(i.slice(1).map(Tc).map(Da)):e==="in"?ga(i[1],i.slice(2)):e==="!in"?Da(ga(i[1],i.slice(2))):e==="has"?Oh(i[1]):e==="!has"?Da(Oh(i[1])):e!=="within"||i;var o}function Ou(i,e,o){switch(i){case"$type":return[`filter-type-${o}`,e];case"$id":return[`filter-id-${o}`,e];default:return[`filter-${o}`,i,e]}}function ga(i,e){if(e.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(o=>typeof o!=typeof e[0])?["filter-in-large",i,["literal",e.sort(bp)]]:["filter-in-small",i,["literal",e]]}}function Oh(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Da(i){return["!",i]}function as(i){return wc(It(i.value))?Co(Dt({},i,{expressionContext:"filter",valueSpec:i.styleSpec[`filter_${i.layerType||"fill"}`]})):za(i)}function za(i){const e=i.value,o=i.key;if(Kr(e)!=="array")return[new fn(o,e,`array expected, ${Kr(e)} found`)];const c=i.styleSpec;let f,_=[];if(e.length<1)return[new fn(o,e,"filter array must have at least 1 element")];switch(_=_.concat(Pl({key:`${o}[0]`,value:e[0],valueSpec:c.filter_operator,style:i.style,styleSpec:i.styleSpec})),Tt(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Tt(e[1])==="$type"&&_.push(new fn(o,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&_.push(new fn(o,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(f=Kr(e[1]),f!=="string"&&_.push(new fn(`${o}[1]`,e[1],`string expected, ${f} found`)));for(let v=2;v<e.length;v++)f=Kr(e[v]),Tt(e[1])==="$type"?_=_.concat(Pl({key:`${o}[${v}]`,value:e[v],valueSpec:c.geometry_type,style:i.style,styleSpec:i.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&_.push(new fn(`${o}[${v}]`,e[v],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let v=1;v<e.length;v++)_=_.concat(za({key:`${o}[${v}]`,value:e[v],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":f=Kr(e[1]),e.length!==2?_.push(new fn(o,e,`filter array for "${e[0]}" operator must have 2 elements`)):f!=="string"&&_.push(new fn(`${o}[1]`,e[1],`string expected, ${f} found`));break;case"within":f=Kr(e[1]),e.length!==2?_.push(new fn(o,e,`filter array for "${e[0]}" operator must have 2 elements`)):f!=="object"&&_.push(new fn(`${o}[1]`,e[1],`object expected, ${f} found`))}return _}function Ks(i,e){const o=i.key,c=i.style,f=i.styleSpec,_=i.value,v=i.objectKey,E=f[`${e}_${i.layerType}`];if(!E)return[];const S=v.match(/^(.*)-transition$/);if(e==="paint"&&S&&E[S[1]]&&E[S[1]].transition)return Ur({key:o,value:_,valueSpec:f.transition,style:c,styleSpec:f});const k=i.valueSpec||E[v];if(!k)return[new fn(o,_,`unknown property "${v}"`)];let L;if(Kr(_)==="string"&&kl(k)&&!k.tokens&&(L=/^{([^}]+)}$/.exec(_))){const N=`\`{ "type": "identity", "property": ${L?JSON.stringify(L[1]):'"_"'} }\``;return[new fn(o,_,`"${v}" does not support interpolation syntax
Use an identity property function instead: ${N}.`)]}const z=[];return i.layerType==="symbol"&&(v==="text-field"&&c&&!c.glyphs&&z.push(new fn(o,_,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&gc(It(_))&&Tt(_.type)==="identity"&&z.push(new fn(o,_,'"text-font" does not support identity functions'))),z.concat(Ur({key:i.key,value:_,valueSpec:k,style:c,styleSpec:f,expressionContext:"property",propertyType:e,propertyKey:v}))}function Dh(i){return Ks(i,"paint")}function df(i){return Ks(i,"layout")}function Tp(i){let e=[];const o=i.value,c=i.key,f=i.style,_=i.styleSpec;o.type||o.ref||e.push(new fn(c,o,'either "type" or "ref" is required'));let v=Tt(o.type);const E=Tt(o.ref);if(o.id){const S=Tt(o.id);for(let k=0;k<i.arrayIndex;k++){const L=f.layers[k];Tt(L.id)===S&&e.push(new fn(c,o.id,`duplicate layer id "${o.id}", previously used at line ${L.id.__line__}`))}}if("ref"in o){let S;["type","source","source-layer","filter","layout"].forEach(k=>{k in o&&e.push(new fn(c,o[k],`"${k}" is prohibited for ref layers`))}),f.layers.forEach(k=>{Tt(k.id)===E&&(S=k)}),S?S.ref?e.push(new fn(c,o.ref,"ref cannot reference another ref layer")):v=Tt(S.type):typeof E=="string"&&e.push(new fn(c,o.ref,`ref layer "${E}" not found`))}else if(v!=="background"&&v!=="sky")if(o.source){const S=f.sources&&f.sources[o.source],k=S&&Tt(S.type);S?k==="vector"&&v==="raster"?e.push(new fn(c,o.source,`layer "${o.id}" requires a raster source`)):k==="raster"&&v!=="raster"?e.push(new fn(c,o.source,`layer "${o.id}" requires a vector source`)):k!=="vector"||o["source-layer"]?k==="raster-dem"&&v!=="hillshade"?e.push(new fn(c,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):v!=="line"||!o.paint||!o.paint["line-gradient"]&&!o.paint["line-trim-offset"]||k==="geojson"&&S.lineMetrics||e.push(new fn(c,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new fn(c,o,`layer "${o.id}" must specify a "source-layer"`)):e.push(new fn(c,o.source,`source "${o.source}" not found`))}else e.push(new fn(c,o,'missing required property "source"'));return e=e.concat(ss({key:c,value:o,valueSpec:_.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ur({key:`${c}.type`,value:o.type,valueSpec:_.layer.type,style:i.style,styleSpec:i.styleSpec,object:o,objectKey:"type"}),filter:S=>as(Dt({layerType:v},S)),layout:S=>ss({layer:o,key:S.key,value:S.value,valueSpec:{},style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*":k=>df(Dt({layerType:v},k))}}),paint:S=>ss({layer:o,key:S.key,value:S.value,valueSpec:{},style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*":k=>Dh(Dt({layerType:v},k))}})}})),e}function ls(i){const e=i.value,o=i.key,c=Kr(e);return c!=="string"?[new fn(o,e,`string expected, ${c} found`)]:[]}const Cc={promoteId:function({key:i,value:e}){if(Kr(e)==="string")return ls({key:i,value:e});{const o=[];for(const c in e)o.push(...ls({key:`${i}.${c}`,value:e[c]}));return o}}};function Il(i){const e=i.value,o=i.key,c=i.styleSpec,f=i.style;if(!e.type)return[new fn(o,e,'"type" is required')];const _=Tt(e.type);let v;switch(_){case"vector":case"raster":case"raster-dem":return v=ss({key:o,value:e,valueSpec:c[`source_${_.replace("-","_")}`],style:i.style,styleSpec:c,objectElementValidators:Cc}),v;case"geojson":if(v=ss({key:o,value:e,valueSpec:c.source_geojson,style:f,styleSpec:c,objectElementValidators:Cc}),e.cluster)for(const E in e.clusterProperties){const[S,k]=e.clusterProperties[E],L=typeof S=="string"?[S,["accumulated"],["get",E]]:S;v.push(...Co({key:`${o}.${E}.map`,value:k,expressionContext:"cluster-map"})),v.push(...Co({key:`${o}.${E}.reduce`,value:L,expressionContext:"cluster-reduce"}))}return v;case"video":return ss({key:o,value:e,valueSpec:c.source_video,style:f,styleSpec:c});case"image":return ss({key:o,value:e,valueSpec:c.source_image,style:f,styleSpec:c});case"canvas":return[new fn(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Pl({key:`${o}.type`,value:e.type,valueSpec:{values:zh(c)}})}}function zh(i){return i.source.reduce((e,o)=>{const c=i[o];return c.type.type==="enum"&&(e=e.concat(Object.keys(c.type.values))),e},[])}function Bh(i){const e=i.value,o=i.styleSpec,c=o.light,f=i.style;let _=[];const v=Kr(e);if(e===void 0)return _;if(v!=="object")return _=_.concat([new fn("light",e,`object expected, ${v} found`)]),_;for(const E in e){const S=E.match(/^(.*)-transition$/);_=_.concat(S&&c[S[1]]&&c[S[1]].transition?Ur({key:E,value:e[E],valueSpec:o.transition,style:f,styleSpec:o}):c[E]?Ur({key:E,value:e[E],valueSpec:c[E],style:f,styleSpec:o}):[new fn(E,e[E],`unknown property "${E}"`)])}return _}function ll(i){const e=i.value,o=i.key,c=i.style,f=i.styleSpec,_=f.terrain;let v=[];const E=Kr(e);if(e===void 0)return v;if(E!=="object")return v=v.concat([new fn("terrain",e,`object expected, ${E} found`)]),v;for(const S in e){const k=S.match(/^(.*)-transition$/);v=v.concat(k&&_[k[1]]&&_[k[1]].transition?Ur({key:S,value:e[S],valueSpec:f.transition,style:c,styleSpec:f}):_[S]?Ur({key:S,value:e[S],valueSpec:_[S],style:c,styleSpec:f}):[new fn(S,e[S],`unknown property "${S}"`)])}if(e.source){const S=c.sources&&c.sources[e.source],k=S&&Tt(S.type);S?k!=="raster-dem"&&v.push(new fn(o,e.source,`terrain cannot be used with a source of type ${String(k)}, it only be used with a "raster-dem" source type`)):v.push(new fn(o,e.source,`source "${e.source}" not found`))}else v.push(new fn(o,e,'terrain is missing required property "source"'));return v}function Ba(i){const e=i.value,o=i.style,c=i.styleSpec,f=c.fog;let _=[];const v=Kr(e);if(e===void 0)return _;if(v!=="object")return _=_.concat([new fn("fog",e,`object expected, ${v} found`)]),_;for(const E in e){const S=E.match(/^(.*)-transition$/);_=_.concat(S&&f[S[1]]&&f[S[1]].transition?Ur({key:E,value:e[E],valueSpec:c.transition,style:o,styleSpec:c}):f[E]?Ur({key:E,value:e[E],valueSpec:f[E],style:o,styleSpec:c}):[new fn(E,e[E],`unknown property "${E}"`)])}return _}const Pi={"*":()=>[],array:Al,boolean:function(i){const e=i.value,o=i.key,c=Kr(e);return c!=="boolean"?[new fn(o,e,`boolean expected, ${c} found`)]:[]},number:vc,color:function(i){const e=i.key,o=i.value,c=Kr(o);return c!=="string"?[new fn(e,o,`color expected, ${c} found`)]:Vr(o)===null?[new fn(e,o,`color expected, "${o}" found`)]:[]},enum:Pl,filter:as,function:Ru,layer:Tp,object:ss,source:Il,light:Bh,terrain:ll,fog:Ba,string:ls,formatted:function(i){return ls(i).length===0?[]:Co(i)},resolvedImage:function(i){return ls(i).length===0?[]:Co(i)},projection:function(i){const e=i.value,o=i.styleSpec,c=o.projection,f=i.style;let _=[];const v=Kr(e);if(v==="object")for(const E in e)_=_.concat(Ur({key:E,value:e[E],valueSpec:c[E],style:f,styleSpec:o}));else v!=="string"&&(_=_.concat([new fn("projection",e,`object or string expected, ${v} found`)]));return _}};function Ur(i){const e=i.value,o=i.valueSpec,c=i.styleSpec;return o.expression&&gc(Tt(e))?Ru(i):o.expression&&Ml(It(e))?Co(i):o.type&&Pi[o.type]?Pi[o.type](i):ss(Dt({},i,{valueSpec:o.type?c[o.type]:o}))}function cl(i){const e=i.value,o=i.key,c=ls(i);return c.length||(e.indexOf("{fontstack}")===-1&&c.push(new fn(o,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&c.push(new fn(o,e,'"glyphs" url must include a "{range}" token'))),c}function Po(i,e=Te){return Io(Ur({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,objectElementValidators:{glyphs:cl,"*":()=>[]}}))}const cs=i=>Io(Dh(i)),Ll=i=>Io(df(i));function Io(i){return i.slice().sort((e,o)=>e.line&&o.line?e.line-o.line:0)}function Ho(i,e){let o=!1;if(e&&e.length)for(const c of e)i.fire(new cn(new Error(c.message))),o=!0;return o}var jh=Xs,zs=3;function Xs(i,e,o){var c=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var f=new Int32Array(this.arrayBuffer);i=f[0],this.d=(e=f[1])+2*(o=f[2]);for(var _=0;_<this.d*this.d;_++){var v=f[zs+_],E=f[zs+_+1];c.push(v===E?null:f.subarray(v,E))}var S=f[zs+c.length+1];this.keys=f.subarray(f[zs+c.length],S),this.bboxes=f.subarray(S),this.insert=this._insertReadonly}else{this.d=e+2*o;for(var k=0;k<this.d*this.d;k++)c.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=i,this.padding=o,this.scale=e/i,this.uid=0;var L=o/e*i;this.min=-L,this.max=i+L}Xs.prototype.insert=function(i,e,o,c,f){this._forEachCell(e,o,c,f,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(e),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(f)},Xs.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Xs.prototype._insertCell=function(i,e,o,c,f,_){this.cells[f].push(_)},Xs.prototype.query=function(i,e,o,c,f){var _=this.min,v=this.max;if(i<=_&&e<=_&&v<=o&&v<=c&&!f)return Array.prototype.slice.call(this.keys);var E=[];return this._forEachCell(i,e,o,c,this._queryCell,E,{},f),E},Xs.prototype._queryCell=function(i,e,o,c,f,_,v,E){var S=this.cells[f];if(S!==null)for(var k=this.keys,L=this.bboxes,z=0;z<S.length;z++){var N=S[z];if(v[N]===void 0){var W=4*N;(E?E(L[W+0],L[W+1],L[W+2],L[W+3]):i<=L[W+2]&&e<=L[W+3]&&o>=L[W+0]&&c>=L[W+1])?(v[N]=!0,_.push(k[N])):v[N]=!1}}},Xs.prototype._forEachCell=function(i,e,o,c,f,_,v,E){for(var S=this._convertToCellCoord(i),k=this._convertToCellCoord(e),L=this._convertToCellCoord(o),z=this._convertToCellCoord(c),N=S;N<=L;N++)for(var W=k;W<=z;W++){var q=this.d*W+N;if((!E||E(this._convertFromCellCoord(N),this._convertFromCellCoord(W),this._convertFromCellCoord(N+1),this._convertFromCellCoord(W+1)))&&f.call(this,i,e,o,c,q,_,v,E))return}},Xs.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},Xs.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},Xs.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,e=zs+this.cells.length+1+1,o=0,c=0;c<this.cells.length;c++)o+=this.cells[c].length;var f=new Int32Array(e+o+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var _=e,v=0;v<i.length;v++){var E=i[v];f[zs+v]=_,f.set(E,_),_+=E.length}return f[zs+i.length]=_,f.set(this.keys,_),f[zs+i.length+1]=_+=this.keys.length,f.set(this.bboxes,_),_+=this.bboxes.length,f.buffer};var _a=Ie(jh);const Du={};function gn(i,e,o={}){Object.defineProperty(i,"_classRegistryKey",{value:e,writeable:!1}),Du[e]={klass:i,omit:o.omit||[]}}gn(Object,"Object"),_a.serialize=function(i,e){const o=i.toArrayBuffer();return e&&e.push(o),{buffer:o}},_a.deserialize=function(i){return new _a(i.buffer)},Object.defineProperty(_a,"name",{value:"Grid"}),gn(_a,"Grid"),gn(_i,"Color"),gn(Error,"Error"),gn(lo,"AJAXError"),gn(Is,"ResolvedImage"),gn(Lu,"StylePropertyFunction"),gn(Pu,"StyleExpression",{omit:["_evaluator"]}),gn(sl,"ZoomDependentExpression"),gn(Iu,"ZoomConstantExpression"),gn(Rs,"CompoundExpression",{omit:["_evaluate"]});for(const i in mc)Du[mc[i]._classRegistryKey]||gn(mc[i],`Expression${i}`);function Sc(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function zu(i){return M.ImageBitmap&&i instanceof M.ImageBitmap}function Rl(i,e){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(Sc(i)||zu(i))return e&&e.push(i),i;if(ArrayBuffer.isView(i)){const o=i;return e&&e.push(o.buffer),o}if(i instanceof M.ImageData)return e&&e.push(i.data.buffer),i;if(Array.isArray(i)){const o=[];for(const c of i)o.push(Rl(c,e));return o}if(typeof i=="object"){const o=i.constructor,c=o._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const f=o.serialize?o.serialize(i,e):{};if(!o.serialize){for(const _ in i)i.hasOwnProperty(_)&&(Du[c].omit.indexOf(_)>=0||(f[_]=Rl(i[_],e)));i instanceof Error&&(f.message=i.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(f.$name=c),f}throw new Error("can't serialize object of type "+typeof i)}function Ol(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||Sc(i)||zu(i)||ArrayBuffer.isView(i)||i instanceof M.ImageData)return i;if(Array.isArray(i))return i.map(Ol);if(typeof i=="object"){const e=i.$name||"Object",{klass:o}=Du[e];if(!o)throw new Error(`can't deserialize unregistered class ${e}`);if(o.deserialize)return o.deserialize(i);const c=Object.create(o.prototype);for(const f of Object.keys(i))f!=="$name"&&(c[f]=Ol(i[f]));return c}throw new Error("can't deserialize object of type "+typeof i)}const un={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function ul(i){for(const e of i)if(Mc(e.charCodeAt(0)))return!0;return!1}function kc(i){for(const e of i)if(!Bu(e.charCodeAt(0)))return!1;return!0}function Bu(i){return!(un.Arabic(i)||un["Arabic Supplement"](i)||un["Arabic Extended-A"](i)||un["Arabic Presentation Forms-A"](i)||un["Arabic Presentation Forms-B"](i))}function Mc(i){return!(i!==746&&i!==747&&(i<4352||!(un["Bopomofo Extended"](i)||un.Bopomofo(i)||un["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||un["CJK Compatibility Ideographs"](i)||un["CJK Compatibility"](i)||un["CJK Radicals Supplement"](i)||un["CJK Strokes"](i)||!(!un["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||un["CJK Unified Ideographs Extension A"](i)||un["CJK Unified Ideographs"](i)||un["Enclosed CJK Letters and Months"](i)||un["Hangul Compatibility Jamo"](i)||un["Hangul Jamo Extended-A"](i)||un["Hangul Jamo Extended-B"](i)||un["Hangul Jamo"](i)||un["Hangul Syllables"](i)||un.Hiragana(i)||un["Ideographic Description Characters"](i)||un.Kanbun(i)||un["Kangxi Radicals"](i)||un["Katakana Phonetic Extensions"](i)||un.Katakana(i)&&i!==12540||!(!un["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!un["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||un["Unified Canadian Aboriginal Syllabics"](i)||un["Unified Canadian Aboriginal Syllabics Extended"](i)||un["Vertical Forms"](i)||un["Yijing Hexagram Symbols"](i)||un["Yi Syllables"](i)||un["Yi Radicals"](i))))}function xs(i){return!(Mc(i)||function(e){return!!(un["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||un["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||un["Letterlike Symbols"](e)||un["Number Forms"](e)||un["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||un["Control Pictures"](e)&&e!==9251||un["Optical Character Recognition"](e)||un["Enclosed Alphanumerics"](e)||un["Geometric Shapes"](e)||un["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||un["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||un["CJK Symbols and Punctuation"](e)||un.Katakana(e)||un["Private Use Area"](e)||un["CJK Compatibility Forms"](e)||un["Small Form Variants"](e)||un["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(i))}function ws(i){return i>=1424&&i<=2303||un["Arabic Presentation Forms-A"](i)||un["Arabic Presentation Forms-B"](i)}function Dl(i,e){return!(!e&&ws(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||un.Khmer(i))}function ja(i){for(const e of i)if(ws(e.charCodeAt(0)))return!0;return!1}const Ys="deferred",Na="loading",Nh="loaded";let hl=null,g="unavailable",s=null;const h=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(g="error"),hl&&hl(i)};function y(){w.fire(new En("pluginStateChange",{pluginStatus:g,pluginURL:s}))}const w=new yt,T=function(){return g},P=function(){if(g!==Ys||!s)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");g=Na,y(),s&&go({url:s},i=>{i?h(i):(g=Nh,y())})},I={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>g===Nh||I.applyArabicShaping!=null,isLoading:()=>g===Na,setState(i){g=i.pluginStatus,s=i.pluginURL},isParsed:()=>I.applyArabicShaping!=null&&I.processBidirectionalText!=null&&I.processStyledBidirectionalText!=null,getPluginURL:()=>s};class O{constructor(e,o){this.zoom=e,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(o,c){for(const f of o)if(!Dl(f.charCodeAt(0),c))return!1;return!0}(e,I.isLoaded())}}class ${constructor(e,o){this.property=e,this.value=o,this.expression=function(c,f){if(gc(c))return new Lu(c,f);if(Ml(c)){const _=Oa(c,f);if(_.result==="error")throw new Error(_.value.map(v=>`${v.key}: ${v.message}`).join(", "));return _.value}{let _=c;return typeof c=="string"&&f.type==="color"&&(_=_i.parse(c)),{kind:"constant",evaluate:()=>_}}}(o===void 0?e.specification.default:o,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,o,c){return this.property.possiblyEvaluate(this,e,o,c)}}class U{constructor(e){this.property=e,this.value=new $(e,void 0)}transitioned(e,o){return new oe(this.property,this.value,o,vn({},e.transition,this.transition),e.now)}untransitioned(){return new oe(this.property,this.value,null,{},0)}}class H{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return An(this._values[e].value.value)}setValue(e,o){this._values.hasOwnProperty(e)||(this._values[e]=new U(this._values[e].property)),this._values[e].value=new $(this._values[e].property,o===null?void 0:An(o))}getTransition(e){return An(this._values[e].transition)}setTransition(e,o){this._values.hasOwnProperty(e)||(this._values[e]=new U(this._values[e].property)),this._values[e].transition=An(o)||void 0}serialize(){const e={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(e[o]=c);const f=this.getTransition(o);f!==void 0&&(e[`${o}-transition`]=f)}return e}transitioned(e,o){const c=new de(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].transitioned(e,o._values[f]);return c}untransitioned(){const e=new de(this._properties);for(const o of Object.keys(this._values))e._values[o]=this._values[o].untransitioned();return e}}class oe{constructor(e,o,c,f,_){const v=f.delay||0,E=f.duration||0;_=_||0,this.property=e,this.value=o,this.begin=_+v,this.end=this.begin+E,e.specification.transition&&(f.delay||f.duration)&&(this.prior=c)}possiblyEvaluate(e,o,c){const f=e.now||0,_=this.value.possiblyEvaluate(e,o,c),v=this.prior;if(v){if(f>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(f<this.begin)return v.possiblyEvaluate(e,o,c);{const E=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(e,o,c),_,In(E))}}return _}}class de{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,o,c){const f=new ye(this._properties);for(const _ of Object.keys(this._values))f._values[_]=this._values[_].possiblyEvaluate(e,o,c);return f}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class me{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return An(this._values[e].value)}setValue(e,o){this._values[e]=new $(this._values[e].property,o===null?void 0:An(o))}serialize(){const e={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(e[o]=c)}return e}possiblyEvaluate(e,o,c){const f=new ye(this._properties);for(const _ of Object.keys(this._values))f._values[_]=this._values[_].possiblyEvaluate(e,o,c);return f}}class fe{constructor(e,o,c){this.property=e,this.value=o,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,o,c,f){return this.property.evaluate(this.value,this.parameters,e,o,c,f)}}class ye{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class K{constructor(e){this.specification=e}possiblyEvaluate(e,o){return e.expression.evaluate(o)}interpolate(e,o,c){const f=xu[this.specification.type];return f?f(e,o,c):e}}class ue{constructor(e,o){this.specification=e,this.overrides=o}possiblyEvaluate(e,o,c,f){return new fe(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(o,null,{},c,f)}:e.expression,o)}interpolate(e,o,c){if(e.value.kind!=="constant"||o.value.kind!=="constant")return e;if(e.value.value===void 0||o.value.value===void 0)return new fe(this,{kind:"constant",value:void 0},e.parameters);const f=xu[this.specification.type];return f?new fe(this,{kind:"constant",value:f(e.value.value,o.value.value,c)},e.parameters):e}evaluate(e,o,c,f,_,v){return e.kind==="constant"?e.value:e.evaluate(o,c,f,_,v)}}class Ee{constructor(e){this.specification=e}possiblyEvaluate(e,o,c,f){return!!e.expression.evaluate(o,null,{},c,f)}interpolate(){return!1}}class Ce{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new O(0,{});for(const c in e){const f=e[c];f.specification.overridable&&this.overridableProperties.push(c);const _=this.defaultPropertyValues[c]=new $(f,void 0),v=this.defaultTransitionablePropertyValues[c]=new U(f);this.defaultTransitioningPropertyValues[c]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=_.possiblyEvaluate(o)}}}function Fe(i,e){return 256*(i=Bt(Math.floor(i),0,255))+Bt(Math.floor(e),0,255)}gn(ue,"DataDrivenProperty"),gn(K,"DataConstantProperty"),gn(Ee,"ColorRampProperty");const $e={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ne{constructor(e,o){this._structArray=e,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Je{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,o){return e._trim(),o&&(e.isTransferred=!0,o.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const o=Object.create(this.prototype);return o.arrayBuffer=e.arrayBuffer,o.length=e.length,o.capacity=e.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ye(i,e=1){let o=0,c=0;return{members:i.map(f=>{const _=$e[f.type].BYTES_PER_ELEMENT,v=o=ut(o,Math.max(e,_)),E=f.components||1;return c=Math.max(c,_),o+=_*E,{name:f.name,type:f.type,components:E,offset:v}}),size:ut(o,Math.max(c,e)),alignment:e}}function ut(i,e){return Math.ceil(i/e)*e}class Kt extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o){const c=this.length;return this.resize(c+1),this.emplace(c,e,o)}emplace(e,o,c){const f=2*e;return this.int16[f+0]=o,this.int16[f+1]=c,e}}Kt.prototype.bytesPerElement=4,gn(Kt,"StructArrayLayout2i4");class st extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,c)}emplace(e,o,c,f){const _=3*e;return this.int16[_+0]=o,this.int16[_+1]=c,this.int16[_+2]=f,e}}st.prototype.bytesPerElement=6,gn(st,"StructArrayLayout3i6");class Mt extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,c,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,o,c,f)}emplace(e,o,c,f,_){const v=4*e;return this.int16[v+0]=o,this.int16[v+1]=c,this.int16[v+2]=f,this.int16[v+3]=_,e}}Mt.prototype.bytesPerElement=8,gn(Mt,"StructArrayLayout4i8");class gt extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_,v,E){const S=this.length;return this.resize(S+1),this.emplace(S,e,o,c,f,_,v,E)}emplace(e,o,c,f,_,v,E,S){const k=6*e,L=12*e,z=3*e;return this.int16[k+0]=o,this.int16[k+1]=c,this.uint8[L+4]=f,this.uint8[L+5]=_,this.uint8[L+6]=v,this.uint8[L+7]=E,this.float32[z+2]=S,e}}gt.prototype.bytesPerElement=12,gn(gt,"StructArrayLayout2i4ub1f12");class Zt extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,o,c,f)}emplace(e,o,c,f,_){const v=4*e;return this.float32[v+0]=o,this.float32[v+1]=c,this.float32[v+2]=f,this.float32[v+3]=_,e}}Zt.prototype.bytesPerElement=16,gn(Zt,"StructArrayLayout4f16");class at extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_){const v=this.length;return this.resize(v+1),this.emplace(v,e,o,c,f,_)}emplace(e,o,c,f,_,v){const E=6*e,S=3*e;return this.uint16[E+0]=o,this.uint16[E+1]=c,this.uint16[E+2]=f,this.uint16[E+3]=_,this.float32[S+2]=v,e}}at.prototype.bytesPerElement=12,gn(at,"StructArrayLayout4ui1f12");class St extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,c,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,o,c,f)}emplace(e,o,c,f,_){const v=4*e;return this.uint16[v+0]=o,this.uint16[v+1]=c,this.uint16[v+2]=f,this.uint16[v+3]=_,e}}St.prototype.bytesPerElement=8,gn(St,"StructArrayLayout4ui8");class Ht extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,o,c,f,_,v)}emplace(e,o,c,f,_,v,E){const S=6*e;return this.int16[S+0]=o,this.int16[S+1]=c,this.int16[S+2]=f,this.int16[S+3]=_,this.int16[S+4]=v,this.int16[S+5]=E,e}}Ht.prototype.bytesPerElement=12,gn(Ht,"StructArrayLayout6i12");class Ft extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_,v,E,S,k,L,z,N){const W=this.length;return this.resize(W+1),this.emplace(W,e,o,c,f,_,v,E,S,k,L,z,N)}emplace(e,o,c,f,_,v,E,S,k,L,z,N,W){const q=12*e;return this.int16[q+0]=o,this.int16[q+1]=c,this.int16[q+2]=f,this.int16[q+3]=_,this.uint16[q+4]=v,this.uint16[q+5]=E,this.uint16[q+6]=S,this.uint16[q+7]=k,this.int16[q+8]=L,this.int16[q+9]=z,this.int16[q+10]=N,this.int16[q+11]=W,e}}Ft.prototype.bytesPerElement=24,gn(Ft,"StructArrayLayout4i4ui4i24");class Yt extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,o,c,f,_,v)}emplace(e,o,c,f,_,v,E){const S=10*e,k=5*e;return this.int16[S+0]=o,this.int16[S+1]=c,this.int16[S+2]=f,this.float32[k+2]=_,this.float32[k+3]=v,this.float32[k+4]=E,e}}Yt.prototype.bytesPerElement=20,gn(Yt,"StructArrayLayout3i3f20");class $n extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint32[1*e+0]=o,e}}$n.prototype.bytesPerElement=4,gn($n,"StructArrayLayout1ul4");class mr extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_,v,E,S,k,L,z,N,W){const q=this.length;return this.resize(q+1),this.emplace(q,e,o,c,f,_,v,E,S,k,L,z,N,W)}emplace(e,o,c,f,_,v,E,S,k,L,z,N,W,q){const X=20*e,le=10*e;return this.int16[X+0]=o,this.int16[X+1]=c,this.int16[X+2]=f,this.int16[X+3]=_,this.int16[X+4]=v,this.float32[le+3]=E,this.float32[le+4]=S,this.float32[le+5]=k,this.float32[le+6]=L,this.int16[X+14]=z,this.uint32[le+8]=N,this.uint16[X+18]=W,this.uint16[X+19]=q,e}}mr.prototype.bytesPerElement=40,gn(mr,"StructArrayLayout5i4f1i1ul2ui40");class kn extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_,v,E){const S=this.length;return this.resize(S+1),this.emplace(S,e,o,c,f,_,v,E)}emplace(e,o,c,f,_,v,E,S){const k=8*e;return this.int16[k+0]=o,this.int16[k+1]=c,this.int16[k+2]=f,this.int16[k+4]=_,this.int16[k+5]=v,this.int16[k+6]=E,this.int16[k+7]=S,e}}kn.prototype.bytesPerElement=16,gn(kn,"StructArrayLayout3i2i2i16");class Zn extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_){const v=this.length;return this.resize(v+1),this.emplace(v,e,o,c,f,_)}emplace(e,o,c,f,_,v){const E=4*e,S=8*e;return this.float32[E+0]=o,this.float32[E+1]=c,this.float32[E+2]=f,this.int16[S+6]=_,this.int16[S+7]=v,e}}Zn.prototype.bytesPerElement=16,gn(Zn,"StructArrayLayout2f1f2i16");class zr extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,o,c,f)}emplace(e,o,c,f,_){const v=12*e,E=3*e;return this.uint8[v+0]=o,this.uint8[v+1]=c,this.float32[E+1]=f,this.float32[E+2]=_,e}}zr.prototype.bytesPerElement=12,gn(zr,"StructArrayLayout2ub2f12");class Or extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,c)}emplace(e,o,c,f){const _=3*e;return this.float32[_+0]=o,this.float32[_+1]=c,this.float32[_+2]=f,e}}Or.prototype.bytesPerElement=12,gn(Or,"StructArrayLayout3f12");class jn extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,c)}emplace(e,o,c,f){const _=3*e;return this.uint16[_+0]=o,this.uint16[_+1]=c,this.uint16[_+2]=f,e}}jn.prototype.bytesPerElement=6,gn(jn,"StructArrayLayout3ui6");class Jr extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_,v,E,S,k,L,z,N,W,q,X,le,ve,Re,be,Pe,Be){const ze=this.length;return this.resize(ze+1),this.emplace(ze,e,o,c,f,_,v,E,S,k,L,z,N,W,q,X,le,ve,Re,be,Pe,Be)}emplace(e,o,c,f,_,v,E,S,k,L,z,N,W,q,X,le,ve,Re,be,Pe,Be,ze){const ft=30*e,ct=15*e,Pt=60*e;return this.int16[ft+0]=o,this.int16[ft+1]=c,this.int16[ft+2]=f,this.float32[ct+2]=_,this.float32[ct+3]=v,this.uint16[ft+8]=E,this.uint16[ft+9]=S,this.uint32[ct+5]=k,this.uint32[ct+6]=L,this.uint32[ct+7]=z,this.uint16[ft+16]=N,this.uint16[ft+17]=W,this.uint16[ft+18]=q,this.float32[ct+10]=X,this.float32[ct+11]=le,this.uint8[Pt+48]=ve,this.uint8[Pt+49]=Re,this.uint8[Pt+50]=be,this.uint32[ct+13]=Pe,this.int16[ft+28]=Be,this.uint8[Pt+58]=ze,e}}Jr.prototype.bytesPerElement=60,gn(Jr,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class ti extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_,v,E,S,k,L,z,N,W,q,X,le,ve,Re,be,Pe,Be,ze,ft,ct,Pt,Jt,vt,Rt,Ot,Vt){const Qt=this.length;return this.resize(Qt+1),this.emplace(Qt,e,o,c,f,_,v,E,S,k,L,z,N,W,q,X,le,ve,Re,be,Pe,Be,ze,ft,ct,Pt,Jt,vt,Rt,Ot,Vt)}emplace(e,o,c,f,_,v,E,S,k,L,z,N,W,q,X,le,ve,Re,be,Pe,Be,ze,ft,ct,Pt,Jt,vt,Rt,Ot,Vt,Qt){const kt=38*e,pn=19*e;return this.int16[kt+0]=o,this.int16[kt+1]=c,this.int16[kt+2]=f,this.float32[pn+2]=_,this.float32[pn+3]=v,this.int16[kt+8]=E,this.int16[kt+9]=S,this.int16[kt+10]=k,this.int16[kt+11]=L,this.int16[kt+12]=z,this.int16[kt+13]=N,this.uint16[kt+14]=W,this.uint16[kt+15]=q,this.uint16[kt+16]=X,this.uint16[kt+17]=le,this.uint16[kt+18]=ve,this.uint16[kt+19]=Re,this.uint16[kt+20]=be,this.uint16[kt+21]=Pe,this.uint16[kt+22]=Be,this.uint16[kt+23]=ze,this.uint16[kt+24]=ft,this.uint16[kt+25]=ct,this.uint16[kt+26]=Pt,this.uint16[kt+27]=Jt,this.uint16[kt+28]=vt,this.uint32[pn+15]=Rt,this.float32[pn+16]=Ot,this.float32[pn+17]=Vt,this.float32[pn+18]=Qt,e}}ti.prototype.bytesPerElement=76,gn(ti,"StructArrayLayout3i2f6i15ui1ul3f76");class oi extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.float32[1*e+0]=o,e}}oi.prototype.bytesPerElement=4,gn(oi,"StructArrayLayout1f4");class di extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_){const v=this.length;return this.resize(v+1),this.emplace(v,e,o,c,f,_)}emplace(e,o,c,f,_,v){const E=5*e;return this.float32[E+0]=o,this.float32[E+1]=c,this.float32[E+2]=f,this.float32[E+3]=_,this.float32[E+4]=v,e}}di.prototype.bytesPerElement=20,gn(di,"StructArrayLayout5f20");class Lo extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,c,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,o,c,f)}emplace(e,o,c,f,_){const v=6*e;return this.uint32[3*e+0]=o,this.uint16[v+2]=c,this.uint16[v+3]=f,this.uint16[v+4]=_,e}}Lo.prototype.bytesPerElement=12,gn(Lo,"StructArrayLayout1ul3ui12");class qi extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o){const c=this.length;return this.resize(c+1),this.emplace(c,e,o)}emplace(e,o,c){const f=2*e;return this.uint16[f+0]=o,this.uint16[f+1]=c,e}}qi.prototype.bytesPerElement=4,gn(qi,"StructArrayLayout2ui4");class bs extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint16[1*e+0]=o,e}}bs.prototype.bytesPerElement=2,gn(bs,"StructArrayLayout1ui2");class us extends Je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o){const c=this.length;return this.resize(c+1),this.emplace(c,e,o)}emplace(e,o,c){const f=2*e;return this.float32[f+0]=o,this.float32[f+1]=c,e}}us.prototype.bytesPerElement=8,gn(us,"StructArrayLayout2f8");class Qr extends Ne{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Qr.prototype.size=40;class ni extends mr{get(e){return new Qr(this,e)}}gn(ni,"CollisionBoxArray");class Wr extends Ne{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Wr.prototype.size=60;class Ei extends Jr{get(e){return new Wr(this,e)}}gn(Ei,"PlacedSymbolArray");class Ro extends Ne{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Ro.prototype.size=76;class hi extends ti{get(e){return new Ro(this,e)}}gn(hi,"SymbolInstanceArray");class Ko extends oi{getoffsetX(e){return this.float32[1*e+0]}}gn(Ko,"GlyphOffsetArray");class Ac extends Kt{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}gn(Ac,"SymbolLineVertexArray");class yi extends Ne{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}yi.prototype.size=12;class dl extends Lo{get(e){return new yi(this,e)}}gn(dl,"FeatureIndexArray");class Js extends qi{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}gn(Js,"FillExtrusionCentroidArray");const ya=Ye([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),va=Ye([{name:"a_dash",components:4,type:"Uint16"}]);var Pc={exports:{}},Qs={exports:{}};Qs.exports=function(i,e){var o,c,f,_,v,E,S,k;for(c=i.length-(o=3&i.length),f=e,v=3432918353,E=461845907,k=0;k<c;)S=255&i.charCodeAt(k)|(255&i.charCodeAt(++k))<<8|(255&i.charCodeAt(++k))<<16|(255&i.charCodeAt(++k))<<24,++k,f=27492+(65535&(_=5*(65535&(f=(f^=S=(65535&(S=(S=(65535&S)*v+(((S>>>16)*v&65535)<<16)&4294967295)<<15|S>>>17))*E+(((S>>>16)*E&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(S=0,o){case 3:S^=(255&i.charCodeAt(k+2))<<16;case 2:S^=(255&i.charCodeAt(k+1))<<8;case 1:f^=S=(65535&(S=(S=(65535&(S^=255&i.charCodeAt(k)))*v+(((S>>>16)*v&65535)<<16)&4294967295)<<15|S>>>17))*E+(((S>>>16)*E&65535)<<16)&4294967295}return f^=i.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0};var zi=Qs.exports,So={exports:{}};So.exports=function(i,e){for(var o,c=i.length,f=e^c,_=0;c>=4;)o=1540483477*(65535&(o=255&i.charCodeAt(_)|(255&i.charCodeAt(++_))<<8|(255&i.charCodeAt(++_))<<16|(255&i.charCodeAt(++_))<<24))+((1540483477*(o>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),c-=4,++_;switch(c){case 3:f^=(255&i.charCodeAt(_+2))<<16;case 2:f^=(255&i.charCodeAt(_+1))<<8;case 1:f=1540483477*(65535&(f^=255&i.charCodeAt(_)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};var Oo=zi,Cp=So.exports;Pc.exports=Oo,Pc.exports.murmur3=Oo,Pc.exports.murmur2=Cp;var ju=Ie(Pc.exports);class Ic{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,o,c,f){this.ids.push(s1(e)),this.positions.push(o,c,f)}getPositions(e){const o=s1(e);let c=0,f=this.ids.length-1;for(;c<f;){const v=c+f>>1;this.ids[v]>=o?f=v:c=v+1}const _=[];for(;this.ids[c]===o;)_.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return _}static serialize(e,o){const c=new Float64Array(e.ids),f=new Uint32Array(e.positions);return $o(c,f,0,c.length-1),o&&o.push(c.buffer,f.buffer),{ids:c,positions:f}}static deserialize(e){const o=new Ic;return o.ids=e.ids,o.positions=e.positions,o.indexed=!0,o}}function s1(i){const e=+i;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:ju(String(i))}function $o(i,e,o,c){for(;o<c;){const f=i[o+c>>1];let _=o-1,v=c+1;for(;;){do _++;while(i[_]<f);do v--;while(i[v]>f);if(_>=v)break;Fh(i,_,v),Fh(e,3*_,3*v),Fh(e,3*_+1,3*v+1),Fh(e,3*_+2,3*v+2)}v-o<c-v?($o(i,e,o,v),o=v+1):($o(i,e,v+1,c),c=v)}}function Fh(i,e,o){const c=i[e];i[e]=i[o],i[o]=c}gn(Ic,"FeaturePositionMap");class Fa{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,o),this.initialized=!0),!!this.location}}class Uh extends Fa{constructor(e){super(e),this.current=0}set(e,o,c){this.fetchUniformLocation(e,o)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class Ua extends Fa{constructor(e){super(e),this.current=[0,0,0,0]}set(e,o,c){this.fetchUniformLocation(e,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class ea extends Fa{constructor(e){super(e),this.current=_i.transparent}set(e,o,c){this.fetchUniformLocation(e,o)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const ff=new Float32Array(16),Qm=new Float32Array(9),eg=new Float32Array(4);function Sp(i){return[Fe(255*i.r,255*i.g),Fe(255*i.b,255*i.a)]}class $h{constructor(e,o,c){this.value=e,this.uniformNames=o.map(f=>`u_${f}`),this.type=c}setUniform(e,o,c,f,_){o.set(e,_,f.constantOr(this.value))}getBinding(e,o){return this.type==="color"?new ea(e):new Uh(e)}}class Nu{constructor(e,o){this.uniformNames=o.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,o,c,f,_){const v=_==="u_pattern"||_==="u_dash"?this.pattern:_==="u_pixel_ratio"?this.pixelRatio:null;v&&o.set(e,_,v)}getBinding(e,o){return o==="u_pattern"||o==="u_dash"?new Ua(e):new Uh(e)}}class fl{constructor(e,o,c,f){this.expression=e,this.type=c,this.maxValue=0,this.paintVertexAttributes=o.map(_=>({name:`a_${_}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(e,o,c,f,_,v){const E=this.paintVertexArray.length,S=this.expression.evaluate(new O(0),o,{},_,f,v);this.paintVertexArray.resize(e),this._setPaintValue(E,e,S)}updatePaintArray(e,o,c,f,_){const v=this.expression.evaluate({zoom:0},c,f,void 0,_);this._setPaintValue(e,o,v)}_setPaintValue(e,o,c){if(this.type==="color"){const f=Sp(c);for(let _=e;_<o;_++)this.paintVertexArray.emplace(_,f[0],f[1])}else{for(let f=e;f<o;f++)this.paintVertexArray.emplace(f,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class xa{constructor(e,o,c,f,_,v){this.expression=e,this.uniformNames=o.map(E=>`u_${E}_t`),this.type=c,this.useIntegerZoom=f,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=o.map(E=>({name:`a_${E}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(e,o,c,f,_,v){const E=this.expression.evaluate(new O(this.zoom),o,{},_,f,v),S=this.expression.evaluate(new O(this.zoom+1),o,{},_,f,v),k=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(k,e,E,S)}updatePaintArray(e,o,c,f,_){const v=this.expression.evaluate({zoom:this.zoom},c,f,void 0,_),E=this.expression.evaluate({zoom:this.zoom+1},c,f,void 0,_);this._setPaintValue(e,o,v,E)}_setPaintValue(e,o,c,f){if(this.type==="color"){const _=Sp(c),v=Sp(f);for(let E=e;E<o;E++)this.paintVertexArray.emplace(E,_[0],_[1],v[0],v[1])}else{for(let _=e;_<o;_++)this.paintVertexArray.emplace(_,c,f);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(f))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,o,c,f,_){const v=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,E=Bt(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);o.set(e,_,E)}getBinding(e,o){return new Uh(e)}}class zl{constructor(e,o,c,f,_){this.expression=e,this.layerId=_,this.paintVertexAttributes=(c==="array"?va:ya).members;for(let v=0;v<o.length;++v);this.paintVertexArray=new f}populatePaintArray(e,o,c){const f=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(f,e,o.patterns&&o.patterns[this.layerId],c)}updatePaintArray(e,o,c,f,_,v){this._setPaintValues(e,o,c.patterns&&c.patterns[this.layerId],v)}_setPaintValues(e,o,c,f){if(!f||!c)return;const _=f[c];if(!_)return;const{tl:v,br:E,pixelRatio:S}=_;for(let k=e;k<o;k++)this.paintVertexArray.emplace(k,v[0],v[1],E[0],E[1],S)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Bl{constructor(e,o,c=()=>!0){this.binders={},this._buffers=[];const f=[];for(const _ in e.paint._values){if(!c(_))continue;const v=e.paint.get(_);if(!(v instanceof fe&&kl(v.property.specification)))continue;const E=a1(_,e.type),S=v.value,k=v.property.specification.type,L=!!v.property.useIntegerZoom,z=_==="line-dasharray"||_.endsWith("pattern"),N=_==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(S.kind!=="constant"||N)if(S.kind==="source"||N||z){const W=tg(_,k,"source");this.binders[_]=z?new zl(S,E,k,W,e.id):new fl(S,E,k,W),f.push(`/a_${_}`)}else{const W=tg(_,k,"composite");this.binders[_]=new xa(S,E,k,L,o,W),f.push(`/z_${_}`)}else this.binders[_]=z?new Nu(S.value,E):new $h(S.value,E,k),f.push(`/u_${_}`)}this.cacheKey=f.sort().join("")}getMaxValue(e){const o=this.binders[e];return o instanceof fl||o instanceof xa?o.maxValue:0}populatePaintArrays(e,o,c,f,_,v){for(const E in this.binders){const S=this.binders[E];(S instanceof fl||S instanceof xa||S instanceof zl)&&S.populatePaintArray(e,o,c,f,_,v)}}setConstantPatternPositions(e){for(const o in this.binders){const c=this.binders[o];c instanceof Nu&&c.setConstantPatternPositions(e)}}updatePaintArrays(e,o,c,f,_,v){let E=!1;for(const S in e){const k=o.getPositions(S);for(const L of k){const z=c.feature(L.index);for(const N in this.binders){const W=this.binders[N];if((W instanceof fl||W instanceof xa||W instanceof zl)&&W.expression.isStateDependent===!0){const q=f.paint.get(N);W.expression=q.value,W.updatePaintArray(L.start,L.end,z,e[S],_,v),E=!0}}}}return E}defines(){const e=[];for(const o in this.binders){const c=this.binders[o];(c instanceof $h||c instanceof Nu)&&e.push(...c.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return e}getBinderAttributes(){const e=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof fl||c instanceof xa||c instanceof zl)for(let f=0;f<c.paintVertexAttributes.length;f++)e.push(c.paintVertexAttributes[f].name)}return e}getBinderUniforms(){const e=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof $h||c instanceof Nu||c instanceof xa)for(const f of c.uniformNames)e.push(f)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const o=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof $h||f instanceof Nu||f instanceof xa)for(const _ of f.uniformNames)o.push({name:_,property:c,binding:f.getBinding(e,_)})}return o}setUniforms(e,o,c,f,_){for(const{name:v,property:E,binding:S}of c)this.binders[E].setUniform(e,S,_,f.get(E),v)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const o=this.binders[e];(o instanceof fl||o instanceof xa||o instanceof zl)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(e){for(const o in this.binders){const c=this.binders[o];(c instanceof fl||c instanceof xa||c instanceof zl)&&c.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const o=this.binders[e];(o instanceof fl||o instanceof xa||o instanceof zl)&&o.destroy()}}}class Lc{constructor(e,o,c=()=>!0){this.programConfigurations={};for(const f of e)this.programConfigurations[f.id]=new Bl(f,o,c);this.needsUpload=!1,this._featureMap=new Ic,this._bufferOffset=0}populatePaintArrays(e,o,c,f,_,v,E){for(const S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(e,o,f,_,v,E);o.id!==void 0&&this._featureMap.add(o.id,c,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,o,c,f,_){for(const v of c)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(e,this._featureMap,o,v,f,_)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const pf={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function a1(i,e){return pf[i]||[i.replace(`${e}-`,"").replace(/-/g,"_")]}const kp={"line-pattern":{source:at,composite:at},"fill-pattern":{source:at,composite:at},"fill-extrusion-pattern":{source:at,composite:at},"line-dasharray":{source:St,composite:St}},Mp={color:{source:us,composite:Zt},number:{source:oi,composite:us}};function tg(i,e,o){const c=kp[i];return c&&c[o]||Mp[e][o]}gn($h,"ConstantBinder"),gn(Nu,"PatternConstantBinder"),gn(fl,"SourceExpressionBinder"),gn(zl,"PatternCompositeBinder"),gn(xa,"CompositeExpressionBinder"),gn(Bl,"ProgramConfiguration",{omit:["_buffers"]}),gn(Lc,"ProgramConfigurationSet");const Ap="-transition";class wa extends yt{constructor(e,o){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),o.layout&&(this._unevaluatedLayout=new me(o.layout)),o.paint)){this._transitionablePaint=new H(o.paint);for(const c in e.paint)this.setPaintProperty(c,e.paint[c],{validate:!1});for(const c in e.layout)this.setLayoutProperty(c,e.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ye(o.paint)}}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,o,c={}){o!=null&&this._validate(Ll,`layers.${this.id}.layout.${e}`,e,o,c)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,o):this.visibility=o)}getPaintProperty(e){return Nt(e,Ap)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,o,c={}){if(o!=null&&this._validate(cs,`layers.${this.id}.paint.${e}`,e,o,c))return!1;if(Nt(e,Ap))return this._transitionablePaint.setTransition(e.slice(0,-11),o||void 0),!1;{const f=this._transitionablePaint._values[e],_=f.value.isDataDriven(),v=f.value;this._transitionablePaint.setValue(e,o),this._handleSpecialPaintPropertyUpdate(e);const E=this._transitionablePaint._values[e].value,S=E.isDataDriven(),k=Nt(e,"pattern")||e==="line-dasharray";return S||_||k||this._handleOverridablePaintPropertyUpdate(e,v,E)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,o,c){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,o)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),hn(e,(o,c)=>!(o===void 0||c==="layout"&&!Object.keys(o).length||c==="paint"&&!Object.keys(o).length))}_validate(e,o,c,f,_={}){return(!_||_.validate!==!1)&&Ho(this,e.call(Po,{key:o,layerType:this.type,objectKey:c,value:f,styleSpec:Te,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const o=this.paint.get(e);if(o instanceof fe&&kl(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=bc(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const l1=Ye([{name:"a_pos",components:2,type:"Int16"}],4),c1=Ye([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Ji{constructor(e=[]){this.segments=e}prepareSegment(e,o,c,f){let _=this.segments[this.segments.length-1];return e>Ji.MAX_VERTEX_ARRAY_LENGTH&&Nn(`Max vertices per segment is ${Ji.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!_||_.vertexLength+e>Ji.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==f)&&(_={vertexOffset:o.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},f!==void 0&&(_.sortKey=f),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const e of this.segments)for(const o in e.vaos)e.vaos[o].destroy()}static simpleSegment(e,o,c,f){return new Ji([{vertexOffset:e,primitiveOffset:o,vertexLength:c,primitiveLength:f,vaos:{},sortKey:0}])}}Ji.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,gn(Ji,"SegmentVector");var Wn=8192;class jl{constructor(e,o){e&&(o?this.setSouthWest(e).setNorthEast(o):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof $r?new $r(e.lng,e.lat):$r.convert(e),this}setSouthWest(e){return this._sw=e instanceof $r?new $r(e.lng,e.lat):$r.convert(e),this}extend(e){const o=this._sw,c=this._ne;let f,_;if(e instanceof $r)f=e,_=e;else{if(!(e instanceof jl))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(jl.convert(e)):this.extend($r.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend($r.convert(e)):this;if(f=e._sw,_=e._ne,!f||!_)return this}return o||c?(o.lng=Math.min(f.lng,o.lng),o.lat=Math.min(f.lat,o.lat),c.lng=Math.max(_.lng,c.lng),c.lat=Math.max(_.lat,c.lat)):(this._sw=new $r(f.lng,f.lat),this._ne=new $r(_.lng,_.lat)),this}getCenter(){return new $r((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new $r(this.getWest(),this.getNorth())}getSouthEast(){return new $r(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:o,lat:c}=$r.convert(e);let f=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(e){return!e||e instanceof jl?e:new jl(e)}}var mf=1e-6,Es=typeof Float32Array<"u"?Float32Array:Array;function u1(){var i=new Es(9);return Es!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function ng(i,e,o){var c=e[0],f=e[1],_=e[2],v=e[3],E=e[4],S=e[5],k=e[6],L=e[7],z=e[8],N=o[0],W=o[1],q=o[2],X=o[3],le=o[4],ve=o[5],Re=o[6],be=o[7],Pe=o[8];return i[0]=N*c+W*v+q*k,i[1]=N*f+W*E+q*L,i[2]=N*_+W*S+q*z,i[3]=X*c+le*v+ve*k,i[4]=X*f+le*E+ve*L,i[5]=X*_+le*S+ve*z,i[6]=Re*c+be*v+Pe*k,i[7]=Re*f+be*E+Pe*L,i[8]=Re*_+be*S+Pe*z,i}function $a(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function rg(i,e){var o=e[0],c=e[1],f=e[2],_=e[3],v=e[4],E=e[5],S=e[6],k=e[7],L=e[8],z=e[9],N=e[10],W=e[11],q=e[12],X=e[13],le=e[14],ve=e[15],Re=o*E-c*v,be=o*S-f*v,Pe=o*k-_*v,Be=c*S-f*E,ze=c*k-_*E,ft=f*k-_*S,ct=L*X-z*q,Pt=L*le-N*q,Jt=L*ve-W*q,vt=z*le-N*X,Rt=z*ve-W*X,Ot=N*ve-W*le,Vt=Re*Ot-be*Rt+Pe*vt+Be*Jt-ze*Pt+ft*ct;return Vt?(i[0]=(E*Ot-S*Rt+k*vt)*(Vt=1/Vt),i[1]=(f*Rt-c*Ot-_*vt)*Vt,i[2]=(X*ft-le*ze+ve*Be)*Vt,i[3]=(N*ze-z*ft-W*Be)*Vt,i[4]=(S*Jt-v*Ot-k*Pt)*Vt,i[5]=(o*Ot-f*Jt+_*Pt)*Vt,i[6]=(le*Pe-q*ft-ve*be)*Vt,i[7]=(L*ft-N*Pe+W*be)*Vt,i[8]=(v*Rt-E*Jt+k*ct)*Vt,i[9]=(c*Jt-o*Rt-_*ct)*Vt,i[10]=(q*ze-X*Pe+ve*Re)*Vt,i[11]=(z*Pe-L*ze-W*Re)*Vt,i[12]=(E*Pt-v*vt-S*ct)*Vt,i[13]=(o*vt-c*Pt+f*ct)*Vt,i[14]=(X*be-q*Be-le*Re)*Vt,i[15]=(L*Be-z*be+N*Re)*Vt,i):null}function Rc(i,e,o){var c=e[0],f=e[1],_=e[2],v=e[3],E=e[4],S=e[5],k=e[6],L=e[7],z=e[8],N=e[9],W=e[10],q=e[11],X=e[12],le=e[13],ve=e[14],Re=e[15],be=o[0],Pe=o[1],Be=o[2],ze=o[3];return i[0]=be*c+Pe*E+Be*z+ze*X,i[1]=be*f+Pe*S+Be*N+ze*le,i[2]=be*_+Pe*k+Be*W+ze*ve,i[3]=be*v+Pe*L+Be*q+ze*Re,i[4]=(be=o[4])*c+(Pe=o[5])*E+(Be=o[6])*z+(ze=o[7])*X,i[5]=be*f+Pe*S+Be*N+ze*le,i[6]=be*_+Pe*k+Be*W+ze*ve,i[7]=be*v+Pe*L+Be*q+ze*Re,i[8]=(be=o[8])*c+(Pe=o[9])*E+(Be=o[10])*z+(ze=o[11])*X,i[9]=be*f+Pe*S+Be*N+ze*le,i[10]=be*_+Pe*k+Be*W+ze*ve,i[11]=be*v+Pe*L+Be*q+ze*Re,i[12]=(be=o[12])*c+(Pe=o[13])*E+(Be=o[14])*z+(ze=o[15])*X,i[13]=be*f+Pe*S+Be*N+ze*le,i[14]=be*_+Pe*k+Be*W+ze*ve,i[15]=be*v+Pe*L+Be*q+ze*Re,i}function Vh(i,e,o){var c,f,_,v,E,S,k,L,z,N,W,q,X=o[0],le=o[1],ve=o[2];return e===i?(i[12]=e[0]*X+e[4]*le+e[8]*ve+e[12],i[13]=e[1]*X+e[5]*le+e[9]*ve+e[13],i[14]=e[2]*X+e[6]*le+e[10]*ve+e[14],i[15]=e[3]*X+e[7]*le+e[11]*ve+e[15]):(f=e[1],_=e[2],v=e[3],E=e[4],S=e[5],k=e[6],L=e[7],z=e[8],N=e[9],W=e[10],q=e[11],i[0]=c=e[0],i[1]=f,i[2]=_,i[3]=v,i[4]=E,i[5]=S,i[6]=k,i[7]=L,i[8]=z,i[9]=N,i[10]=W,i[11]=q,i[12]=c*X+E*le+z*ve+e[12],i[13]=f*X+S*le+N*ve+e[13],i[14]=_*X+k*le+W*ve+e[14],i[15]=v*X+L*le+q*ve+e[15]),i}function Oc(i,e,o){var c=o[0],f=o[1],_=o[2];return i[0]=e[0]*c,i[1]=e[1]*c,i[2]=e[2]*c,i[3]=e[3]*c,i[4]=e[4]*f,i[5]=e[5]*f,i[6]=e[6]*f,i[7]=e[7]*f,i[8]=e[8]*_,i[9]=e[9]*_,i[10]=e[10]*_,i[11]=e[11]*_,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}function Wh(i,e,o){var c=Math.sin(o),f=Math.cos(o),_=e[4],v=e[5],E=e[6],S=e[7],k=e[8],L=e[9],z=e[10],N=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=_*f+k*c,i[5]=v*f+L*c,i[6]=E*f+z*c,i[7]=S*f+N*c,i[8]=k*f-_*c,i[9]=L*f-v*c,i[10]=z*f-E*c,i[11]=N*f-S*c,i}function Pp(i,e,o){var c=Math.sin(o),f=Math.cos(o),_=e[0],v=e[1],E=e[2],S=e[3],k=e[8],L=e[9],z=e[10],N=e[11];return e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=_*f-k*c,i[1]=v*f-L*c,i[2]=E*f-z*c,i[3]=S*f-N*c,i[8]=_*c+k*f,i[9]=v*c+L*f,i[10]=E*c+z*f,i[11]=S*c+N*f,i}function h1(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function d1(i,e,o){var c,f,_,v=o[0],E=o[1],S=o[2],k=Math.hypot(v,E,S);return k<mf?null:(v*=k=1/k,E*=k,S*=k,c=Math.sin(e),f=Math.cos(e),i[0]=v*v*(_=1-f)+f,i[1]=E*v*_+S*c,i[2]=S*v*_-E*c,i[3]=0,i[4]=v*E*_-S*c,i[5]=E*E*_+f,i[6]=S*E*_+v*c,i[7]=0,i[8]=v*S*_+E*c,i[9]=E*S*_-v*c,i[10]=S*S*_+f,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)}Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});var qh=Rc;function gf(){var i=new Es(3);return Es!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function Ip(i){var e=new Es(3);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e}function _f(i){return Math.hypot(i[0],i[1],i[2])}function Fu(i,e,o){var c=new Es(3);return c[0]=i,c[1]=e,c[2]=o,c}function pl(i,e,o){return i[0]=e[0]+o[0],i[1]=e[1]+o[1],i[2]=e[2]+o[2],i}function Lp(i,e,o){return i[0]=e[0]-o[0],i[1]=e[1]-o[1],i[2]=e[2]-o[2],i}function ig(i,e,o){return i[0]=e[0]*o[0],i[1]=e[1]*o[1],i[2]=e[2]*o[2],i}function Gh(i,e,o){return i[0]=Math.min(e[0],o[0]),i[1]=Math.min(e[1],o[1]),i[2]=Math.min(e[2],o[2]),i}function yf(i,e,o){return i[0]=Math.max(e[0],o[0]),i[1]=Math.max(e[1],o[1]),i[2]=Math.max(e[2],o[2]),i}function $i(i,e,o){return i[0]=e[0]*o,i[1]=e[1]*o,i[2]=e[2]*o,i}function Do(i,e,o,c){return i[0]=e[0]+o[0]*c,i[1]=e[1]+o[1]*c,i[2]=e[2]+o[2]*c,i}function Xo(i,e){var o=e[0],c=e[1],f=e[2],_=o*o+c*c+f*f;return _>0&&(_=1/Math.sqrt(_)),i[0]=e[0]*_,i[1]=e[1]*_,i[2]=e[2]*_,i}function ta(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}function Rp(i,e,o){var c=e[0],f=e[1],_=e[2],v=o[0],E=o[1],S=o[2];return i[0]=f*S-_*E,i[1]=_*v-c*S,i[2]=c*E-f*v,i}function Gi(i,e,o){var c=e[0],f=e[1],_=e[2],v=o[3]*c+o[7]*f+o[11]*_+o[15];return i[0]=(o[0]*c+o[4]*f+o[8]*_+o[12])/(v=v||1),i[1]=(o[1]*c+o[5]*f+o[9]*_+o[13])/v,i[2]=(o[2]*c+o[6]*f+o[10]*_+o[14])/v,i}function og(i,e,o){var c=o[0],f=o[1],_=o[2],v=e[0],E=e[1],S=e[2],k=f*S-_*E,L=_*v-c*S,z=c*E-f*v,N=f*z-_*L,W=_*k-c*z,q=c*L-f*k,X=2*o[3];return L*=X,z*=X,W*=2,q*=2,i[0]=v+(k*=X)+(N*=2),i[1]=E+L+W,i[2]=S+z+q,i}var Uu,ba=Lp,sg=ig,f1=_f;function ag(i,e,o){return i[0]=e[0]*o,i[1]=e[1]*o,i[2]=e[2]*o,i[3]=e[3]*o,i}function Op(i,e){var o=e[0],c=e[1],f=e[2],_=e[3],v=o*o+c*c+f*f+_*_;return v>0&&(v=1/Math.sqrt(v)),i[0]=o*v,i[1]=c*v,i[2]=f*v,i[3]=_*v,i}function Nl(i,e,o){var c=e[0],f=e[1],_=e[2],v=e[3];return i[0]=o[0]*c+o[4]*f+o[8]*_+o[12]*v,i[1]=o[1]*c+o[5]*f+o[9]*_+o[13]*v,i[2]=o[2]*c+o[6]*f+o[10]*_+o[14]*v,i[3]=o[3]*c+o[7]*f+o[11]*_+o[15]*v,i}function lg(){var i=new Es(4);return Es!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function Dp(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i}function vf(i,e,o){o*=.5;var c=e[0],f=e[1],_=e[2],v=e[3],E=Math.sin(o),S=Math.cos(o);return i[0]=c*S+v*E,i[1]=f*S+_*E,i[2]=_*S-f*E,i[3]=v*S-c*E,i}function p1(i,e,o){o*=.5;var c=e[0],f=e[1],_=e[2],v=e[3],E=Math.sin(o),S=Math.cos(o);return i[0]=c*S-_*E,i[1]=f*S+v*E,i[2]=_*S+c*E,i[3]=v*S-f*E,i}gf(),Uu=new Es(4),Es!=Float32Array&&(Uu[0]=0,Uu[1]=0,Uu[2]=0,Uu[3]=0);var m1=Op;gf(),Fu(1,0,0),Fu(0,1,0),lg(),lg(),u1();const cg=Ye([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:ug}=cg,xf=Ye([{name:"a_pos_3",components:3,type:"Int16"}]);var na=Ye([{name:"a_pos",type:"Int16",components:2}]);class hg{constructor(e,o){this.pos=e,this.dir=o}intersectsPlane(e,o,c){const f=ta(o,this.dir);if(Math.abs(f)<1e-6)return!1;const _=((e[0]-this.pos[0])*o[0]+(e[1]-this.pos[1])*o[1]+(e[2]-this.pos[2])*o[2])/f;return c[0]=this.pos[0]+this.dir[0]*_,c[1]=this.pos[1]+this.dir[1]*_,c[2]=this.pos[2]+this.dir[2]*_,!0}closestPointOnSphere(e,o,c){if(function(W,q){var X=W[0],le=W[1],ve=W[2],Re=q[0],be=q[1],Pe=q[2];return Math.abs(X-Re)<=mf*Math.max(1,Math.abs(X),Math.abs(Re))&&Math.abs(le-be)<=mf*Math.max(1,Math.abs(le),Math.abs(be))&&Math.abs(ve-Pe)<=mf*Math.max(1,Math.abs(ve),Math.abs(Pe))}(this.pos,e)||o===0)return c[0]=c[1]=c[2]=0,!1;const[f,_,v]=this.dir,E=this.pos[0]-e[0],S=this.pos[1]-e[1],k=this.pos[2]-e[2],L=f*f+_*_+v*v,z=2*(E*f+S*_+k*v),N=z*z-4*L*(E*E+S*S+k*k-o*o);if(N<0){const W=Math.max(-z/2,0),q=E+f*W,X=S+_*W,le=k+v*W,ve=Math.hypot(q,X,le);return c[0]=q*o/ve,c[1]=X*o/ve,c[2]=le*o/ve,!1}{const W=(-z-Math.sqrt(N))/(2*L);if(W<0){const q=Math.hypot(E,S,k);return c[0]=E*o/q,c[1]=S*o/q,c[2]=k*o/q,!1}return c[0]=E+f*W,c[1]=S+_*W,c[2]=k+v*W,!0}}}class zp{constructor(e,o,c,f,_){this.TL=e,this.TR=o,this.BR=c,this.BL=f,this.horizon=_}static fromInvProjectionMatrix(e,o,c){const f=[-1,1,1],_=[1,1,1],v=[1,-1,1],E=[-1,-1,1],S=Gi(f,f,e),k=Gi(_,_,e),L=Gi(v,v,e),z=Gi(E,E,e);return new zp(S,k,L,z,o/c)}}class wf{constructor(e,o){this.points=e,this.planes=o}static fromInvProjectionMatrix(e,o,c,f){const _=Math.pow(2,c),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const k=Nl([],S,e),L=1/k[3]/o*_;return function(z,N,W){return z[0]=N[0]*W[0],z[1]=N[1]*W[1],z[2]=N[2]*W[2],z[3]=N[3]*W[3],z}(k,k,[L,L,f?1/k[3]:L,L])}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const k=Xo([],Rp([],ba([],v[S[0]],v[S[1]]),ba([],v[S[2]],v[S[1]]))),L=-ta(k,v[S[1]]);return k.concat(L)});return new wf(v,E)}}class Yo{static fromPoints(e){const o=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const f of e)Gh(o,o,f),yf(c,c,f);return new Yo(o,c)}static applyTransform(e,o){const c=e.getCorners();for(let f=0;f<c.length;++f)Gi(c[f],c[f],o);return Yo.fromPoints(c)}constructor(e,o){this.min=e,this.max=o,this.center=$i([],pl([],this.min,this.max),.5)}quadrant(e){const o=[e%2==0,e<2],c=Ip(this.min),f=Ip(this.max);for(let _=0;_<o.length;_++)c[_]=o[_]?this.min[_]:this.center[_],f[_]=o[_]?this.center[_]:this.max[_];return f[2]=this.max[2],new Yo(c,f)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,o=this.max;return[[e[0],e[1],e[2]],[o[0],e[1],e[2]],[o[0],o[1],e[2]],[e[0],o[1],e[2]],[e[0],e[1],o[2]],[o[0],e[1],o[2]],[o[0],o[1],o[2]],[e[0],o[1],o[2]]]}intersects(e){const o=this.getCorners();let c=!0;for(let f=0;f<e.planes.length;f++){const _=e.planes[f];let v=0;for(let E=0;E<o.length;E++)v+=ta(_,o[E])+_[3]>=0;if(v===0)return 0;v!==o.length&&(c=!1)}if(c)return 2;for(let f=0;f<3;f++){let _=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(let E=0;E<e.points.length;E++){const S=e.points[E][f]-this.min[f];_=Math.min(_,S),v=Math.max(v,S)}if(v<0||_>this.max[f]-this.min[f])return 0}return 1}}const Bp=5,Zh=6,Zi=Wn/Math.PI/2,Ly=16383,$u=64,Dc=[$u,32,16],Bi=-Zi,Ea=Zi,Hn=[new Yo([Bi,Bi,Bi],[Ea,Ea,Ea]),new Yo([Bi,Bi,Bi],[0,0,Ea]),new Yo([0,Bi,Bi],[Ea,0,Ea]),new Yo([Bi,0,Bi],[0,Ea,Ea]),new Yo([0,0,Bi],[Ea,Ea,Ea])];function Fl(i){return i*Zi/Tf}function jp(i,e,o,c=!0){const f=$i([],i._camera.position,i.worldSize),_=[e,o,1,1];Nl(_,_,i.pixelMatrixInverse),ag(_,_,1/_[3]);const v=Xo([],ba([],_,f)),E=i.globeMatrix,S=[E[12],E[13],E[14]],k=ba([],S,f),L=_f(k),z=Xo([],k),N=i.worldSize/(2*Math.PI),W=ta(z,v),q=Math.asin(N/L);if(q<Math.acos(W)){if(!c)return null;const Jt=[],vt=[];$i(Jt,v,L/W),Xo(vt,ba(vt,Jt,k)),Xo(v,pl(v,k,$i(v,vt,Math.tan(q)*L)))}const X=[];new hg(f,v).closestPointOnSphere(S,N,X);const le=Xo([],Ri(E,0)),ve=Xo([],Ri(E,1)),Re=Xo([],Ri(E,2)),be=ta(le,X),Pe=ta(ve,X),Be=ta(Re,X),ze=ht(Math.asin(-Pe/N));let ft=ht(Math.atan2(be,Be));ft=i.center.lng+function(Jt,vt){const Rt=(vt-Jt+180)%360-180;return Rt<-180?Rt+360:Rt}(i.center.lng,ft);const ct=ji(ft),Pt=Bt(Ti(ze),0,1);return new Ul(ct,Pt)}class g1{constructor(e,o,c){this.a=ba([],e,c),this.b=ba([],o,c),this.center=c;const f=Xo([],this.a),_=Xo([],this.b);this.angle=Math.acos(ta(f,_))}}function dg(i,e){if(i.angle===0)return null;let o;return o=i.a[e]===0?1/i.angle*.5*Math.PI:1/i.angle*Math.atan(i.b[e]/i.a[e]/Math.sin(i.angle)-1/Math.tan(i.angle)),o<0||o>1?null:function(c,f,_,v){const E=Math.sin(_);return c*(Math.sin((1-v)*_)/E)+f*(Math.sin(v*_)/E)}(i.a[e],i.b[e],i.angle,Bt(o,0,1))+i.center[e]}function Bs(i){if(i.z<=1)return Hn[i.z+2*i.y+i.x];const e=Ef(bf(i));return Yo.fromPoints(e)}function ml(i,e,o){return $i(i,i,1-o),Do(i,i,e,o)}function Np(i,e){const o=Cs(e.zoom);if(o===0)return Bs(i);const c=bf(i),f=Ef(c),_=ji(c.getWest())*e.worldSize,v=ji(c.getEast())*e.worldSize,E=Ti(c.getNorth())*e.worldSize,S=Ti(c.getSouth())*e.worldSize,k=[_,E,0],L=[v,E,0],z=[_,S,0],N=[v,S,0],W=rg([],e.globeMatrix);return Gi(k,k,W),Gi(L,L,W),Gi(z,z,W),Gi(N,N,W),f[0]=ml(f[0],z,o),f[1]=ml(f[1],N,o),f[2]=ml(f[2],L,o),f[3]=ml(f[3],k,o),Yo.fromPoints(f)}function fg(i,e,o){for(const c of i)Gi(c,c,e),$i(c,c,o)}function _1(i,e,o){const c=e/i.worldSize,f=i.globeMatrix;if(o.z<=1){const ct=Bs(o).getCorners();return fg(ct,f,c),Yo.fromPoints(ct)}const _=bf(o),v=Ef(_);fg(v,f,c);const E=Number.MAX_VALUE,S=[-E,-E,-E],k=[E,E,E];if(_.contains(i.center)){for(const Jt of v)Gh(k,k,Jt),yf(S,S,Jt);S[2]=0;const ct=i.point,Pt=[ct.x*c,ct.y*c,0];return Gh(k,k,Pt),yf(S,S,Pt),new Yo(k,S)}const L=[f[12]*c,f[13]*c,f[14]*c],z=_.getCenter(),N=Bt(i.center.lat,-uo,uo),W=Bt(z.lat,-uo,uo),q=ji(i.center.lng),X=Ti(N);let le=q-ji(z.lng);const ve=X-Ti(W);le>.5?le-=1:le<-.5&&(le+=1);let Re=0;Math.abs(le)>Math.abs(ve)?Re=le>=0?1:3:(Re=ve>=0?0:2,Do(L,L,[f[4]*c,f[5]*c,f[6]*c],-Math.sin(lt(ve>=0?_.getSouth():_.getNorth()))*Zi));const be=v[Re],Pe=v[(Re+1)%4],Be=new g1(be,Pe,L),ze=[dg(Be,0)||be[0],dg(Be,1)||be[1],dg(Be,2)||be[2]],ft=Cs(i.zoom);if(ft>0){const ct=function({x:Jt,y:vt,z:Rt},Ot,Vt,Qt,kt){const pn=1/(1<<Rt);let Rn=Jt*pn,_n=Rn+pn,Mr=vt*pn,en=Mr+pn,Kn=0;const Ar=(Rn+_n)/2-Qt;return Ar>.5?Kn=-1:Ar<-.5&&(Kn=1),Rn=((Rn+Kn)*Ot-(Qt*=Ot))*Vt+Qt,_n=((_n+Kn)*Ot-Qt)*Vt+Qt,Mr=(Mr*Ot-(kt*=Ot))*Vt+kt,en=(en*Ot-kt)*Vt+kt,[[Rn,en,0],[_n,en,0],[_n,Mr,0],[Rn,Mr,0]]}(o,e,i._pixelsPerMercatorPixel,q,X);for(let Jt=0;Jt<v.length;Jt++)ml(v[Jt],ct[Jt],ft);const Pt=pl([],ct[Re],ct[(Re+1)%4]);$i(Pt,Pt,.5),ml(ze,Pt,ft)}for(const ct of v)Gh(k,k,ct),yf(S,S,ct);return k[2]=Math.min(be[2],Pe[2]),Gh(k,k,ze),yf(S,S,ze),new Yo(k,S)}function bf({x:i,y:e,z:o}){const c=1/(1<<o),f=new $r(Hi(i*c),io((e+1)*c)),_=new $r(Hi((i+1)*c),io(e*c));return new jl(f,_)}function Ef(i){const e=lt(i.getNorth()),o=lt(i.getSouth()),c=Math.cos(e),f=Math.cos(o),_=Math.sin(e),v=Math.sin(o),E=i.getWest(),S=i.getEast();return[zc(f,v,E),zc(f,v,S),zc(c,_,S),zc(c,_,E)]}function zc(i,e,o,c=Zi){return o=lt(o),[i*Math.sin(o)*c,-e*c,i*Math.cos(o)*c]}function co(i,e,o){return zc(Math.cos(lt(i)),Math.sin(lt(i)),e,o)}function Ts(i,e,o,c){const f=1<<o.z,_=(i/Wn+o.x)/f;return co(io((e/Wn+o.y)/f),Hi(_),c)}function Va({min:i,max:e}){return Ly/Math.max(e[0]-i[0],e[1]-i[1],e[2]-i[2])}const pg=new Float64Array(16);function Hh(i){const e=Va(i),o=h1(pg,[e,e,e]);return Vh(o,o,((c=[])[0]=-(f=i.min)[0],c[1]=-f[1],c[2]=-f[2],c));var c,f}function ra(i){const e=(c=i.min,(o=pg)[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=c[0],o[13]=c[1],o[14]=c[2],o[15]=1,o);var o,c;const f=1/Va(i);return Oc(e,e,[f,f,f])}function mg(i,e,o,c,f){const _=function(S){const k=Wn/(2*Math.PI);return S/(2*Math.PI)/k}(o),v=[i,e,-o/(2*Math.PI)],E=$a(new Float64Array(16));return Vh(E,E,v),Oc(E,E,[_,_,_]),Wh(E,E,lt(-f)),Pp(E,E,lt(-c)),E}function Cs(i){return je(Bp,Zh,i)}function y1(i,e){const o=co(e.lat,e.lng),c=function(q){const X=co(q._center.lat,q._center.lng);let le=Rp([],Fu(0,1,0),X);const ve=d1([],-q.angle,X);le=Gi(le,le,ve),d1(ve,-q._pitch,le);const Re=Xo([],X);return $i(Re,Re,Fl(q.cameraToCenterDistance/q.pixelsPerMeter)),Gi(Re,Re,ve),pl([],X,Re)}(i);return v=(f=Lp([],c,o))[0],E=f[1],S=f[2],k=(_=o)[0],L=_[1],z=_[2],W=(N=Math.sqrt(v*v+E*E+S*S)*Math.sqrt(k*k+L*L+z*z))&&ta(f,_)/N,Math.acos(Math.min(Math.max(W,-1),1));var f,_,v,E,S,k,L,z,N,W}function Fp(i,e){return y1(i,e)>Math.PI/2*1.01}const gg=lt(85),v1=Math.cos(gg),x1=Math.sin(gg),Tf=63710088e-1,Cf=2*Math.PI*Tf;class gl{constructor(e,o){if(isNaN(e)||isNaN(o))throw new Error(`Invalid LngLat object: (${e}, ${o})`);if(this.lng=+e,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new gl(At(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const o=Math.PI/180,c=this.lat*o,f=e.lat*o,_=Math.sin(c)*Math.sin(f)+Math.cos(c)*Math.cos(f)*Math.cos((e.lng-this.lng)*o);return Tf*Math.acos(Math.min(_,1))}toBounds(e=0){const o=360*e/40075017,c=o/Math.cos(Math.PI/180*this.lat);return new jl(new gl(this.lng-c,this.lat-o),new gl(this.lng+c,this.lat+o))}toEcef(e){const o=Fl(e);return co(this.lat,this.lng,Zi+o)}static convert(e){if(e instanceof gl)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new gl(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new gl(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var $r=gl;function si(i){return Cf*Math.cos(i*Math.PI/180)}function ji(i){return(180+i)/360}function Ti(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function Ni(i,e){return i/si(e)}function Hi(i){return 360*i-180}function io(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function ko(i,e){return i*si(io(e))}const uo=85.051129;function Bc(i){return 1/Math.cos(i*Math.PI/180)}class Ul{constructor(e,o,c=0){this.x=+e,this.y=+o,this.z=+c}static fromLngLat(e,o=0){const c=$r.convert(e);return new Ul(ji(c.lng),Ti(c.lat),Ni(o,c.lat))}toLngLat(){return new $r(Hi(this.x),io(this.y))}toAltitude(){return ko(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Cf*Bc(io(this.y))}}function Sf(i,e,o,c,f,_,v,E,S){const k=(e+c)/2,L=(o+f)/2,z=new ge(k,L);E(z),function(N,W,q,X,le,ve){const Re=q-le,be=X-ve;return Math.abs((X-W)*Re-(q-N)*be)/Math.hypot(Re,be)}(z.x,z.y,_.x,_.y,v.x,v.y)>=S?(Sf(i,e,o,k,L,_,z,E,S),Sf(i,k,L,c,f,z,v,E,S)):i.push(v)}function Kh(i,e,o){let c=i[0],f=c.x,_=c.y;e(c);const v=[c];for(let E=1;E<i.length;E++){const S=i[E],{x:k,y:L}=S;e(S),Sf(v,f,_,k,L,c,S,e,o),f=k,_=L,c=S}return v}function hs(i,e,o,c){if(c(e,o)){const f=e.add(o)._mult(.5);hs(i,e,f,c),hs(i,f,o,c)}else i.push(o)}function _g(i,e){let o=i[0];const c=[o];for(let f=1;f<i.length;f++){const _=i[f];hs(c,o,_,e),o=_}return c}const jc=Math.pow(2,14)-1,_l=-jc-1;function Up(i,e){const o=Math.round(i.x*e),c=Math.round(i.y*e);return i.x=Bt(o,_l,jc),i.y=Bt(c,_l,jc),(o<i.x||o>i.x+1||c<i.y||c>i.y+1)&&Nn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function Wa(i,e,o){const c=i.loadGeometry(),f=i.extent,_=Wn/f;if(e&&o&&o.projection.isReprojectedInTileSpace){const v=1<<e.z,{scale:E,x:S,y:k,projection:L}=o,z=N=>{const W=Hi((e.x+N.x/f)/v),q=io((e.y+N.y/f)/v),X=L.project(W,q);N.x=(X.x*E-S)*f,N.y=(X.y*E-k)*f};for(let N=0;N<c.length;N++)if(i.type!==1)c[N]=Kh(c[N],z,1);else{const W=[];for(const q of c[N])q.x<0||q.x>=f||q.y<0||q.y>=f||(z(q),W.push(q));c[N]=W}}for(const v of c)for(const E of v)Up(E,_);return c}function js(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?Wa(i):[]}}function Vu(i,e,o,c,f){i.emplaceBack(2*e+(c+1)/2,2*o+(f+1)/2)}function qa(i,e,o){i.emplaceBack(e.x,e.y,e.z,o[0]*16384,o[1]*16384,o[2]*16384)}class Xh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Kt,this.indexArray=new jn,this.segments=new Ji,this.programConfigurations=new Lc(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,c,f){const _=this.layers[0],v=[];let E=null;_.type==="circle"&&(E=_.layout.get("circle-sort-key"));for(const{feature:k,id:L,index:z,sourceLayerIndex:N}of e){const W=this.layers[0]._featureFilter.needGeometry,q=js(k,W);if(!this.layers[0]._featureFilter.filter(new O(this.zoom),q,c))continue;const X=E?E.evaluate(q,{},c):void 0,le={id:L,properties:k.properties,type:k.type,sourceLayerIndex:N,index:z,geometry:W?q.geometry:Wa(k,c,f),patterns:{},sortKey:X};v.push(le)}E&&v.sort((k,L)=>k.sortKey-L.sortKey);let S=null;f.projection.name==="globe"&&(this.globeExtVertexArray=new Ht,S=f.projection);for(const k of v){const{geometry:L,index:z,sourceLayerIndex:N}=k,W=e[z].feature;this.addFeature(k,L,z,o.availableImages,c,S),o.featureIndex.insert(W,L,z,N,this.index)}}update(e,o,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,l1.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,c1.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,o,c,f,_,v){for(const E of o)for(const S of E){const k=S.x,L=S.y;if(k<0||k>=Wn||L<0||L>=Wn)continue;if(v){const W=v.projectTilePoint(k,L,_),q=v.upVector(_,k,L),X=this.globeExtVertexArray;qa(X,W,q),qa(X,W,q),qa(X,W,q),qa(X,W,q)}const z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),N=z.vertexLength;Vu(this.layoutVertexArray,k,L,-1,-1),Vu(this.layoutVertexArray,k,L,1,-1),Vu(this.layoutVertexArray,k,L,1,1),Vu(this.layoutVertexArray,k,L,-1,1),this.indexArray.emplaceBack(N,N+1,N+2),this.indexArray.emplaceBack(N,N+2,N+3),z.vertexLength+=4,z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,{},f,_)}}function Yh(i,e){for(let o=0;o<i.length;o++)if($l(e,i[o]))return!0;for(let o=0;o<e.length;o++)if($l(i,e[o]))return!0;return!!Jo(i,e)}function yg(i,e,o){return!!$l(i,e)||!!ia(e,i,o)}function kf(i,e){if(i.length===1)return vg(e,i[0]);for(let o=0;o<e.length;o++){const c=e[o];for(let f=0;f<c.length;f++)if($l(i,c[f]))return!0}for(let o=0;o<i.length;o++)if(vg(e,i[o]))return!0;for(let o=0;o<e.length;o++)if(Jo(i,e[o]))return!0;return!1}function $p(i,e,o){if(i.length>1){if(Jo(i,e))return!0;for(let c=0;c<e.length;c++)if(ia(e[c],i,o))return!0}for(let c=0;c<i.length;c++)if(ia(i[c],e,o))return!0;return!1}function Jo(i,e){if(i.length===0||e.length===0)return!1;for(let o=0;o<i.length-1;o++){const c=i[o],f=i[o+1];for(let _=0;_<e.length-1;_++)if(Nc(c,f,e[_],e[_+1]))return!0}return!1}function Nc(i,e,o,c){return xr(i,o,c)!==xr(e,o,c)&&xr(i,e,o)!==xr(i,e,c)}function ia(i,e,o){const c=o*o;if(e.length===1)return i.distSqr(e[0])<c;for(let f=1;f<e.length;f++)if(Ss(i,e[f-1],e[f])<c)return!0;return!1}function Ss(i,e,o){const c=e.distSqr(o);if(c===0)return i.distSqr(e);const f=((i.x-e.x)*(o.x-e.x)+(i.y-e.y)*(o.y-e.y))/c;return i.distSqr(f<0?e:f>1?o:o.sub(e)._mult(f)._add(e))}function vg(i,e){let o,c,f,_=!1;for(let v=0;v<i.length;v++){o=i[v];for(let E=0,S=o.length-1;E<o.length;S=E++)c=o[E],f=o[S],c.y>e.y!=f.y>e.y&&e.x<(f.x-c.x)*(e.y-c.y)/(f.y-c.y)+c.x&&(_=!_)}return _}function $l(i,e){let o=!1;for(let c=0,f=i.length-1;c<i.length;f=c++){const _=i[c],v=i[f];_.y>e.y!=v.y>e.y&&e.x<(v.x-_.x)*(e.y-_.y)/(v.y-_.y)+_.x&&(o=!o)}return o}function Vp(i,e,o,c,f){for(const v of i)if(e<=v.x&&o<=v.y&&c>=v.x&&f>=v.y)return!0;const _=[new ge(e,o),new ge(e,f),new ge(c,f),new ge(c,o)];if(i.length>2){for(const v of _)if($l(i,v))return!0}for(let v=0;v<i.length-1;v++)if(Ry(i[v],i[v+1],_))return!0;return!1}function Ry(i,e,o){const c=o[0],f=o[2];if(i.x<c.x&&e.x<c.x||i.x>f.x&&e.x>f.x||i.y<c.y&&e.y<c.y||i.y>f.y&&e.y>f.y)return!1;const _=xr(i,e,o[0]);return _!==xr(i,e,o[1])||_!==xr(i,e,o[2])||_!==xr(i,e,o[3])}function oa(i,e,o){const c=e.paint.get(i).value;return c.kind==="constant"?c.value:o.programConfigurations.get(e.id).getMaxValue(i)}function Mf(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Wp(i,e,o,c,f){if(!e[0]&&!e[1])return i;const _=ge.convert(e)._mult(f);o==="viewport"&&_._rotate(-c);const v=[];for(let E=0;E<i.length;E++)v.push(i[E].sub(_));return v}function Fc(i,e,o,c){const f=ge.convert(i)._mult(c);return e==="viewport"&&f._rotate(-o),f}gn(Xh,"CircleBucket",{omit:["layers"]});const xg=new Ce({"circle-sort-key":new ue(Te.layout_circle["circle-sort-key"])});var Wu={paint:new Ce({"circle-radius":new ue(Te.paint_circle["circle-radius"]),"circle-color":new ue(Te.paint_circle["circle-color"]),"circle-blur":new ue(Te.paint_circle["circle-blur"]),"circle-opacity":new ue(Te.paint_circle["circle-opacity"]),"circle-translate":new K(Te.paint_circle["circle-translate"]),"circle-translate-anchor":new K(Te.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new K(Te.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new K(Te.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ue(Te.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ue(Te.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ue(Te.paint_circle["circle-stroke-opacity"])}),layout:xg};function wg(i,e,o,c,f,_,v,E,S){if(_&&i.queryGeometry.isAboveHorizon)return!1;_&&(S*=i.pixelToTileUnitsFactor);const k=i.tileID.canonical,L=o.projection.upVectorScale(k,o.center.lat,o.worldSize).metersToTile;for(const z of e)for(const N of z){const W=N.add(E),q=f&&o.elevation?o.elevation.exaggeration()*f.getElevationAt(W.x,W.y,!0):0,X=o.projection.projectTilePoint(W.x,W.y,k);if(q>0){const be=o.projection.upVector(k,W.x,W.y);X.x+=be[0]*L*q,X.y+=be[1]*L*q,X.z+=be[2]*L*q}const le=_?W:w1(X.x,X.y,X.z,c),ve=_?i.tilespaceRays.map(be=>Oy(be,q)):i.queryGeometry.screenGeometry,Re=Nl([],[X.x,X.y,X.z,1],c);if(!v&&_?S*=Re[3]/o.cameraToCenterDistance:v&&!_&&(S*=o.cameraToCenterDistance/Re[3]),_){const be=io((N.y/Wn+k.y)/(1<<k.z));S/=o.projection.pixelsPerMeter(be,1)/Ni(1,be)}if(yg(ve,le,S))return!0}return!1}function w1(i,e,o,c){const f=Nl([],[i,e,o,1],c);return new ge(f[0]/f[3],f[1]/f[3])}const qp=Fu(0,0,0),Gp=Fu(0,0,1);function Oy(i,e){const o=gf();return qp[2]=e,i.intersectsPlane(qp,Gp,o),new ge(o[0],o[1])}class b1 extends Xh{}function bg(i,{width:e,height:o},c,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==e*o*c)throw new RangeError("mismatched image size")}else f=new Uint8Array(e*o*c);return i.width=e,i.height=o,i.data=f,i}function Eg(i,e,o){const{width:c,height:f}=e;c===i.width&&f===i.height||(Vl(i,e,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,c),height:Math.min(i.height,f)},o),i.width=c,i.height=f,i.data=e.data)}function Vl(i,e,o,c,f,_){if(f.width===0||f.height===0)return e;if(f.width>i.width||f.height>i.height||o.x>i.width-f.width||o.y>i.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>e.width||f.height>e.height||c.x>e.width-f.width||c.y>e.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const v=i.data,E=e.data;for(let S=0;S<f.height;S++){const k=((o.y+S)*i.width+o.x)*_,L=((c.y+S)*e.width+c.x)*_;for(let z=0;z<f.width*_;z++)E[L+z]=v[k+z]}return e}gn(b1,"HeatmapBucket",{omit:["layers"]});class Wl{constructor(e,o){bg(this,e,1,o)}resize(e){Eg(this,new Wl(e),1)}clone(){return new Wl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,o,c,f,_){Vl(e,o,c,f,_,1)}}class zo{constructor(e,o){bg(this,e,4,o)}resize(e){Eg(this,new zo(e),4)}replace(e,o){o?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new zo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,o,c,f,_){Vl(e,o,c,f,_,4)}}gn(Wl,"AlphaImage"),gn(zo,"RGBAImage");var E1={paint:new Ce({"heatmap-radius":new ue(Te.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ue(Te.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new K(Te.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ee(Te.paint_heatmap["heatmap-color"]),"heatmap-opacity":new K(Te.paint_heatmap["heatmap-opacity"])})};function Qi(i){const e={},o=i.resolution||256,c=i.clips?i.clips.length:1,f=i.image||new zo({width:o,height:c}),_=(v,E,S)=>{e[i.evaluationKey]=S;const k=i.expression.evaluate(e);f.data[v+E+0]=Math.floor(255*k.r/k.a),f.data[v+E+1]=Math.floor(255*k.g/k.a),f.data[v+E+2]=Math.floor(255*k.b/k.a),f.data[v+E+3]=Math.floor(255*k.a)};if(i.clips)for(let v=0,E=0;v<c;++v,E+=4*o)for(let S=0,k=0;S<o;S++,k+=4){const L=S/(o-1),{start:z,end:N}=i.clips[v];_(E,k,z*(1-L)+N*L)}else for(let v=0,E=0;v<o;v++,E+=4)_(0,E,v/(o-1));return f}var Dy={paint:new Ce({"hillshade-illumination-direction":new K(Te.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new K(Te.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new K(Te.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new K(Te.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new K(Te.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new K(Te.paint_hillshade["hillshade-accent-color"])})};const T1=Ye([{name:"a_pos",components:2,type:"Int16"}],4),{members:zy}=T1;var Tg={exports:{}};function Af(i,e,o){o=o||2;var c,f,_,v,E,S,k,L=e&&e.length,z=L?e[0]*o:i.length,N=Cg(i,0,z,o,!0),W=[];if(!N||N.next===N.prev)return W;if(L&&(N=function(X,le,ve,Re){var be,Pe,Be,ze=[];for(be=0,Pe=le.length;be<Pe;be++)(Be=Cg(X,le[be]*Re,be<Pe-1?le[be+1]*Re:X.length,Re,!1))===Be.next&&(Be.steiner=!0),ze.push(jy(Be));for(ze.sort(Gu),be=0;be<ze.length;be++)ve=Hp(ze[be],ve);return ve}(i,e,N,o)),i.length>80*o){c=_=i[0],f=v=i[1];for(var q=o;q<z;q+=o)(E=i[q])<c&&(c=E),(S=i[q+1])<f&&(f=S),E>_&&(_=E),S>v&&(v=S);k=(k=Math.max(_-c,v-f))!==0?32767/k:0}return ds(N,W,o,c,f,k,0),W}function Cg(i,e,o,c,f){var _,v;if(f===Of(i,e,o,c)>0)for(_=e;_<o;_+=c)v=Mg(_,i[_],i[_+1],v);else for(_=o-c;_>=e;_-=c)v=Mg(_,i[_],i[_+1],v);return v&&If(v,v.next)&&(Ku(v),v=v.next),v}function qu(i,e){if(!i)return i;e||(e=i);var o,c=i;do if(o=!1,c.steiner||!If(c,c.next)&&eo(c.prev,c,c.next)!==0)c=c.next;else{if(Ku(c),(c=e=c.prev)===c.next)break;o=!0}while(o||c!==e);return e}function ds(i,e,o,c,f,_,v){if(i){!v&&_&&function(L,z,N,W){var q=L;do q.z===0&&(q.z=Pf(q.x,q.y,z,N,W)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next;while(q!==L);q.prevZ.nextZ=null,q.prevZ=null,function(X){var le,ve,Re,be,Pe,Be,ze,ft,ct=1;do{for(ve=X,X=null,Pe=null,Be=0;ve;){for(Be++,Re=ve,ze=0,le=0;le<ct&&(ze++,Re=Re.nextZ);le++);for(ft=ct;ze>0||ft>0&&Re;)ze!==0&&(ft===0||!Re||ve.z<=Re.z)?(be=ve,ve=ve.nextZ,ze--):(be=Re,Re=Re.nextZ,ft--),Pe?Pe.nextZ=be:X=be,be.prevZ=Pe,Pe=be;ve=Re}Pe.nextZ=null,ct*=2}while(Be>1)}(q)}(i,c,f,_);for(var E,S,k=i;i.prev!==i.next;)if(E=i.prev,S=i.next,_?By(i,c,f,_):Sg(i))e.push(E.i/o|0),e.push(i.i/o|0),e.push(S.i/o|0),Ku(i),i=S.next,k=S.next;else if((i=S)===k){v?v===1?ds(i=Uc(qu(i),e,o),e,o,c,f,_,2):v===2&&Zp(i,e,o,c,f,_):ds(qu(i),e,o,c,f,_,1);break}}}function Sg(i){var e=i.prev,o=i,c=i.next;if(eo(e,o,c)>=0)return!1;for(var f=e.x,_=o.x,v=c.x,E=e.y,S=o.y,k=c.y,L=f<_?f<v?f:v:_<v?_:v,z=E<S?E<k?E:k:S<k?S:k,N=f>_?f>v?f:v:_>v?_:v,W=E>S?E>k?E:k:S>k?S:k,q=c.next;q!==e;){if(q.x>=L&&q.x<=N&&q.y>=z&&q.y<=W&&$c(f,E,_,S,v,k,q.x,q.y)&&eo(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function By(i,e,o,c){var f=i.prev,_=i,v=i.next;if(eo(f,_,v)>=0)return!1;for(var E=f.x,S=_.x,k=v.x,L=f.y,z=_.y,N=v.y,W=E<S?E<k?E:k:S<k?S:k,q=L<z?L<N?L:N:z<N?z:N,X=E>S?E>k?E:k:S>k?S:k,le=L>z?L>N?L:N:z>N?z:N,ve=Pf(W,q,e,o,c),Re=Pf(X,le,e,o,c),be=i.prevZ,Pe=i.nextZ;be&&be.z>=ve&&Pe&&Pe.z<=Re;){if(be.x>=W&&be.x<=X&&be.y>=q&&be.y<=le&&be!==f&&be!==v&&$c(E,L,S,z,k,N,be.x,be.y)&&eo(be.prev,be,be.next)>=0||(be=be.prevZ,Pe.x>=W&&Pe.x<=X&&Pe.y>=q&&Pe.y<=le&&Pe!==f&&Pe!==v&&$c(E,L,S,z,k,N,Pe.x,Pe.y)&&eo(Pe.prev,Pe,Pe.next)>=0))return!1;Pe=Pe.nextZ}for(;be&&be.z>=ve;){if(be.x>=W&&be.x<=X&&be.y>=q&&be.y<=le&&be!==f&&be!==v&&$c(E,L,S,z,k,N,be.x,be.y)&&eo(be.prev,be,be.next)>=0)return!1;be=be.prevZ}for(;Pe&&Pe.z<=Re;){if(Pe.x>=W&&Pe.x<=X&&Pe.y>=q&&Pe.y<=le&&Pe!==f&&Pe!==v&&$c(E,L,S,z,k,N,Pe.x,Pe.y)&&eo(Pe.prev,Pe,Pe.next)>=0)return!1;Pe=Pe.nextZ}return!0}function Uc(i,e,o){var c=i;do{var f=c.prev,_=c.next.next;!If(f,_)&&Lf(f,c,c.next,_)&&Hu(f,_)&&Hu(_,f)&&(e.push(f.i/o|0),e.push(c.i/o|0),e.push(_.i/o|0),Ku(c),Ku(c.next),c=i=_),c=c.next}while(c!==i);return qu(c)}function Zp(i,e,o,c,f,_){var v=i;do{for(var E=v.next.next;E!==v.prev;){if(v.i!==E.i&&Ny(v,E)){var S=C1(v,E);return v=qu(v,v.next),S=qu(S,S.next),ds(v,e,o,c,f,_,0),void ds(S,e,o,c,f,_,0)}E=E.next}v=v.next}while(v!==i)}function Gu(i,e){return i.x-e.x}function Hp(i,e){var o=function(f,_){var v,E=_,S=f.x,k=f.y,L=-1/0;do{if(k<=E.y&&k>=E.next.y&&E.next.y!==E.y){var z=E.x+(k-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(z<=S&&z>L&&(L=z,v=E.x<E.next.x?E:E.next,z===S))return v}E=E.next}while(E!==_);if(!v)return null;var N,W=v,q=v.x,X=v.y,le=1/0;E=v;do S>=E.x&&E.x>=q&&S!==E.x&&$c(k<X?S:L,k,q,X,k<X?L:S,k,E.x,E.y)&&(N=Math.abs(k-E.y)/(S-E.x),Hu(E,f)&&(N<le||N===le&&(E.x>v.x||E.x===v.x&&kg(v,E)))&&(v=E,le=N)),E=E.next;while(E!==W);return v}(i,e);if(!o)return e;var c=C1(o,i);return qu(c,c.next),qu(o,o.next)}function kg(i,e){return eo(i.prev,i,e.prev)<0&&eo(e.next,i,i.next)<0}function Pf(i,e,o,c,f){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-o)*f|0)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-c)*f|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function jy(i){var e=i,o=i;do(e.x<o.x||e.x===o.x&&e.y<o.y)&&(o=e),e=e.next;while(e!==i);return o}function $c(i,e,o,c,f,_,v,E){return(f-v)*(e-E)>=(i-v)*(_-E)&&(i-v)*(c-E)>=(o-v)*(e-E)&&(o-v)*(_-E)>=(f-v)*(c-E)}function Ny(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function(o,c){var f=o;do{if(f.i!==o.i&&f.next.i!==o.i&&f.i!==c.i&&f.next.i!==c.i&&Lf(f,f.next,o,c))return!0;f=f.next}while(f!==o);return!1}(i,e)&&(Hu(i,e)&&Hu(e,i)&&function(o,c){var f=o,_=!1,v=(o.x+c.x)/2,E=(o.y+c.y)/2;do f.y>E!=f.next.y>E&&f.next.y!==f.y&&v<(f.next.x-f.x)*(E-f.y)/(f.next.y-f.y)+f.x&&(_=!_),f=f.next;while(f!==o);return _}(i,e)&&(eo(i.prev,i,e.prev)||eo(i,e.prev,e))||If(i,e)&&eo(i.prev,i,i.next)>0&&eo(e.prev,e,e.next)>0)}function eo(i,e,o){return(e.y-i.y)*(o.x-e.x)-(e.x-i.x)*(o.y-e.y)}function If(i,e){return i.x===e.x&&i.y===e.y}function Lf(i,e,o,c){var f=Rf(eo(i,e,o)),_=Rf(eo(i,e,c)),v=Rf(eo(o,c,i)),E=Rf(eo(o,c,e));return f!==_&&v!==E||!(f!==0||!Zu(i,o,e))||!(_!==0||!Zu(i,c,e))||!(v!==0||!Zu(o,i,c))||!(E!==0||!Zu(o,e,c))}function Zu(i,e,o){return e.x<=Math.max(i.x,o.x)&&e.x>=Math.min(i.x,o.x)&&e.y<=Math.max(i.y,o.y)&&e.y>=Math.min(i.y,o.y)}function Rf(i){return i>0?1:i<0?-1:0}function Hu(i,e){return eo(i.prev,i,i.next)<0?eo(i,e,i.next)>=0&&eo(i,i.prev,e)>=0:eo(i,e,i.prev)<0||eo(i,i.next,e)<0}function C1(i,e){var o=new Jh(i.i,i.x,i.y),c=new Jh(e.i,e.x,e.y),f=i.next,_=e.prev;return i.next=e,e.prev=i,o.next=f,f.prev=o,c.next=o,o.prev=c,_.next=c,c.prev=_,c}function Mg(i,e,o,c){var f=new Jh(i,e,o);return c?(f.next=c.next,f.prev=c,c.next.prev=f,c.next=f):(f.prev=f,f.next=f),f}function Ku(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Jh(i,e,o){this.i=i,this.x=e,this.y=o,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Of(i,e,o,c){for(var f=0,_=e,v=o-c;_<o;_+=c)f+=(i[v]-i[_])*(i[_+1]+i[v+1]),v=_;return f}Tg.exports=Af,Tg.exports.default=Af,Af.deviation=function(i,e,o,c){var f=e&&e.length,_=Math.abs(Of(i,0,f?e[0]*o:i.length,o));if(f)for(var v=0,E=e.length;v<E;v++)_-=Math.abs(Of(i,e[v]*o,v<E-1?e[v+1]*o:i.length,o));var S=0;for(v=0;v<c.length;v+=3){var k=c[v]*o,L=c[v+1]*o,z=c[v+2]*o;S+=Math.abs((i[k]-i[z])*(i[L+1]-i[k+1])-(i[k]-i[L])*(i[z+1]-i[k+1]))}return _===0&&S===0?0:Math.abs((S-_)/_)},Af.flatten=function(i){for(var e=i[0][0].length,o={vertices:[],holes:[],dimensions:e},c=0,f=0;f<i.length;f++){for(var _=0;_<i[f].length;_++)for(var v=0;v<e;v++)o.vertices.push(i[f][_][v]);f>0&&o.holes.push(c+=i[f-1].length)}return o};var Qh=Ie(Tg.exports);function S1(i,e,o,c,f){k1(i,e,o,c||i.length-1,f||Fy)}function k1(i,e,o,c,f){for(;c>o;){if(c-o>600){var _=c-o+1,v=e-o+1,E=Math.log(_),S=.5*Math.exp(2*E/3),k=.5*Math.sqrt(E*S*(_-S)/_)*(v-_/2<0?-1:1);k1(i,e,Math.max(o,Math.floor(e-v*S/_+k)),Math.min(c,Math.floor(e+(_-v)*S/_+k)),f)}var L=i[e],z=o,N=c;for(Vc(i,o,e),f(i[c],L)>0&&Vc(i,o,c);z<N;){for(Vc(i,z,N),z++,N--;f(i[z],L)<0;)z++;for(;f(i[N],L)>0;)N--}f(i[o],L)===0?Vc(i,o,N):Vc(i,++N,c),N<=e&&(o=N+1),e<=N&&(c=N-1)}}function Vc(i,e,o){var c=i[e];i[e]=i[o],i[o]=c}function Fy(i,e){return i<e?-1:i>e?1:0}function Xu(i,e){const o=i.length;if(o<=1)return[i];const c=[];let f,_;for(let v=0;v<o;v++){const E=nr(i[v]);E!==0&&(i[v].area=Math.abs(E),_===void 0&&(_=E<0),_===E<0?(f&&c.push(f),f=[i[v]]):f.push(i[v]))}if(f&&c.push(f),e>1)for(let v=0;v<c.length;v++)c[v].length<=e||(S1(c[v],e,1,c[v].length-1,Uy),c[v]=c[v].slice(0,e));return c}function Uy(i,e){return e.area-i.area}function ed(i,e,o){const c=o.patternDependencies;let f=!1;for(const _ of e){const v=_.paint.get(`${i}-pattern`);v.isConstant()||(f=!0);const E=v.constantOr(null);E&&(f=!0,c[E]=!0)}return f}function u(i,e,o,c,f){const _=f.patternDependencies;for(const v of e){const E=v.paint.get(`${i}-pattern`).value;if(E.kind!=="constant"){let S=E.evaluate({zoom:c},o,{},f.availableImages);S=S&&S.name?S.name:S,_[S]=!0,o.patterns[v.id]=S}}return o}class p{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Kt,this.indexArray=new jn,this.indexArray2=new qi,this.programConfigurations=new Lc(e.layers,e.zoom),this.segments=new Ji,this.segments2=new Ji,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.projection=e.projection}populate(e,o,c,f){this.hasPattern=ed("fill",this.layers,o);const _=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:E,id:S,index:k,sourceLayerIndex:L}of e){const z=this.layers[0]._featureFilter.needGeometry,N=js(E,z);if(!this.layers[0]._featureFilter.filter(new O(this.zoom),N,c))continue;const W=_?_.evaluate(N,{},c,o.availableImages):void 0,q={id:S,properties:E.properties,type:E.type,sourceLayerIndex:L,index:k,geometry:z?N.geometry:Wa(E,c,f),patterns:{},sortKey:W};v.push(q)}_&&v.sort((E,S)=>E.sortKey-S.sortKey);for(const E of v){const{geometry:S,index:k,sourceLayerIndex:L}=E;if(this.hasPattern){const z=u("fill",this.layers,E,this.zoom,o);this.patternFeatures.push(z)}else this.addFeature(E,S,k,c,{},o.availableImages);o.featureIndex.insert(e[k].feature,S,k,L,this.index)}}update(e,o,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,c,f)}addFeatures(e,o,c,f,_){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,o,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,zy),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,o,c,f,_,v=[]){for(const E of Xu(o,500)){let S=0;for(const q of E)S+=q.length;const k=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),L=k.vertexLength,z=[],N=[];for(const q of E){if(q.length===0)continue;q!==E[0]&&N.push(z.length/2);const X=this.segments2.prepareSegment(q.length,this.layoutVertexArray,this.indexArray2),le=X.vertexLength;this.layoutVertexArray.emplaceBack(q[0].x,q[0].y),this.indexArray2.emplaceBack(le+q.length-1,le),z.push(q[0].x),z.push(q[0].y);for(let ve=1;ve<q.length;ve++)this.layoutVertexArray.emplaceBack(q[ve].x,q[ve].y),this.indexArray2.emplaceBack(le+ve-1,le+ve),z.push(q[ve].x),z.push(q[ve].y);X.vertexLength+=q.length,X.primitiveLength+=q.length}const W=Qh(z,N);for(let q=0;q<W.length;q+=3)this.indexArray.emplaceBack(L+W[q],L+W[q+1],L+W[q+2]);k.vertexLength+=S,k.primitiveLength+=W.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,_,v,f)}}gn(p,"FillBucket",{omit:["layers","patternFeatures"]});const b=new Ce({"fill-sort-key":new ue(Te.layout_fill["fill-sort-key"])});var A={paint:new Ce({"fill-antialias":new K(Te.paint_fill["fill-antialias"]),"fill-opacity":new ue(Te.paint_fill["fill-opacity"]),"fill-color":new ue(Te.paint_fill["fill-color"]),"fill-outline-color":new ue(Te.paint_fill["fill-outline-color"]),"fill-translate":new K(Te.paint_fill["fill-translate"]),"fill-translate-anchor":new K(Te.paint_fill["fill-translate-anchor"]),"fill-pattern":new ue(Te.paint_fill["fill-pattern"])}),layout:b};const D=Ye([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),V=Ye([{name:"a_centroid_pos",components:2,type:"Uint16"}]),re=Ye([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:De}=D;var Xe={},Ct=et,rn=on;function on(i,e,o,c,f){this.properties={},this.extent=o,this.type=0,this._pbf=i,this._geometry=-1,this._keys=c,this._values=f,i.readFields(nn,this,e)}function nn(i,e,o){i==1?e.id=o.readVarint():i==2?function(c,f){for(var _=c.readVarint()+c.pos;c.pos<_;){var v=f._keys[c.readVarint()],E=f._values[c.readVarint()];f.properties[v]=E}}(o,e):i==3?e.type=o.readVarint():i==4&&(e._geometry=o.pos)}function Un(i){for(var e,o,c=0,f=0,_=i.length,v=_-1;f<_;v=f++)c+=((o=i[v]).x-(e=i[f]).x)*(e.y+o.y);return c}on.types=["Unknown","Point","LineString","Polygon"],on.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var e,o=i.readVarint()+i.pos,c=1,f=0,_=0,v=0,E=[];i.pos<o;){if(f<=0){var S=i.readVarint();c=7&S,f=S>>3}if(f--,c===1||c===2)_+=i.readSVarint(),v+=i.readSVarint(),c===1&&(e&&E.push(e),e=[]),e.push(new Ct(_,v));else{if(c!==7)throw new Error("unknown command "+c);e&&e.push(e[0].clone())}}return e&&E.push(e),E},on.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var e=i.readVarint()+i.pos,o=1,c=0,f=0,_=0,v=1/0,E=-1/0,S=1/0,k=-1/0;i.pos<e;){if(c<=0){var L=i.readVarint();o=7&L,c=L>>3}if(c--,o===1||o===2)(f+=i.readSVarint())<v&&(v=f),f>E&&(E=f),(_+=i.readSVarint())<S&&(S=_),_>k&&(k=_);else if(o!==7)throw new Error("unknown command "+o)}return[v,S,E,k]},on.prototype.toGeoJSON=function(i,e,o){var c,f,_=this.extent*Math.pow(2,o),v=this.extent*i,E=this.extent*e,S=this.loadGeometry(),k=on.types[this.type];function L(W){for(var q=0;q<W.length;q++){var X=W[q];W[q]=[360*(X.x+v)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(X.y+E)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var z=[];for(c=0;c<S.length;c++)z[c]=S[c][0];L(S=z);break;case 2:for(c=0;c<S.length;c++)L(S[c]);break;case 3:for(S=function(W){var q=W.length;if(q<=1)return[W];for(var X,le,ve=[],Re=0;Re<q;Re++){var be=Un(W[Re]);be!==0&&(le===void 0&&(le=be<0),le===be<0?(X&&ve.push(X),X=[W[Re]]):X.push(W[Re]))}return X&&ve.push(X),ve}(S),c=0;c<S.length;c++)for(f=0;f<S[c].length;f++)L(S[c][f])}S.length===1?S=S[0]:k="Multi"+k;var N={type:"Feature",geometry:{type:k,coordinates:S},properties:this.properties};return"id"in this&&(N.id=this.id),N};var Jn=rn,er=ho;function ho(i,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(_t,this,e),this.length=this._features.length}function _t(i,e,o){i===15?e.version=o.readVarint():i===1?e.name=o.readString():i===5?e.extent=o.readVarint():i===2?e._features.push(o.pos):i===3?e._keys.push(o.readString()):i===4&&e._values.push(function(c){for(var f=null,_=c.readVarint()+c.pos;c.pos<_;){var v=c.readVarint()>>3;f=v===1?c.readString():v===2?c.readFloat():v===3?c.readDouble():v===4?c.readVarint64():v===5?c.readVarint():v===6?c.readSVarint():v===7?c.readBoolean():null}return f}(o))}ho.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var e=this._pbf.readVarint()+this._pbf.pos;return new Jn(this._pbf,e,this.extent,this._keys,this._values)};var nt=er;function Et(i,e,o){if(i===3){var c=new nt(o,o.readVarint()+o.pos);c.length&&(e[c.name]=c)}}var dn=Xe.VectorTile=function(i,e){this.layers=i.readFields(Et,{},e)},tr=Xe.VectorTileFeature=rn;function gr(i,e,o,c){const f=[],_=c===0?(v,E,S,k,L,z)=>{v.push(new ge(z,S+(z-E)/(k-E)*(L-S)))}:(v,E,S,k,L,z)=>{v.push(new ge(E+(z-S)/(L-S)*(k-E),z))};for(const v of i){const E=[];for(const S of v){if(S.length<=2)continue;const k=[];for(let N=0;N<S.length-1;N++){const W=S[N].x,q=S[N].y,X=S[N+1].x,le=S[N+1].y,ve=c===0?W:q,Re=c===0?X:le;ve<e?Re>e&&_(k,W,q,X,le,e):ve>o?Re<o&&_(k,W,q,X,le,o):k.push(S[N]),Re<e&&ve>=e&&_(k,W,q,X,le,e),Re>o&&ve<=o&&_(k,W,q,X,le,o)}let L=S[S.length-1];const z=c===0?L.x:L.y;z>=e&&z<=o&&k.push(L),k.length&&(L=k[k.length-1],k[0].x===L.x&&k[0].y===L.y||k.push(k[0]),E.push(k))}E.length&&f.push(E)}return f}Xe.VectorTileLayer=er;const Tr=tr.types,Dr=Math.pow(2,13);function fo(i,e,o,c,f,_,v,E){i.emplaceBack((e<<1)+v,(o<<1)+_,(Math.floor(c*Dr)<<1)+f,Math.round(E))}function ri(i,e,o){i.emplaceBack(e.x,e.y,e.z,o[0]*16384,o[1]*16384,o[2]*16384)}class ql{constructor(){this.acc=new ge(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new ge(e.x,e.y),this.max=new ge(e.x,e.y))}append(e,o){this.currentPolyCount.edges++,this.acc._add(e);const c=this.min,f=this.max;e.x<c.x?c.x=e.x:e.x>f.x&&(f.x=e.x),e.y<c.y?c.y=e.y:e.y>f.y&&(f.y=e.y),((e.x===0||e.x===Wn)&&e.x===o.x)!=((e.y===0||e.y===Wn)&&e.y===o.y)&&this.processBorderOverlap(e,o),o.x<0!=e.x<0&&this.addBorderIntersection(0,qr(o.y,e.y,(0-o.x)/(e.x-o.x))),o.x>Wn!=e.x>Wn&&this.addBorderIntersection(1,qr(o.y,e.y,(Wn-o.x)/(e.x-o.x))),o.y<0!=e.y<0&&this.addBorderIntersection(2,qr(o.x,e.x,(0-o.y)/(e.y-o.y))),o.y>Wn!=e.y>Wn&&this.addBorderIntersection(3,qr(o.x,e.x,(Wn-o.y)/(e.y-o.y)))}addBorderIntersection(e,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[e];o<c[0]&&(c[0]=o),o>c[1]&&(c[1]=o)}processBorderOverlap(e,o){if(e.x===o.x){if(e.y===o.y)return;const c=e.x===0?0:1;this.addBorderIntersection(c,o.y),this.addBorderIntersection(c,e.y)}else{const c=e.y===0?2:3;this.addBorderIntersection(c,o.x),this.addBorderIntersection(c,e.x)}}centroid(){const e=this.polyCount.reduce((o,c)=>o+c.edges,0);return e!==0?this.acc.div(e)._round():new ge(0,0)}span(){return new ge(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,o)=>e+ +(o[0]!==Number.MAX_VALUE),0)}}class Df{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Mt,this.centroidVertexArray=new Js,this.indexArray=new jn,this.programConfigurations=new Lc(e.layers,e.zoom),this.segments=new Ji,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.enableTerrain=e.enableTerrain}populate(e,o,c,f){this.features=[],this.hasPattern=ed("fill-extrusion",this.layers,o),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(_){const v=Math.exp(Math.PI*(1-_.y/(1<<_.z)*2));return 80150034*v/(v*v+1)/Wn/(1<<_.z)}(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:_,id:v,index:E,sourceLayerIndex:S}of e){const k=this.layers[0]._featureFilter.needGeometry,L=js(_,k);if(!this.layers[0]._featureFilter.filter(new O(this.zoom),L,c))continue;const z={id:v,sourceLayerIndex:S,index:E,geometry:k?L.geometry:Wa(_,c,f),properties:_.properties,type:_.type,patterns:{}},N=this.layoutVertexArray.length;this.hasPattern?this.features.push(u("fill-extrusion",this.layers,z,this.zoom,o)):this.addFeature(z,z.geometry,E,c,{},o.availableImages,f),o.featureIndex.insert(_,z.geometry,E,S,this.index,N)}this.sortBorders()}addFeatures(e,o,c,f,_){for(const v of this.features){const{geometry:E}=v;this.addFeature(v,E,v.index,o,c,f,_)}this.sortBorders()}update(e,o,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,De),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,re.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,V.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,o,c,f,_,v,E){const S=[new ge(0,0),new ge(Wn,Wn)],k=E.projection,L=k.name==="globe",z=this.enableTerrain&&!L?new ql:null,N=Tr[e.type]==="Polygon";L&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Ht);const W=Xu(o,500);for(let ve=W.length-1;ve>=0;ve--){const Re=W[ve];(Re.length===0||(q=Re[0]).every(be=>be.x<=0)||q.every(be=>be.x>=Wn)||q.every(be=>be.y<=0)||q.every(be=>be.y>=Wn))&&W.splice(ve,1)}var q;let X;if(L)X=Mb(W,S,f);else{X=[];for(const ve of W)X.push({polygon:ve,bounds:S})}const le=N?this.edgeRadius:0;for(const{polygon:ve,bounds:Re}of X){let be=0,Pe=0;for(const ze of ve)N&&!ze[0].equals(ze[ze.length-1])&&ze.push(ze[0]),Pe+=N?ze.length-1:ze.length;const Be=this.segments.prepareSegment((N?5:4)*Pe,this.layoutVertexArray,this.indexArray);if(N){const ze=[],ft=[];be=Be.vertexLength;for(const Pt of ve){let Jt,vt;Pt.length&&Pt!==ve[0]&&ft.push(ze.length/2),Jt=Pt[1].sub(Pt[0])._perp()._unit();for(let Rt=1;Rt<Pt.length;Rt++){const Ot=Pt[Rt],Vt=Pt[Rt===Pt.length-1?1:Rt+1];let{x:Qt,y:kt}=Ot;if(le){vt=Vt.sub(Ot)._perp()._unit();const pn=Jt.add(vt)._unit(),Rn=le*Math.min(4,1/(Jt.x*pn.x+Jt.y*pn.y));Qt+=Rn*pn.x,kt+=Rn*pn.y,Jt=vt}fo(this.layoutVertexArray,Qt,kt,0,0,1,1,0),Be.vertexLength++,ze.push(Ot.x,Ot.y),L&&ri(this.layoutVertexExtArray,k.projectTilePoint(Qt,kt,f),k.upVector(f,Qt,kt))}}const ct=Qh(ze,ft);for(let Pt=0;Pt<ct.length;Pt+=3)this.indexArray.emplaceBack(be+ct[Pt],be+ct[Pt+2],be+ct[Pt+1]),Be.primitiveLength++}for(const ze of ve){z&&ze.length&&z.startRing(ze[0]);let ft,ct,Pt,Jt=ze.length>4&&Cb(ze[ze.length-2],ze[0],ze[1]),vt=le?Y6(ze[ze.length-2],ze[0],ze[1],le):0;ct=ze[1].sub(ze[0])._perp()._unit();let Rt=!0;for(let Ot=1,Vt=0;Ot<ze.length;Ot++){let Qt=ze[Ot-1],kt=ze[Ot];const pn=ze[Ot===ze.length-1?1:Ot+1];if(z&&N&&z.currentPolyCount.top++,Tb(kt,Qt,Re)){le&&(ct=pn.sub(kt)._perp()._unit(),Rt=!Rt);continue}z&&z.append(kt,Qt);const Rn=kt.sub(Qt)._perp(),_n=Rn.x/(Math.abs(Rn.x)+Math.abs(Rn.y)),Mr=Rn.y>0?1:0,en=Qt.dist(kt);if(Vt+en>32768&&(Vt=0),le){Pt=pn.sub(kt)._perp()._unit();let Pr=Eb(Qt,kt,pn,bb(ct,Pt),le);isNaN(Pr)&&(Pr=0);const lr=kt.sub(Qt)._unit();Qt=Qt.add(lr.mult(vt))._round(),kt=kt.add(lr.mult(-Pr))._round(),vt=Pr,ct=Pt}const Kn=Be.vertexLength,Ar=ze.length>4&&Cb(Qt,kt,pn);let ii=Sb(Vt,Jt,Rt);if(fo(this.layoutVertexArray,Qt.x,Qt.y,_n,Mr,0,0,ii),fo(this.layoutVertexArray,Qt.x,Qt.y,_n,Mr,0,1,ii),Vt+=en,ii=Sb(Vt,Ar,!Rt),Jt=Ar,fo(this.layoutVertexArray,kt.x,kt.y,_n,Mr,0,0,ii),fo(this.layoutVertexArray,kt.x,kt.y,_n,Mr,0,1,ii),Be.vertexLength+=4,this.indexArray.emplaceBack(Kn+0,Kn+1,Kn+2),this.indexArray.emplaceBack(Kn+1,Kn+3,Kn+2),Be.primitiveLength+=2,le){const Pr=be+(Ot===1?ze.length-2:Ot-2),lr=Ot===1?be:Pr+1;if(this.indexArray.emplaceBack(Kn+1,Pr,Kn+3),this.indexArray.emplaceBack(Pr,lr,Kn+3),Be.primitiveLength+=2,ft===void 0&&(ft=Kn),!Tb(pn,ze[Ot],Re)){const Ii=Ot===ze.length-1?ft:Be.vertexLength;this.indexArray.emplaceBack(Kn+2,Kn+3,Ii),this.indexArray.emplaceBack(Kn+3,Ii+1,Ii),this.indexArray.emplaceBack(Kn+3,lr,Ii+1),Be.primitiveLength+=3}Rt=!Rt}if(L){const Pr=this.layoutVertexExtArray,lr=k.projectTilePoint(Qt.x,Qt.y,f),Ii=k.projectTilePoint(kt.x,kt.y,f),Lr=k.upVector(f,Qt.x,Qt.y),Rr=k.upVector(f,kt.x,kt.y);ri(Pr,lr,Lr),ri(Pr,lr,Lr),ri(Pr,Ii,Rr),ri(Pr,Ii,Rr)}}N&&(be+=ze.length-1)}}if(z&&z.polyCount.length>0){if(z.borders){z.vertexArrayOffset=this.centroidVertexArray.length;const ve=z.borders,Re=this.featuresOnBorder.push(z)-1;for(let be=0;be<4;be++)ve[be][0]!==Number.MAX_VALUE&&this.borders[be].push(Re)}this.encodeCentroid(z.borders?void 0:z.centroid(),z)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,_,v,f)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((o,c)=>this.featuresOnBorder[o].borders[e][0]-this.featuresOnBorder[c].borders[e][0])}encodeCentroid(e,o,c=!0){let f,_;if(e)if(e.y!==0){const E=o.span()._mult(this.tileToMeter);f=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(E.x/10)),_=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(E.y/10))}else f=Math.ceil(7*(e.x+450)),_=0;else f=0,_=+c;let v=c?this.centroidVertexArray.length:o.vertexArrayOffset;for(const E of o.polyCount){c&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*E.edges+E.top);for(let S=0;S<E.top;S++)this.centroidVertexArray.emplace(v++,f,_);for(let S=0;S<2*E.edges;S++)this.centroidVertexArray.emplace(v++,0,_),this.centroidVertexArray.emplace(v++,f,_)}}}function bb(i,e){const o=i.add(e)._unit();return i.x*o.x+i.y*o.y}function Y6(i,e,o,c){const f=e.sub(i)._perp()._unit(),_=o.sub(e)._perp()._unit();return Eb(i,e,o,bb(f,_),c)}function Eb(i,e,o,c,f){const _=Math.sqrt(1-c*c);return Math.min(i.dist(e)/3,e.dist(o)/3,f*_/c)}function Tb(i,e,o){return i.x<o[0].x&&e.x<o[0].x||i.x>o[1].x&&e.x>o[1].x||i.y<o[0].y&&e.y<o[0].y||i.y>o[1].y&&e.y>o[1].y}function Cb(i,e,o){if(i.x<0||i.x>=Wn||e.x<0||e.x>=Wn||o.x<0||o.x>=Wn)return!1;const c=o.sub(e),f=c.perp(),_=i.sub(e);return(c.x*_.x+c.y*_.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(_.x*_.x+_.y*_.y))>-.866&&f.x*_.x+f.y*_.y<0}function Sb(i,e,o){const c=e?2|i:-3&i;return o?1|c:-2&c}function kb(){const i=Math.PI/32,e=Math.tan(i),o=Tf;return o*Math.sqrt(1+2*e*e)-o}function Mb(i,e,o){const c=1<<o.z,f=Hi(o.x/c),_=Hi((o.x+1)/c),v=io(o.y/c),E=io((o.y+1)/c);return function(S,k,L,z,N=0,W){const q=[];if(!S.length||!L||!z)return q;const X=(ze,ft)=>{for(const ct of ze)q.push({polygon:ct,bounds:ft})},le=Math.ceil(Math.log2(L)),ve=Math.ceil(Math.log2(z)),Re=le-ve,be=[];for(let ze=0;ze<Math.abs(Re);ze++)be.push(Re>0?0:1);for(let ze=0;ze<Math.min(le,ve);ze++)be.push(0),be.push(1);let Pe=S;if(Pe=gr(Pe,k[0].y-N,k[1].y+N,1),Pe=gr(Pe,k[0].x-N,k[1].x+N,0),!Pe.length)return q;const Be=[];for(be.length?Be.push({polygons:Pe,bounds:k,depth:0}):X(Pe,k);Be.length;){const ze=Be.pop(),ft=ze.depth,ct=be[ft],Pt=ze.bounds[0],Jt=ze.bounds[1],vt=ct===0?Pt.x:Pt.y,Rt=ct===0?Jt.x:Jt.y,Ot=W?W(ct,vt,Rt):.5*(vt+Rt),Vt=gr(ze.polygons,vt-N,Ot+N,ct),Qt=gr(ze.polygons,Ot-N,Rt+N,ct);if(Vt.length){const kt=[Pt,new ge(ct===0?Ot:Jt.x,ct===1?Ot:Jt.y)];be.length>ft+1?Be.push({polygons:Vt,bounds:kt,depth:ft+1}):X(Vt,kt)}if(Qt.length){const kt=[new ge(ct===0?Ot:Pt.x,ct===1?Ot:Pt.y),Jt];be.length>ft+1?Be.push({polygons:Qt,bounds:kt,depth:ft+1}):X(Qt,kt)}}return q}(i,e,Math.ceil((_-f)/11.25),Math.ceil((v-E)/11.25),1,(S,k,L)=>{if(S===0)return .5*(k+L);{const z=io((o.y+k/Wn)/c);return(Ti(.5*(io((o.y+L/Wn)/c)+z))*c-o.y)*Wn}})}gn(Df,"FillExtrusionBucket",{omit:["layers","features"]}),gn(ql,"PartMetadata");const J6=new Ce({"fill-extrusion-edge-radius":new K(Te["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Q6={paint:new Ce({"fill-extrusion-opacity":new K(Te["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ue(Te["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new K(Te["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new K(Te["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ue(Te["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ue(Te["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ue(Te["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new K(Te["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new K(Te["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new K(Te["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new K(Te["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:J6};function Ab(i,e,o){var c=2*Math.PI*6378137/256/Math.pow(2,o);return[i*c-2*Math.PI*6378137/2,e*c-2*Math.PI*6378137/2]}class M1{constructor(e,o,c){this.z=e,this.x=o,this.y=c,this.key=Ag(0,e,e,o,c)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,o){const c=function(_,v,E){var S=Ab(256*_,256*(v=Math.pow(2,E)-v-1),E),k=Ab(256*(_+1),256*(v+1),E);return S[0]+","+S[1]+","+k[0]+","+k[1]}(this.x,this.y,this.z),f=function(_,v,E){let S,k="";for(let L=_;L>0;L--)S=1<<L-1,k+=(v&S?1:0)+(E&S?2:0);return k}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Pb{constructor(e,o){this.wrap=e,this.canonical=o,this.key=Ag(e,o.z,o.z,o.x,o.y)}}class Ns{constructor(e,o,c,f,_){this.overscaledZ=e,this.wrap=o,this.canonical=new M1(c,+f,+_),this.key=o===0&&e===c?this.canonical.key:Ag(o,e,c,f,_)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const o=this.canonical.z-e;return e>this.canonical.z?new Ns(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ns(e,this.wrap,e,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(e,o=!0){if(this.overscaledZ===e&&o)return this.key;if(e>this.canonical.z)return Ag(this.wrap*+o,e,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-e;return Ag(this.wrap*+o,e,e,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const o=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>o&&e.canonical.y===this.canonical.y>>o}children(e){if(this.overscaledZ>=e)return[new Ns(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,c=2*this.canonical.x,f=2*this.canonical.y;return[new Ns(o,this.wrap,o,c,f),new Ns(o,this.wrap,o,c+1,f),new Ns(o,this.wrap,o,c,f+1),new Ns(o,this.wrap,o,c+1,f+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Ns(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ns(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Pb(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Ag(i,e,o,c,f){const _=1<<Math.min(o,22);let v=_*(f%_)+c%_;return i&&o<22&&(v+=_*_*((i<0?-2*i-1:2*i)%(1<<2*(22-o)))),16*(32*v+o)+(e-o)}gn(M1,"CanonicalTileID"),gn(Ns,"OverscaledTileID",{omit:["projMatrix"]});class Kp extends ge{constructor(e,o,c){super(e,o),this.z=c}}function Pg(i,e){return i.x*e.x+i.y*e.y}function Ib(i,e){if(i.length===1){let o=0;const c=e[o++];let f;for(;!f||c.equals(f);)if(f=e[o++],!f)return 1/0;for(;o<e.length;o++){const _=e[o],v=i[0],E=f.sub(c),S=_.sub(c),k=v.sub(c),L=Pg(E,E),z=Pg(E,S),N=Pg(S,S),W=Pg(k,E),q=Pg(k,S),X=L*N-z*z,le=(N*W-z*q)/X,ve=(L*q-z*W)/X,Re=c.z*(1-le-ve)+f.z*le+_.z*ve;if(isFinite(Re))return Re}return 1/0}{let o=1/0;for(const c of e)o=Math.min(o,c.z);return o}}function Lb(i,e,o,c,f,_,v,E){const S=v*f.getElevationAt(i,e,!0,!0),k=_[0]!==0,L=k?_[1]===0?v*(_[0]/7-450):v*function(z,N,W){const q=Math.floor(N[0]/8),X=Math.floor(N[1]/8),le=10*(N[0]-8*q),ve=10*(N[1]-8*X),Re=z.getElevationAt(q,X,!0,!0),be=z.getMeterToDEM(W),Pe=Math.floor(.5*(le*be-1)),Be=Math.floor(.5*(ve*be-1)),ze=z.tileCoordToPixel(q,X),ft=2*Pe+1,ct=2*Be+1,Pt=function(Qt,kt,pn,Rn,_n){return[Qt.getElevationAtPixel(kt,pn,!0),Qt.getElevationAtPixel(kt+_n,pn,!0),Qt.getElevationAtPixel(kt,pn+_n,!0),Qt.getElevationAtPixel(kt+Rn,pn+_n,!0)]}(z,ze.x-Pe,ze.y-Be,ft,ct),Jt=Math.abs(Pt[0]-Pt[1]),vt=Math.abs(Pt[2]-Pt[3]),Rt=Math.abs(Pt[0]-Pt[2])+Math.abs(Pt[1]-Pt[3]),Ot=Math.min(.25,.5*be*(Jt+vt)/ft),Vt=Math.min(.25,.5*be*Rt/ct);return Re+Math.max(Ot*le,Vt*ve)}(f,_,E):S;return{base:S+(o===0)?-1:o,top:k?Math.max(L+c,S+o+2):S+c}}const e8=Ye([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:t8}=e8,n8=Ye([{name:"a_packed",components:4,type:"Float32"}]),{members:r8}=n8,i8=tr.types,o8=Math.cos(Math.PI/180*37.5);class A1{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new gt,this.layoutVertexArray2=new Zt,this.indexArray=new jn,this.programConfigurations=new Lc(e.layers,e.zoom),this.segments=new Ji,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,c,f){this.hasPattern=ed("line",this.layers,o);const _=this.layers[0].layout.get("line-sort-key"),v=[];for(const{feature:L,id:z,index:N,sourceLayerIndex:W}of e){const q=this.layers[0]._featureFilter.needGeometry,X=js(L,q);if(!this.layers[0]._featureFilter.filter(new O(this.zoom),X,c))continue;const le=_?_.evaluate(X,{},c):void 0,ve={id:z,properties:L.properties,type:L.type,sourceLayerIndex:W,index:N,geometry:q?X.geometry:Wa(L,c,f),patterns:{},sortKey:le};v.push(ve)}_&&v.sort((L,z)=>L.sortKey-z.sortKey);const{lineAtlas:E,featureIndex:S}=o,k=this.addConstantDashes(E);for(const L of v){const{geometry:z,index:N,sourceLayerIndex:W}=L;if(k&&this.addFeatureDashes(L,E),this.hasPattern){const q=u("line",this.layers,L,this.zoom,o);this.patternFeatures.push(q)}else this.addFeature(L,z,N,c,E.positions,o.availableImages);S.insert(e[N].feature,z,N,W,this.index)}}addConstantDashes(e){let o=!1;for(const c of this.layers){const f=c.paint.get("line-dasharray").value,_=c.layout.get("line-cap").value;if(f.kind!=="constant"||_.kind!=="constant")o=!0;else{const v=_.value,E=f.value;if(!E)continue;e.addDash(E,v)}}return o}addFeatureDashes(e,o){const c=this.zoom;for(const f of this.layers){const _=f.paint.get("line-dasharray").value,v=f.layout.get("line-cap").value;if(_.kind==="constant"&&v.kind==="constant")continue;let E,S;if(_.kind==="constant"){if(E=_.value,!E)continue}else E=_.evaluate({zoom:c},e);S=v.kind==="constant"?v.value:v.evaluate({zoom:c},e),o.addDash(E,S),e.patterns[f.id]=o.getKey(E,S)}}update(e,o,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,c,f)}addFeatures(e,o,c,f,_){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,o,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,r8)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,t8),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,o,c,f,_,v){const E=this.layers[0].layout,S=E.get("line-join").evaluate(e,{}),k=E.get("line-cap").evaluate(e,{}),L=E.get("line-miter-limit"),z=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const N of o)this.addLine(N,e,S,k,L,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,_,v,f)}addLine(e,o,c,f,_,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ve=0;ve<e.length-1;ve++)this.totalDistance+=e[ve].dist(e[ve+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const E=i8[o.type]==="Polygon";let S=e.length;for(;S>=2&&e[S-1].equals(e[S-2]);)S--;let k=0;for(;k<S-1&&e[k].equals(e[k+1]);)k++;if(S<(E?3:2))return;c==="bevel"&&(_=1.05);const L=this.overscaling<=16?15*Wn/(512*this.overscaling):0,z=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let N,W,q,X,le;this.e1=this.e2=-1,E&&(N=e[S-2],le=e[k].sub(N)._unit()._perp());for(let ve=k;ve<S;ve++){if(q=ve===S-1?E?e[k+1]:void 0:e[ve+1],q&&e[ve].equals(q))continue;le&&(X=le),N&&(W=N),N=e[ve],le=q?q.sub(N)._unit()._perp():X,X=X||le;let Re=X.add(le);Re.x===0&&Re.y===0||Re._unit();const be=X.x*le.x+X.y*le.y,Pe=Re.x*le.x+Re.y*le.y,Be=Pe!==0?1/Pe:1/0,ze=2*Math.sqrt(2-2*Pe),ft=Pe<o8&&W&&q,ct=X.x*le.y-X.y*le.x>0;if(ft&&ve>k){const vt=N.dist(W);if(vt>2*L){const Rt=N.sub(N.sub(W)._mult(L/vt)._round());this.updateDistance(W,Rt),this.addCurrentVertex(Rt,X,0,0,z),W=Rt}}const Pt=W&&q;let Jt=Pt?c:E?"butt":f;if(Pt&&Jt==="round"&&(Be<v?Jt="miter":Be<=2&&(Jt="fakeround")),Jt==="miter"&&Be>_&&(Jt="bevel"),Jt==="bevel"&&(Be>2&&(Jt="flipbevel"),Be<_&&(Jt="miter")),W&&this.updateDistance(W,N),Jt==="miter")Re._mult(Be),this.addCurrentVertex(N,Re,0,0,z);else if(Jt==="flipbevel"){if(Be>100)Re=le.mult(-1);else{const vt=Be*X.add(le).mag()/X.sub(le).mag();Re._perp()._mult(vt*(ct?-1:1))}this.addCurrentVertex(N,Re,0,0,z),this.addCurrentVertex(N,Re.mult(-1),0,0,z)}else if(Jt==="bevel"||Jt==="fakeround"){const vt=-Math.sqrt(Be*Be-1),Rt=ct?vt:0,Ot=ct?0:vt;if(W&&this.addCurrentVertex(N,X,Rt,Ot,z),Jt==="fakeround"){const Vt=Math.round(180*ze/Math.PI/20);for(let Qt=1;Qt<Vt;Qt++){let kt=Qt/Vt;if(kt!==.5){const Rn=kt-.5;kt+=kt*Rn*(kt-1)*((1.0904+be*(be*(3.55645-1.43519*be)-3.2452))*Rn*Rn+(.848013+be*(.215638*be-1.06021)))}const pn=le.sub(X)._mult(kt)._add(X)._unit()._mult(ct?-1:1);this.addHalfVertex(N,pn.x,pn.y,!1,ct,0,z)}}q&&this.addCurrentVertex(N,le,-Rt,-Ot,z)}else if(Jt==="butt")this.addCurrentVertex(N,Re,0,0,z);else if(Jt==="square"){const vt=W?1:-1;W||this.addCurrentVertex(N,Re,vt,vt,z),this.addCurrentVertex(N,Re,0,0,z),W&&this.addCurrentVertex(N,Re,vt,vt,z)}else Jt==="round"&&(W&&(this.addCurrentVertex(N,X,0,0,z),this.addCurrentVertex(N,X,1,1,z,!0)),q&&(this.addCurrentVertex(N,le,-1,-1,z,!0),this.addCurrentVertex(N,le,0,0,z)));if(ft&&ve<S-1){const vt=N.dist(q);if(vt>2*L){const Rt=N.add(q.sub(N)._mult(L/vt)._round());this.updateDistance(N,Rt),this.addCurrentVertex(Rt,le,0,0,z),N=Rt}}}}addCurrentVertex(e,o,c,f,_,v=!1){const E=o.y*f-o.x,S=-o.y-o.x*f;this.addHalfVertex(e,o.x+o.y*c,o.y-o.x*c,v,!1,c,_),this.addHalfVertex(e,E,S,v,!0,-f,_)}addHalfVertex({x:e,y:o},c,f,_,v,E,S){this.layoutVertexArray.emplaceBack((e<<1)+(_?1:0),(o<<1)+(v?1:0),Math.round(63*c)+128,Math.round(63*f)+128,1+(E===0?0:E<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const k=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),S.primitiveLength++),v?this.e2=k:this.e1=k}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,o){this.distance+=e.dist(o),this.updateScaledDistance()}}gn(A1,"LineBucket",{omit:["layers","patternFeatures"]});const s8=new Ce({"line-cap":new ue(Te.layout_line["line-cap"]),"line-join":new ue(Te.layout_line["line-join"]),"line-miter-limit":new K(Te.layout_line["line-miter-limit"]),"line-round-limit":new K(Te.layout_line["line-round-limit"]),"line-sort-key":new ue(Te.layout_line["line-sort-key"])});var Rb={paint:new Ce({"line-opacity":new ue(Te.paint_line["line-opacity"]),"line-color":new ue(Te.paint_line["line-color"]),"line-translate":new K(Te.paint_line["line-translate"]),"line-translate-anchor":new K(Te.paint_line["line-translate-anchor"]),"line-width":new ue(Te.paint_line["line-width"]),"line-gap-width":new ue(Te.paint_line["line-gap-width"]),"line-offset":new ue(Te.paint_line["line-offset"]),"line-blur":new ue(Te.paint_line["line-blur"]),"line-dasharray":new ue(Te.paint_line["line-dasharray"]),"line-pattern":new ue(Te.paint_line["line-pattern"]),"line-gradient":new Ee(Te.paint_line["line-gradient"]),"line-trim-offset":new K(Te.paint_line["line-trim-offset"])}),layout:s8};const Ob=new class extends ue{possiblyEvaluate(i,e){return e=new O(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(i,e)}evaluate(i,e,o,c){return e=vn({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(i,e,o,c)}}(Rb.paint.properties["line-width"].specification);function Db(i,e){return e>0?e+2*i:i}Ob.useIntegerZoom=!0;const a8=Ye([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),l8=Ye([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),c8=Ye([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ye([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const u8=Ye([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),h8=Ye([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Ye([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const zb=Ye([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),d8=Ye([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ye([{name:"triangle",components:3,type:"Uint16"}]),Ye([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ye([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ye([{type:"Float32",name:"offsetX"}]),Ye([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Qo=24;const Gl=128;function $y(i,e){const{expression:o}=e;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new O(i+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:f}=o;let _=0;for(;_<c.length&&c[_]<=i;)_++;_=Math.max(0,_-1);let v=_;for(;v<c.length&&c[v]<i+1;)v++;v=Math.min(c.length-1,v);const E=c[_],S=c[v];return o.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:S,interpolationType:f}:{kind:"camera",minZoom:E,maxZoom:S,minSize:o.evaluate(new O(E)),maxSize:o.evaluate(new O(S)),interpolationType:f}}}function P1(i,{uSize:e,uSizeT:o},{lowerSize:c,upperSize:f}){return i.kind==="source"?c/Gl:i.kind==="composite"?qr(c/Gl,f/Gl,o):e}function Xp(i,e){let o=0,c=0;if(i.kind==="constant")c=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:f,minZoom:_,maxZoom:v}=i,E=f?Bt(is.interpolationFactor(f,e,_,v),0,1):0;i.kind==="camera"?c=qr(i.minSize,i.maxSize,E):o=E}return{uSizeT:o,uSize:c}}var f8=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Gl,evaluateSizeForFeature:P1,evaluateSizeForZoom:Xp,getSizeData:$y});function p8(i,e,o){return i.sections.forEach(c=>{c.text=function(f,_,v){const E=_.layout.get("text-transform").evaluate(v,{});return E==="uppercase"?f=f.toLocaleUpperCase():E==="lowercase"&&(f=f.toLocaleLowerCase()),I.applyArabicShaping&&(f=I.applyArabicShaping(f)),f}(c.text,e,o)}),i}const Ig={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function m8(i){return i==="︶"||i==="﹈"||i==="︸"||i==="﹄"||i==="﹂"||i==="︾"||i==="︼"||i==="︺"||i==="︘"||i==="﹀"||i==="︐"||i==="︓"||i==="︔"||i==="｀"||i==="￣"||i==="︑"||i==="︒"}function g8(i){return i==="︵"||i==="﹇"||i==="︷"||i==="﹃"||i==="﹁"||i==="︽"||i==="︻"||i==="︹"||i==="︗"||i==="︿"}var Bb=Ci,jb=function(i,e,o,c,f){var _,v,E=8*f-c-1,S=(1<<E)-1,k=S>>1,L=-7,z=f-1,N=-1,W=i[e+z];for(z+=N,_=W&(1<<-L)-1,W>>=-L,L+=E;L>0;_=256*_+i[e+z],z+=N,L-=8);for(v=_&(1<<-L)-1,_>>=-L,L+=c;L>0;v=256*v+i[e+z],z+=N,L-=8);if(_===0)_=1-k;else{if(_===S)return v?NaN:1/0*(W?-1:1);v+=Math.pow(2,c),_-=k}return(W?-1:1)*v*Math.pow(2,_-c)},Nb=function(i,e,o,c,f,_){var v,E,S,k=8*_-f-1,L=(1<<k)-1,z=L>>1,N=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,W=0,q=1,X=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(E=isNaN(e)?1:0,v=L):(v=Math.floor(Math.log(e)/Math.LN2),e*(S=Math.pow(2,-v))<1&&(v--,S*=2),(e+=v+z>=1?N/S:N*Math.pow(2,1-z))*S>=2&&(v++,S/=2),v+z>=L?(E=0,v=L):v+z>=1?(E=(e*S-1)*Math.pow(2,f),v+=z):(E=e*Math.pow(2,z-1)*Math.pow(2,f),v=0));f>=8;i[o+W]=255&E,W+=q,E/=256,f-=8);for(v=v<<f|E,k+=f;k>0;i[o+W]=255&v,W+=q,v/=256,k-=8);i[o+W-q]|=128*X};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Ci(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}Ci.Varint=0,Ci.Fixed64=1,Ci.Bytes=2,Ci.Fixed32=5;var Vy=4294967296,Fb=1/Vy,Ub=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Yu(i){return i.type===Ci.Bytes?i.readVarint()+i.pos:i.pos+1}function Yp(i,e,o){return o?4294967296*e+(i>>>0):4294967296*(e>>>0)+(i>>>0)}function $b(i,e,o){var c=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));o.realloc(c);for(var f=o.pos-1;f>=i;f--)o.buf[f+c]=o.buf[f]}function _8(i,e){for(var o=0;o<i.length;o++)e.writeVarint(i[o])}function y8(i,e){for(var o=0;o<i.length;o++)e.writeSVarint(i[o])}function v8(i,e){for(var o=0;o<i.length;o++)e.writeFloat(i[o])}function x8(i,e){for(var o=0;o<i.length;o++)e.writeDouble(i[o])}function w8(i,e){for(var o=0;o<i.length;o++)e.writeBoolean(i[o])}function b8(i,e){for(var o=0;o<i.length;o++)e.writeFixed32(i[o])}function E8(i,e){for(var o=0;o<i.length;o++)e.writeSFixed32(i[o])}function T8(i,e){for(var o=0;o<i.length;o++)e.writeFixed64(i[o])}function C8(i,e){for(var o=0;o<i.length;o++)e.writeSFixed64(i[o])}function I1(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+16777216*i[e+3]}function Jp(i,e,o){i[o]=e,i[o+1]=e>>>8,i[o+2]=e>>>16,i[o+3]=e>>>24}function Vb(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+(i[e+3]<<24)}Ci.prototype={destroy:function(){this.buf=null},readFields:function(i,e,o){for(o=o||this.length;this.pos<o;){var c=this.readVarint(),f=c>>3,_=this.pos;this.type=7&c,i(f,e,this),this.pos===_&&this.skip(c)}return e},readMessage:function(i,e){return this.readFields(i,e,this.readVarint()+this.pos)},readFixed32:function(){var i=I1(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=Vb(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=I1(this.buf,this.pos)+I1(this.buf,this.pos+4)*Vy;return this.pos+=8,i},readSFixed64:function(){var i=I1(this.buf,this.pos)+Vb(this.buf,this.pos+4)*Vy;return this.pos+=8,i},readFloat:function(){var i=jb(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=jb(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var e,o,c=this.buf;return e=127&(o=c[this.pos++]),o<128?e:(e|=(127&(o=c[this.pos++]))<<7,o<128?e:(e|=(127&(o=c[this.pos++]))<<14,o<128?e:(e|=(127&(o=c[this.pos++]))<<21,o<128?e:function(f,_,v){var E,S,k=v.buf;if(E=(112&(S=k[v.pos++]))>>4,S<128||(E|=(127&(S=k[v.pos++]))<<3,S<128)||(E|=(127&(S=k[v.pos++]))<<10,S<128)||(E|=(127&(S=k[v.pos++]))<<17,S<128)||(E|=(127&(S=k[v.pos++]))<<24,S<128)||(E|=(1&(S=k[v.pos++]))<<31,S<128))return Yp(f,E,_);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(o=c[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,e=this.pos;return this.pos=i,i-e>=12&&Ub?function(o,c,f){return Ub.decode(o.subarray(c,f))}(this.buf,e,i):function(o,c,f){for(var _="",v=c;v<f;){var E,S,k,L=o[v],z=null,N=L>239?4:L>223?3:L>191?2:1;if(v+N>f)break;N===1?L<128&&(z=L):N===2?(192&(E=o[v+1]))==128&&(z=(31&L)<<6|63&E)<=127&&(z=null):N===3?(S=o[v+2],(192&(E=o[v+1]))==128&&(192&S)==128&&((z=(15&L)<<12|(63&E)<<6|63&S)<=2047||z>=55296&&z<=57343)&&(z=null)):N===4&&(S=o[v+2],k=o[v+3],(192&(E=o[v+1]))==128&&(192&S)==128&&(192&k)==128&&((z=(15&L)<<18|(63&E)<<12|(63&S)<<6|63&k)<=65535||z>=1114112)&&(z=null)),z===null?(z=65533,N=1):z>65535&&(z-=65536,_+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),_+=String.fromCharCode(z),v+=N}return _}(this.buf,e,i)},readBytes:function(){var i=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,i);return this.pos=i,e},readPackedVarint:function(i,e){if(this.type!==Ci.Bytes)return i.push(this.readVarint(e));var o=Yu(this);for(i=i||[];this.pos<o;)i.push(this.readVarint(e));return i},readPackedSVarint:function(i){if(this.type!==Ci.Bytes)return i.push(this.readSVarint());var e=Yu(this);for(i=i||[];this.pos<e;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==Ci.Bytes)return i.push(this.readBoolean());var e=Yu(this);for(i=i||[];this.pos<e;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==Ci.Bytes)return i.push(this.readFloat());var e=Yu(this);for(i=i||[];this.pos<e;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==Ci.Bytes)return i.push(this.readDouble());var e=Yu(this);for(i=i||[];this.pos<e;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==Ci.Bytes)return i.push(this.readFixed32());var e=Yu(this);for(i=i||[];this.pos<e;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==Ci.Bytes)return i.push(this.readSFixed32());var e=Yu(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==Ci.Bytes)return i.push(this.readFixed64());var e=Yu(this);for(i=i||[];this.pos<e;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==Ci.Bytes)return i.push(this.readSFixed64());var e=Yu(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed64());return i},skip:function(i){var e=7&i;if(e===Ci.Varint)for(;this.buf[this.pos++]>127;);else if(e===Ci.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Ci.Fixed32)this.pos+=4;else{if(e!==Ci.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(i,e){this.writeVarint(i<<3|e)},realloc:function(i){for(var e=this.length||16;e<this.pos+i;)e*=2;if(e!==this.length){var o=new Uint8Array(e);o.set(this.buf),this.buf=o,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),Jp(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),Jp(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),Jp(this.buf,-1&i,this.pos),Jp(this.buf,Math.floor(i*Fb),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),Jp(this.buf,-1&i,this.pos),Jp(this.buf,Math.floor(i*Fb),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(e,o){var c,f;if(e>=0?(c=e%4294967296|0,f=e/4294967296|0):(f=~(-e/4294967296),4294967295^(c=~(-e%4294967296))?c=c+1|0:(c=0,f=f+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(_,v,E){E.buf[E.pos++]=127&_|128,_>>>=7,E.buf[E.pos++]=127&_|128,_>>>=7,E.buf[E.pos++]=127&_|128,_>>>=7,E.buf[E.pos++]=127&_|128,E.buf[E.pos]=127&(_>>>=7)}(c,0,o),function(_,v){var E=(7&_)<<4;v.buf[v.pos++]|=E|((_>>>=3)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_)))))}(f,o)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var e=this.pos;this.pos=function(c,f,_){for(var v,E,S=0;S<f.length;S++){if((v=f.charCodeAt(S))>55295&&v<57344){if(!E){v>56319||S+1===f.length?(c[_++]=239,c[_++]=191,c[_++]=189):E=v;continue}if(v<56320){c[_++]=239,c[_++]=191,c[_++]=189,E=v;continue}v=E-55296<<10|v-56320|65536,E=null}else E&&(c[_++]=239,c[_++]=191,c[_++]=189,E=null);v<128?c[_++]=v:(v<2048?c[_++]=v>>6|192:(v<65536?c[_++]=v>>12|224:(c[_++]=v>>18|240,c[_++]=v>>12&63|128),c[_++]=v>>6&63|128),c[_++]=63&v|128)}return _}(this.buf,i,this.pos);var o=this.pos-e;o>=128&&$b(e,o,this),this.pos=e-1,this.writeVarint(o),this.pos+=o},writeFloat:function(i){this.realloc(4),Nb(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),Nb(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var e=i.length;this.writeVarint(e),this.realloc(e);for(var o=0;o<e;o++)this.buf[this.pos++]=i[o]},writeRawMessage:function(i,e){this.pos++;var o=this.pos;i(e,this);var c=this.pos-o;c>=128&&$b(o,c,this),this.pos=o-1,this.writeVarint(c),this.pos+=c},writeMessage:function(i,e,o){this.writeTag(i,Ci.Bytes),this.writeRawMessage(e,o)},writePackedVarint:function(i,e){e.length&&this.writeMessage(i,_8,e)},writePackedSVarint:function(i,e){e.length&&this.writeMessage(i,y8,e)},writePackedBoolean:function(i,e){e.length&&this.writeMessage(i,w8,e)},writePackedFloat:function(i,e){e.length&&this.writeMessage(i,v8,e)},writePackedDouble:function(i,e){e.length&&this.writeMessage(i,x8,e)},writePackedFixed32:function(i,e){e.length&&this.writeMessage(i,b8,e)},writePackedSFixed32:function(i,e){e.length&&this.writeMessage(i,E8,e)},writePackedFixed64:function(i,e){e.length&&this.writeMessage(i,T8,e)},writePackedSFixed64:function(i,e){e.length&&this.writeMessage(i,C8,e)},writeBytesField:function(i,e){this.writeTag(i,Ci.Bytes),this.writeBytes(e)},writeFixed32Field:function(i,e){this.writeTag(i,Ci.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(i,e){this.writeTag(i,Ci.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(i,e){this.writeTag(i,Ci.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(i,e){this.writeTag(i,Ci.Fixed64),this.writeSFixed64(e)},writeVarintField:function(i,e){this.writeTag(i,Ci.Varint),this.writeVarint(e)},writeSVarintField:function(i,e){this.writeTag(i,Ci.Varint),this.writeSVarint(e)},writeStringField:function(i,e){this.writeTag(i,Ci.Bytes),this.writeString(e)},writeFloatField:function(i,e){this.writeTag(i,Ci.Fixed32),this.writeFloat(e)},writeDoubleField:function(i,e){this.writeTag(i,Ci.Fixed64),this.writeDouble(e)},writeBooleanField:function(i,e){this.writeVarintField(i,!!e)}};var L1=Ie(Bb);const Wy=3;function S8(i,e,o){e.glyphs=[],i===1&&o.readMessage(k8,e)}function k8(i,e,o){if(i===3){const{id:c,bitmap:f,width:_,height:v,left:E,top:S,advance:k}=o.readMessage(M8,{});e.glyphs.push({id:c,bitmap:new Wl({width:_+2*Wy,height:v+2*Wy},f),metrics:{width:_,height:v,left:E,top:S,advance:k}})}else i===4?e.ascender=o.readSVarint():i===5&&(e.descender=o.readSVarint())}function M8(i,e,o){i===1?e.id=o.readVarint():i===2?e.bitmap=o.readBytes():i===3?e.width=o.readVarint():i===4?e.height=o.readVarint():i===5?e.left=o.readSVarint():i===6?e.top=o.readSVarint():i===7&&(e.advance=o.readVarint())}const Wb=Wy;function qy(i){let e=0,o=0;for(const v of i)e+=v.w*v.h,o=Math.max(o,v.w);i.sort((v,E)=>E.h-v.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),o),h:1/0}];let f=0,_=0;for(const v of i)for(let E=c.length-1;E>=0;E--){const S=c[E];if(!(v.w>S.w||v.h>S.h)){if(v.x=S.x,v.y=S.y,_=Math.max(_,v.y+v.h),f=Math.max(f,v.x+v.w),v.w===S.w&&v.h===S.h){const k=c.pop();E<c.length&&(c[E]=k)}else v.h===S.h?(S.x+=v.w,S.w-=v.w):v.w===S.w?(S.y+=v.h,S.h-=v.h):(c.push({x:S.x+v.w,y:S.y,w:S.w-v.w,h:v.h}),S.y+=v.h,S.h-=v.h);break}}return{w:f,h:_,fill:e/(f*_)||0}}const sa=1;class Gy{constructor(e,{pixelRatio:o,version:c,stretchX:f,stretchY:_,content:v}){this.paddedRect=e,this.pixelRatio=o,this.stretchX=f,this.stretchY=_,this.content=v,this.version=c}get tl(){return[this.paddedRect.x+sa,this.paddedRect.y+sa]}get br(){return[this.paddedRect.x+this.paddedRect.w-sa,this.paddedRect.y+this.paddedRect.h-sa]}get displaySize(){return[(this.paddedRect.w-2*sa)/this.pixelRatio,(this.paddedRect.h-2*sa)/this.pixelRatio]}}class qb{constructor(e,o){const c={},f={};this.haveRenderCallbacks=[];const _=[];this.addImages(e,c,_),this.addImages(o,f,_);const{w:v,h:E}=qy(_),S=new zo({width:v||1,height:E||1});for(const k in e){const L=e[k],z=c[k].paddedRect;zo.copy(L.data,S,{x:0,y:0},{x:z.x+sa,y:z.y+sa},L.data)}for(const k in o){const L=o[k],z=f[k].paddedRect,N=z.x+sa,W=z.y+sa,q=L.data.width,X=L.data.height;zo.copy(L.data,S,{x:0,y:0},{x:N,y:W},L.data),zo.copy(L.data,S,{x:0,y:X-1},{x:N,y:W-1},{width:q,height:1}),zo.copy(L.data,S,{x:0,y:0},{x:N,y:W+X},{width:q,height:1}),zo.copy(L.data,S,{x:q-1,y:0},{x:N-1,y:W},{width:1,height:X}),zo.copy(L.data,S,{x:0,y:0},{x:N+q,y:W},{width:1,height:X})}this.image=S,this.iconPositions=c,this.patternPositions=f}addImages(e,o,c){for(const f in e){const _=e[f],v={x:0,y:0,w:_.data.width+2*sa,h:_.data.height+2*sa};c.push(v),o[f]=new Gy(v,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(e,o){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(c=>e.hasImage(c)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in e.updatedImages)this.patchUpdatedImage(this.iconPositions[c],e.getImage(c),o),this.patchUpdatedImage(this.patternPositions[c],e.getImage(c),o)}patchUpdatedImage(e,o,c){if(!e||!o||e.version===o.version)return;e.version=o.version;const[f,_]=e.tl;c.update(o.data,void 0,{x:f,y:_})}}gn(Gy,"ImagePosition"),gn(qb,"ImageAtlas");const Ga={horizontal:1,vertical:2,horizontalOnly:3},Gb=-17;class Lg{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,o){const c=new Lg;return c.scale=e||1,c.fontStack=o,c}static forImage(e){const o=new Lg;return o.imageName=e,o}}class Qp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,o){const c=new Qp;for(let f=0;f<e.sections.length;f++){const _=e.sections[f];_.image?c.addImageSection(_):c.addTextSection(_,o)}return c}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(o,c){let f="";for(let _=0;_<o.length;_++){const v=o.charCodeAt(_+1)||null,E=o.charCodeAt(_-1)||null;f+=!c&&(v&&xs(v)&&!Ig[o[_+1]]||E&&xs(E)&&!Ig[o[_-1]])||!Ig[o[_]]?o[_]:Ig[o[_]]}return f}(this.text,e)}trim(){let e=0;for(let c=0;c<this.text.length&&R1[this.text.charCodeAt(c)];c++)e++;let o=this.text.length;for(let c=this.text.length-1;c>=0&&c>=e&&R1[this.text.charCodeAt(c)];c--)o--;this.text=this.text.substring(e,o),this.sectionIndex=this.sectionIndex.slice(e,o)}substring(e,o){const c=new Qp;return c.text=this.text.substring(e,o),c.sectionIndex=this.sectionIndex.slice(e,o),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,o)=>Math.max(e,this.sections[o].scale),0)}addTextSection(e,o){this.text+=e.text,this.sections.push(Lg.forText(e.scale,e.fontStack||o));const c=this.sections.length-1;for(let f=0;f<e.text.length;++f)this.sectionIndex.push(c)}addImageSection(e){const o=e.image?e.image.name:"";if(o.length===0)return void Nn("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(Lg.forImage(o)),this.sectionIndex.push(this.sections.length-1)):Nn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Zy(i,e,o,c,f,_,v,E,S,k,L,z,N,W,q){const X=Qp.fromFeature(i,f);z===Ga.vertical&&X.verticalizePunctuation(N);let le=[];const ve=function(ze,ft,ct,Pt,Jt,vt){if(!ze)return[];const Rt=[],Ot=function(pn,Rn,_n,Mr,en,Kn){let Ar=0;for(let ii=0;ii<pn.length();ii++){const Pr=pn.getSection(ii);Ar+=Zb(pn.getCharCode(ii),Pr,Mr,en,Rn,Kn)}return Ar/Math.max(1,Math.ceil(Ar/_n))}(ze,ft,ct,Pt,Jt,vt),Vt=ze.text.indexOf("​")>=0;let Qt=0;for(let pn=0;pn<ze.length();pn++){const Rn=ze.getSection(pn),_n=ze.getCharCode(pn);if(R1[_n]||(Qt+=Zb(_n,Rn,Pt,Jt,ft,vt)),pn<ze.length()-1){const Mr=!((kt=_n)<11904||!(un["Bopomofo Extended"](kt)||un.Bopomofo(kt)||un["CJK Compatibility Forms"](kt)||un["CJK Compatibility Ideographs"](kt)||un["CJK Compatibility"](kt)||un["CJK Radicals Supplement"](kt)||un["CJK Strokes"](kt)||un["CJK Symbols and Punctuation"](kt)||un["CJK Unified Ideographs Extension A"](kt)||un["CJK Unified Ideographs"](kt)||un["Enclosed CJK Letters and Months"](kt)||un["Halfwidth and Fullwidth Forms"](kt)||un.Hiragana(kt)||un["Ideographic Description Characters"](kt)||un["Kangxi Radicals"](kt)||un["Katakana Phonetic Extensions"](kt)||un.Katakana(kt)||un["Vertical Forms"](kt)||un["Yi Radicals"](kt)||un["Yi Syllables"](kt)));(A8[_n]||Mr||Rn.imageName)&&Rt.push(Kb(pn+1,Qt,Ot,Rt,P8(_n,ze.getCharCode(pn+1),Mr&&Vt),!1))}}var kt;return Xb(Kb(ze.length(),Qt,Ot,Rt,0,!0))}(X,k,_,e,c,W),{processBidirectionalText:Re,processStyledBidirectionalText:be}=I;if(Re&&X.sections.length===1){const ze=Re(X.toString(),ve);for(const ft of ze){const ct=new Qp;ct.text=ft,ct.sections=X.sections;for(let Pt=0;Pt<ft.length;Pt++)ct.sectionIndex.push(0);le.push(ct)}}else if(be){const ze=be(X.text,X.sectionIndex,ve);for(const ft of ze){const ct=new Qp;ct.text=ft[0],ct.sectionIndex=ft[1],ct.sections=X.sections,le.push(ct)}}else le=function(ze,ft){const ct=[],Pt=ze.text;let Jt=0;for(const vt of ft)ct.push(ze.substring(Jt,vt)),Jt=vt;return Jt<Pt.length&&ct.push(ze.substring(Jt,Pt.length)),ct}(X,ve);const Pe=[],Be={positionedLines:Pe,text:X.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:z,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ze,ft,ct,Pt,Jt,vt,Rt,Ot,Vt,Qt,kt,pn){let Rn=0,_n=0,Mr=0;const en=Ot==="right"?1:Ot==="left"?0:.5;let Kn=!1;for(const Lr of Jt){const Rr=Lr.getSections();for(const vi of Rr){if(vi.imageName)continue;const Si=ft[vi.fontStack];if(Si&&(Kn=Si.ascender!==void 0&&Si.descender!==void 0,!Kn))break}if(!Kn)break}let Ar=0;for(const Lr of Jt){Lr.trim();const Rr=Lr.getMaxScale(),vi=(Rr-1)*Qo,Si={positionedGlyphs:[],lineOffset:0};ze.positionedLines[Ar]=Si;const ki=Si.positionedGlyphs;let xi=0;if(!Lr.length()){_n+=vt,++Ar;continue}let Ki=0,oo=0;for(let wi=0;wi<Lr.length();wi++){const Mo=Lr.getSection(wi),yo=Lr.getSectionIndex(wi),to=Lr.getCharCode(wi);let ai=Mo.scale,vo=null,Mi=null,Fs=null,xo=Qo,es=0;const Vo=!(Vt===Ga.horizontal||!kt&&!Mc(to)||kt&&(R1[to]||(ii=to,un.Arabic(ii)||un["Arabic Supplement"](ii)||un["Arabic Extended-A"](ii)||un["Arabic Presentation Forms-A"](ii)||un["Arabic Presentation Forms-B"](ii))));if(Mo.imageName){const Us=Pt[Mo.imageName];if(!Us)continue;Fs=Mo.imageName,ze.iconsInText=ze.iconsInText||!0,Mi=Us.paddedRect;const Wo=Us.displaySize;ai=ai*Qo/pn,vo={width:Wo[0],height:Wo[1],left:sa,top:-Wb,advance:Vo?Wo[1]:Wo[0],localGlyph:!1},es=Kn?-vo.height*ai:Gb+Rr*Qo-Wo[1]*ai,xo=vo.advance;const Kl=(Vo?Wo[0]:Wo[1])*ai-Qo*Rr;Kl>0&&Kl>xi&&(xi=Kl)}else{const Us=ct[Mo.fontStack];if(!Us)continue;Us[to]&&(Mi=Us[to]);const Wo=ft[Mo.fontStack];if(!Wo)continue;const Kl=Wo.glyphs[to];if(!Kl)continue;if(vo=Kl.metrics,xo=to!==8203?Qo:0,Kn){const sm=Wo.ascender!==void 0?Math.abs(Wo.ascender):0,$g=Wo.descender!==void 0?Math.abs(Wo.descender):0,Vg=(sm+$g)*ai;Ki<Vg&&(Ki=Vg,oo=(sm-$g)/2*ai),es=-sm*ai}else es=Gb+(Rr-ai)*Qo}Vo?(ze.verticalizable=!0,ki.push({glyph:to,imageName:Fs,x:Rn,y:_n+es,vertical:Vo,scale:ai,localGlyph:vo.localGlyph,fontStack:Mo.fontStack,sectionIndex:yo,metrics:vo,rect:Mi}),Rn+=xo*ai+Qt):(ki.push({glyph:to,imageName:Fs,x:Rn,y:_n+es,vertical:Vo,scale:ai,localGlyph:vo.localGlyph,fontStack:Mo.fontStack,sectionIndex:yo,metrics:vo,rect:Mi}),Rn+=vo.advance*ai+Qt)}ki.length!==0&&(Mr=Math.max(Rn-Qt,Mr),Kn?Yb(ki,en,xi,oo,vt*Rr/2):Yb(ki,en,xi,0,vt/2)),Rn=0;const _o=vt*Rr+xi;Si.lineOffset=Math.max(xi,vi),_n+=_o,++Ar}var ii;const Pr=_n,{horizontalAlign:lr,verticalAlign:Ii}=Hy(Rt);(function(Lr,Rr,vi,Si,ki,xi){const Ki=(Rr-vi)*ki,oo=-xi*Si;for(const _o of Lr)for(const wi of _o.positionedGlyphs)wi.x+=Ki,wi.y+=oo})(ze.positionedLines,en,lr,Ii,Mr,Pr),ze.top+=-Ii*Pr,ze.bottom=ze.top+Pr,ze.left+=-lr*Mr,ze.right=ze.left+Mr,ze.hasBaseline=Kn}(Be,e,o,c,le,v,E,S,z,k,N,q),!function(ze){for(const ft of ze)if(ft.positionedGlyphs.length!==0)return!1;return!0}(Pe)&&Be}const R1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},A8={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Zb(i,e,o,c,f,_){if(e.imageName){const v=c[e.imageName];return v?v.displaySize[0]*e.scale*Qo/_+f:0}{const v=o[e.fontStack],E=v&&v.glyphs[i];return E?E.metrics.advance*e.scale+f:0}}function Hb(i,e,o,c){const f=Math.pow(i-e,2);return c?i<e?f/2:2*f:f+Math.abs(o)*o}function P8(i,e,o){let c=0;return i===10&&(c-=1e4),o&&(c+=150),i!==40&&i!==65288||(c+=50),e!==41&&e!==65289||(c+=50),c}function Kb(i,e,o,c,f,_){let v=null,E=Hb(e,o,f,_);for(const S of c){const k=Hb(e-S.x,o,f,_)+S.badness;k<=E&&(v=S,E=k)}return{index:i,x:e,priorBreak:v,badness:E}}function Xb(i){return i?Xb(i.priorBreak).concat(i.index):[]}function Hy(i){let e=.5,o=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:e,verticalAlign:o}}function Yb(i,e,o,c,f){if(!(e||o||c||f))return;const _=i.length-1,v=i[_],E=(v.x+v.metrics.advance*v.scale)*e;for(let S=0;S<=_;S++)i[S].x-=E,i[S].y+=o+c+f}function I8(i,e,o){const{horizontalAlign:c,verticalAlign:f}=Hy(o),_=e[0]-i.displaySize[0]*c,v=e[1]-i.displaySize[1]*f;return{image:i,top:v,bottom:v+i.displaySize[1],left:_,right:_+i.displaySize[0]}}function Jb(i,e,o,c,f,_){const v=i.image;let E;if(v.content){const le=v.content,ve=v.pixelRatio||1;E=[le[0]/ve,le[1]/ve,v.displaySize[0]-le[2]/ve,v.displaySize[1]-le[3]/ve]}const S=e.left*_,k=e.right*_;let L,z,N,W;o==="width"||o==="both"?(W=f[0]+S-c[3],z=f[0]+k+c[1]):(W=f[0]+(S+k-v.displaySize[0])/2,z=W+v.displaySize[0]);const q=e.top*_,X=e.bottom*_;return o==="height"||o==="both"?(L=f[1]+q-c[0],N=f[1]+X+c[2]):(L=f[1]+(q+X-v.displaySize[1])/2,N=L+v.displaySize[1]),{image:v,top:L,right:z,bottom:N,left:W,collisionPadding:E}}class Ju extends ge{constructor(e,o,c,f,_){super(e,o),this.angle=f,this.z=c,_!==void 0&&(this.segment=_)}clone(){return new Ju(this.x,this.y,this.z,this.angle,this.segment)}}function Qb(i,e,o,c,f){if(e.segment===void 0)return!0;let _=e,v=e.segment+1,E=0;for(;E>-o/2;){if(v--,v<0)return!1;E-=i[v].dist(_),_=i[v]}E+=i[v].dist(i[v+1]),v++;const S=[];let k=0;for(;E<o/2;){const L=i[v],z=i[v+1];if(!z)return!1;let N=i[v-1].angleTo(L)-L.angleTo(z);for(N=Math.abs((N+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:E,angleDelta:N}),k+=N;E-S[0].distance>c;)k-=S.shift().angleDelta;if(k>f)return!1;v++,E+=L.dist(z)}return!0}function e3(i){let e=0;for(let o=0;o<i.length-1;o++)e+=i[o].dist(i[o+1]);return e}function t3(i,e,o){return i?.6*e*o:0}function n3(i,e){return Math.max(i?i.right-i.left:0,e?e.right-e.left:0)}function L8(i,e,o,c,f,_){const v=t3(o,f,_),E=n3(o,c)*_;let S=0;const k=e3(i)/2;for(let L=0;L<i.length-1;L++){const z=i[L],N=i[L+1],W=z.dist(N);if(S+W>k){const q=(k-S)/W,X=qr(z.x,N.x,q),le=qr(z.y,N.y,q),ve=new Ju(X,le,0,N.angleTo(z),L);return!v||Qb(i,ve,E,v,e)?ve:void 0}S+=W}}function R8(i,e,o,c,f,_,v,E,S){const k=t3(c,_,v),L=n3(c,f),z=L*v,N=i[0].x===0||i[0].x===S||i[0].y===0||i[0].y===S;return e-z<e/4&&(e=z+e/4),r3(i,N?e/2*E%e:(L/2+2*_)*v*E%e,e,k,o,z,N,!1,S)}function r3(i,e,o,c,f,_,v,E,S){const k=_/2,L=e3(i);let z=0,N=e-o,W=[];for(let q=0;q<i.length-1;q++){const X=i[q],le=i[q+1],ve=X.dist(le),Re=le.angleTo(X);for(;N+o<z+ve;){N+=o;const be=(N-z)/ve,Pe=qr(X.x,le.x,be),Be=qr(X.y,le.y,be);if(Pe>=0&&Pe<S&&Be>=0&&Be<S&&N-k>=0&&N+k<=L){const ze=new Ju(Pe,Be,0,Re,q);ze._round(),c&&!Qb(i,ze,_,c,f)||W.push(ze)}}z+=ve}return E||W.length||v||(W=r3(i,z/2,o,c,f,_,v,!0,S)),W}function i3(i,e,o,c,f){const _=[];for(let v=0;v<i.length;v++){const E=i[v];let S;for(let k=0;k<E.length-1;k++){let L=E[k],z=E[k+1];L.x<e&&z.x<e||(L.x<e?L=new ge(e,L.y+(e-L.x)/(z.x-L.x)*(z.y-L.y))._round():z.x<e&&(z=new ge(e,L.y+(e-L.x)/(z.x-L.x)*(z.y-L.y))._round()),L.y<o&&z.y<o||(L.y<o?L=new ge(L.x+(o-L.y)/(z.y-L.y)*(z.x-L.x),o)._round():z.y<o&&(z=new ge(L.x+(o-L.y)/(z.y-L.y)*(z.x-L.x),o)._round()),L.x>=c&&z.x>=c||(L.x>=c?L=new ge(c,L.y+(c-L.x)/(z.x-L.x)*(z.y-L.y))._round():z.x>=c&&(z=new ge(c,L.y+(c-L.x)/(z.x-L.x)*(z.y-L.y))._round()),L.y>=f&&z.y>=f||(L.y>=f?L=new ge(L.x+(f-L.y)/(z.y-L.y)*(z.x-L.x),f)._round():z.y>=f&&(z=new ge(L.x+(f-L.y)/(z.y-L.y)*(z.x-L.x),f)._round()),S&&L.equals(S[S.length-1])||(S=[L],_.push(S)),S.push(z)))))}}return _}gn(Ju,"Anchor");const Rg=1e20;function o3(i,e,o,c,f,_,v,E,S){for(let k=e;k<e+c;k++)s3(i,o*_+k,_,f,v,E,S);for(let k=o;k<o+f;k++)s3(i,k*_+e,1,c,v,E,S)}function s3(i,e,o,c,f,_,v){_[0]=0,v[0]=-Rg,v[1]=Rg,f[0]=i[e];for(let E=1,S=0,k=0;E<c;E++){f[E]=i[e+E*o];const L=E*E;do{const z=_[S];k=(f[E]-f[z]+L-z*z)/(E-z)/2}while(k<=v[S]&&--S>-1);S++,_[S]=E,v[S]=k,v[S+1]=Rg}for(let E=0,S=0;E<c;E++){for(;v[S+1]<E;)S++;const k=_[S],L=E-k;i[e+E*o]=f[k]+L*L}}const Zl=2,Ky={none:0,ideographs:1,all:2};class em{constructor(e,o,c){this.requestManager=e,this.localGlyphMode=o,this.localFontFamily=c,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,o){const c=[];for(const f in e)for(const _ of e[f])c.push({stack:f,id:_});sn(c,({stack:f,id:_},v)=>{let E=this.entries[f];E||(E=this.entries[f]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let S=E.glyphs[_];if(S!==void 0)return void v(null,{stack:f,id:_,glyph:S});if(S=this._tinySDF(E,f,_),S)return E.glyphs[_]=S,void v(null,{stack:f,id:_,glyph:S});const k=Math.floor(_/256);if(256*k>65535)return void v(new Error("glyphs > 65535 not supported"));if(E.ranges[k])return void v(null,{stack:f,id:_,glyph:S});let L=E.requests[k];L||(L=E.requests[k]=[],em.loadGlyphRange(f,k,this.url,this.requestManager,(z,N)=>{if(N){E.ascender=N.ascender,E.descender=N.descender;for(const W in N.glyphs)this._doesCharSupportLocalGlyph(+W)||(E.glyphs[+W]=N.glyphs[+W]);E.ranges[k]=!0}for(const W of L)W(z,N);delete E.requests[k]})),L.push((z,N)=>{z?v(z):N&&v(null,{stack:f,id:_,glyph:N.glyphs[_]||null})})},(f,_)=>{if(f)o(f);else if(_){const v={};for(const{stack:E,id:S,glyph:k}of _)v[E]===void 0&&(v[E]={}),v[E].glyphs===void 0&&(v[E].glyphs={}),v[E].glyphs[S]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics},v[E].ascender=this.entries[E].ascender,v[E].descender=this.entries[E].descender;o(null,v)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Ky.none&&(this.localGlyphMode===Ky.all?!!this.localFontFamily:!!this.localFontFamily&&(un["CJK Unified Ideographs"](e)||un["Hangul Syllables"](e)||un.Hiragana(e)||un.Katakana(e)||un["CJK Symbols and Punctuation"](e)))}_tinySDF(e,o,c){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let _=e.tinySDF;if(!_){let X="400";/bold/i.test(o)?X="900":/medium/i.test(o)?X="500":/light/i.test(o)&&(X="200"),_=e.tinySDF=new em.TinySDF({fontFamily:f,fontWeight:X,fontSize:24*Zl,buffer:3*Zl,radius:8*Zl}),_.fontWeight=X}if(this.localGlyphs[_.fontWeight][c])return this.localGlyphs[_.fontWeight][c];const v=String.fromCharCode(c),{data:E,width:S,height:k,glyphWidth:L,glyphHeight:z,glyphLeft:N,glyphTop:W,glyphAdvance:q}=_.draw(v);return this.localGlyphs[_.fontWeight][c]={id:c,bitmap:new Wl({width:S,height:k},E),metrics:{width:L/Zl,height:z/Zl,left:N/Zl,top:W/Zl-27,advance:q/Zl,localGlyph:!0}}}}em.loadGlyphRange=function(i,e,o,c,f){const _=256*e,v=_+255,E=c.transformRequest(c.normalizeGlyphsURL(o).replace("{fontstack}",i).replace("{range}",`${_}-${v}`),ao.Glyphs);go(E,(S,k)=>{if(S)f(S);else if(k){const L={},z=function(N){return new L1(N).readFields(S8,{})}(k);for(const N of z.glyphs)L[N.id]=N;f(null,{glyphs:L,ascender:z.ascender,descender:z.descender})}})},em.TinySDF=class{constructor({fontSize:i=24,buffer:e=3,radius:o=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:_="normal",fontStyle:v="normal"}={}){this.buffer=e,this.cutoff=c,this.radius=o;const E=this.size=i+4*e,S=this._createCanvas(E),k=this.ctx=S.getContext("2d",{willReadFrequently:!0});k.font=`${v} ${_} ${i}px ${f}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(i){const e=document.createElement("canvas");return e.width=e.height=i,e}draw(i){const{width:e,actualBoundingBoxAscent:o,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:_}=this.ctx.measureText(i),v=Math.ceil(o),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-f))),S=Math.min(this.size-this.buffer,v+Math.ceil(c)),k=E+2*this.buffer,L=S+2*this.buffer,z=Math.max(k*L,0),N=new Uint8ClampedArray(z),W={data:N,width:k,height:L,glyphWidth:E,glyphHeight:S,glyphTop:v,glyphLeft:0,glyphAdvance:e};if(E===0||S===0)return W;const{ctx:q,buffer:X,gridInner:le,gridOuter:ve}=this;q.clearRect(X,X,E,S),q.fillText(i,X,X+v);const Re=q.getImageData(X,X,E,S);ve.fill(Rg,0,z),le.fill(0,0,z);for(let be=0;be<S;be++)for(let Pe=0;Pe<E;Pe++){const Be=Re.data[4*(be*E+Pe)+3]/255;if(Be===0)continue;const ze=(be+X)*k+Pe+X;if(Be===1)ve[ze]=0,le[ze]=Rg;else{const ft=.5-Be;ve[ze]=ft>0?ft*ft:0,le[ze]=ft<0?ft*ft:0}}o3(ve,0,0,k,L,k,this.f,this.v,this.z),o3(le,X,X,E,S,k,this.f,this.v,this.z);for(let be=0;be<z;be++){const Pe=Math.sqrt(ve[be])-Math.sqrt(le[be]);N[be]=Math.round(255-255*(Pe/this.radius+this.cutoff))}return W}};const tm=sa;function a3(i,e,o,c){const f=[],_=i.image,v=_.pixelRatio,E=_.paddedRect.w-2*tm,S=_.paddedRect.h-2*tm,k=i.right-i.left,L=i.bottom-i.top,z=_.stretchX||[[0,E]],N=_.stretchY||[[0,S]],W=(vt,Rt)=>vt+Rt[1]-Rt[0],q=z.reduce(W,0),X=N.reduce(W,0),le=E-q,ve=S-X;let Re=0,be=q,Pe=0,Be=X,ze=0,ft=le,ct=0,Pt=ve;if(_.content&&c){const vt=_.content;Re=O1(z,0,vt[0]),Pe=O1(N,0,vt[1]),be=O1(z,vt[0],vt[2]),Be=O1(N,vt[1],vt[3]),ze=vt[0]-Re,ct=vt[1]-Pe,ft=vt[2]-vt[0]-be,Pt=vt[3]-vt[1]-Be}const Jt=(vt,Rt,Ot,Vt)=>{const Qt=D1(vt.stretch-Re,be,k,i.left),kt=z1(vt.fixed-ze,ft,vt.stretch,q),pn=D1(Rt.stretch-Pe,Be,L,i.top),Rn=z1(Rt.fixed-ct,Pt,Rt.stretch,X),_n=D1(Ot.stretch-Re,be,k,i.left),Mr=z1(Ot.fixed-ze,ft,Ot.stretch,q),en=D1(Vt.stretch-Pe,Be,L,i.top),Kn=z1(Vt.fixed-ct,Pt,Vt.stretch,X),Ar=new ge(Qt,pn),ii=new ge(_n,pn),Pr=new ge(_n,en),lr=new ge(Qt,en),Ii=new ge(kt/v,Rn/v),Lr=new ge(Mr/v,Kn/v),Rr=e*Math.PI/180;if(Rr){const ki=Math.sin(Rr),xi=Math.cos(Rr),Ki=[xi,-ki,ki,xi];Ar._matMult(Ki),ii._matMult(Ki),lr._matMult(Ki),Pr._matMult(Ki)}const vi=vt.stretch+vt.fixed,Si=Rt.stretch+Rt.fixed;return{tl:Ar,tr:ii,bl:lr,br:Pr,tex:{x:_.paddedRect.x+tm+vi,y:_.paddedRect.y+tm+Si,w:Ot.stretch+Ot.fixed-vi,h:Vt.stretch+Vt.fixed-Si},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ii,pixelOffsetBR:Lr,minFontScaleX:ft/v/k,minFontScaleY:Pt/v/L,isSDF:o}};if(c&&(_.stretchX||_.stretchY)){const vt=l3(z,le,q),Rt=l3(N,ve,X);for(let Ot=0;Ot<vt.length-1;Ot++){const Vt=vt[Ot],Qt=vt[Ot+1];for(let kt=0;kt<Rt.length-1;kt++)f.push(Jt(Vt,Rt[kt],Qt,Rt[kt+1]))}}else f.push(Jt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:S+1}));return f}function O1(i,e,o){let c=0;for(const f of i)c+=Math.max(e,Math.min(o,f[1]))-Math.max(e,Math.min(o,f[0]));return c}function l3(i,e,o){const c=[{fixed:-tm,stretch:0}];for(const[f,_]of i){const v=c[c.length-1];c.push({fixed:f-v.stretch,stretch:v.stretch}),c.push({fixed:f-v.stretch,stretch:v.stretch+(_-f)})}return c.push({fixed:e+tm,stretch:o}),c}function D1(i,e,o,c){return i/e*o+c}function z1(i,e,o,c){return i-e*o/c}function O8(i,e,o,c){const f=e+i.positionedLines[c].lineOffset;return c===0?o+f/2:o+(f+(e+i.positionedLines[c-1].lineOffset))/2}class D8{constructor(e=[],o=z8){if(this.data=e,this.length=this.data.length,this.compare=o,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:o,compare:c}=this,f=o[e];for(;e>0;){const _=e-1>>1,v=o[_];if(c(f,v)>=0)break;o[e]=v,e=_}o[e]=f}_down(e){const{data:o,compare:c}=this,f=this.length>>1,_=o[e];for(;e<f;){let v=1+(e<<1),E=o[v];const S=v+1;if(S<this.length&&c(o[S],E)<0&&(v=S,E=o[S]),c(E,_)>=0)break;o[e]=E,e=v}o[e]=_}}function z8(i,e){return i<e?-1:i>e?1:0}function B8(i,e=1,o=!1){let c=1/0,f=1/0,_=-1/0,v=-1/0;const E=i[0];for(let W=0;W<E.length;W++){const q=E[W];(!W||q.x<c)&&(c=q.x),(!W||q.y<f)&&(f=q.y),(!W||q.x>_)&&(_=q.x),(!W||q.y>v)&&(v=q.y)}const S=Math.min(_-c,v-f);let k=S/2;const L=new D8([],j8);if(S===0)return new ge(c,f);for(let W=c;W<_;W+=S)for(let q=f;q<v;q+=S)L.push(new nm(W+k,q+k,k,i));let z=function(W){let q=0,X=0,le=0;const ve=W[0];for(let Re=0,be=ve.length,Pe=be-1;Re<be;Pe=Re++){const Be=ve[Re],ze=ve[Pe],ft=Be.x*ze.y-ze.x*Be.y;X+=(Be.x+ze.x)*ft,le+=(Be.y+ze.y)*ft,q+=3*ft}return new nm(X/q,le/q,0,W)}(i),N=L.length;for(;L.length;){const W=L.pop();(W.d>z.d||!z.d)&&(z=W,o&&console.log("found best %d after %d probes",Math.round(1e4*W.d)/1e4,N)),W.max-z.d<=e||(k=W.h/2,L.push(new nm(W.p.x-k,W.p.y-k,k,i)),L.push(new nm(W.p.x+k,W.p.y-k,k,i)),L.push(new nm(W.p.x-k,W.p.y+k,k,i)),L.push(new nm(W.p.x+k,W.p.y+k,k,i)),N+=4)}return o&&(console.log(`num probes: ${N}`),console.log(`best distance: ${z.d}`)),z.p}function j8(i,e){return e.max-i.max}class nm{constructor(e,o,c,f){this.p=new ge(e,o),this.h=c,this.d=function(_,v){let E=!1,S=1/0;for(let k=0;k<v.length;k++){const L=v[k];for(let z=0,N=L.length,W=N-1;z<N;W=z++){const q=L[z],X=L[W];q.y>_.y!=X.y>_.y&&_.x<(X.x-q.x)*(_.y-q.y)/(X.y-q.y)+q.x&&(E=!E),S=Math.min(S,Ss(_,q,X))}}return(E?1:-1)*Math.sqrt(S)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}}const rm=7,Xy=Number.POSITIVE_INFINITY,N8=Math.sqrt(2);function c3(i,[e,o]){let c=0,f=0;if(o===Xy){e<0&&(e=0);const _=e/N8;switch(i){case"top-right":case"top-left":f=_-rm;break;case"bottom-right":case"bottom-left":f=-_+rm;break;case"bottom":f=-e+rm;break;case"top":f=e-rm}switch(i){case"top-right":case"bottom-right":c=-_;break;case"top-left":case"bottom-left":c=_;break;case"left":c=e;break;case"right":c=-e}}else{switch(e=Math.abs(e),o=Math.abs(o),i){case"top-right":case"top-left":case"top":f=o-rm;break;case"bottom-right":case"bottom-left":case"bottom":f=-o+rm}switch(i){case"top-right":case"bottom-right":case"right":c=-e;break;case"top-left":case"bottom-left":case"left":c=e}}return[c,f]}function F8(i,e,o,c,f,_,v,E,S,k){i.createArrays(),i.tilePixelRatio=Wn/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const L=i.layers[0].layout,z=i.layers[0]._unevaluatedLayout._values,N={};if(i.textSizeData.kind==="composite"){const{minZoom:X,maxZoom:le}=i.textSizeData;N.compositeTextSizes=[z["text-size"].possiblyEvaluate(new O(X),E),z["text-size"].possiblyEvaluate(new O(le),E)]}if(i.iconSizeData.kind==="composite"){const{minZoom:X,maxZoom:le}=i.iconSizeData;N.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new O(X),E),z["icon-size"].possiblyEvaluate(new O(le),E)]}N.layoutTextSize=z["text-size"].possiblyEvaluate(new O(S+1),E),N.layoutIconSize=z["icon-size"].possiblyEvaluate(new O(S+1),E),N.textMaxSize=z["text-size"].possiblyEvaluate(new O(18),E);const W=L.get("text-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",q=L.get("text-size");for(const X of i.features){const le=L.get("text-font").evaluate(X,{},E).join(","),ve=q.evaluate(X,{},E),Re=N.layoutTextSize.evaluate(X,{},E),be=(N.layoutIconSize.evaluate(X,{},E),{horizontal:{},vertical:void 0}),Pe=X.text;let Be,ze=[0,0];if(Pe){const Pt=Pe.toString(),Jt=L.get("text-letter-spacing").evaluate(X,{},E)*Qo,vt=L.get("text-line-height").evaluate(X,{},E)*Qo,Rt=kc(Pt)?Jt:0,Ot=L.get("text-anchor").evaluate(X,{},E),Vt=L.get("text-variable-anchor");if(!Vt){const _n=L.get("text-radial-offset").evaluate(X,{},E);ze=_n?c3(Ot,[_n*Qo,Xy]):L.get("text-offset").evaluate(X,{},E).map(Mr=>Mr*Qo)}let Qt=W?"center":L.get("text-justify").evaluate(X,{},E);const kt=L.get("symbol-placement")==="point",pn=kt?L.get("text-max-width").evaluate(X,{},E)*Qo:1/0,Rn=_n=>{i.allowVerticalPlacement&&ul(Pt)&&(be.vertical=Zy(Pe,e,o,f,le,pn,vt,Ot,_n,Rt,ze,Ga.vertical,!0,Re,ve))};if(!W&&Vt){const _n=Qt==="auto"?Vt.map(en=>Yy(en)):[Qt];let Mr=!1;for(let en=0;en<_n.length;en++){const Kn=_n[en];if(!be.horizontal[Kn])if(Mr)be.horizontal[Kn]=be.horizontal[0];else{const Ar=Zy(Pe,e,o,f,le,pn,vt,"center",Kn,Rt,ze,Ga.horizontal,!1,Re,ve);Ar&&(be.horizontal[Kn]=Ar,Mr=Ar.positionedLines.length===1)}}Rn("left")}else{if(Qt==="auto"&&(Qt=Yy(Ot)),kt||L.get("text-writing-mode").indexOf("horizontal")>=0||!ul(Pt)){const _n=Zy(Pe,e,o,f,le,pn,vt,Ot,Qt,Rt,ze,Ga.horizontal,!1,Re,ve);_n&&(be.horizontal[Qt]=_n)}Rn(kt?"left":Qt)}}let ft=!1;if(X.icon&&X.icon.name){const Pt=c[X.icon.name];Pt&&(Be=I8(f[X.icon.name],L.get("icon-offset").evaluate(X,{},E),L.get("icon-anchor").evaluate(X,{},E)),ft=Pt.sdf,i.sdfIcons===void 0?i.sdfIcons=Pt.sdf:i.sdfIcons!==Pt.sdf&&Nn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Pt.pixelRatio!==i.pixelRatio||L.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const ct=h3(be.horizontal)||be.vertical;i.iconsInText||(i.iconsInText=!!ct&&ct.iconsInText),(ct||Be)&&U8(i,X,be,Be,c,N,Re,0,ze,ft,v,E,k)}_&&i.generateCollisionDebugBuffers(S,i.collisionBoxArray)}function Yy(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function U8(i,e,o,c,f,_,v,E,S,k,L,z,N){let W=_.textMaxSize.evaluate(e,{},z);W===void 0&&(W=v);const q=i.layers[0].layout,X=q.get("icon-offset").evaluate(e,{},z),le=h3(o.horizontal)||o.vertical,ve=N.name==="globe",Re=Qo,be=v/Re,Pe=i.tilePixelRatio*W/Re,Be=(Ot=i.overscaling,i.zoom>18&&Ot>2&&(Ot>>=1),Math.max(Wn/(512*Ot),1)*q.get("symbol-spacing")),ze=q.get("text-padding")*i.tilePixelRatio,ft=q.get("icon-padding")*i.tilePixelRatio,ct=lt(q.get("text-max-angle")),Pt=q.get("text-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",Jt=q.get("icon-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",vt=q.get("symbol-placement"),Rt=Be/2;var Ot;const Vt=q.get("icon-text-fit");let Qt;c&&Vt!=="none"&&(i.allowVerticalPlacement&&o.vertical&&(Qt=Jb(c,o.vertical,Vt,q.get("icon-text-fit-padding"),X,be)),le&&(c=Jb(c,le,Vt,q.get("icon-text-fit-padding"),X,be)));const kt=(pn,Rn,_n)=>{if(Rn.x<0||Rn.x>=Wn||Rn.y<0||Rn.y>=Wn)return;let Mr=null;if(ve){const{x:en,y:Kn,z:Ar}=N.projectTilePoint(Rn.x,Rn.y,_n);Mr={anchor:new Ju(en,Kn,Ar,0,void 0),up:N.upVector(_n,Rn.x,Rn.y)}}(function(en,Kn,Ar,ii,Pr,lr,Ii,Lr,Rr,vi,Si,ki,xi,Ki,oo,_o,wi,Mo,yo,to,ai,vo,Mi,Fs,xo){const es=en.addToLineVertexArray(Kn,ii);let Vo,Us,Wo,Kl,sm,$g,Vg,W3=0,q3=0,G3=0,Z3=0,dv=-1,fv=-1;const Zc={};let H3=ju("");const jf=Ar?Ar.anchor:Kn;let pv=0,mv=0;if(Rr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[pv,mv]=Rr.layout.get("text-offset").evaluate(ai,{},xo).map(Ta=>Ta*Qo):(pv=Rr.layout.get("text-radial-offset").evaluate(ai,{},xo)*Qo,mv=Xy),en.allowVerticalPlacement&&Pr.vertical){const Ta=Pr.vertical;if(oo)$g=Jy(Ta),Lr&&(Vg=Jy(Lr));else{const Ca=Rr.layout.get("text-rotate").evaluate(ai,{},xo)+90;Wo=B1(vi,jf,Kn,Si,ki,xi,Ta,Ki,Ca,_o),Lr&&(Kl=B1(vi,jf,Kn,Si,ki,xi,Lr,Mo,Ca))}}if(lr){const Ta=Rr.layout.get("icon-rotate").evaluate(ai,{},xo),Ca=Rr.layout.get("icon-text-fit")!=="none",Wg=a3(lr,Ta,Mi,Ca),_v=Lr?a3(Lr,Ta,Mi,Ca):void 0;Us=B1(vi,jf,Kn,Si,ki,xi,lr,Mo,Ta),W3=4*Wg.length;const K3=en.iconSizeData;let Nf=null;K3.kind==="source"?(Nf=[Gl*Rr.layout.get("icon-size").evaluate(ai,{},xo)],Nf[0]>td&&Nn(`${en.layerIds[0]}: Value for "icon-size" is >= ${Og}. Reduce your "icon-size".`)):K3.kind==="composite"&&(Nf=[Gl*vo.compositeIconSizes[0].evaluate(ai,{},xo),Gl*vo.compositeIconSizes[1].evaluate(ai,{},xo)],(Nf[0]>td||Nf[1]>td)&&Nn(`${en.layerIds[0]}: Value for "icon-size" is >= ${Og}. Reduce your "icon-size".`)),en.addSymbols(en.icon,Wg,Nf,to,yo,ai,!1,Ar,Kn,es.lineStartIndex,es.lineLength,-1,Fs,xo),dv=en.icon.placedSymbolArray.length-1,_v&&(q3=4*_v.length,en.addSymbols(en.icon,_v,Nf,to,yo,ai,Ga.vertical,Ar,Kn,es.lineStartIndex,es.lineLength,-1,Fs,xo),fv=en.icon.placedSymbolArray.length-1)}for(const Ta in Pr.horizontal){const Ca=Pr.horizontal[Ta];Vo||(H3=ju(Ca.text),oo?sm=Jy(Ca):Vo=B1(vi,jf,Kn,Si,ki,xi,Ca,Ki,Rr.layout.get("text-rotate").evaluate(ai,{},xo),_o));const Wg=Ca.positionedLines.length===1;if(G3+=u3(en,Ar,Kn,Ca,Ii,Rr,oo,ai,_o,es,Pr.vertical?Ga.horizontal:Ga.horizontalOnly,Wg?Object.keys(Pr.horizontal):[Ta],Zc,dv,vo,Fs,xo),Wg)break}Pr.vertical&&(Z3+=u3(en,Ar,Kn,Pr.vertical,Ii,Rr,oo,ai,_o,es,Ga.vertical,["vertical"],Zc,fv,vo,Fs,xo));let ad=-1;const gv=(Ta,Ca)=>Ta?Math.max(Ta,Ca):Ca;ad=gv(sm,ad),ad=gv($g,ad),ad=gv(Vg,ad);const mk=ad>-1?1:0;en.glyphOffsetArray.length>=rd.MAX_GLYPHS&&Nn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ai.sortKey!==void 0&&en.addToSortKeyRanges(en.symbolInstances.length,ai.sortKey),en.symbolInstances.emplaceBack(jf.x,jf.y,jf.z,Kn.x,Kn.y,Zc.right>=0?Zc.right:-1,Zc.center>=0?Zc.center:-1,Zc.left>=0?Zc.left:-1,Zc.vertical>=0?Zc.vertical:-1,dv,fv,H3,Vo!==void 0?Vo:en.collisionBoxArray.length,Vo!==void 0?Vo+1:en.collisionBoxArray.length,Wo!==void 0?Wo:en.collisionBoxArray.length,Wo!==void 0?Wo+1:en.collisionBoxArray.length,Us!==void 0?Us:en.collisionBoxArray.length,Us!==void 0?Us+1:en.collisionBoxArray.length,Kl||en.collisionBoxArray.length,Kl?Kl+1:en.collisionBoxArray.length,Si,G3,Z3,W3,q3,mk,0,pv,mv,ad)})(i,Rn,Mr,pn,o,c,f,Qt,i.layers[0],i.collisionBoxArray,e.index,e.sourceLayerIndex,i.index,ze,Pt,S,0,ft,Jt,X,e,_,k,L,z)};if(vt==="line")for(const pn of i3(e.geometry,0,0,Wn,Wn)){const Rn=R8(pn,Be,ct,o.vertical||le,c,Re,Pe,i.overscaling,Wn);for(const _n of Rn)le&&$8(i,le.text,Rt,_n)||kt(pn,_n,z)}else if(vt==="line-center"){for(const pn of e.geometry)if(pn.length>1){const Rn=L8(pn,ct,o.vertical||le,c,Re,Pe);Rn&&kt(pn,Rn,z)}}else if(e.type==="Polygon")for(const pn of Xu(e.geometry,0)){const Rn=B8(pn,16);kt(pn[0],new Ju(Rn.x,Rn.y,0,0,void 0),z)}else if(e.type==="LineString")for(const pn of e.geometry)kt(pn,new Ju(pn[0].x,pn[0].y,0,0,void 0),z);else if(e.type==="Point")for(const pn of e.geometry)for(const Rn of pn)kt([Rn],new Ju(Rn.x,Rn.y,0,0,void 0),z)}const Og=255,td=Og*Gl;function u3(i,e,o,c,f,_,v,E,S,k,L,z,N,W,q,X,le){const ve=function(Pe,Be,ze,ft,ct,Pt,Jt,vt){const Rt=[];if(Be.positionedLines.length===0)return Rt;const Ot=ft.layout.get("text-rotate").evaluate(Pt,{})*Math.PI/180,Vt=function(_n){const Mr=_n[0],en=_n[1],Kn=Mr*en;return Kn>0?[Mr,-en]:Kn<0?[-Mr,en]:Mr===0?[en,Mr]:[en,-Mr]}(ze);let Qt=Math.abs(Be.top-Be.bottom);for(const _n of Be.positionedLines)Qt-=_n.lineOffset;const kt=Be.positionedLines.length,pn=Qt/kt;let Rn=Be.top-ze[1];for(let _n=0;_n<kt;++_n){const Mr=Be.positionedLines[_n];Rn=O8(Be,pn,Rn,_n);for(const en of Mr.positionedGlyphs){if(!en.rect)continue;const Kn=en.rect||{};let Ar=Wb+1,ii=!0,Pr=1,lr=0;if(en.imageName){const Mi=Jt[en.imageName];if(!Mi)continue;if(Mi.sdf){Nn("SDF images are not supported in formatted text and will be ignored.");continue}ii=!1,Pr=Mi.pixelRatio,Ar=sa/Pr}const Ii=(ct||vt)&&en.vertical,Lr=en.metrics.advance*en.scale/2,Rr=en.metrics,vi=en.rect;if(vi===null)continue;vt&&Be.verticalizable&&(lr=en.imageName?Lr-en.metrics.width*en.scale/2:0);const Si=ct?[en.x+Lr,en.y]:[0,0];let ki=[0,0],xi=[0,0],Ki=!1;ct||(Ii?(xi=[en.x+Lr+Vt[0],en.y+Vt[1]-lr],Ki=!0):ki=[en.x+Lr+ze[0],en.y+ze[1]-lr]);const oo=vi.w*en.scale/(Pr*(en.localGlyph?Zl:1)),_o=vi.h*en.scale/(Pr*(en.localGlyph?Zl:1));let wi,Mo,yo,to;if(Ii){const Mi=en.y-Rn,Fs=new ge(-Lr,Lr-Mi),xo=-Math.PI/2,es=new ge(...xi);wi=new ge(-Lr+ki[0],ki[1]),wi._rotateAround(xo,Fs)._add(es),wi.x+=-Mi+Lr,wi.y-=(Rr.left-Ar)*en.scale;const Vo=en.imageName?Rr.advance*en.scale:Qo*en.scale,Us=String.fromCharCode(en.glyph);m8(Us)?wi.x+=(1-Ar)*en.scale:g8(Us)?wi.x+=Vo-Rr.height*en.scale+(-Ar-1)*en.scale:wi.x+=en.imageName||Rr.width+2*Ar===vi.w&&Rr.height+2*Ar===vi.h?(Vo-_o)/2:(Vo-(Rr.height+2*Ar)*en.scale)/2,Mo=new ge(wi.x,wi.y-oo),yo=new ge(wi.x+_o,wi.y),to=new ge(wi.x+_o,wi.y-oo)}else{const Mi=(Rr.left-Ar)*en.scale-Lr+ki[0],Fs=(-Rr.top-Ar)*en.scale+ki[1],xo=Mi+oo,es=Fs+_o;wi=new ge(Mi,Fs),Mo=new ge(xo,Fs),yo=new ge(Mi,es),to=new ge(xo,es)}if(Ot){let Mi;Mi=ct?new ge(0,0):Ki?new ge(Vt[0],Vt[1]):new ge(ze[0],ze[1]),wi._rotateAround(Ot,Mi),Mo._rotateAround(Ot,Mi),yo._rotateAround(Ot,Mi),to._rotateAround(Ot,Mi)}const ai=new ge(0,0),vo=new ge(0,0);Rt.push({tl:wi,tr:Mo,bl:yo,br:to,tex:Kn,writingMode:Be.writingMode,glyphOffset:Si,sectionIndex:en.sectionIndex,isSDF:ii,pixelOffsetTL:ai,pixelOffsetBR:vo,minFontScaleX:0,minFontScaleY:0})}}return Rt}(0,c,S,_,v,E,f,i.allowVerticalPlacement),Re=i.textSizeData;let be=null;Re.kind==="source"?(be=[Gl*_.layout.get("text-size").evaluate(E,{},le)],be[0]>td&&Nn(`${i.layerIds[0]}: Value for "text-size" is >= ${Og}. Reduce your "text-size".`)):Re.kind==="composite"&&(be=[Gl*q.compositeTextSizes[0].evaluate(E,{},le),Gl*q.compositeTextSizes[1].evaluate(E,{},le)],(be[0]>td||be[1]>td)&&Nn(`${i.layerIds[0]}: Value for "text-size" is >= ${Og}. Reduce your "text-size".`)),i.addSymbols(i.text,ve,be,S,v,E,L,e,o,k.lineStartIndex,k.lineLength,W,X,le);for(const Pe of z)N[Pe]=i.text.placedSymbolArray.length-1;return 4*ve.length}function h3(i){for(const e in i)return i[e];return null}function B1(i,e,o,c,f,_,v,E,S,k){let L=v.top,z=v.bottom,N=v.left,W=v.right;const q=v.collisionPadding;if(q&&(N-=q[0],L-=q[1],W+=q[2],z+=q[3]),S){const X=new ge(N,L),le=new ge(W,L),ve=new ge(N,z),Re=new ge(W,z),be=lt(S);let Pe=new ge(0,0);k&&(Pe=new ge(k[0],k[1])),X._rotateAround(be,Pe),le._rotateAround(be,Pe),ve._rotateAround(be,Pe),Re._rotateAround(be,Pe),N=Math.min(X.x,le.x,ve.x,Re.x),W=Math.max(X.x,le.x,ve.x,Re.x),L=Math.min(X.y,le.y,ve.y,Re.y),z=Math.max(X.y,le.y,ve.y,Re.y)}return i.emplaceBack(e.x,e.y,e.z,o.x,o.y,N,L,W,z,E,c,f,_),i.length-1}function Jy(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const e=i.bottom-i.top;return e>0?Math.max(10,e):null}function $8(i,e,o,c){const f=i.compareText;if(e in f){const _=f[e];for(let v=_.length-1;v>=0;v--)if(c.dist(_[v])<o)return!0}else f[e]=[];return f[e].push(c),!1}function d3(i,e){const o=i.fovAboveCenter,c=i.elevation?i.elevation.getMinElevationBelowMSL()*e:0,f=(i._camera.position[2]*i.worldSize-c)/Math.cos(i._pitch),_=Math.sin(o)*f/Math.sin(Math.max(Math.PI/2-i._pitch-o,.01)),v=Math.sin(i._pitch)*_+f;return Math.min(1.01*v,f*(1/i._horizonShift))}function zf(i,e){if(!e.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:e};const o=Math.pow(2,-i.z),c=i.x*o,f=(i.x+1)*o,_=i.y*o,v=(i.y+1)*o,E=Hi(c),S=Hi(f),k=io(_),L=io(v),z=e.project(E,k),N=e.project(S,k),W=e.project(S,L),q=e.project(E,L);let X=Math.min(z.x,N.x,W.x,q.x),le=Math.min(z.y,N.y,W.y,q.y),ve=Math.max(z.x,N.x,W.x,q.x),Re=Math.max(z.y,N.y,W.y,q.y);const be=o/16;function Pe(ze,ft,ct,Pt,Jt,vt){const Rt=(ct+Jt)/2,Ot=(Pt+vt)/2,Vt=e.project(Hi(Rt),io(Ot)),Qt=Math.max(0,X-Vt.x,le-Vt.y,Vt.x-ve,Vt.y-Re);X=Math.min(X,Vt.x),ve=Math.max(ve,Vt.x),le=Math.min(le,Vt.y),Re=Math.max(Re,Vt.y),Qt>be&&(Pe(ze,Vt,ct,Pt,Rt,Ot),Pe(Vt,ft,Rt,Ot,Jt,vt))}Pe(z,N,c,_,f,_),Pe(N,W,f,_,f,v),Pe(W,q,f,v,c,v),Pe(q,z,c,v,c,_),X-=be,le-=be,ve+=be,Re+=be;const Be=1/Math.max(ve-X,Re-le);return{scale:Be,x:X*Be,y:le*Be,x2:ve*Be,y2:Re*Be,projection:e}}const V8=$a(new Float32Array(16));class nd{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,o){return{x:0,y:0,z:0}}unproject(e,o){return new $r(0,0)}projectTilePoint(e,o,c){return{x:e,y:o,z:0}}locationPoint(e,o,c=!0){return e._coordinatePoint(e.locationCoordinate(o),c)}pixelsPerMeter(e,o){return Ni(1,e)*o}pixelSpaceConversion(e,o,c){return 1}farthestPixelDistance(e){return d3(e,e.pixelsPerMeter)}pointCoordinate(e,o,c,f){const _=e.horizonLineFromTop(!1),v=new ge(o,Math.max(_,c));return e.rayIntersectionCoordinate(e.pointRayIntersection(v,f))}pointCoordinate3D(e,o,c){const f=new ge(o,c);if(e.elevation)return e.elevation.pointCoordinate(f);{const _=this.pointCoordinate(e,f.x,f.y,0);return[_.x,_.y,_.z]}}isPointAboveHorizon(e,o){if(e.elevation)return!this.pointCoordinate3D(e,o.x,o.y);const c=e.horizonLineFromTop();return o.y<c}createInversionMatrix(e,o){return V8}createTileMatrix(e,o,c){let f,_,v;const E=c.canonical,S=$a(new Float64Array(16));if(this.isReprojectedInTileSpace){const k=zf(E,this);f=1,_=k.x+c.wrap*k.scale,v=k.y,Oc(S,S,[f/k.scale,f/k.scale,e.pixelsPerMeter/o])}else f=o/e.zoomScale(E.z),_=(E.x+Math.pow(2,E.z)*c.wrap)*f,v=E.y*f;return Vh(S,S,[_,v,0]),Oc(S,S,[f/Wn,f/Wn,1]),S}upVector(e,o,c){return[0,0,1]}upVectorScale(e,o,c){return{metersToTile:1}}}class W8 extends nd{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[o,c]=this.parallels=e.parallels||[29.5,45.5],f=Math.sin(lt(o));this.n=(f+Math.sin(lt(c)))/2,this.c=1+f*(2*this.n-f),this.r0=Math.sqrt(this.c)/this.n}project(e,o){const{n:c,c:f,r0:_}=this,v=lt(e-this.center[0]),E=lt(o),S=Math.sqrt(f-2*c*Math.sin(E))/c;return{x:S*Math.sin(v*c),y:S*Math.cos(v*c)-_,z:0}}unproject(e,o){const{n:c,c:f,r0:_}=this,v=_+o;let E=Math.atan2(e,Math.abs(v))*Math.sign(v);v*c<0&&(E-=Math.PI*Math.sign(e)*Math.sign(v));const S=lt(this.center[0])*c;E=At(E,-Math.PI-S,Math.PI-S);const k=Bt(ht(E/c)+this.center[0],-180,180),L=Math.asin(Bt((f-(e*e+v*v)*c*c)/(2*c),-1,1)),z=Bt(ht(L),-uo,uo);return new $r(k,z)}}const Dg=1.340264,zg=-.081106,Bg=893e-6,jg=.003796,j1=Math.sqrt(3)/2;class q8 extends nd{project(e,o){o=o/180*Math.PI,e=e/180*Math.PI;const c=Math.asin(j1*Math.sin(o)),f=c*c,_=f*f*f;return{x:.5*(e*Math.cos(c)/(j1*(Dg+3*zg*f+_*(7*Bg+9*jg*f)))/Math.PI+.5),y:1-.5*(c*(Dg+zg*f+_*(Bg+jg*f))/Math.PI+1),z:0}}unproject(e,o){e=(2*e-.5)*Math.PI;let c=o=(2*(1-o)-1)*Math.PI,f=c*c,_=f*f*f;for(let L,z,N,W=0;W<12&&(z=c*(Dg+zg*f+_*(Bg+jg*f))-o,N=Dg+3*zg*f+_*(7*Bg+9*jg*f),L=z/N,c=Bt(c-L,-Math.PI/3,Math.PI/3),f=c*c,_=f*f*f,!(Math.abs(L)<1e-12));++W);const v=j1*e*(Dg+3*zg*f+_*(7*Bg+9*jg*f))/Math.cos(c),E=Math.asin(Math.sin(c)/j1),S=Bt(180*v/Math.PI,-180,180),k=Bt(180*E/Math.PI,-uo,uo);return new $r(S,k)}}class G8 extends nd{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,o){return{x:.5+e/360,y:.5-o/360,z:0}}unproject(e,o){const c=360*(e-.5),f=Bt(360*(.5-o),-uo,uo);return new $r(c,f)}}const im=Math.PI/2;function N1(i){return Math.tan((im+i)/2)}class Z8 extends nd{constructor(e){super(e),this.center=e.center||[0,30];const[o,c]=this.parallels=e.parallels||[30,30];let f=lt(o),_=lt(c);this.southernCenter=f+_<0,this.southernCenter&&(f=-f,_=-_);const v=Math.cos(f),E=N1(f);this.n=f===_?Math.sin(f):Math.log(v/Math.cos(_))/Math.log(N1(_)/E),this.f=v*Math.pow(N1(f),this.n)/this.n}project(e,o){o=lt(o),this.southernCenter&&(o=-o),e=lt(e-this.center[0]);const c=1e-6,{n:f,f:_}=this;_>0?o<-im+c&&(o=-im+c):o>im-c&&(o=im-c);const v=_/Math.pow(N1(o),f);let E=v*Math.sin(f*e),S=_-v*Math.cos(f*e);return E=.5*(E/Math.PI+.5),S=.5*(S/Math.PI+.5),{x:E,y:this.southernCenter?S:1-S,z:0}}unproject(e,o){e=(2*e-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:c,f}=this,_=f-o,v=Math.sign(_),E=Math.sign(c)*Math.sqrt(e*e+_*_);let S=Math.atan2(e,Math.abs(_))*v;_*c<0&&(S-=Math.PI*Math.sign(e)*v);const k=Bt(ht(S/c)+this.center[0],-180,180),L=Bt(ht(2*Math.atan(Math.pow(f/E,1/c))-im),-uo,uo);return new $r(k,this.southernCenter?-L:L)}}class f3 extends nd{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,o){return{x:ji(e),y:Ti(o),z:0}}unproject(e,o){const c=Hi(e),f=io(o);return new $r(c,f)}}const p3=lt(uo);class H8 extends nd{project(e,o){const c=(o=lt(o))*o,f=c*c;return{x:.5*((e=lt(e))*(.8707-.131979*c+f*(f*(.003971*c-.001529*f)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+c*(.015085+f*(.028874*c-.044475-.005916*f)))/Math.PI+1),z:0}}unproject(e,o){e=(2*e-.5)*Math.PI;let c=o=(2*(1-o)-1)*Math.PI,f=25,_=0,v=c*c;do{v=c*c;const k=v*v;_=(c*(1.007226+v*(.015085+k*(.028874*v-.044475-.005916*k)))-o)/(1.007226+v*(.045255+k*(.259866*v-.311325-.005916*11*k))),c=Bt(c-_,-p3,p3)}while(Math.abs(_)>1e-6&&--f>0);v=c*c;const E=Bt(ht(e/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),S=ht(c);return new $r(E,S)}}const m3=lt(uo);class K8 extends nd{project(e,o){o=lt(o),e=lt(e);const c=Math.cos(o),f=2/Math.PI,_=Math.acos(c*Math.cos(e/2)),v=Math.sin(_)/_,E=.5*(e*f+2*c*Math.sin(e/2)/v)||0,S=.5*(o+Math.sin(o)/v)||0;return{x:.5*(E/Math.PI+.5),y:1-.5*(S/Math.PI+1),z:0}}unproject(e,o){let c=e=(2*e-.5)*Math.PI,f=o=(2*(1-o)-1)*Math.PI,_=25;const v=1e-6;let E=0,S=0;do{const k=Math.cos(f),L=Math.sin(f),z=2*L*k,N=L*L,W=k*k,q=Math.cos(c/2),X=Math.sin(c/2),le=2*q*X,ve=X*X,Re=1-W*q*q,be=Re?1/Re:0,Pe=Re?Math.acos(k*q)*Math.sqrt(1/Re):0,Be=.5*(2*Pe*k*X+2*c/Math.PI)-e,ze=.5*(Pe*L+f)-o,ft=.5*be*(W*ve+Pe*k*q*N)+1/Math.PI,ct=be*(le*z/4-Pe*L*X),Pt=.125*be*(z*X-Pe*L*W*le),Jt=.5*be*(N*q+Pe*ve*k)+.5,vt=ct*Pt-Jt*ft;E=(ze*ct-Be*Jt)/vt,S=(Be*Pt-ze*ft)/vt,c=Bt(c-E,-Math.PI,Math.PI),f=Bt(f-S,-m3,m3)}while((Math.abs(E)>v||Math.abs(S)>v)&&--_>0);return new $r(ht(c),ht(f))}}class g3 extends nd{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(lt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,o){const{scale:c,cosPhi:f}=this;return{x:lt(e)*f*c+.5,y:-Math.sin(lt(o))/f*c+.5,z:0}}unproject(e,o){const{scale:c,cosPhi:f}=this,_=-(o-.5)/c,v=Bt(ht((e-.5)/c)/f,-180,180),E=Math.asin(Bt(_*f,-1,1)),S=Bt(ht(E),-uo,uo);return new $r(v,S)}}class X8 extends f3{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,o,c){const f=Ts(e,o,c);return Gi(f,f,Hh(Bs(c))),{x:f[0],y:f[1],z:f[2]}}locationPoint(e,o){const c=co(o.lat,o.lng),f=Xo([],c),_=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(o),e._centerAltitude):e._centerAltitude;Do(c,c,f,Ni(1,0)*Wn*_);const v=$a(new Float64Array(16));return Rc(v,e.pixelMatrix,e.globeMatrix),Gi(c,c,v),new ge(c[0],c[1])}pixelsPerMeter(e,o){return Ni(1,0)*o}pixelSpaceConversion(e,o,c){const f=Ni(1,e)*o,_=qr(Ni(1,45)*o,f,c);return this.pixelsPerMeter(e,o)/_}createTileMatrix(e,o,c){const f=ra(Bs(c.canonical));return Rc(new Float64Array(16),e.globeMatrix,f)}createInversionMatrix(e,o){const{center:c}=e,f=Hh(Bs(o));return Pp(f,f,lt(c.lng)),Wh(f,f,lt(c.lat)),Oc(f,f,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(f)}pointCoordinate(e,o,c,f){return jp(e,o,c,!0)||new Ul(0,0)}pointCoordinate3D(e,o,c){const f=this.pointCoordinate(e,o,c,0);return[f.x,f.y,f.z]}isPointAboveHorizon(e,o){return!jp(e,o.x,o.y,!1)}farthestPixelDistance(e){const o=function(f,_){const v=f.cameraToCenterDistance,E=f._centerAltitude*_,S=f._camera,k=f._camera.forward(),L=pl([],$i([],k,-v),[0,0,E]),z=f.worldSize/(2*Math.PI),N=[0,0,-z],W=f.width/f.height,q=Math.tan(f.fovAboveCenter),X=$i([],S.up(),q),le=$i([],S.right(),q*W),ve=Xo([],pl([],pl([],k,X),le)),Re=[];let be;if(new hg(L,ve).closestPointOnSphere(N,z,Re)){const Pe=pl([],Re,N),Be=ba([],Pe,L);be=Math.cos(f.fovAboveCenter)*_f(Be)}else{const Pe=ba([],L,N),Be=ba([],N,L);Xo(Be,Be);const ze=_f(Pe)-z;be=Math.sqrt(ze*(ze+2*z));const ft=Math.acos(be/(z+ze))-Math.acos(ta(k,Be));be*=Math.cos(ft)}return 1.01*be}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),c=Cs(e.zoom);if(c>0){const f=d3(e,Ni(1,e.center.lat)*e.worldSize),_=e.worldSize/(2*Math.PI),v=Math.max(e.width,e.height)/e.worldSize*Math.PI;return qr(o,f+_*(1-Math.cos(v)),Math.pow(c,10))}return o}upVector(e,o,c){return Ts(o,c,e,1)}upVectorScale(e){return{metersToTile:Fl(Va(Bs(e)))}}}function _3(i){const e=i.parallels,o=!!e&&Math.abs(e[0]+e[1])<.01;switch(i.name){case"mercator":return new f3(i);case"equirectangular":return new G8(i);case"naturalEarth":return new H8(i);case"equalEarth":return new q8(i);case"winkelTripel":return new K8(i);case"albers":return o?new g3(i):new W8(i);case"lambertConformalConic":return o?new g3(i):new Z8(i);case"globe":return new X8(i)}throw new Error(`Invalid projection name: ${i.name}`)}const Y8=tr.types,J8=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function F1(i,e,o,c,f,_,v,E,S,k,L,z,N){const W=E?Math.min(td,Math.round(E[0])):0,q=E?Math.min(td,Math.round(E[1])):0;i.emplaceBack(e,o,Math.round(32*c),Math.round(32*f),_,v,(W<<1)+(S?1:0),q,16*k,16*L,256*z,256*N)}function U1(i,e,o,c,f,_,v){i.emplaceBack(e,o,c,f,_,v)}function $1(i,e,o,c,f){i.emplaceBack(e,o,c,f),i.emplaceBack(e,o,c,f),i.emplaceBack(e,o,c,f),i.emplaceBack(e,o,c,f)}function Q8(i){for(const e of i.sections)if(ja(e.text))return!0;return!1}class Qy{constructor(e){this.layoutVertexArray=new Ft,this.indexArray=new jn,this.programConfigurations=e,this.segments=new Ji,this.dynamicLayoutVertexArray=new Zt,this.opacityVertexArray=new $n,this.placedSymbolArray=new Ei,this.globeExtVertexArray=new Yt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,o,c,f){this.isEmpty()||(c&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,a8.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,c8.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,J8,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,l8.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||f)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}gn(Qy,"SymbolBuffers");class ev{constructor(e,o,c){this.layoutVertexArray=new e,this.layoutAttributes=o,this.indexArray=new c,this.segments=new Ji,this.collisionVertexArray=new zr,this.collisionVertexArrayExt=new Or}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,u8.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,h8.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}gn(ev,"CollisionBuffers");class rd{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(v=>v.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=$a([]),this.placementViewportMatrix=$a([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=$y(this.zoom,o["text-size"]),this.iconSizeData=$y(this.zoom,o["icon-size"]);const c=this.layers[0].layout,f=c.get("symbol-sort-key"),_=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(v=>Ga[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new Qy(new Lc(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Qy(new Lc(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Ko,this.lineVertexArray=new Ac,this.symbolInstances=new hi}calculateGlyphDependencies(e,o,c,f,_){for(let v=0;v<e.length;v++)if(o[e.charCodeAt(v)]=!0,f&&_){const E=Ig[e.charAt(v)];E&&(o[E.charCodeAt(0)]=!0)}}populate(e,o,c,f){const _=this.layers[0],v=_.layout,E=this.projection.name==="globe",S=v.get("text-font"),k=v.get("text-field"),L=v.get("icon-image"),z=(k.value.kind!=="constant"||k.value.value instanceof To&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),N=L.value.kind!=="constant"||!!L.value.value||Object.keys(L.parameters).length>0,W=v.get("symbol-sort-key");if(this.features=[],!z&&!N)return;const q=o.iconDependencies,X=o.glyphDependencies,le=o.availableImages,ve=new O(this.zoom);for(const{feature:Re,id:be,index:Pe,sourceLayerIndex:Be}of e){const ze=_._featureFilter.needGeometry,ft=js(Re,ze);if(!_._featureFilter.filter(ve,ft,c))continue;if(ze||(ft.geometry=Wa(Re,c,f)),E&&Re.type!==1&&c.z<=5){const vt=ft.geometry,Rt=.98078528056,Ot=(Vt,Qt)=>ta(Ts(Vt.x,Vt.y,c,1),Ts(Qt.x,Qt.y,c,1))<Rt;for(let Vt=0;Vt<vt.length;Vt++)vt[Vt]=_g(vt[Vt],Ot)}let ct,Pt;if(z){const vt=_.getValueAndResolveTokens("text-field",ft,c,le),Rt=To.factory(vt);Q8(Rt)&&(this.hasRTLText=!0),(!this.hasRTLText||T()==="unavailable"||this.hasRTLText&&I.isParsed())&&(ct=p8(Rt,_,ft))}if(N){const vt=_.getValueAndResolveTokens("icon-image",ft,c,le);Pt=vt instanceof Is?vt:Is.fromString(vt)}if(!ct&&!Pt)continue;const Jt=this.sortFeaturesByKey?W.evaluate(ft,{},c):void 0;if(this.features.push({id:be,text:ct,icon:Pt,index:Pe,sourceLayerIndex:Be,geometry:ft.geometry,properties:Re.properties,type:Y8[Re.type],sortKey:Jt}),Pt&&(q[Pt.name]=!0),ct){const vt=S.evaluate(ft,{},c).join(","),Rt=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ga.vertical)>=0;for(const Ot of ct.sections)if(Ot.image)q[Ot.image.name]=!0;else{const Vt=ul(ct.toString()),Qt=Ot.fontStack||vt,kt=X[Qt]=X[Qt]||{};this.calculateGlyphDependencies(Ot.text,kt,Rt,this.allowVerticalPlacement,Vt)}}}v.get("symbol-placement")==="line"&&(this.features=function(Re){const be={},Pe={},Be=[];let ze=0;function ft(vt){Be.push(Re[vt]),ze++}function ct(vt,Rt,Ot){const Vt=Pe[vt];return delete Pe[vt],Pe[Rt]=Vt,Be[Vt].geometry[0].pop(),Be[Vt].geometry[0]=Be[Vt].geometry[0].concat(Ot[0]),Vt}function Pt(vt,Rt,Ot){const Vt=be[Rt];return delete be[Rt],be[vt]=Vt,Be[Vt].geometry[0].shift(),Be[Vt].geometry[0]=Ot[0].concat(Be[Vt].geometry[0]),Vt}function Jt(vt,Rt,Ot){const Vt=Ot?Rt[0][Rt[0].length-1]:Rt[0][0];return`${vt}:${Vt.x}:${Vt.y}`}for(let vt=0;vt<Re.length;vt++){const Rt=Re[vt],Ot=Rt.geometry,Vt=Rt.text?Rt.text.toString():null;if(!Vt){ft(vt);continue}const Qt=Jt(Vt,Ot),kt=Jt(Vt,Ot,!0);if(Qt in Pe&&kt in be&&Pe[Qt]!==be[kt]){const pn=Pt(Qt,kt,Ot),Rn=ct(Qt,kt,Be[pn].geometry);delete be[Qt],delete Pe[kt],Pe[Jt(Vt,Be[Rn].geometry,!0)]=Rn,Be[pn].geometry=null}else Qt in Pe?ct(Qt,kt,Ot):kt in be?Pt(Qt,kt,Ot):(ft(vt),be[Qt]=ze-1,Pe[kt]=ze-1)}return Be.filter(vt=>vt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Re,be)=>Re.sortKey-be.sortKey)}update(e,o,c,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,o,this.layers,c,f),this.icon.programConfigurations.updatePaintArrays(e,o,this.layers,c,f))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=_3(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,o){const c=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:f,y:_}of o)this.lineVertexArray.emplaceBack(f,_);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(e,o,c,f,_,v,E,S,k,L,z,N,W,q){const X=e.indexArray,le=e.layoutVertexArray,ve=e.globeExtVertexArray,Re=e.segments.prepareSegment(4*o.length,le,X,this.canOverlap?v.sortKey:void 0),be=this.glyphOffsetArray.length,Pe=Re.vertexLength,Be=this.allowVerticalPlacement&&E===Ga.vertical?Math.PI/2:0,ze=v.text&&v.text.sections;for(let ct=0;ct<o.length;ct++){const{tl:Pt,tr:Jt,bl:vt,br:Rt,tex:Ot,pixelOffsetTL:Vt,pixelOffsetBR:Qt,minFontScaleX:kt,minFontScaleY:pn,glyphOffset:Rn,isSDF:_n,sectionIndex:Mr}=o[ct],en=Re.vertexLength,Kn=Rn[1];if(F1(le,k.x,k.y,Pt.x,Kn+Pt.y,Ot.x,Ot.y,c,_n,Vt.x,Vt.y,kt,pn),F1(le,k.x,k.y,Jt.x,Kn+Jt.y,Ot.x+Ot.w,Ot.y,c,_n,Qt.x,Vt.y,kt,pn),F1(le,k.x,k.y,vt.x,Kn+vt.y,Ot.x,Ot.y+Ot.h,c,_n,Vt.x,Qt.y,kt,pn),F1(le,k.x,k.y,Rt.x,Kn+Rt.y,Ot.x+Ot.w,Ot.y+Ot.h,c,_n,Qt.x,Qt.y,kt,pn),S){const{x:Ar,y:ii,z:Pr}=S.anchor,[lr,Ii,Lr]=S.up;U1(ve,Ar,ii,Pr,lr,Ii,Lr),U1(ve,Ar,ii,Pr,lr,Ii,Lr),U1(ve,Ar,ii,Pr,lr,Ii,Lr),U1(ve,Ar,ii,Pr,lr,Ii,Lr),$1(e.dynamicLayoutVertexArray,Ar,ii,Pr,Be)}else $1(e.dynamicLayoutVertexArray,k.x,k.y,k.z,Be);X.emplaceBack(en,en+1,en+2),X.emplaceBack(en+1,en+2,en+3),Re.vertexLength+=4,Re.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Rn[0]),ct!==o.length-1&&Mr===o[ct+1].sectionIndex||e.programConfigurations.populatePaintArrays(le.length,v,v.index,{},W,q,ze&&ze[Mr])}const ft=S?S.anchor:k;e.placedSymbolArray.emplaceBack(ft.x,ft.y,ft.z,k.x,k.y,be,this.glyphOffsetArray.length-be,Pe,L,z,k.segment,c?c[0]:0,c?c[1]:0,f[0],f[1],E,0,!1,0,N,0)}_commitLayoutVertex(e,o,c,f,_,v,E){e.emplaceBack(o,c,f,_,v,Math.round(E.x),Math.round(E.y))}_addCollisionDebugVertices(e,o,c,f,_,v,E){const S=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),k=S.vertexLength,L=E.tileAnchorX,z=E.tileAnchorY;for(let W=0;W<4;W++)c.collisionVertexArray.emplaceBack(0,0,0,0);c.collisionVertexArrayExt.emplaceBack(o,-e.padding,-e.padding),c.collisionVertexArrayExt.emplaceBack(o,e.padding,-e.padding),c.collisionVertexArrayExt.emplaceBack(o,e.padding,e.padding),c.collisionVertexArrayExt.emplaceBack(o,-e.padding,e.padding),this._commitLayoutVertex(c.layoutVertexArray,f,_,v,L,z,new ge(e.x1,e.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,_,v,L,z,new ge(e.x2,e.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,_,v,L,z,new ge(e.x2,e.y2)),this._commitLayoutVertex(c.layoutVertexArray,f,_,v,L,z,new ge(e.x1,e.y2)),S.vertexLength+=4;const N=c.indexArray;N.emplaceBack(k,k+1),N.emplaceBack(k+1,k+2),N.emplaceBack(k+2,k+3),N.emplaceBack(k+3,k),S.primitiveLength+=4}_addTextDebugCollisionBoxes(e,o,c,f,_,v){for(let E=f;E<_;E++){const S=c.get(E),k=this.getSymbolInstanceTextSize(e,v,o,E);this._addCollisionDebugVertices(S,k,this.textCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(e,o,c,f,_,v){for(let E=f;E<_;E++){const S=c.get(E),k=this.getSymbolInstanceIconSize(e,o,v.placedIconSymbolIndex);this._addCollisionDebugVertices(S,k,this.iconCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,v)}}generateCollisionDebugBuffers(e,o){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ev(kn,zb.members,qi),this.iconCollisionBox=new ev(kn,zb.members,qi);const c=Xp(this.iconSizeData,e),f=Xp(this.textSizeData,e);for(let _=0;_<this.symbolInstances.length;_++){const v=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(f,e,o,v.textBoxStartIndex,v.textBoxEndIndex,v),this._addTextDebugCollisionBoxes(f,e,o,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._addIconDebugCollisionBoxes(c,e,o,v.iconBoxStartIndex,v.iconBoxEndIndex,v),this._addIconDebugCollisionBoxes(c,e,o,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v)}}getSymbolInstanceTextSize(e,o,c,f){const _=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:f),v=P1(this.textSizeData,e,_)/Qo;return this.tilePixelRatio*v}getSymbolInstanceIconSize(e,o,c){const f=this.icon.placedSymbolArray.get(c),_=P1(this.iconSizeData,e,f);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(e,o,c){e.emplaceBack(o,-c,-c),e.emplaceBack(o,c,-c),e.emplaceBack(o,c,c),e.emplaceBack(o,-c,c)}_updateTextDebugCollisionBoxes(e,o,c,f,_,v){for(let E=f;E<_;E++){const S=c.get(E),k=this.getSymbolInstanceTextSize(e,v,o,E);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,k,S.padding)}}_updateIconDebugCollisionBoxes(e,o,c,f,_,v){for(let E=f;E<_;E++){const S=c.get(E),k=this.getSymbolInstanceIconSize(e,o,v);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,k,S.padding)}}updateCollisionDebugBuffers(e,o){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=Xp(this.iconSizeData,e),f=Xp(this.textSizeData,e);for(let _=0;_<this.symbolInstances.length;_++){const v=this.symbolInstances.get(_);this._updateTextDebugCollisionBoxes(f,e,o,v.textBoxStartIndex,v.textBoxEndIndex,v),this._updateTextDebugCollisionBoxes(f,e,o,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._updateIconDebugCollisionBoxes(c,e,o,v.iconBoxStartIndex,v.iconBoxEndIndex,v.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(c,e,o,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,o,c,f,_,v,E,S,k){const L={};if(o<c){const{x1:z,y1:N,x2:W,y2:q,padding:X,projectedAnchorX:le,projectedAnchorY:ve,projectedAnchorZ:Re,tileAnchorX:be,tileAnchorY:Pe,featureIndex:Be}=e.get(o);L.textBox={x1:z,y1:N,x2:W,y2:q,padding:X,projectedAnchorX:le,projectedAnchorY:ve,projectedAnchorZ:Re,tileAnchorX:be,tileAnchorY:Pe},L.textFeatureIndex=Be}if(f<_){const{x1:z,y1:N,x2:W,y2:q,padding:X,projectedAnchorX:le,projectedAnchorY:ve,projectedAnchorZ:Re,tileAnchorX:be,tileAnchorY:Pe,featureIndex:Be}=e.get(f);L.verticalTextBox={x1:z,y1:N,x2:W,y2:q,padding:X,projectedAnchorX:le,projectedAnchorY:ve,projectedAnchorZ:Re,tileAnchorX:be,tileAnchorY:Pe},L.verticalTextFeatureIndex=Be}if(v<E){const{x1:z,y1:N,x2:W,y2:q,padding:X,projectedAnchorX:le,projectedAnchorY:ve,projectedAnchorZ:Re,tileAnchorX:be,tileAnchorY:Pe,featureIndex:Be}=e.get(v);L.iconBox={x1:z,y1:N,x2:W,y2:q,padding:X,projectedAnchorX:le,projectedAnchorY:ve,projectedAnchorZ:Re,tileAnchorX:be,tileAnchorY:Pe},L.iconFeatureIndex=Be}if(S<k){const{x1:z,y1:N,x2:W,y2:q,padding:X,projectedAnchorX:le,projectedAnchorY:ve,projectedAnchorZ:Re,tileAnchorX:be,tileAnchorY:Pe,featureIndex:Be}=e.get(S);L.verticalIconBox={x1:z,y1:N,x2:W,y2:q,padding:X,projectedAnchorX:le,projectedAnchorY:ve,projectedAnchorZ:Re,tileAnchorX:be,tileAnchorY:Pe},L.verticalIconFeatureIndex=Be}return L}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const c=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,o){const c=e.placedSymbolArray.get(o),f=c.vertexStartIndex+4*c.numGlyphs;for(let _=c.vertexStartIndex;_<f;_+=4)e.indexArray.emplaceBack(_,_+1,_+2),e.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(e),c=Math.cos(e),f=[],_=[],v=[];for(let E=0;E<this.symbolInstances.length;++E){v.push(E);const S=this.symbolInstances.get(E);f.push(0|Math.round(o*S.tileAnchorX+c*S.tileAnchorY)),_.push(S.featureIndex)}return v.sort((E,S)=>f[E]-f[S]||_[S]-_[E]),v}addToSortKeyRanges(e,o){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===o?c.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const c=this.symbolInstances.get(o);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:_,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:E,placedIconSymbolIndex:S,verticalPlacedIconSymbolIndex:k}=c;f>=0&&this.addIndicesForPlacedSymbol(this.text,f),_>=0&&_!==f&&this.addIndicesForPlacedSymbol(this.text,_),v>=0&&v!==_&&v!==f&&this.addIndicesForPlacedSymbol(this.text,v),E>=0&&this.addIndicesForPlacedSymbol(this.text,E),S>=0&&this.addIndicesForPlacedSymbol(this.icon,S),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}gn(rd,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),rd.MAX_GLYPHS=65535,rd.addDynamicAttributes=$1;const ek=new Ce({"symbol-placement":new K(Te.layout_symbol["symbol-placement"]),"symbol-spacing":new K(Te.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new K(Te.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ue(Te.layout_symbol["symbol-sort-key"]),"symbol-z-order":new K(Te.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new K(Te.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new K(Te.layout_symbol["icon-ignore-placement"]),"icon-optional":new K(Te.layout_symbol["icon-optional"]),"icon-rotation-alignment":new K(Te.layout_symbol["icon-rotation-alignment"]),"icon-size":new ue(Te.layout_symbol["icon-size"]),"icon-text-fit":new K(Te.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new K(Te.layout_symbol["icon-text-fit-padding"]),"icon-image":new ue(Te.layout_symbol["icon-image"]),"icon-rotate":new ue(Te.layout_symbol["icon-rotate"]),"icon-padding":new K(Te.layout_symbol["icon-padding"]),"icon-keep-upright":new K(Te.layout_symbol["icon-keep-upright"]),"icon-offset":new ue(Te.layout_symbol["icon-offset"]),"icon-anchor":new ue(Te.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new K(Te.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new K(Te.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new K(Te.layout_symbol["text-rotation-alignment"]),"text-field":new ue(Te.layout_symbol["text-field"]),"text-font":new ue(Te.layout_symbol["text-font"]),"text-size":new ue(Te.layout_symbol["text-size"]),"text-max-width":new ue(Te.layout_symbol["text-max-width"]),"text-line-height":new ue(Te.layout_symbol["text-line-height"]),"text-letter-spacing":new ue(Te.layout_symbol["text-letter-spacing"]),"text-justify":new ue(Te.layout_symbol["text-justify"]),"text-radial-offset":new ue(Te.layout_symbol["text-radial-offset"]),"text-variable-anchor":new K(Te.layout_symbol["text-variable-anchor"]),"text-anchor":new ue(Te.layout_symbol["text-anchor"]),"text-max-angle":new K(Te.layout_symbol["text-max-angle"]),"text-writing-mode":new K(Te.layout_symbol["text-writing-mode"]),"text-rotate":new ue(Te.layout_symbol["text-rotate"]),"text-padding":new K(Te.layout_symbol["text-padding"]),"text-keep-upright":new K(Te.layout_symbol["text-keep-upright"]),"text-transform":new ue(Te.layout_symbol["text-transform"]),"text-offset":new ue(Te.layout_symbol["text-offset"]),"text-allow-overlap":new K(Te.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new K(Te.layout_symbol["text-ignore-placement"]),"text-optional":new K(Te.layout_symbol["text-optional"])});var tv={paint:new Ce({"icon-opacity":new ue(Te.paint_symbol["icon-opacity"]),"icon-color":new ue(Te.paint_symbol["icon-color"]),"icon-halo-color":new ue(Te.paint_symbol["icon-halo-color"]),"icon-halo-width":new ue(Te.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ue(Te.paint_symbol["icon-halo-blur"]),"icon-translate":new K(Te.paint_symbol["icon-translate"]),"icon-translate-anchor":new K(Te.paint_symbol["icon-translate-anchor"]),"text-opacity":new ue(Te.paint_symbol["text-opacity"]),"text-color":new ue(Te.paint_symbol["text-color"],{runtimeType:yr,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new ue(Te.paint_symbol["text-halo-color"]),"text-halo-width":new ue(Te.paint_symbol["text-halo-width"]),"text-halo-blur":new ue(Te.paint_symbol["text-halo-blur"]),"text-translate":new K(Te.paint_symbol["text-translate"]),"text-translate-anchor":new K(Te.paint_symbol["text-translate-anchor"])}),layout:ek};class y3{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:sr,this.defaultValue=e}evaluate(e){if(e.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(e.formattedSection))return o.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}gn(y3,"FormatSectionOverride",{omit:["defaultValue"]});class V1 extends wa{constructor(e){super(e,tv)}recalculate(e,o){super.recalculate(e,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const f=[];for(const _ of c)f.indexOf(_)<0&&f.push(_);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,o,c,f){const _=this.layout.get(e).evaluate(o,{},c,f),v=this._unevaluatedLayout._values[e];return v.isDataDriven()||Ml(v.value)||!_?_:function(E,S){return S.replace(/{([^{}]+)}/g,(k,L)=>L in E?String(E[L]):"")}(o.properties,_)}createBucket(e){return new rd(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of tv.paint.overridableProperties){if(!V1.hasPaintOverride(this.layout,e))continue;const o=this.paint.get(e),c=new y3(o),f=new Pu(c,o.property.specification);let _=null;_=o.value.kind==="constant"||o.value.kind==="source"?new Iu("source",f):new sl("composite",f,o.value.zoomStops,o.value._interpolationType),this.paint._values[e]=new fe(o.property,_,o.parameters)}}_handleOverridablePaintPropertyUpdate(e,o,c){return!(!this.layout||o.isDataDriven()||c.isDataDriven())&&V1.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,o){const c=e.get("text-field"),f=tv.paint.properties[o];let _=!1;const v=E=>{for(const S of E)if(f.overrides&&f.overrides.hasOverride(S))return void(_=!0)};if(c.value.kind==="constant"&&c.value.value instanceof To)v(c.value.value.sections);else if(c.value.kind==="source"){const E=k=>{_||(k instanceof Zs&&Ui(k.value)===ie?v(k.value.sections):k instanceof da?v(k.sections):k.eachChild(E))},S=c.value;S._styleExpression&&E(S._styleExpression.expression)}return _}getProgramConfiguration(e){return new Bl(this,e)}}var tk={paint:new Ce({"background-color":new K(Te.paint_background["background-color"]),"background-pattern":new K(Te.paint_background["background-pattern"]),"background-opacity":new K(Te.paint_background["background-opacity"])})},nk={paint:new Ce({"raster-opacity":new K(Te.paint_raster["raster-opacity"]),"raster-hue-rotate":new K(Te.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new K(Te.paint_raster["raster-brightness-min"]),"raster-brightness-max":new K(Te.paint_raster["raster-brightness-max"]),"raster-saturation":new K(Te.paint_raster["raster-saturation"]),"raster-contrast":new K(Te.paint_raster["raster-contrast"]),"raster-resampling":new K(Te.paint_raster["raster-resampling"]),"raster-fade-duration":new K(Te.paint_raster["raster-fade-duration"])})};class rk extends wa{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var ik={paint:new Ce({"sky-type":new K(Te.paint_sky["sky-type"]),"sky-atmosphere-sun":new K(Te.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new K(Te.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new K(Te.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new K(Te.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ee(Te.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new K(Te.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new K(Te.paint_sky["sky-atmosphere-color"]),"sky-opacity":new K(Te.paint_sky["sky-opacity"])})};function nv(i,e,o){const c=[0,0,1],f=Dp([]);return p1(f,f,o?-lt(i)+Math.PI:lt(i)),vf(f,f,-lt(e)),og(c,c,f),Xo(c,c)}const ok={circle:class extends wa{constructor(i){super(i,Wu)}createBucket(i){return new Xh(i)}queryRadius(i){const e=i;return oa("circle-radius",this,e)+oa("circle-stroke-width",this,e)+Mf(this.paint.get("circle-translate"))}queryIntersectsFeature(i,e,o,c,f,_,v,E){const S=Fc(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,i.pixelToTileUnitsFactor),k=this.paint.get("circle-radius").evaluate(e,o)+this.paint.get("circle-stroke-width").evaluate(e,o);return wg(i,c,_,v,E,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",S,k)}getProgramIds(){return["circle"]}getProgramConfiguration(i){return new Bl(this,i)}},heatmap:class extends wa{createBucket(i){return new b1(i)}constructor(i){super(i,E1),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Qi({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return oa("heatmap-radius",this,i)}queryIntersectsFeature(i,e,o,c,f,_,v,E){const S=this.paint.get("heatmap-radius").evaluate(e,o);return wg(i,c,_,v,E,!0,!0,new ge(0,0),S)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(i){return new Bl(this,i)}},hillshade:class extends wa{constructor(i){super(i,Dy)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends wa{constructor(i){super(i,A)}getProgramIds(){const i=this.paint.get("fill-pattern"),e=i&&i.constantOr(1),o=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getProgramConfiguration(i){return new Bl(this,i)}recalculate(i,e){super.recalculate(i,e);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new p(i)}queryRadius(){return Mf(this.paint.get("fill-translate"))}queryIntersectsFeature(i,e,o,c,f,_){return!i.queryGeometry.isAboveHorizon&&kf(Wp(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,i.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends wa{constructor(i){super(i,Q6)}createBucket(i){return new Df(i)}queryRadius(){return Mf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(i){return new Bl(this,i)}queryIntersectsFeature(i,e,o,c,f,_,v,E,S){const k=Fc(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,i.pixelToTileUnitsFactor),L=this.paint.get("fill-extrusion-height").evaluate(e,o),z=this.paint.get("fill-extrusion-base").evaluate(e,o),N=[0,0],W=E&&_.elevation,q=_.elevation?_.elevation.exaggeration():1,X=i.tile.getBucket(this);if(W&&X instanceof Df){const Pe=X.centroidVertexArray,Be=S+1;Be<Pe.length&&(N[0]=Pe.geta_centroid_pos0(Be),N[1]=Pe.geta_centroid_pos1(Be))}if(N[0]===0&&N[1]===1)return!1;_.projection.name==="globe"&&(c=Mb([c],[new ge(0,0),new ge(Wn,Wn)],i.tileID.canonical).map(Pe=>Pe.polygon).flat());const le=W?E:null,[ve,Re]=function(Pe,Be,ze,ft,ct,Pt,Jt,vt,Rt,Ot,Vt){return Pe.projection.name==="globe"?function(Qt,kt,pn,Rn,_n,Mr,en,Kn,Ar,ii,Pr){const lr=[],Ii=[],Lr=Qt.projection.upVectorScale(Pr,Qt.center.lat,Qt.worldSize).metersToTile,Rr=[0,0,0,1],vi=[0,0,0,1],Si=(xi,Ki,oo,_o)=>{xi[0]=Ki,xi[1]=oo,xi[2]=_o,xi[3]=1},ki=kb();pn>0&&(pn+=ki),Rn+=ki;for(const xi of kt){const Ki=[],oo=[];for(const _o of xi){const wi=_o.x+_n.x,Mo=_o.y+_n.y,yo=Qt.projection.projectTilePoint(wi,Mo,Pr),to=Qt.projection.upVector(Pr,_o.x,_o.y);let ai=pn,vo=Rn;if(en){const Mi=Lb(wi,Mo,pn,Rn,en,Kn,Ar,ii);ai+=Mi.base,vo+=Mi.top}pn!==0?Si(Rr,yo.x+to[0]*Lr*ai,yo.y+to[1]*Lr*ai,yo.z+to[2]*Lr*ai):Si(Rr,yo.x,yo.y,yo.z),Si(vi,yo.x+to[0]*Lr*vo,yo.y+to[1]*Lr*vo,yo.z+to[2]*Lr*vo),Gi(Rr,Rr,Mr),Gi(vi,vi,Mr),Ki.push(new Kp(Rr[0],Rr[1],Rr[2])),oo.push(new Kp(vi[0],vi[1],vi[2]))}lr.push(Ki),Ii.push(oo)}return[lr,Ii]}(Pe,Be,ze,ft,ct,Pt,Jt,vt,Rt,Ot,Vt):Jt?function(Qt,kt,pn,Rn,_n,Mr,en,Kn,Ar){const ii=[],Pr=[],lr=[0,0,0,1];for(const Ii of Qt){const Lr=[],Rr=[];for(const vi of Ii){const Si=vi.x+Rn.x,ki=vi.y+Rn.y,xi=Lb(Si,ki,kt,pn,Mr,en,Kn,Ar);lr[0]=Si,lr[1]=ki,lr[2]=xi.base,lr[3]=1,Nl(lr,lr,_n),lr[3]=Math.max(lr[3],1e-5);const Ki=new Kp(lr[0]/lr[3],lr[1]/lr[3],lr[2]/lr[3]);lr[0]=Si,lr[1]=ki,lr[2]=xi.top,lr[3]=1,Nl(lr,lr,_n),lr[3]=Math.max(lr[3],1e-5);const oo=new Kp(lr[0]/lr[3],lr[1]/lr[3],lr[2]/lr[3]);Lr.push(Ki),Rr.push(oo)}ii.push(Lr),Pr.push(Rr)}return[ii,Pr]}(Be,ze,ft,ct,Pt,Jt,vt,Rt,Ot):function(Qt,kt,pn,Rn,_n){const Mr=[],en=[],Kn=_n[8]*kt,Ar=_n[9]*kt,ii=_n[10]*kt,Pr=_n[11]*kt,lr=_n[8]*pn,Ii=_n[9]*pn,Lr=_n[10]*pn,Rr=_n[11]*pn;for(const vi of Qt){const Si=[],ki=[];for(const xi of vi){const Ki=xi.x+Rn.x,oo=xi.y+Rn.y,_o=_n[0]*Ki+_n[4]*oo+_n[12],wi=_n[1]*Ki+_n[5]*oo+_n[13],Mo=_n[2]*Ki+_n[6]*oo+_n[14],yo=_n[3]*Ki+_n[7]*oo+_n[15],to=_o+Kn,ai=wi+Ar,vo=Mo+ii,Mi=Math.max(yo+Pr,1e-5),Fs=_o+lr,xo=wi+Ii,es=Mo+Lr,Vo=Math.max(yo+Rr,1e-5);Si.push(new Kp(to/Mi,ai/Mi,vo/Mi)),ki.push(new Kp(Fs/Vo,xo/Vo,es/Vo))}Mr.push(Si),en.push(ki)}return[Mr,en]}(Be,ze,ft,ct,Pt)}(_,c,z,L,k,v,le,N,q,_.center.lat,i.tileID.canonical),be=i.queryGeometry;return function(Pe,Be,ze){let ft=1/0;kf(ze,Be)&&(ft=Ib(ze,Be[0]));for(let ct=0;ct<Be.length;ct++){const Pt=Be[ct],Jt=Pe[ct];for(let vt=0;vt<Pt.length-1;vt++){const Rt=Pt[vt],Ot=[Rt,Pt[vt+1],Jt[vt+1],Jt[vt],Rt];Yh(ze,Ot)&&(ft=Math.min(ft,Ib(ze,Ot)))}}return ft!==1/0&&ft}(ve,Re,be.isPointQuery()?be.screenBounds:be.screenGeometry)}},line:class extends wa{constructor(i){super(i,Rb),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Hd,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(i,e){super.recalculate(i,e),this.paint._values["line-floorwidth"]=Ob.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new A1(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(i){return new Bl(this,i)}queryRadius(i){const e=i,o=Db(oa("line-width",this,e),oa("line-gap-width",this,e)),c=oa("line-offset",this,e);return o/2+Math.abs(c)+Mf(this.paint.get("line-translate"))}queryIntersectsFeature(i,e,o,c,f,_){if(i.queryGeometry.isAboveHorizon)return!1;const v=Wp(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,i.pixelToTileUnitsFactor),E=i.pixelToTileUnitsFactor/2*Db(this.paint.get("line-width").evaluate(e,o),this.paint.get("line-gap-width").evaluate(e,o)),S=this.paint.get("line-offset").evaluate(e,o);return S&&(c=function(k,L){const z=[],N=new ge(0,0);for(let W=0;W<k.length;W++){const q=k[W],X=[];for(let le=0;le<q.length;le++){const ve=q[le],Re=q[le+1],be=le===0?N:ve.sub(q[le-1])._unit()._perp(),Pe=le===q.length-1?N:Re.sub(ve)._unit()._perp(),Be=be._add(Pe)._unit();Be._mult(1/(Be.x*Pe.x+Be.y*Pe.y)),X.push(Be._mult(L)._add(ve))}z.push(X)}return z}(c,S*i.pixelToTileUnitsFactor)),function(k,L,z){for(let N=0;N<L.length;N++){const W=L[N];if(k.length>=3){for(let q=0;q<W.length;q++)if($l(k,W[q]))return!0}if($p(k,W,z))return!0}return!1}(v,c,E)}isTileClipped(){return!0}},symbol:V1,background:class extends wa{constructor(i){super(i,tk)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends wa{constructor(i){super(i,nk)}getProgramIds(){return["raster"]}},sky:class extends wa{constructor(i){super(i,ik),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Qi({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(i,e){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),f=!c,_=i.style.light,v=_.properties.get("position");return f&&_.properties.get("anchor")==="viewport"&&Nn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?nv(v.azimuthal,90-v.polar,e):nv(c[0],90-c[1],e)}const o=this.paint.get("sky-gradient-center");return nv(o[0],90-o[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}}};class Ng{constructor(e,o,c,f){this.context=e,this.format=c,this.texture=e.gl.createTexture(),this.update(o,f)}update(e,o,c){const{width:f,height:_}=e,{context:v}=this,{gl:E}=v,{HTMLImageElement:S,HTMLCanvasElement:k,HTMLVideoElement:L,ImageData:z,ImageBitmap:N}=M;if(E.bindTexture(E.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!o||o.premultiply!==!1)),c||this.size&&this.size[0]===f&&this.size[1]===_){const{x:W,y:q}=c||{x:0,y:0};e instanceof S||e instanceof k||e instanceof L||e instanceof z||N&&e instanceof N?E.texSubImage2D(E.TEXTURE_2D,0,W,q,E.RGBA,E.UNSIGNED_BYTE,e):E.texSubImage2D(E.TEXTURE_2D,0,W,q,f,_,E.RGBA,E.UNSIGNED_BYTE,e.data)}else this.size=[f,_],e instanceof S||e instanceof k||e instanceof L||e instanceof z||N&&e instanceof N?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,e):E.texImage2D(E.TEXTURE_2D,0,this.format,f,_,0,this.format,E.UNSIGNED_BYTE,e.data);this.useMipmap=!!(o&&o.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&E.generateMipmap(E.TEXTURE_2D)}bind(e,o){const{context:c}=this,{gl:f}=c;f.bindTexture(f.TEXTURE_2D,this.texture),e!==this.filter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,e),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this.useMipmap?e===f.NEAREST?f.NEAREST_MIPMAP_NEAREST:f.LINEAR_MIPMAP_NEAREST:e),this.filter=e),o!==this.wrap&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,o),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class sk{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class ak{constructor(){this.tasks={},this.taskQueue=[],xt(["process"],this),this.invoker=new sk(this.process),this.nextId=0}add(e,o){const c=this.nextId++,f=function({type:_,isSymbolTile:v,zoom:E}){return E=E||0,_==="message"?0:_!=="maybePrepare"||v?_!=="parseTile"||v?_==="parseTile"&&v?300-E:_==="maybePrepare"&&v?400-E:500:200-E:100-E}(o);if(f===0){Zr();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[c]={fn:e,metadata:o,priority:f,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){Zr();try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const o=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let e=null,o=1/0;for(let f=0;f<this.taskQueue.length;f++){const _=this.tasks[this.taskQueue[f]];_.priority<o&&(o=_.priority,e=f)}if(e===null)return null;const c=this.taskQueue[e];return this.taskQueue.splice(e,1),c}remove(){this.invoker.remove()}}class v3{constructor(e){this._stringToNumber={},this._numberToString=[];for(let o=0;o<e.length;o++){const c=e[o];this._stringToNumber[c]=o,this._numberToString[o]=c}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const lk=["tile","layer","source","sourceLayer","state"];class x3{constructor(e,o,c,f,_){this.type="Feature",this._vectorTileFeature=e,this._z=o,this._x=c,this._y=f,this.properties=e.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const o of lk)this[o]!==void 0&&(e[o]=this[o]);return e}}const yl=32,Wc=33,id=new Uint16Array(8184);for(let i=0;i<2046;i++){let e=i+2,o=0,c=0,f=0,_=0,v=0,E=0;for(1&e?f=_=v=yl:o=c=E=yl;(e>>=1)>1;){const k=o+f>>1,L=c+_>>1;1&e?(f=o,_=c,o=v,c=E):(o=f,c=_,f=v,_=E),v=k,E=L}const S=4*i;id[S+0]=o,id[S+1]=c,id[S+2]=f,id[S+3]=_}const qc=new Uint16Array(2178),od=new Uint8Array(1089),W1=new Uint16Array(1089);function w3(i){return i===0?-.03125:i===32?.03125:0}var b3=Ye([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const E3={type:2,extent:Wn,loadGeometry:()=>[[new ge(0,0),new ge(Wn+1,0),new ge(Wn+1,Wn+1),new ge(0,Wn+1),new ge(0,0)]]};class rv{constructor(e,o,c,f,_){this.tileID=e,this.uid=Yn(),this.uses=0,this.tileSize=o,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=_,this.expiredRequestCount=0,this.state="loading",f&&f.transform&&(this.projection=f.transform.projection)}registerFadeDuration(e){const o=e+this.timeAdded;o<Pn.now()||this.fadeEndTime&&o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=zf(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,o,c){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(f,_){const v={};if(!_)return v;for(const E of f){const S=E.layerIds.map(k=>_.getLayer(k)).filter(Boolean);if(S.length!==0){E.layers=S,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map(k=>S.filter(L=>L.id===k)[0]));for(const k of S)v[k.id]=E}}return v}(e.buckets,o.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof rd){if(this.hasSymbolBuckets=!0,!c)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof rd&&_.hasRTLText){this.hasRTLText=!0,I.isLoading()||I.isLoaded()||T()!=="deferred"||P();break}}this.queryPadding=0;for(const f in this.buckets){const _=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(f).queryRadius(_))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new ni}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const c in this.buckets){const f=this.buckets[c];f.uploadPending()&&f.upload(e)}const o=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ng(e,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ng(e,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Ng(e,this.lineAtlas.image,o.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,o,c,f,_,v,E,S){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:f,pixelPosMatrix:E,transform:v,params:_,tileTransform:this.tileTransform},e,o,c):{}}querySourceFeatures(e,o){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const f=c.loadVTLayers(),_=o?o.sourceLayer:"",v=f._geojsonTileLayer||f[_];if(!v)return;const E=bc(o&&o.filter),{z:S,x:k,y:L}=this.tileID.canonical,z={z:S,x:k,y:L};for(let N=0;N<v.length;N++){const W=v.feature(N);if(E.needGeometry){const le=js(W,!0);if(!E.filter(new O(this.tileID.overscaledZ),le,this.tileID.canonical))continue}else if(!E.filter(new O(this.tileID.overscaledZ),W))continue;const q=c.getId(W,_),X=new x3(W,S,k,L,q);X.tile=z,e.push(X)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const o=this.expirationTime;if(e.cacheControl){const c=Br(e.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const c=Date.now();let f=!1;if(this.expirationTime>c)f=!1;else if(o)if(this.expirationTime<o)f=!0;else{const _=this.expirationTime-o;_?this.expirationTime=c+Math.max(_,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!o)return;const c=this.latestFeatureIndex.loadVTLayers(),f=o.style.listImages();for(const _ in this.buckets){if(!o.style.hasLayer(_))continue;const v=this.buckets[_],E=v.layers[0].sourceLayer||"_geojsonTileLayer",S=c[E],k=e[E];if(!S||!k||Object.keys(k).length===0)continue;if(v.update(k,S,f,this.imageAtlas&&this.imageAtlas.patternPositions||{}),v instanceof A1||v instanceof p){const z=o.style._getSourceCache(v.layers[0].source);o._terrain&&o._terrain.enabled&&z&&v.programConfigurations.needsUpload&&o._terrain._clearRenderCacheForTile(z.id,this.tileID)}const L=o&&o.style&&o.style.getLayer(_);L&&(this.queryPadding=Math.max(this.queryPadding,L.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Pn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Pn.now()+e}setTexture(e,o){const c=o.context,f=c.gl;this.texture=this.texture||o.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Ng(c,e,f.RGBA,{useMipmap:!0}),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE))}setDependencies(e,o){const c={};for(const f of o)c[f]=!0;this.dependencies[e]=c}hasDependency(e,o){for(const c of e){const f=this.dependencies[c];if(f){for(const _ of o)if(f[_])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,o){if(!o||o.name==="mercator"||this._tileDebugBuffer)return;const c=Wa(E3,this.tileID.canonical,this.tileTransform)[0],f=new Kt,_=new bs;for(let v=0;v<c.length;v++){const{x:E,y:S}=c[v];f.emplaceBack(E,S),_.emplaceBack(v)}_.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(_),this._tileDebugBuffer=e.createVertexBuffer(f,na.members),this._tileDebugSegments=Ji.simpleSegment(0,0,f.length,_.length)}_makeTileBoundsBuffers(e,o){if(this._tileBoundsBuffer||!o||o.name==="mercator")return;const c=Wa(E3,this.tileID.canonical,this.tileTransform)[0];let f,_;if(this.isRaster){const v=function(E,S){const k=zf(E,S),L=Math.pow(2,E.z);for(let le=0;le<Wc;le++)for(let ve=0;ve<Wc;ve++){const Re=Hi((E.x+(ve+w3(ve))/yl)/L),be=io((E.y+(le+w3(le))/yl)/L),Pe=S.project(Re,be),Be=le*Wc+ve;qc[2*Be+0]=Math.round((Pe.x*k.scale-k.x)*Wn),qc[2*Be+1]=Math.round((Pe.y*k.scale-k.y)*Wn)}od.fill(0),W1.fill(0);for(let le=2045;le>=0;le--){const ve=4*le,Re=id[ve+0],be=id[ve+1],Pe=id[ve+2],Be=id[ve+3],ze=Re+Pe>>1,ft=be+Be>>1,ct=ze+ft-be,Pt=ft+Re-ze,Jt=be*Wc+Re,vt=Be*Wc+Pe,Rt=ft*Wc+ze,Ot=Math.hypot((qc[2*Jt+0]+qc[2*vt+0])/2-qc[2*Rt+0],(qc[2*Jt+1]+qc[2*vt+1])/2-qc[2*Rt+1])>=16;od[Rt]=od[Rt]||(Ot?1:0),le<1022&&(od[Rt]=od[Rt]||od[(be+Pt>>1)*Wc+(Re+ct>>1)]||od[(Be+Pt>>1)*Wc+(Pe+ct>>1)])}const z=new Mt,N=new jn;let W=0;function q(le,ve){const Re=ve*Wc+le;return W1[Re]===0&&(z.emplaceBack(qc[2*Re+0],qc[2*Re+1],le*Wn/yl,ve*Wn/yl),W1[Re]=++W),W1[Re]-1}function X(le,ve,Re,be,Pe,Be){const ze=le+Re>>1,ft=ve+be>>1;if(Math.abs(le-Pe)+Math.abs(ve-Be)>1&&od[ft*Wc+ze])X(Pe,Be,le,ve,ze,ft),X(Re,be,Pe,Be,ze,ft);else{const ct=q(le,ve),Pt=q(Re,be),Jt=q(Pe,Be);N.emplaceBack(ct,Pt,Jt)}}return X(0,0,yl,yl,yl,0),X(yl,yl,0,0,0,yl),{vertices:z,indices:N}}(this.tileID.canonical,o);f=v.vertices,_=v.indices}else{f=new Mt,_=new jn;for(const{x:E,y:S}of c)f.emplaceBack(E,S,0,0);const v=Qh(f.int16,void 0,4);for(let E=0;E<v.length;E+=3)_.emplaceBack(v[E],v[E+1],v[E+2])}this._tileBoundsBuffer=e.createVertexBuffer(f,b3.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(_),this._tileBoundsSegments=Ji.simpleSegment(0,0,f.length,_.length)}_makeGlobeTileDebugBuffers(e,o){const c=o.projection;if(!c||c.name!=="globe"||o.freezeTileCoverage)return;const f=this.tileID.canonical,_=Hh(Np(f,o)),v=Cs(o.zoom);let E;v>0&&(E=rg(new Float64Array(16),o.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,f,o,_,E,v),this._makeGlobeTileDebugTextBuffer(e,f,o,_,E,v)}_globePoint(e,o,c,f,_,v,E){let S=Ts(e,o,c);if(v){const k=1<<c.z,L=ji(f.center.lng),z=Ti(f.center.lat),N=(c.x+.5)/k-L;let W=0;N>.5?W=-1:N<-.5&&(W=1);let q=(e/Wn+c.x)/k+W,X=(o/Wn+c.y)/k;q=(q-L)*f._pixelsPerMercatorPixel+L,X=(X-z)*f._pixelsPerMercatorPixel+z;const le=[q*f.worldSize,X*f.worldSize,0];Gi(le,le,v),S=ml(S,le,E)}return Gi(S,S,_)}_makeGlobeTileDebugBorderBuffer(e,o,c,f,_,v){const E=new Kt,S=new bs,k=new st,L=(N,W,q,X,le)=>{const ve=(q-N)/(le-1),Re=(X-W)/(le-1),be=E.length;for(let Pe=0;Pe<le;Pe++){const Be=N+Pe*ve,ze=W+Pe*Re;E.emplaceBack(Be,ze);const ft=this._globePoint(Be,ze,o,c,f,_,v);k.emplaceBack(ft[0],ft[1],ft[2]),S.emplaceBack(be+Pe)}},z=Wn;L(0,0,z,0,16),L(z,0,z,z,16),L(z,z,0,z,16),L(0,z,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(S),this._tileDebugBuffer=e.createVertexBuffer(E,na.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(k,xf.members),this._tileDebugSegments=Ji.simpleSegment(0,0,E.length,S.length)}_makeGlobeTileDebugTextBuffer(e,o,c,f,_,v){const E=Wn/4,S=new Kt,k=new jn,L=new st,z=25;k.reserve(32),S.reserve(z),L.reserve(z);const N=(W,q)=>z*W+q;for(let W=0;W<z;W++){const q=W*E;for(let X=0;X<z;X++){const le=X*E;S.emplaceBack(le,q);const ve=this._globePoint(le,q,o,c,f,_,v);L.emplaceBack(ve[0],ve[1],ve[2])}}for(let W=0;W<4;W++)for(let q=0;q<4;q++){const X=N(W,q),le=N(W,q+1),ve=N(W+1,q),Re=N(W+1,q+1);k.emplaceBack(X,le,ve),k.emplaceBack(ve,le,Re)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(k),this._tileDebugTextBuffer=e.createVertexBuffer(S,na.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(L,xf.members),this._tileDebugTextSegments=Ji.simpleSegment(0,0,z,32)}}class ck{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,o,c){const f=String(o);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][f]=this.stateChanges[e][f]||{},vn(this.stateChanges[e][f],c),this.deletedStates[e]===null){this.deletedStates[e]={};for(const _ in this.state[e])_!==f&&(this.deletedStates[e][_]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][f]===null){this.deletedStates[e][f]={};for(const _ in this.state[e][f])c[_]||(this.deletedStates[e][f][_]=null)}else for(const _ in c)this.deletedStates[e]&&this.deletedStates[e][f]&&this.deletedStates[e][f][_]===null&&delete this.deletedStates[e][f][_]}removeFeatureState(e,o,c){if(this.deletedStates[e]===null)return;const f=String(o);if(this.deletedStates[e]=this.deletedStates[e]||{},c&&o!==void 0)this.deletedStates[e][f]!==null&&(this.deletedStates[e][f]=this.deletedStates[e][f]||{},this.deletedStates[e][f][c]=null);else if(o!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][f])for(c in this.deletedStates[e][f]={},this.stateChanges[e][f])this.deletedStates[e][f][c]=null;else this.deletedStates[e][f]=null;else this.deletedStates[e]=null}getState(e,o){const c=String(o),f=vn({},(this.state[e]||{})[c],(this.stateChanges[e]||{})[c]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const _=this.deletedStates[e][o];if(_===null)return{};for(const v in _)delete f[v]}return f}initializeTileState(e,o){e.setFeatureState(this.state,o)}coalesceChanges(e,o){const c={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const _={};for(const v in this.stateChanges[f])this.state[f][v]||(this.state[f][v]={}),vn(this.state[f][v],this.stateChanges[f][v]),_[v]=this.state[f][v];c[f]=_}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const _={};if(this.deletedStates[f]===null)for(const v in this.state[f])_[v]={},this.state[f][v]={};else for(const v in this.deletedStates[f]){if(this.deletedStates[f][v]===null)this.state[f][v]={};else if(this.state[f][v])for(const E of Object.keys(this.deletedStates[f][v]))delete this.state[f][v][E];_[v]=this.state[f][v]}c[f]=c[f]||{},vn(c[f],_)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const f in e)e[f].setFeatureState(c,o)}}class T3{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,o){const c=this.toIdx(e,o);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(e,o){return this.leaves[this.toIdx(e,o)]}toIdx(e,o){return o*this.size+e}}function C3(i,e,o,c){let f=0,_=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(c[v])<1e-15){if(o[v]<i[v]||o[v]>e[v])return null}else{const E=1/c[v];let S=(i[v]-o[v])*E,k=(e[v]-o[v])*E;if(S>k){const L=S;S=k,k=L}if(S>f&&(f=S),k<_&&(_=k),f>_)return null}return f}function S3(i,e,o,c,f,_,v,E,S,k,L){const z=c-i,N=f-e,W=_-o,q=v-i,X=E-e,le=S-o,ve=L[1]*le-L[2]*X,Re=L[2]*q-L[0]*le,be=L[0]*X-L[1]*q,Pe=z*ve+N*Re+W*be;if(Math.abs(Pe)<1e-15)return null;const Be=1/Pe,ze=k[0]-i,ft=k[1]-e,ct=k[2]-o,Pt=(ze*ve+ft*Re+ct*be)*Be;if(Pt<0||Pt>1)return null;const Jt=ft*W-ct*N,vt=ct*z-ze*W,Rt=ze*N-ft*z,Ot=(L[0]*Jt+L[1]*vt+L[2]*Rt)*Be;return Ot<0||Pt+Ot>1?null:(q*Jt+X*vt+le*Rt)*Be}function k3(i,e,o){return(i-e)/(o-e)}function M3(i,e,o,c,f,_,v,E,S){const k=1<<o,L=_-c,z=v-f,N=(i+1)/k*L+c,W=(e+0)/k*z+f,q=(e+1)/k*z+f;E[0]=(i+0)/k*L+c,E[1]=W,S[0]=N,S[1]=q}class A3{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(_){const v=Math.ceil(Math.log2(_.dim/8)),E=[];let S=Math.ceil(Math.pow(2,v));const k=1/S,L=(W,q,X,le,ve)=>{const Re=le?1:0,be=(W+1)*X-Re,Pe=q*X,Be=(q+1)*X-Re;ve[0]=W*X,ve[1]=Pe,ve[2]=be,ve[3]=Be};let z=new T3(S);const N=[];for(let W=0;W<S*S;W++){L(W%S,Math.floor(W/S),k,!1,N);const q=sd(N[0],N[1],_),X=sd(N[2],N[1],_),le=sd(N[2],N[3],_),ve=sd(N[0],N[3],_);z.minimums.push(Math.min(q,X,le,ve)),z.maximums.push(Math.max(q,X,le,ve)),z.leaves.push(1)}for(E.push(z),S/=2;S>=1;S/=2){const W=E[E.length-1];z=new T3(S);for(let q=0;q<S*S;q++){L(q%S,Math.floor(q/S),2,!0,N);const X=W.getElevation(N[0],N[1]),le=W.getElevation(N[2],N[1]),ve=W.getElevation(N[2],N[3]),Re=W.getElevation(N[0],N[3]),be=W.isLeaf(N[0],N[1]),Pe=W.isLeaf(N[2],N[1]),Be=W.isLeaf(N[2],N[3]),ze=W.isLeaf(N[0],N[3]),ft=Math.min(X.min,le.min,ve.min,Re.min),ct=Math.max(X.max,le.max,ve.max,Re.max),Pt=be&&Pe&&Be&&ze;z.maximums.push(ct),z.minimums.push(ft),z.leaves.push(ct-ft<=5&&Pt?1:0)}E.push(z)}return E}(this.dem),c=o.length-1,f=o[c];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(o,0,0,c,0)}raycastRoot(e,o,c,f,_,v,E=1){return C3([e,o,-100],[c,f,this.maximums[0]*E],_,v)}raycast(e,o,c,f,_,v,E=1){if(!this.nodeCount)return null;const S=this.raycastRoot(e,o,c,f,_,v,E);if(S==null)return null;const k=[],L=[],z=[],N=[],W=[{idx:0,t:S,nodex:0,nodey:0,depth:0}];for(;W.length>0;){const{idx:q,t:X,nodex:le,nodey:ve,depth:Re}=W.pop();if(this.leaves[q]){M3(le,ve,Re,e,o,c,f,z,N);const Pe=1<<Re,Be=(le+0)/Pe,ze=(le+1)/Pe,ft=(ve+0)/Pe,ct=(ve+1)/Pe,Pt=sd(Be,ft,this.dem)*E,Jt=sd(ze,ft,this.dem)*E,vt=sd(ze,ct,this.dem)*E,Rt=sd(Be,ct,this.dem)*E,Ot=S3(z[0],z[1],Pt,N[0],z[1],Jt,N[0],N[1],vt,_,v),Vt=S3(N[0],N[1],vt,z[0],N[1],Rt,z[0],z[1],Pt,_,v),Qt=Math.min(Ot!==null?Ot:Number.MAX_VALUE,Vt!==null?Vt:Number.MAX_VALUE);if(Qt!==Number.MAX_VALUE)return Qt;{const kt=Do([],_,v,X);if(P3(Pt,Jt,Rt,vt,k3(kt[0],z[0],N[0]),k3(kt[1],z[1],N[1]))>=kt[2])return X}continue}let be=0;for(let Pe=0;Pe<this._siblingOffset.length;Pe++){M3((le<<1)+this._siblingOffset[Pe][0],(ve<<1)+this._siblingOffset[Pe][1],Re+1,e,o,c,f,z,N),z[2]=-100,N[2]=this.maximums[this.childOffsets[q]+Pe]*E;const Be=C3(z,N,_,v);if(Be!=null){const ze=Be;k[Pe]=ze;let ft=!1;for(let ct=0;ct<be&&!ft;ct++)ze>=k[L[ct]]&&(L.splice(ct,0,Pe),ft=!0);ft||(L[be]=Pe),be++}}for(let Pe=0;Pe<be;Pe++){const Be=L[Pe];W.push({idx:this.childOffsets[q]+Be,t:k[Be],nodex:(le<<1)+this._siblingOffset[Be][0],nodey:(ve<<1)+this._siblingOffset[Be][1],depth:Re+1})}}return null}_addNode(e,o,c){return this.minimums.push(e),this.maximums.push(o),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(e,o,c,f,_){if(e[f].isLeaf(o,c)===1)return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const v=f-1,E=e[v];let S=0,k=0;for(let L=0;L<this._siblingOffset.length;L++){const z=2*o+this._siblingOffset[L][0],N=2*c+this._siblingOffset[L][1],W=E.getElevation(z,N),q=E.isLeaf(z,N),X=this._addNode(W.min,W.max,q);q&&(S|=1<<L),k||(k=X)}for(let L=0;L<this._siblingOffset.length;L++)S&1<<L||this._construct(e,2*o+this._siblingOffset[L][0],2*c+this._siblingOffset[L][1],v,k+L)}}function P3(i,e,o,c,f,_){return qr(qr(i,o,_),qr(e,c,_),f)}function sd(i,e,o){const c=o.dim,f=Bt(i*c-.5,0,c-1),_=Bt(e*c-.5,0,c-1),v=Math.floor(f),E=Math.floor(_),S=Math.min(v+1,c-1),k=Math.min(E+1,c-1);return P3(o.get(v,E),o.get(S,E),o.get(v,k),o.get(S,k),f-v,_-E)}const I3={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function uk(i,e,o){return(256*i*256+256*e+o)/10-1e4}function hk(i,e,o){return 256*i+e+o/256-32768}class q1{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,o,c,f=!1,_=!1){if(this.uid=e,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return Nn(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const v=this.dim=o.height-2,E=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.encoding=c||"mapbox",this.borderReady=f,!f){for(let S=0;S<v;S++)E[this._idx(-1,S)]=E[this._idx(0,S)],E[this._idx(v,S)]=E[this._idx(v-1,S)],E[this._idx(S,-1)]=E[this._idx(S,0)],E[this._idx(S,v)]=E[this._idx(S,v-1)];E[this._idx(-1,-1)]=E[this._idx(0,0)],E[this._idx(v,-1)]=E[this._idx(v-1,0)],E[this._idx(-1,v)]=E[this._idx(0,v-1)],E[this._idx(v,v)]=E[this._idx(v-1,v-1)],_&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new A3(this)}get(e,o,c=!1){c&&(e=Bt(e,-1,this.dim),o=Bt(o,-1,this.dim));const f=4*this._idx(e,o);return(this.encoding==="terrarium"?hk:uk)(this.pixels[f],this.pixels[f+1],this.pixels[f+2])}static getUnpackVector(e){return I3[e]}get unpackVector(){return I3[this.encoding]}_idx(e,o){if(e<-1||e>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(e+1)}static pack(e,o){const c=[0,0,0,0],f=q1.getUnpackVector(o);let _=Math.floor((e+f[3])/f[2]);return c[2]=_%256,_=Math.floor(_/256),c[1]=_%256,_=Math.floor(_/256),c[0]=_,c}getPixels(){return new zo({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,o,c){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let f=o*this.dim,_=o*this.dim+this.dim,v=c*this.dim,E=c*this.dim+this.dim;switch(o){case-1:f=_-1;break;case 1:_=f+1}switch(c){case-1:v=E-1;break;case 1:E=v+1}const S=-o*this.dim,k=-c*this.dim;for(let L=v;L<E;L++)for(let z=f;z<_;z++){const N=4*this._idx(z,L),W=4*this._idx(z+S,L+k);this.pixels[N+0]=e.pixels[W+0],this.pixels[N+1]=e.pixels[W+1],this.pixels[N+2]=e.pixels[W+2],this.pixels[N+3]=e.pixels[W+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}gn(q1,"DEMData"),gn(A3,"DemMinMaxQuadTree",{omit:["dem"]});class dk{constructor(e,o){this.max=e,this.onRemove=o,this.reset()}reset(){for(const e in this.data)for(const o of this.data[e])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(e,o,c){const f=e.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const _={value:o,timeout:void 0};if(c!==void 0&&(_.timeout=setTimeout(()=>{this.remove(e,_)},c)),this.data[f].push(_),this.order.push(f),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const o=this.data[e].shift();return o.timeout&&clearTimeout(o.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),o.value}getByKey(e){const o=this.data[e];return o?o[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,o){if(!this.has(e))return this;const c=e.wrapped().key,f=o===void 0?0:this.data[c].indexOf(o),_=this.data[c][f];return this.data[c].splice(f,1),_.timeout&&clearTimeout(_.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(_.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(e){const o=[];for(const c in this.data)for(const f of this.data[c])e(f.value)||o.push(f);for(const c of o)this.remove(c.value.tileID,c)}}class om{constructor(e,o,c){this.func=e,this.mask=o,this.range=c}}om.ReadOnly=!1,om.ReadWrite=!0,om.disabled=new om(519,om.ReadOnly,[0,1]);const iv=7680;class ov{constructor(e,o,c,f,_,v){this.test=e,this.ref=o,this.mask=c,this.fail=f,this.depthFail=_,this.pass=v}}ov.disabled=new ov({func:519,mask:0},0,0,iv,iv,iv);class Gc{constructor(e,o,c){this.blendFunction=e,this.blendColor=o,this.mask=c}}Gc.Replace=[1,0],Gc.disabled=new Gc(Gc.Replace,_i.transparent,[!1,!1,!1,!1]),Gc.unblended=new Gc(Gc.Replace,_i.transparent,[!0,!0,!0,!0]),Gc.alphaBlended=new Gc([1,771],_i.transparent,[!0,!0,!0,!0]);const sv=1029,av=2305;class Hl{constructor(e,o,c){this.enable=e,this.mode=o,this.frontFace=c}}Hl.disabled=new Hl(!1,sv,av),Hl.backCCW=new Hl(!0,sv,av),Hl.backCW=new Hl(!0,sv,2304),Hl.frontCW=new Hl(!0,1028,2304),Hl.frontCCW=new Hl(!0,1028,av);class Bf extends yt{constructor(e,o,c){super(),this.id=e,this._onlySymbols=c,o.on("data",f=>{f.dataType==="source"&&f.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&f.dataType==="source"&&f.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),o.on("error",()=>{this._sourceErrored=!0}),this._source=o,this._tiles={},this._cache=new dk(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=o.minTileCacheSize,this._maxTileCacheSize=o.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new ck,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const o=this._tiles[e];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,o){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,o)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const c=this._tiles[o];c.upload(e),c.prepare(this.map.style.imageManager)}}getIds(){return zn(this._tiles).map(e=>e.tileID).sort(L3).map(e=>e.key)}getRenderableIds(e){const o=[];for(const c in this._tiles)this._isIdRenderable(+c,e)&&o.push(this._tiles[c]);return e?o.sort((c,f)=>{const _=c.tileID,v=f.tileID,E=new ge(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),S=new ge(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-v.overscaledZ||S.y-E.y||S.x-E.x}).map(c=>c.tileID.key):o.map(c=>c.tileID).sort(L3).map(c=>c.key)}hasRenderableParent(e){const o=this.findLoadedParent(e,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(e,o){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(o||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,o){const c=this._tiles[e];c&&(c.state!=="loading"&&(c.state=o),this._loadTile(c,this._tileLoaded.bind(this,c,e,o)))}_tileLoaded(e,o,c,f){if(f)if(e.state="errored",f.status!==404)this._source.fire(new cn(f,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const _=this.map.painter.terrain;this.update(this.transform,_.getScaledDemTileSize(),!0),_.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Pn.now(),c==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(o,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new En("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const o=this.getRenderableIds();for(let f=0;f<o.length;f++){const _=o[f];if(e.neighboringTiles&&e.neighboringTiles[_]){const v=this.getTileByID(_);c(e,v),c(v,e)}}function c(f,_){if(!f.dem||f.dem.borderReady)return;f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0;let v=_.tileID.canonical.x-f.tileID.canonical.x;const E=_.tileID.canonical.y-f.tileID.canonical.y,S=Math.pow(2,f.tileID.canonical.z),k=_.tileID.key;v===0&&E===0||Math.abs(E)>1||(Math.abs(v)>1&&(Math.abs(v+S)===1?v+=S:Math.abs(v-S)===1&&(v-=S)),_.dem&&f.dem&&(f.dem.backfillBorder(_.dem,v,E),f.neighboringTiles&&f.neighboringTiles[k]&&(f.neighboringTiles[k].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,o,c,f){for(const _ in this._tiles){let v=this._tiles[_];if(f[_]||!v.hasData()||v.tileID.overscaledZ<=o||v.tileID.overscaledZ>c)continue;let E=v.tileID;for(;v&&v.tileID.overscaledZ>o+1;){const k=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[k.key],v&&v.hasData()&&(E=k)}let S=E;for(;S.overscaledZ>o;)if(S=S.scaledTo(S.overscaledZ-1),e[S.key]){f[E.key]=E;break}}}findLoadedParent(e,o){if(e.key in this._loadedParentTiles){const c=this._loadedParentTiles[e.key];return c&&c.tileID.overscaledZ>=o?c:null}for(let c=e.overscaledZ-1;c>=o;c--){const f=e.scaledTo(c),_=this._getLoadedTile(f);if(_)return _}}_getLoadedTile(e){const o=this._tiles[e.key];return o&&o.hasData()?o:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,o){o=o||this._source.tileSize;const c=Math.ceil(e.width/o)+1,f=Math.ceil(e.height/o)+1,_=Math.floor(c*f*5),v=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,_):_,E=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(E)}handleWrapJump(e){const o=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,o){const c={};for(const f in this._tiles){const _=this._tiles[f];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+o),c[_.tileID.key]=_}this._tiles=c;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(+f,this._tiles[f])}}update(e,o,c){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let f;this.updateCacheSize(e,o),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(E=>new Ns(E.canonical.z,E.wrap,E.canonical.z,E.canonical.x,E.canonical.y)):(f=e.coveringTiles({tileSize:o||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(f=f.filter(E=>this._source.hasTile(E)))):f=[];const _=this._updateRetainedTiles(f);if(R3(this._source.type)&&f.length!==0){const E={},S={},k=Object.keys(_);for(const z of k){const N=_[z],W=this._tiles[z];if(!W||W.fadeEndTime&&W.fadeEndTime<=Pn.now())continue;const q=this.findLoadedParent(N,Math.max(N.overscaledZ-Bf.maxOverzooming,this._source.minzoom));q&&(this._addTile(q.tileID),E[q.tileID.key]=q.tileID),S[z]=N}const L=f[f.length-1].overscaledZ;for(const z in this._tiles){const N=this._tiles[z];if(_[z]||!N.hasData())continue;let W=N.tileID;for(;W.overscaledZ>L;){W=W.scaledTo(W.overscaledZ-1);const q=this._tiles[W.key];if(q&&q.hasData()&&S[W.key]){_[z]=N.tileID;break}}}for(const z in E)_[z]||(this._coveredTiles[z]=!0,_[z]=E[z])}for(const E in _)this._tiles[E].clearFadeHold();const v=function(E,S){const k=[];for(const L in E)L in S||k.push(L);return k}(this._tiles,_);for(const E of v){const S=this._tiles[E];S.hasSymbolBuckets&&!S.holdingForFade()?S.setHoldDuration(this.map._fadeDuration):S.hasSymbolBuckets&&!S.symbolFadeFinished()||this._removeTile(+E)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const o={};if(e.length===0)return o;const c={},f=e.reduce((k,L)=>Math.min(k,L.overscaledZ),1/0),_=e[0].overscaledZ,v=Math.max(_-Bf.maxOverzooming,this._source.minzoom),E=Math.max(_+Bf.maxUnderzooming,this._source.minzoom),S={};for(const k of e){const L=this._addTile(k);o[k.key]=k,L.hasData()||f<this._source.maxzoom&&(S[k.key]=k)}this._retainLoadedChildren(S,f,E,o);for(const k of e){let L=this._tiles[k.key];if(L.hasData())continue;if(k.canonical.z>=this._source.maxzoom){const N=k.children(this._source.maxzoom)[0],W=this.getTile(N);if(W&&W.hasData()){o[N.key]=N;continue}}else{const N=k.children(this._source.maxzoom);if(o[N[0].key]&&o[N[1].key]&&o[N[2].key]&&o[N[3].key])continue}let z=L.wasRequested();for(let N=k.overscaledZ-1;N>=v;--N){const W=k.scaledTo(N);if(c[W.key]||(c[W.key]=!0,L=this.getTile(W),!L&&z&&(L=this._addTile(W)),L&&(o[W.key]=W,z=L.wasRequested(),L.hasData())))break}}return o}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const o=[];let c,f=this._tiles[e].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){c=this._loadedParentTiles[f.key];break}o.push(f.key);const _=f.scaledTo(f.overscaledZ-1);if(c=this._getLoadedTile(_),c)break;f=_}for(const _ of o)this._loadedParentTiles[_]=c}}_addTile(e){let o=this._tiles[e.key];if(o)return o;o=this._cache.getAndRemove(e),o&&(this._setTileReloadTimer(e.key,o),o.tileID=e,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,o)));const c=!!o;if(!c){const f=this.map?this.map.painter:null;o=new rv(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,f,this._isRaster),this._loadTile(o,this._tileLoaded.bind(this,o,e.key,o.state))}return o?(o.uses++,this._tiles[e.key]=o,c||this._source.fire(new En("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o):null}_setTileReloadTimer(e,o){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const c=o.getExpiryTimeout();c&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},c))}_removeTile(e){const o=this._tiles[e];o&&(o.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,o,c){const f=[],_=this.transform;if(!_)return f;const v=_.projection.name==="globe",E=ji(_.center.lng);for(const S in this._tiles){const k=this._tiles[S];if(c&&k.clearQueryDebugViz(),k.holdingForFade())continue;let L;if(v){const z=k.tileID.canonical;if(z.z===0){const N=[Math.abs(Bt(E,...Fg(z,-1))-E),Math.abs(Bt(E,...Fg(z,1))-E)];L=[0,2*N.indexOf(Math.min(...N))-1]}else{const N=[Math.abs(Bt(E,...Fg(z,-1))-E),Math.abs(Bt(E,...Fg(z,0))-E),Math.abs(Bt(E,...Fg(z,1))-E)];L=[N.indexOf(Math.min(...N))-1]}}else L=[0];for(const z of L){const N=e.containsTile(k,_,o,z);N&&f.push(N)}}return f}getVisibleCoordinates(e){const o=this.getRenderableIds(e).map(c=>this._tiles[c].tileID);for(const c of o)c.projMatrix=this.transform.calculateProjMatrix(c.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if(R3(this._source.type))for(const e in this._tiles){const o=this._tiles[e];if(o.fadeEndTime!==void 0&&o.fadeEndTime>=Pn.now())return!0}return!1}setFeatureState(e,o,c){this._state.updateState(e=e||"_geojsonTileLayer",o,c)}removeFeatureState(e,o,c){this._state.removeFeatureState(e=e||"_geojsonTileLayer",o,c)}getFeatureState(e,o){return this._state.getState(e=e||"_geojsonTileLayer",o)}setDependencies(e,o,c){const f=this._tiles[e];f&&f.setDependencies(o,c)}reloadTilesForDependencies(e,o){for(const c in this._tiles)this._tiles[c].hasDependency(e,o)&&this._reloadTile(+c,"reloading");this._cache.filter(c=>!c.hasDependency(e,o))}_preloadTiles(e,o){if(!this._sourceLoaded){const E=()=>{this._sourceLoaded&&(this._source.off("data",E),this._preloadTiles(e,o))};return void this._source.on("data",E)}const c=new Map,f=Array.isArray(e)?e:[e],_=this.map.painter.terrain,v=this.usedForTerrain&&_?_.getScaledDemTileSize():this._source.tileSize;for(const E of f){const S=E.coveringTiles({tileSize:v,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const k of S)c.set(k.key,k);this.usedForTerrain&&E.updateElevation(!1)}sn(Array.from(c.values()),(E,S)=>{const k=new rv(E,this._source.tileSize*E.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(k,L=>{this._source.type==="raster-dem"&&k.dem&&this._backfillDEM(k),S(L,k)})},o)}}function L3(i,e){const o=Math.abs(2*i.wrap)-+(i.wrap<0),c=Math.abs(2*e.wrap)-+(e.wrap<0);return i.overscaledZ-e.overscaledZ||c-o||e.canonical.y-i.canonical.y||e.canonical.x-i.canonical.x}function R3(i){return i==="raster"||i==="image"||i==="video"||i==="custom"}function Fg(i,e){const o=1<<i.z;return[i.x/o+e,(i.x+1)/o+e]}Bf.maxOverzooming=10,Bf.maxUnderzooming=3;class G1{constructor(e,o,c){this._demTile=e,this._dem=this._demTile.dem,this._scale=o,this._offset=c}static create(e,o,c){const f=c||e.findDEMTileFor(o);if(!f||!f.dem)return;const _=f.dem,v=f.tileID,E=1<<o.canonical.z-v.canonical.z;return new G1(f,f.tileSize/Wn/E,[(o.canonical.x/E-v.canonical.x)*_.dim,(o.canonical.y/E-v.canonical.y)*_.dim])}tileCoordToPixel(e,o){const c=o*this._scale+this._offset[1],f=Math.floor(e*this._scale+this._offset[0]),_=Math.floor(c);return new ge(f,_)}getElevationAt(e,o,c,f){const _=e*this._scale+this._offset[0],v=o*this._scale+this._offset[1],E=Math.floor(_),S=Math.floor(v),k=this._dem;return f=!!f,c?qr(qr(k.get(E,S,f),k.get(E,S+1,f),v-S),qr(k.get(E+1,S,f),k.get(E+1,S+1,f),v-S),_-E):k.get(E,S,f)}getElevationAtPixel(e,o,c){return this._dem.get(e,o,!!c)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Ni(1,e)*this._dem.stride}}class O3{constructor(e,o){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new _a(Wn,16,0),this.featureIndexArray=new dl,this.promoteId=o}insert(e,o,c,f,_,v=0){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,f,_,v);const S=this.grid;for(let k=0;k<o.length;k++){const L=o[k],z=[1/0,1/0,-1/0,-1/0];for(let N=0;N<L.length;N++){const W=L[N];z[0]=Math.min(z[0],W.x),z[1]=Math.min(z[1],W.y),z[2]=Math.max(z[2],W.x),z[3]=Math.max(z[3],W.y)}z[0]<Wn&&z[1]<Wn&&z[2]>=0&&z[3]>=0&&S.insert(E,z[0],z[1],z[2],z[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new dn(new L1(this.rawTileData)).layers,this.sourceLayerCoder=new v3(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,o,c,f){this.loadVTLayers();const _=e.params||{},v=bc(_.filter),E=e.tileResult,S=e.transform,k=E.bufferedTilespaceBounds,L=this.grid.query(k.min.x,k.min.y,k.max.x,k.max.y,(q,X,le,ve)=>Vp(E.bufferedTilespaceGeometry,q,X,le,ve));L.sort(fk);let z=null;S.elevation&&L.length>0&&(z=G1.create(S.elevation,this.tileID));const N={};let W;for(let q=0;q<L.length;q++){const X=L[q];if(X===W)continue;W=X;const le=this.featureIndexArray.get(X);let ve=null;this.loadMatchingFeature(N,le,v,_.layers,_.availableImages,o,c,f,(Re,be,Pe,Be=0)=>(ve||(ve=Wa(Re,this.tileID.canonical,e.tileTransform)),be.queryIntersectsFeature(E,Re,Pe,ve,this.z,e.transform,e.pixelPosMatrix,z,Be)))}return N}loadMatchingFeature(e,o,c,f,_,v,E,S,k){const{featureIndex:L,bucketIndex:z,sourceLayerIndex:N,layoutVertexArrayOffset:W}=o,q=this.bucketLayerIDs[z];if(f&&!function(Re,be){for(let Pe=0;Pe<Re.length;Pe++)if(be.indexOf(Re[Pe])>=0)return!0;return!1}(f,q))return;const X=this.sourceLayerCoder.decode(N),le=this.vtLayers[X].feature(L);if(c.needGeometry){const Re=js(le,!0);if(!c.filter(new O(this.tileID.overscaledZ),Re,this.tileID.canonical))return}else if(!c.filter(new O(this.tileID.overscaledZ),le))return;const ve=this.getId(le,X);for(let Re=0;Re<q.length;Re++){const be=q[Re];if(f&&f.indexOf(be)<0)continue;const Pe=v[be];if(!Pe)continue;let Be={};ve!==void 0&&S&&(Be=S.getState(Pe.sourceLayer||"_geojsonTileLayer",ve));const ze=vn({},E[be]);ze.paint=D3(ze.paint,Pe.paint,le,Be,_),ze.layout=D3(ze.layout,Pe.layout,le,Be,_);const ft=!k||k(le,Pe,Be,W);if(!ft)continue;const ct=new x3(le,this.z,this.x,this.y,ve);ct.layer=ze;let Pt=e[be];Pt===void 0&&(Pt=e[be]=[]),Pt.push({featureIndex:L,feature:ct,intersectionZ:ft})}}lookupSymbolFeatures(e,o,c,f,_,v,E,S){const k={};this.loadVTLayers();const L=bc(_);for(const z of e)this.loadMatchingFeature(k,{bucketIndex:c,sourceLayerIndex:f,featureIndex:z,layoutVertexArrayOffset:0},L,v,E,S,o);return k}loadFeature(e){const{featureIndex:o,sourceLayerIndex:c}=e;this.loadVTLayers();const f=this.sourceLayerCoder.decode(c),_=this.vtFeatures[f];if(_[o])return _[o];const v=this.vtLayers[f].feature(o);return _[o]=v,v}hasLayer(e){for(const o of this.bucketLayerIDs)for(const c of o)if(e===c)return!0;return!1}getId(e,o){let c=e.id;if(this.promoteId){const f=typeof this.promoteId=="string"?this.promoteId:this.promoteId[o];f!=null&&(c=e.properties[f]),typeof c=="boolean"&&(c=Number(c))}return c}}function D3(i,e,o,c,f){return wt(i,(_,v)=>{const E=e instanceof ye?e.get(v):null;return E&&E.evaluate?E.evaluate(o,c,f):E})}function fk(i,e){return e-i}gn(O3,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class z3{constructor(e,o){this.width=e,this.height=o,this.nextRow=0,this.image=new Wl({width:e,height:o}),this.positions={},this.uploaded=!1}getDash(e,o){const c=this.getKey(e,o);return this.positions[c]}trim(){const e=this.width,o=this.height=mt(this.nextRow);this.image.resize({width:e,height:o})}getKey(e,o){return e.join(",")+o}getDashRanges(e,o,c){const f=[];let _=e.length%2==1?-e[e.length-1]*c:0,v=e[0]*c,E=!0;f.push({left:_,right:v,isDash:E,zeroLength:e[0]===0});let S=e[0];for(let k=1;k<e.length;k++){E=!E;const L=e[k];_=S*c,S+=L,v=S*c,f.push({left:_,right:v,isDash:E,zeroLength:L===0})}return f}addRoundDash(e,o,c){const f=o/2;for(let _=-c;_<=c;_++){const v=this.width*(this.nextRow+c+_);let E=0,S=e[E];for(let k=0;k<this.width;k++){k/S.right>1&&(S=e[++E]);const L=Math.abs(k-S.left),z=Math.abs(k-S.right),N=Math.min(L,z);let W;const q=_/c*(f+1);if(S.isDash){const X=f-Math.abs(q);W=Math.sqrt(N*N+X*X)}else W=f-Math.sqrt(N*N+q*q);this.image.data[v+k]=Math.max(0,Math.min(255,W+128))}}}addRegularDash(e,o){for(let S=e.length-1;S>=0;--S){const k=e[S],L=e[S+1];k.zeroLength?e.splice(S,1):L&&L.isDash===k.isDash&&(L.left=k.left,e.splice(S,1))}const c=e[0],f=e[e.length-1];c.isDash===f.isDash&&(c.left=f.left-this.width,f.right=c.right+this.width);const _=this.width*this.nextRow;let v=0,E=e[v];for(let S=0;S<this.width;S++){S/E.right>1&&(E=e[++v]);const k=Math.abs(S-E.left),L=Math.abs(S-E.right),z=Math.min(k,L);this.image.data[_+S]=Math.max(0,Math.min(255,(E.isDash?z:-z)+o+128))}}addDash(e,o){const c=this.getKey(e,o);if(this.positions[c])return this.positions[c];const f=o==="round",_=f?7:0,v=2*_+1;if(this.nextRow+v>this.height)return Nn("LineAtlas out of space"),null;e.length===0&&e.push(1);let E=0;for(let L=0;L<e.length;L++)e[L]<0&&(Nn("Negative value is found in line dasharray, replacing values with 0"),e[L]=0),E+=e[L];if(E!==0){const L=this.width/E,z=this.getDashRanges(e,this.width,L);f?this.addRoundDash(z,L,_):this.addRegularDash(z,o==="square"?.5*L:0)}const S=this.nextRow+_;this.nextRow+=v;const k={tl:[S,_],br:[E,0]};return this.positions[c]=k,k}}gn(z3,"LineAtlas");const B3=1*Zl;class j3{constructor(e){const o={},c=[];for(const E in e){const S=e[E],k=o[E]={};for(const L in S.glyphs){const z=S.glyphs[+L];if(!z||z.bitmap.width===0||z.bitmap.height===0)continue;const N=z.metrics.localGlyph?B3:1,W={x:0,y:0,w:z.bitmap.width+2*N,h:z.bitmap.height+2*N};c.push(W),k[L]=W}}const{w:f,h:_}=qy(c),v=new Wl({width:f||1,height:_||1});for(const E in e){const S=e[E];for(const k in S.glyphs){const L=S.glyphs[+k];if(!L||L.bitmap.width===0||L.bitmap.height===0)continue;const z=o[E][k],N=L.metrics.localGlyph?B3:1;Wl.copy(L.bitmap,v,{x:0,y:0},{x:z.x+N,y:z.y+N},L.bitmap)}}this.image=v,this.positions=o}}gn(j3,"GlyphAtlas");class pk{constructor(e){this.tileID=new Ns(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=zf(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,o,c,f,_){this.status="parsing",this.data=e,this.collisionBoxArray=new ni;const v=new v3(Object.keys(e.layers).sort()),E=new O3(this.tileID,this.promoteId);E.bucketLayerIDs=[];const S={},k=new z3(256,256),L={featureIndex:E,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:k,availableImages:c},z=o.familiesBySource[this.source];for(const Be in z){const ze=e.layers[Be];if(!ze)continue;let ft=!1,ct=!1;for(const vt of z[Be])vt[0].type==="symbol"?ft=!0:ct=!0;if(this.isSymbolTile===!0&&!ft||this.isSymbolTile===!1&&!ct)continue;ze.version===1&&Nn(`Vector tile source "${this.source}" layer "${Be}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Pt=v.encode(Be),Jt=[];for(let vt=0;vt<ze.length;vt++){const Rt=ze.feature(vt),Ot=E.getId(Rt,Be);Jt.push({feature:Rt,id:Ot,index:vt,sourceLayerIndex:Pt})}for(const vt of z[Be]){const Rt=vt[0];this.isSymbolTile!==void 0&&Rt.type==="symbol"!==this.isSymbolTile||Rt.minzoom&&this.zoom<Math.floor(Rt.minzoom)||Rt.maxzoom&&this.zoom>=Rt.maxzoom||Rt.visibility!=="none"&&(lv(vt,this.zoom,c),(S[Rt.id]=Rt.createBucket({index:E.bucketLayerIDs.length,layers:vt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Pt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:c})).populate(Jt,L,this.tileID.canonical,this.tileTransform),E.bucketLayerIDs.push(vt.map(Ot=>Ot.id)))}}let N,W,q,X;k.trim();const le={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ve=()=>{if(N)return _(N);if(W&&q&&X){const Be=new j3(W),ze=new qb(q,X);for(const ft in S){const ct=S[ft];ct instanceof rd?(lv(ct.layers,this.zoom,c),F8(ct,W,Be.positions,q,ze.iconPositions,this.showCollisionBoxes,c,this.tileID.canonical,this.tileZoom,this.projection)):ct.hasPattern&&(ct instanceof A1||ct instanceof p||ct instanceof Df)&&(lv(ct.layers,this.zoom,c),ct.addFeatures(L,this.tileID.canonical,ze.patternPositions,c,this.tileTransform))}this.status="done",_(null,{buckets:zn(S).filter(ft=>!ft.isEmpty()),featureIndex:E,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Be.image,lineAtlas:k,imageAtlas:ze,glyphMap:this.returnDependencies?W:null,iconMap:this.returnDependencies?q:null,glyphPositions:this.returnDependencies?Be.positions:null})}},Re=wt(L.glyphDependencies,Be=>Object.keys(Be).map(Number));Object.keys(Re).length?f.send("getGlyphs",{uid:this.uid,stacks:Re},(Be,ze)=>{N||(N=Be,W=ze,ve())},void 0,!1,le):W={};const be=Object.keys(L.iconDependencies);be.length?f.send("getImages",{icons:be,source:this.source,tileID:this.tileID,type:"icons"},(Be,ze)=>{N||(N=Be,q=ze,ve())},void 0,!1,le):q={};const Pe=Object.keys(L.patternDependencies);Pe.length?f.send("getImages",{icons:Pe,source:this.source,tileID:this.tileID,type:"patterns"},(Be,ze)=>{N||(N=Be,X=ze,ve())},void 0,!1,le):X={},ve()}}function lv(i,e,o){const c=new O(e);for(const f of i)f.recalculate(c,o)}class N3{constructor(e){this.entries={},this.scheduler=e}request(e,o,c,f){const _=this.entries[e]=this.entries[e]||{callbacks:[]};if(_.result){const[v,E]=_.result;return this.scheduler?this.scheduler.add(()=>{f(v,E)},o):f(v,E),()=>{}}return _.callbacks.push(f),_.cancel||(_.cancel=c((v,E)=>{_.result=[v,E];for(const S of _.callbacks)this.scheduler?this.scheduler.add(()=>{S(v,E)},o):S(v,E);setTimeout(()=>delete this.entries[e],3e3)})),()=>{_.result||(_.callbacks=_.callbacks.filter(v=>v!==f),_.callbacks.length||(_.cancel(),delete this.entries[e]))}}}function F3(i,e,o){const c=JSON.stringify(i.request);return i.data&&(this.deduped.entries[c]={result:[null,i.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},f=>{const _=go(i.request,(v,E,S,k)=>{v?f(v):E&&f(null,{vectorTile:o?void 0:new dn(new L1(E)),rawData:E,cacheControl:S,expires:k})});return()=>{_.cancel(),f()}},e)}const U3=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class cv{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,c]=new Uint8Array(e,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=c>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const _=U3[15&c];if(!_)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(e,2,1),[E]=new Uint32Array(e,4,1);return new cv(E,v,_,e)}constructor(e,o=64,c=Float64Array,f){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=c,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const _=U3.indexOf(this.ArrayType),v=2*e*this.ArrayType.BYTES_PER_ELEMENT,E=e*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-E%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${c}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+E+S,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+v+E+S),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+E+S,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=e)}add(e,o){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=e,this.coords[this._pos++]=o,c}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return uv(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,o,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:v,nodeSize:E}=this,S=[0,_.length-1,0],k=[];for(;S.length;){const L=S.pop()||0,z=S.pop()||0,N=S.pop()||0;if(z-N<=E){for(let le=N;le<=z;le++){const ve=v[2*le],Re=v[2*le+1];ve>=e&&ve<=c&&Re>=o&&Re<=f&&k.push(_[le])}continue}const W=N+z>>1,q=v[2*W],X=v[2*W+1];q>=e&&q<=c&&X>=o&&X<=f&&k.push(_[W]),(L===0?e<=q:o<=X)&&(S.push(N),S.push(W-1),S.push(1-L)),(L===0?c>=q:f>=X)&&(S.push(W+1),S.push(z),S.push(1-L))}return k}within(e,o,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:_,nodeSize:v}=this,E=[0,f.length-1,0],S=[],k=c*c;for(;E.length;){const L=E.pop()||0,z=E.pop()||0,N=E.pop()||0;if(z-N<=v){for(let le=N;le<=z;le++)V3(_[2*le],_[2*le+1],e,o)<=k&&S.push(f[le]);continue}const W=N+z>>1,q=_[2*W],X=_[2*W+1];V3(q,X,e,o)<=k&&S.push(f[W]),(L===0?e-c<=q:o-c<=X)&&(E.push(N),E.push(W-1),E.push(1-L)),(L===0?e+c>=q:o+c>=X)&&(E.push(W+1),E.push(z),E.push(1-L))}return S}}function uv(i,e,o,c,f,_){if(f-c<=o)return;const v=c+f>>1;$3(i,e,v,c,f,_),uv(i,e,o,c,v-1,1-_),uv(i,e,o,v+1,f,1-_)}function $3(i,e,o,c,f,_){for(;f>c;){if(f-c>600){const k=f-c+1,L=o-c+1,z=Math.log(k),N=.5*Math.exp(2*z/3),W=.5*Math.sqrt(z*N*(k-N)/k)*(L-k/2<0?-1:1);$3(i,e,o,Math.max(c,Math.floor(o-L*N/k+W)),Math.min(f,Math.floor(o+(k-L)*N/k+W)),_)}const v=e[2*o+_];let E=c,S=f;for(Ug(i,e,c,o),e[2*f+_]>v&&Ug(i,e,c,f);E<S;){for(Ug(i,e,E,S),E++,S--;e[2*E+_]<v;)E++;for(;e[2*S+_]>v;)S--}e[2*c+_]===v?Ug(i,e,c,S):(S++,Ug(i,e,S,f)),S<=o&&(c=S+1),o<=S&&(f=S-1)}}function Ug(i,e,o,c){hv(i,o,c),hv(e,2*o,2*c),hv(e,2*o+1,2*c+1)}function hv(i,e,o){const c=i[e];i[e]=i[o],i[o]=c}function V3(i,e,o,c){const f=i-o,_=e-c;return f*f+_*_}a.ARRAY_TYPE=Es,a.AUTH_ERR_MSG=Oe,a.Aabb=Yo,a.Actor=class{constructor(i,e,o){this.target=i,this.parent=e,this.mapId=o,this.callbacks={},this.cancelCallbacks={},xt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Zr()?i:M,this.scheduler=new ak}send(i,e,o,c,f=!1,_){const v=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(o.metadata=_,this.callbacks[v]=o);const E=gi(this.globalScope)?void 0:[];return this.target.postMessage({id:v,type:i,hasCallback:!!o,targetMapId:c,mustQueue:f,sourceMapId:this.mapId,data:Rl(e,E)},E),{cancel:()=>{o&&delete this.callbacks[v],this.target.postMessage({id:v,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(i){const e=i.data,o=e.id;if(o&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const c=this.cancelCallbacks[o];delete this.cancelCallbacks[o],c&&c.cancel()}else if(e.mustQueue||Zr()){const c=this.callbacks[o];this.cancelCallbacks[o]=this.scheduler.add(()=>this.processTask(o,e),c&&c.metadata||{type:"message"})}else this.processTask(o,e)}processTask(i,e){if(e.type==="<response>"){const o=this.callbacks[i];delete this.callbacks[i],o&&(e.error?o(Ol(e.error)):o(null,Ol(e.data)))}else{const o=gi(this.globalScope)?void 0:[],c=e.hasCallback?(_,v)=>{delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:_?Rl(_):null,data:Rl(v,o)},o)}:_=>{},f=Ol(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,f,c);else if(this.parent.getWorkerSource){const _=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,_[0],f.source)[_[1]](f,c)}else c(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=M1,a.Color=_i,a.ColorMode=Gc,a.CullFaceMode=Hl,a.DEMData=q1,a.DataConstantProperty=K,a.DedupedRequest=N3,a.DepthMode=om,a.EXTENT=Wn,a.Elevation=class{isDataAvailableAtPoint(i){const e=this._source();if(this.isUsingMockSource()||!e||i.y<0||i.y>1)return!1;const o=e.getSource().maxzoom,c=1<<o,f=Math.floor(i.x),_=Math.floor((i.x-f)*c),v=Math.floor(i.y*c),E=this.findDEMTileFor(new Ns(o,f,o,_,v));return!(!E||!E.dem)}getAtPointOrZero(i,e=0){return this.getAtPoint(i,e)||0}getAtPoint(i,e,o=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const c=this._source();if(!c||i.y<0||i.y>1)return e;const f=c.getSource().maxzoom,_=1<<f,v=Math.floor(i.x),E=i.x-v,S=new Ns(f,v,f,Math.floor(E*_),Math.floor(i.y*_)),k=this.findDEMTileFor(S);if(!k||!k.dem)return e;const L=k.dem,z=1<<k.tileID.canonical.z,N=(E*z-k.tileID.canonical.x)*L.dim,W=(i.y*z-k.tileID.canonical.y)*L.dim,q=Math.floor(N),X=Math.floor(W);return(o?this.exaggeration():1)*qr(qr(L.get(q,X),L.get(q,X+1),W-X),qr(L.get(q+1,X),L.get(q+1,X+1),W-X),N-q)}getAtTileOffset(i,e,o){const c=1<<i.canonical.z;return this.getAtPointOrZero(new Ul(i.wrap+(i.canonical.x+e/Wn)/c,(i.canonical.y+o/Wn)/c))}getAtTileOffsetFunc(i,e,o,c){return f=>{const _=this.getAtTileOffset(i,f.x,f.y),v=c.upVector(i.canonical,f.x,f.y);return $i(v,v,_*c.upVectorScale(i.canonical,e,o).metersToTile),v}}getForTilePoints(i,e,o,c){if(this.isUsingMockSource())return!1;const f=G1.create(this,i,c);return!!f&&(e.forEach(_=>{_[2]=this.exaggeration()*f.getElevationAt(_[0],_[1],o)}),!0)}getMinMaxForTile(i){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(i);if(!e||!e.dem)return null;const o=e.dem.tree,c=e.tileID,f=1<<i.canonical.z-c.canonical.z;let _=i.canonical.x/f-c.canonical.x,v=i.canonical.y/f-c.canonical.y,E=0;for(let S=0;S<i.canonical.z-c.canonical.z&&!o.leaves[E];S++){_*=2,v*=2;const k=2*Math.floor(v)+Math.floor(_);E=o.childOffsets[E]+k,_%=1,v%=1}return{min:this.exaggeration()*o.minimums[E],max:this.exaggeration()*o.maximums[E]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,e,o){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=cn,a.EvaluationParameters=O,a.Event=En,a.Evented=yt,a.FillExtrusionBucket=Df,a.Frustum=wf,a.FrustumCorners=zp,a.GLOBE_RADIUS=Zi,a.GLOBE_SCALE_MATCH_LATITUDE=45,a.GLOBE_ZOOM_THRESHOLD_MAX=Zh,a.GLOBE_ZOOM_THRESHOLD_MIN=Bp,a.GlobeSharedBuffers=class{constructor(i){this._createGrid(i),this._createPoles(i)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const i of this._poleSegments)i.destroy();for(const i of this._gridSegments)i.withSkirts.destroy(),i.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const i of this._wireframeSegments)i.destroy()}}_fillGridMeshWithLods(i,e){const o=new Kt,c=new jn,f=[],_=i+1+2,v=e[0]+1,E=e[0]+1+(1+e.length),S=(k,L,z)=>{let N=k===_-1?k-2:k===0?k:k-1;return N+=z?24575:0,[N,L]};for(let k=0;k<_;++k)o.emplaceBack(...S(k,0,!0));for(let k=0;k<v;++k)for(let L=0;L<_;++L)o.emplaceBack(...S(L,k,(L===0||L===_-1)&&!0));for(let k=0;k<e.length;++k){const L=e[k];for(let z=0;z<_;++z)o.emplaceBack(...S(z,L,!0))}for(let k=0;k<e.length;++k){const L=c.length,z=e[k]+1+2,N=new jn;for(let X=0;X<z-1;X++){const le=X===z-2,ve=le?_*(E-e.length+k-X):_;for(let Re=0;Re<_-1;Re++){const be=X*_+Re;X===0||le||Re===0||Re===_-2?(N.emplaceBack(be+1,be,be+ve),N.emplaceBack(be+ve,be+ve+1,be+1)):(c.emplaceBack(be+1,be,be+ve),c.emplaceBack(be+ve,be+ve+1,be+1))}}const W=Ji.simpleSegment(0,L,o.length,c.length-L);for(let X=0;X<N.uint16.length;X+=3)c.emplaceBack(N.uint16[X],N.uint16[X+1],N.uint16[X+2]);const q=Ji.simpleSegment(0,L,o.length,c.length-L);f.push({withoutSkirts:W,withSkirts:q})}return{vertices:o,indices:c,segments:f}}_createGrid(i){const e=this._fillGridMeshWithLods($u,Dc);this._gridSegments=e.segments,this._gridBuffer=i.createVertexBuffer(e.vertices,na.members),this._gridIndexBuffer=i.createIndexBuffer(e.indices,!0)}_createPoles(i){const e=new jn;for(let f=0;f<=$u;f++)e.emplaceBack(0,f+1,f+2);this._poleIndexBuffer=i.createIndexBuffer(e,!0);const o=new di,c=new di;this._poleSegments=[];for(let f=0,_=0;f<Bp;f++){const v=360/(1<<f);o.emplaceBack(0,-Zi,0,.5,0),c.emplaceBack(0,-Zi,0,.5,1);for(let E=0;E<=$u;E++){const S=E/$u,k=qr(0,v,S),[L,z,N]=zc(v1,x1,k,Zi);o.emplaceBack(L,z,N,S,0),c.emplaceBack(L,z,N,S,1)}this._poleSegments.push(Ji.simpleSegment(_,0,66,64)),_+=66}this._poleNorthVertexBuffer=i.createVertexBuffer(o,ug,!1),this._poleSouthVertexBuffer=i.createVertexBuffer(c,ug,!1)}getGridBuffers(i,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[i].withSkirts:this._gridSegments[i].withoutSkirts]}getPoleBuffers(i){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[i]]}getWirefameBuffers(i,e){if(!this._wireframeSegments){const o=new qi,c=$u,f=c+1+2,_=1;this._wireframeSegments=[];for(let v=0,E=0;v<Dc.length;v++){const S=Dc[v];for(let L=_;L<S+_;L++)for(let z=_;z<c+_;z++){const N=L*f+z;o.emplaceBack(N,N+1),o.emplaceBack(N,N+f),o.emplaceBack(N,N+f+1)}const k=S*c*3;this._wireframeSegments.push(Ji.simpleSegment(0,E,(S+1)*f,k)),E+=k}this._wireframeIndexBuffer=i.createIndexBuffer(o)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},a.GlyphManager=em,a.ImagePosition=Gy,a.KDBush=cv,a.LivePerformanceUtils=ur,a.LngLat=$r,a.LngLatBounds=jl,a.LocalGlyphMode=Ky,a.MAX_MERCATOR_LATITUDE=uo,a.MercatorCoordinate=Ul,a.ONE_EM=Qo,a.OverscaledTileID=Ns,a.PerformanceMarkers=Cn,a.Point=ge,a.Properties=Ce,a.RGBAImage=zo,a.Ray=hg,a.RequestManager=class{constructor(i,e,o){this._transformRequestFn=i,this._customAccessToken=e,this._silenceAuthErrors=!!o,this._createSkuToken()}_createSkuToken(){const i=function(){let e="";for(let o=0;o<10;o++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",_e,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,e){return this._transformRequestFn&&this._transformRequestFn(i,e)||{url:i}}normalizeStyleURL(i,e){if(!Ge(i))return i;const o=Gt(i);return o.path=`/styles/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||e)}normalizeGlyphsURL(i,e){if(!Ge(i))return i;const o=Gt(i);return o.path=`/fonts/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||e)}normalizeSourceURL(i,e,o,c){if(!Ge(i))return i;const f=Gt(i);return f.path=`/v4/${f.authority}.json`,f.params.push("secure"),o&&f.params.push(`language=${o}`),c&&f.params.push(`worldview=${c}`),this._makeAPIURL(f,this._customAccessToken||e)}normalizeSpriteURL(i,e,o,c){const f=Gt(i);return Ge(i)?(f.path=`/styles/v1${f.path}/sprite${e}${o}`,this._makeAPIURL(f,this._customAccessToken||c)):(f.path+=`${e}${o}`,$t(f))}normalizeTileURL(i,e,o){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!Ge(i))return i;const c=Gt(i);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||o&&c.authority!=="raster"&&o===512?"@2x":""}${Z.supported?".webp":"$1"}`),c.authority==="raster"?c.path=`/${F.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${F.TILE_URL_VERSION}${c.path}`);const f=this._customAccessToken||function(_){for(const v of _){const E=v.match(/^access_token=(.*)$/);if(E)return E[1]}return null}(c.params)||F.ACCESS_TOKEN;return F.REQUIRE_ACCESS_TOKEN&&f&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,f)}canonicalizeTileURL(i,e){const o=Gt(i);if(!o.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!o.path.match(/\.[\w]+$/))return i;let c="mapbox://";o.path.match(/^\/raster\/v1\//)?c+=`raster/${o.path.replace(`/${F.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${o.path.replace(`/${F.TILE_URL_VERSION}/`,"")}`;let f=o.params;return e&&(f=f.filter(_=>!_.match(/^access_token=/))),f.length&&(c+=`?${f.join("&")}`),c}canonicalizeTileset(i,e){const o=!!e&&Ge(e),c=[];for(const f of i.tiles||[])rt(f)?c.push(this.canonicalizeTileURL(f,o)):c.push(f);return c}_makeAPIURL(i,e){const o="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",c=Gt(F.API_URL);if(i.protocol=c.protocol,i.authority=c.authority,i.protocol==="http"){const f=i.params.indexOf("secure");f>=0&&i.params.splice(f,1)}if(c.path!=="/"&&(i.path=`${c.path}${i.path}`),!F.REQUIRE_ACCESS_TOKEN)return $t(i);if(e=e||F.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${o}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${o}`)}return i.params=i.params.filter(f=>f.indexOf("access_token")===-1),i.params.push(`access_token=${e||""}`),$t(i)}},a.ResourceType=ao,a.SegmentVector=Ji,a.SourceCache=Bf,a.StencilMode=ov,a.StructArrayLayout1ui2=bs,a.StructArrayLayout2f1f2i16=Zn,a.StructArrayLayout2i4=Kt,a.StructArrayLayout2ui4=qi,a.StructArrayLayout3f12=Or,a.StructArrayLayout3ui6=jn,a.StructArrayLayout4i8=Mt,a.StructArrayLayout5f20=di,a.Texture=Ng,a.Tile=rv,a.Transitionable=H,a.Uniform1f=Uh,a.Uniform1i=class extends Fa{constructor(i){super(i),this.current=0}set(i,e,o){this.fetchUniformLocation(i,e)&&this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},a.Uniform2f=class extends Fa{constructor(i){super(i),this.current=[0,0]}set(i,e,o){this.fetchUniformLocation(i,e)&&(o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1])))}},a.Uniform3f=class extends Fa{constructor(i){super(i),this.current=[0,0,0]}set(i,e,o){this.fetchUniformLocation(i,e)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2])))}},a.Uniform4f=Ua,a.UniformColor=ea,a.UniformMatrix2f=class extends Fa{constructor(i){super(i),this.current=eg}set(i,e,o){if(this.fetchUniformLocation(i,e)){for(let c=0;c<4;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix2fv(this.location,!1,o);break}}}},a.UniformMatrix3f=class extends Fa{constructor(i){super(i),this.current=Qm}set(i,e,o){if(this.fetchUniformLocation(i,e)){for(let c=0;c<9;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}}},a.UniformMatrix4f=class extends Fa{constructor(i){super(i),this.current=ff}set(i,e,o){if(this.fetchUniformLocation(i,e)){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let c=1;c<16;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}}},a.UnwrappedTileID=Pb,a.ValidationError=fn,a.VectorTileFeature=tr,a.VectorTileWorkerSource=class extends yt{constructor(i,e,o,c,f){super(),this.actor=i,this.layerIndex=e,this.availableImages=o,this.loadVectorData=f||F3,this.loading={},this.loaded={},this.deduped=new N3(i.scheduler),this.isSpriteLoaded=c,this.scheduler=i.scheduler}loadTile(i,e){const o=i.uid,c=i&&i.request,f=c&&c.collectResourceTiming,_=this.loading[o]=new pk(i);_.abort=this.loadVectorData(i,(v,E)=>{const S=!this.loading[o];if(delete this.loading[o],S||v||!E)return _.status="done",S||(this.loaded[o]=_),e(v);const k=E.rawData,L={};E.expires&&(L.expires=E.expires),E.cacheControl&&(L.cacheControl=E.cacheControl),_.vectorTile=E.vectorTile||new dn(new L1(k));const z=()=>{_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,(N,W)=>{if(N||!W)return e(N);const q={};if(f){const X=Sr(c);X.length>0&&(q.resourceTiming=JSON.parse(JSON.stringify(X)))}e(null,vn({rawTileData:k.slice(0)},W,L,q))})};this.isSpriteLoaded?z():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(z,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom}):z()}),this.loaded=this.loaded||{},this.loaded[o]=_})}reloadTile(i,e){const o=this.loaded,c=i.uid,f=this;if(o&&o[c]){const _=o[c];_.showCollisionBoxes=i.showCollisionBoxes,_.enableTerrain=!!i.enableTerrain,_.projection=i.projection,_.tileTransform=zf(i.tileID.canonical,i.projection);const v=(E,S)=>{const k=_.reloadCallback;k&&(delete _.reloadCallback,_.parse(_.vectorTile,f.layerIndex,this.availableImages,f.actor,k)),e(E,S)};_.status==="parsing"?_.reloadCallback=v:_.status==="done"&&(_.vectorTile?_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,v):v())}}abortTile(i,e){const o=i.uid,c=this.loading[o];c&&(c.abort&&c.abort(),delete this.loading[o]),e()}removeTile(i,e){const o=this.loaded,c=i.uid;o&&o[c]&&delete o[c],e()}},a.WritingMode=Ga,a.ZoomDependentExpression=sl,a.add=pl,a.addDynamicAttributes=$1,a.adjoint=function(i,e){var o=e[0],c=e[1],f=e[2],_=e[3],v=e[4],E=e[5],S=e[6],k=e[7],L=e[8];return i[0]=v*L-E*k,i[1]=f*k-c*L,i[2]=c*E-f*v,i[3]=E*S-_*L,i[4]=o*L-f*S,i[5]=f*_-o*E,i[6]=_*k-v*S,i[7]=c*S-o*k,i[8]=o*v-c*_,i},a.asyncAll=sn,a.bezier=Sn,a.bindAll=xt,a.boundsAttributes=b3,a.bufferConvexPolygon=function(i,e){const o=[];for(let c=0;c<i.length;c++){const f=At(c-1,-1,i.length-1),_=At(c+1,-1,i.length-1),v=i[c],E=i[_],S=i[f].sub(v).unit(),k=E.sub(v).unit(),L=k.angleWithSep(S.x,S.y),z=S.add(k).unit().mult(-1*e/Math.sin(L/2));o.push(v.add(z))}return o},a.cacheEntryPossiblyAdded=function(i){Fi++,Fi>cr&&(i.getActor().send("enforceCacheSizeLimit",Nr),Fi=0)},a.calculateGlobeLabelMatrix=function(i,e){const{x:o,y:c}=i.point,f=mg(o,c,i.worldSize/i._pixelsPerMercatorPixel,0,0);return Rc(f,f,ra(Bs(e)))},a.calculateGlobeMatrix=function(i){const{x:e,y:o}=i.point,{lng:c,lat:f}=i._center;return mg(e,o,i.worldSize,c,f)},a.calculateGlobeMercatorMatrix=function(i){const e=i.pixelsPerMeter,o=e/Ni(1,i.center.lat),c=$a(new Float64Array(16));return Vh(c,c,[i.point.x,i.point.y,0]),Oc(c,c,[o,o,e]),Float32Array.from(c)},a.circumferenceAtLatitude=si,a.clamp=Bt,a.clearTileCache=function(i){if(!Di())return;const e=M.caches.delete(dr);i&&e.catch(i).then(()=>i())},a.clipLine=i3,a.clone=function(i){var e=new Es(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e},a.clone$1=An,a.collisionCircleLayout=d8,a.config=F,a.conjugate=function(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i[3]=e[3],i},a.create=function(){var i=new Es(16);return Es!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},a.create$1=u1,a.createExpression=pi,a.createLayout=Ye,a.createStyleLayer=function(i){return i.type==="custom"?new rk(i):new ok[i.type](i)},a.cross=Rp,a.degToRad=lt,a.distance=function(i,e){return Math.hypot(e[0]-i[0],e[1]-i[1],e[2]-i[2])},a.div=function(i,e,o){return i[0]=e[0]/o[0],i[1]=e[1]/o[1],i[2]=e[2]/o[2],i},a.dot=ta,a.earthRadius=Tf,a.ease=qt,a.easeCubicInOut=In,a.ecefToLatLng=function([i,e,o]){const c=Math.hypot(i,e,o),f=Math.atan2(i,o),_=.5*Math.PI-Math.acos(-e/c);return new $r(ht(f),ht(_))},a.emitValidationErrors=Ho,a.endsWith=Nt,a.enforceCacheSizeLimit=function(i){wr(),Cr&&Cr.then(e=>{e.keys().then(o=>{for(let c=0;c<o.length-i;c++)e.delete(o[c])})})},a.evaluateSizeForFeature=P1,a.evaluateSizeForZoom=Xp,a.evaluateVariableOffset=c3,a.evented=w,a.exactEquals=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]},a.exactEquals$1=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]},a.exported=Pn,a.exported$1=Z,a.extend=vn,a.extend$1=Dt,a.fillExtrusionHeightLift=kb,a.filterObject=hn,a.fromMat4=function(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],i},a.fromQuat=function(i,e){var o=e[0],c=e[1],f=e[2],_=e[3],v=o+o,E=c+c,S=f+f,k=o*v,L=c*v,z=c*E,N=f*v,W=f*E,q=f*S,X=_*v,le=_*E,ve=_*S;return i[0]=1-z-q,i[1]=L+ve,i[2]=N-le,i[3]=0,i[4]=L-ve,i[5]=1-k-q,i[6]=W+X,i[7]=0,i[8]=N+le,i[9]=W-X,i[10]=1-k-z,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},a.fromRotation=function(i,e){var o=Math.sin(e),c=Math.cos(e);return i[0]=c,i[1]=o,i[2]=0,i[3]=-o,i[4]=c,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},a.fromScaling=h1,a.furthestTileCorner=function(i){const e=Math.round((i+45+360)%360/90)%4;return Wt[e]},a.getAABBPointSquareDist=function(i,e,o){let c=0;for(let f=0;f<2;++f){const _=o?o[f]:0;i[f]>_&&(c+=(i[f]-_)*(i[f]-_)),e[f]<_&&(c+=(_-e[f])*(_-e[f]))}return c},a.getAnchorAlignment=Hy,a.getAnchorJustification=Yy,a.getBounds=function(i){let e=1/0,o=1/0,c=-1/0,f=-1/0;for(const _ of i)e=Math.min(e,_.x),o=Math.min(o,_.y),c=Math.max(c,_.x),f=Math.max(f,_.y);return{min:new ge(e,o),max:new ge(c,f)}},a.getColumn=Ri,a.getDefaultExportFromCjs=Ie,a.getGridMatrix=function(i,e,o,c){const f=e.getNorth(),_=e.getSouth(),v=e.getWest(),E=e.getEast(),S=1<<i.z,k=E-v,L=f-_,z=k/$u,N=-L/Dc[o],W=[0,z,0,N,0,0,f,v,0];if(i.z>0){const q=180/c;ng(W,W,[q/k+1,0,0,0,q/L+1,0,-.5*q/z,.5*q/N,1])}return W[2]=S,W[5]=i.x,W[8]=i.y,W},a.getImage=ke,a.getJSON=function(i,e){return Fo(vn(i,{type:"json"}),e)},a.getLatitudinalLod=function(i){const e=uo-5;i=Bt(i,-e,e)/e*90;const o=Math.pow(Math.abs(Math.sin(lt(i))),3);return Math.round(o*(Dc.length-1))},a.getMapSessionAPI=ln,a.getPerformanceMeasurement=Sr,a.getProjection=_3,a.getRTLTextPluginStatus=T,a.getReferrer=Ao,a.getTilePoint=function(i,{x:e,y:o},c=0){return new ge(((e-c)*i.scale-i.x)*Wn,(o*i.scale-i.y)*Wn)},a.getTileVec3=function(i,e,o=0){return Fu(((e.x-o)*i.scale-i.x)*Wn,(e.y*i.scale-i.y)*Wn,ko(e.z,e.y))},a.getVideo=function(i,e){const o=M.document.createElement("video");o.muted=!0,o.onloadstart=function(){e(null,o)};for(let c=0;c<i.length;c++){const f=M.document.createElement("source");rs(i[c])||(o.crossOrigin="Anonymous"),f.src=i[c],o.appendChild(f)}return{cancel:()=>{}}},a.globeCenterToScreenPoint=function(i){const e=[0,0,0],o=$a(new Float64Array(16));return Rc(o,i.pixelMatrix,i.globeMatrix),Gi(e,e,o),new ge(e[0],e[1])},a.globeDenormalizeECEF=ra,a.globeECEFOrigin=function(i,e){const o=[0,0,0];return Gi(o,o,Hh(Bs(e.canonical))),Gi(o,o,i),o},a.globeMetersToEcef=Fl,a.globeNormalizeECEF=Hh,a.globePixelsToTileUnits=function(i,e){return Wn/(512*Math.pow(2,i))*Va(Bs(e))},a.globePoleMatrixForTile=function(i,e,o){const c=$a(new Float64Array(16)),f=(e/(1<<i)-.5)*Math.PI*2;return Pp(c,o.globeMatrix,f),Float32Array.from(c)},a.globeTileBounds=Bs,a.globeTiltAtLngLat=y1,a.globeToMercatorTransition=Cs,a.globeUseCustomAntiAliasing=function(i,e,o){const c=Cs(o.zoom),f=i.style.map._antialias,_=!!e.extStandardDerivatives,v=e.extStandardDerivativesForceOff||i.terrain&&i.terrain.exaggeration()>0;return c===0&&!f&&!v&&_},a.identity=$a,a.identity$1=Dp,a.invert=rg,a.isFullscreen=function(){return!!M.document.fullscreenElement||!!M.document.webkitFullscreenElement},a.isLngLatBehindGlobe=Fp,a.isMapAuthenticated=function(i){return or.has(i)},a.isMapboxURL=Ge,a.isSafariWithAntialiasingBug=function(i){const e=i.navigator?i.navigator.userAgent:null;return!!gi(i)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.latFromMercatorY=io,a.latLngToECEF=co,a.len=f1,a.length=_f,a.length$1=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},a.lngFromMercatorX=Hi,a.loadVectorTile=F3,a.makeRequest=Fo,a.mapValue=function(i,e,o,c,f){return Bt((i-e)/(o-e)*(f-c)+c,c,f)},a.mercatorScale=Bc,a.mercatorXfromLng=ji,a.mercatorYfromLat=Ti,a.mercatorZfromAltitude=Ni,a.mul=qh,a.mul$1=sg,a.multiply=Rc,a.multiply$1=ng,a.multiply$2=ig,a.nextPowerOfTwo=mt,a.normalize=Xo,a.normalize$1=m1,a.normalize$2=Op,a.number=qr,a.ortho=function(i,e,o,c,f,_,v){var E=1/(e-o),S=1/(c-f),k=1/(_-v);return i[0]=-2*E,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*S,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*k,i[11]=0,i[12]=(e+o)*E,i[13]=(f+c)*S,i[14]=(v+_)*k,i[15]=1,i},a.pbf=Bb,a.perspective=function(i,e,o,c,f){var _,v=1/Math.tan(e/2);return i[0]=v/o,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=v,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,f!=null&&f!==1/0?(i[10]=(f+c)*(_=1/(c-f)),i[14]=2*f*c*_):(i[10]=-1,i[14]=-2*c),i},a.pick=function(i,e){const o={};for(let c=0;c<e.length;c++){const f=e[c];f in i&&(o[f]=i[f])}return o},a.plugin=I,a.pointGeometry=et,a.polesInViewport=function(i){const e=$a(new Float64Array(16));Rc(e,i.pixelMatrix,i.globeMatrix);const o=[0,Bi,0],c=[0,Ea,0];return Gi(o,o,e),Gi(c,c,e),[o[0]>0&&o[0]<=i.width&&o[1]>0&&o[1]<=i.height&&!Fp(i,new $r(i.center.lat,90)),c[0]>0&&c[0]<=i.width&&c[1]>0&&c[1]<=i.height&&!Fp(i,new $r(i.center.lat,-90))]},a.polygonContainsPoint=$l,a.polygonIntersectsBox=Vp,a.polygonIntersectsPolygon=Yh,a.polygonizeBounds=function(i,e,o=0,c=!0){const f=new ge(o,o),_=i.sub(f),v=e.add(f),E=[_,new ge(v.x,_.y),v,new ge(_.x,v.y)];return c&&E.push(_.clone()),E},a.posAttributes=na,a.postMapLoadEvent=ot,a.postPerformanceEvent=Ut,a.postTurnstileEvent=ce,a.potpack=qy,a.prevPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.floor(Math.log(i)/Math.LN2))},a.radToDeg=ht,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(i){return i({pluginStatus:g,pluginURL:s}),w.on("pluginStateChange",i),i},a.removeAuthState=function(i){or.delete(i)},a.renderColorRamp=Qi,a.resample=Kh,a.rotateX=Wh,a.rotateX$1=vf,a.rotateY=Pp,a.rotateY$1=p1,a.rotateZ=function(i,e,o){var c=Math.sin(o),f=Math.cos(o),_=e[0],v=e[1],E=e[2],S=e[3],k=e[4],L=e[5],z=e[6],N=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=_*f+k*c,i[1]=v*f+L*c,i[2]=E*f+z*c,i[3]=S*f+N*c,i[4]=k*f-_*c,i[5]=L*f-v*c,i[6]=z*f-E*c,i[7]=N*f-S*c,i},a.rotateZ$1=function(i,e,o){o*=.5;var c=e[0],f=e[1],_=e[2],v=e[3],E=Math.sin(o),S=Math.cos(o);return i[0]=c*S+f*E,i[1]=f*S-c*E,i[2]=_*S+v*E,i[3]=v*S-_*E,i},a.scale=Oc,a.scale$1=ag,a.scale$2=$i,a.scaleAndAdd=Do,a.set=function(i,e,o,c){return i[0]=e,i[1]=o,i[2]=c,i},a.setCacheLimits=function(i,e){Nr=i,cr=e},a.setColumn=function(i,e,o){i[4*e+0]=o[0],i[4*e+1]=o[1],i[4*e+2]=o[2],i[4*e+3]=o[3]},a.setRTLTextPlugin=function(i,e,o=!1){if(g===Ys||g===Na||g===Nh)throw new Error("setRTLTextPlugin cannot be called multiple times.");s=Pn.resolveURL(i),g=Ys,hl=e,y(),o||P()},a.smoothstep=je,a.spec=Te,a.squaredLength=function(i){var e=i[0],o=i[1],c=i[2];return e*e+o*o+c*c},a.storeAuthState=function(i,e){e?or.add(i):or.delete(i)},a.sub=ba,a.subtract=Lp,a.symbolSize=f8,a.tileAABB=function(i,e,o,c,f,_,v,E,S){if(S.name==="globe")return _1(i,e,new M1(o,c,f));const k=zf({z:o,x:c,y:f},S);return new Yo([(_+k.x/k.scale)*e,e*(k.y/k.scale),v],[(_+k.x2/k.scale)*e,e*(k.y2/k.scale),E])},a.tileCornersToBounds=bf,a.tileTransform=zf,a.transformMat3=function(i,e,o){var c=e[0],f=e[1],_=e[2];return i[0]=c*o[0]+f*o[3]+_*o[6],i[1]=c*o[1]+f*o[4]+_*o[7],i[2]=c*o[2]+f*o[5]+_*o[8],i},a.transformMat4=Gi,a.transformMat4$1=Nl,a.transformQuat=og,a.transitionTileAABBinECEF=Np,a.translate=Vh,a.transpose=function(i,e){if(i===e){var o=e[1],c=e[2],f=e[5];i[1]=e[3],i[2]=e[6],i[3]=o,i[5]=e[7],i[6]=c,i[7]=f}else i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8];return i},a.triggerPluginCompletionEvent=h,a.uniqueId=Yn,a.updateGlobeVertexNormal=function(i,e,o,c,f){const _=5*e+2;i.float32[_+0]=o,i.float32[_+1]=c,i.float32[_+2]=f},a.validateCustomStyleLayer=function(i){const e=[],o=i.id;return o===void 0&&e.push({message:`layers.${o}: missing required property "id"`}),i.render===void 0&&e.push({message:`layers.${o}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&e.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),e},a.validateFilter=i=>Io(as(i)),a.validateFog=i=>Io(Ba(i)),a.validateLayer=i=>Io(Tp(i)),a.validateLight=i=>Io(Bh(i)),a.validateSource=i=>Io(Il(i)),a.validateStyle=Po,a.validateTerrain=i=>Io(ll(i)),a.values=zn,a.vectorTile=Xe,a.version=R,a.warnOnce=Nn,a.window=M,a.wrap=At}),x(["./shared"],function(a){function M(Ae){if(typeof Ae=="number"||typeof Ae=="boolean"||typeof Ae=="string"||Ae==null)return JSON.stringify(Ae);if(Array.isArray(Ae)){let te="[";for(const ke of Ae)te+=`${M(ke)},`;return`${te}]`}let J="{";for(const te of Object.keys(Ae).sort())J+=`${te}:${M(Ae[te])},`;return`${J}}`}function R(Ae){let J="";for(const te of a.refProperties)J+=`/${M(Ae[te])}`;return J}class j{constructor(J){this.keyCache={},J&&this.replace(J)}replace(J){this._layerConfigs={},this._layers={},this.update(J,[])}update(J,te){for(const Oe of J)this._layerConfigs[Oe.id]=Oe,(this._layers[Oe.id]=a.createStyleLayer(Oe)).compileFilter(),this.keyCache[Oe.id]&&delete this.keyCache[Oe.id];for(const Oe of te)delete this.keyCache[Oe],delete this._layerConfigs[Oe],delete this._layers[Oe];this.familiesBySource={};const ke=function(Oe,Ge){const rt={};for(let Ze=0;Ze<Oe.length;Ze++){const dt=Ge&&Ge[Oe[Ze].id]||R(Oe[Ze]);Ge&&(Ge[Oe[Ze].id]=dt);let Xt=rt[dt];Xt||(Xt=rt[dt]=[]),Xt.push(Oe[Ze])}const it=[];for(const Ze in rt)it.push(rt[Ze]);return it}(a.values(this._layerConfigs),this.keyCache);for(const Oe of ke){const Ge=Oe.map(Gt=>this._layers[Gt.id]),rt=Ge[0];if(rt.visibility==="none")continue;const it=rt.source||"";let Ze=this.familiesBySource[it];Ze||(Ze=this.familiesBySource[it]={});const dt=rt.sourceLayer||"_geojsonTileLayer";let Xt=Ze[dt];Xt||(Xt=Ze[dt]=[]),Xt.push(Ge)}}}class F{loadTile(J,te){const{uid:ke,encoding:Oe,rawImageData:Ge,padding:rt,buildQuadTree:it}=J,Ze=a.window.ImageBitmap&&Ge instanceof a.window.ImageBitmap?this.getImageData(Ge,rt):Ge;te(null,new a.DEMData(ke,Ze,Oe,rt<1,it))}getImageData(J,te){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(J.width,J.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=J.width,this.offscreenCanvas.height=J.height,this.offscreenCanvasContext.drawImage(J,0,0,J.width,J.height);const ke=this.offscreenCanvasContext.getImageData(-te,-te,J.width+2*te,J.height+2*te);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ke}}function Z(Ae,J){if(Ae.length!==0){Y(Ae[0],J);for(var te=1;te<Ae.length;te++)Y(Ae[te],!J)}}function Y(Ae,J){for(var te=0,ke=0,Oe=0,Ge=Ae.length,rt=Ge-1;Oe<Ge;rt=Oe++){var it=(Ae[Oe][0]-Ae[rt][0])*(Ae[rt][1]+Ae[Oe][1]),Ze=te+it;ke+=Math.abs(te)>=Math.abs(it)?te-Ze+it:it-Ze+te,te=Ze}te+ke>=0!=!!J&&Ae.reverse()}var ne=a.getDefaultExportFromCjs(function Ae(J,te){var ke,Oe=J&&J.type;if(Oe==="FeatureCollection")for(ke=0;ke<J.features.length;ke++)Ae(J.features[ke],te);else if(Oe==="GeometryCollection")for(ke=0;ke<J.geometries.length;ke++)Ae(J.geometries[ke],te);else if(Oe==="Feature")Ae(J.geometry,te);else if(Oe==="Polygon")Z(J.coordinates,te);else if(Oe==="MultiPolygon")for(ke=0;ke<J.coordinates.length;ke++)Z(J.coordinates[ke],te);return J});const se=a.VectorTileFeature.prototype.toGeoJSON;var xe={exports:{}},Se=a.pointGeometry,_e=a.vectorTile.VectorTileFeature,Ie=Me;function Me(Ae,J){this.options=J||{},this.features=Ae,this.length=Ae.length}function Ve(Ae,J){this.id=typeof Ae.id=="number"?Ae.id:void 0,this.type=Ae.type,this.rawGeometry=Ae.type===1?[Ae.geometry]:Ae.geometry,this.properties=Ae.tags,this.extent=J||4096}Me.prototype.feature=function(Ae){return new Ve(this.features[Ae],this.options.extent)},Ve.prototype.loadGeometry=function(){var Ae=this.rawGeometry;this.geometry=[];for(var J=0;J<Ae.length;J++){for(var te=Ae[J],ke=[],Oe=0;Oe<te.length;Oe++)ke.push(new Se(te[Oe][0],te[Oe][1]));this.geometry.push(ke)}return this.geometry},Ve.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ae=this.geometry,J=1/0,te=-1/0,ke=1/0,Oe=-1/0,Ge=0;Ge<Ae.length;Ge++)for(var rt=Ae[Ge],it=0;it<rt.length;it++){var Ze=rt[it];J=Math.min(J,Ze.x),te=Math.max(te,Ze.x),ke=Math.min(ke,Ze.y),Oe=Math.max(Oe,Ze.y)}return[J,ke,te,Oe]},Ve.prototype.toGeoJSON=_e.prototype.toGeoJSON;var Ke=a.pbf,et=Ie;function qe(Ae){var J=new Ke;return function(te,ke){for(var Oe in te.layers)ke.writeMessage(3,ge,te.layers[Oe])}(Ae,J),J.finish()}function ge(Ae,J){var te;J.writeVarintField(15,Ae.version||1),J.writeStringField(1,Ae.name||""),J.writeVarintField(5,Ae.extent||4096);var ke={keys:[],values:[],keycache:{},valuecache:{}};for(te=0;te<Ae.length;te++)ke.feature=Ae.feature(te),J.writeMessage(2,We,ke);var Oe=ke.keys;for(te=0;te<Oe.length;te++)J.writeStringField(3,Oe[te]);var Ge=ke.values;for(te=0;te<Ge.length;te++)J.writeMessage(4,In,Ge[te])}function We(Ae,J){var te=Ae.feature;te.id!==void 0&&J.writeVarintField(1,te.id),J.writeMessage(2,Ue,Ae),J.writeVarintField(3,te.type),J.writeMessage(4,Wt,te)}function Ue(Ae,J){var te=Ae.feature,ke=Ae.keys,Oe=Ae.values,Ge=Ae.keycache,rt=Ae.valuecache;for(var it in te.properties){var Ze=te.properties[it],dt=Ge[it];if(Ze!==null){dt===void 0&&(ke.push(it),Ge[it]=dt=ke.length-1),J.writeVarint(dt);var Xt=typeof Ze;Xt!=="string"&&Xt!=="boolean"&&Xt!=="number"&&(Ze=JSON.stringify(Ze));var Gt=Xt+":"+Ze,$t=rt[Gt];$t===void 0&&(Oe.push(Ze),rt[Gt]=$t=Oe.length-1),J.writeVarint($t)}}}function lt(Ae,J){return(J<<3)+(7&Ae)}function ht(Ae){return Ae<<1^Ae>>31}function Wt(Ae,J){for(var te=Ae.loadGeometry(),ke=Ae.type,Oe=0,Ge=0,rt=te.length,it=0;it<rt;it++){var Ze=te[it],dt=1;ke===1&&(dt=Ze.length),J.writeVarint(lt(1,dt));for(var Xt=ke===3?Ze.length-1:Ze.length,Gt=0;Gt<Xt;Gt++){Gt===1&&ke!==1&&J.writeVarint(lt(2,Xt-1));var $t=Ze[Gt].x-Oe,G=Ze[Gt].y-Ge;J.writeVarint(ht($t)),J.writeVarint(ht(G)),Oe+=$t,Ge+=G}ke===3&&J.writeVarint(lt(7,1))}}function In(Ae,J){var te=typeof Ae;te==="string"?J.writeStringField(1,Ae):te==="boolean"?J.writeBooleanField(7,Ae):te==="number"&&(Ae%1!=0?J.writeDoubleField(3,Ae):Ae<0?J.writeSVarintField(6,Ae):J.writeVarintField(5,Ae))}xe.exports=qe,xe.exports.fromVectorTileJs=qe,xe.exports.fromGeojsonVt=function(Ae,J){J=J||{};var te={};for(var ke in Ae)te[ke]=new et(Ae[ke].features,J),te[ke].name=ke,te[ke].version=J.version,te[ke].extent=J.extent;return qe({layers:te})},xe.exports.GeoJSONWrapper=et;var Sn=a.getDefaultExportFromCjs(xe.exports);const qt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ae=>Ae},Bt=Math.fround||(je=new Float32Array(1),Ae=>(je[0]=+Ae,je[0]));var je;const At=3,sn=5,zn=6;class vn{constructor(J){this.options=Object.assign(Object.create(qt),J),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(J){const{log:te,minZoom:ke,maxZoom:Oe}=this.options;te&&console.time("total time");const Ge=`prepare ${J.length} points`;te&&console.time(Ge),this.points=J;const rt=[];for(let Ze=0;Ze<J.length;Ze++){const dt=J[Ze];if(!dt.geometry)continue;const[Xt,Gt]=dt.geometry.coordinates,$t=Bt(ir(Xt)),G=Bt(mt(Gt));rt.push($t,G,1/0,Ze,-1,1),this.options.reduce&&rt.push(0)}let it=this.trees[Oe+1]=this._createTree(rt);te&&console.timeEnd(Ge);for(let Ze=Oe;Ze>=ke;Ze--){const dt=+Date.now();it=this.trees[Ze]=this._createTree(this._cluster(it,Ze)),te&&console.log("z%d: %d clusters in %dms",Ze,it.numItems,+Date.now()-dt)}return te&&console.timeEnd("total time"),this}getClusters(J,te){let ke=((J[0]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,J[1]));let Ge=J[2]===180?180:((J[2]+180)%360+360)%360-180;const rt=Math.max(-90,Math.min(90,J[3]));if(J[2]-J[0]>=360)ke=-180,Ge=180;else if(ke>Ge){const Gt=this.getClusters([ke,Oe,180,rt],te),$t=this.getClusters([-180,Oe,Ge,rt],te);return Gt.concat($t)}const it=this.trees[this._limitZoom(te)],Ze=it.range(ir(ke),mt(rt),ir(Ge),mt(Oe)),dt=it.data,Xt=[];for(const Gt of Ze){const $t=this.stride*Gt;Xt.push(dt[$t+sn]>1?Mn(dt,$t,this.clusterProps):this.points[dt[$t+At]])}return Xt}getChildren(J){const te=this._getOriginId(J),ke=this._getOriginZoom(J),Oe="No cluster with the specified id.",Ge=this.trees[ke];if(!Ge)throw new Error(Oe);const rt=Ge.data;if(te*this.stride>=rt.length)throw new Error(Oe);const it=this.options.radius/(this.options.extent*Math.pow(2,ke-1)),Ze=Ge.within(rt[te*this.stride],rt[te*this.stride+1],it),dt=[];for(const Xt of Ze){const Gt=Xt*this.stride;rt[Gt+4]===J&&dt.push(rt[Gt+sn]>1?Mn(rt,Gt,this.clusterProps):this.points[rt[Gt+At]])}if(dt.length===0)throw new Error(Oe);return dt}getLeaves(J,te,ke){const Oe=[];return this._appendLeaves(Oe,J,te=te||10,ke=ke||0,0),Oe}getTile(J,te,ke){const Oe=this.trees[this._limitZoom(J)],Ge=Math.pow(2,J),{extent:rt,radius:it}=this.options,Ze=it/rt,dt=(ke-Ze)/Ge,Xt=(ke+1+Ze)/Ge,Gt={features:[]};return this._addTileFeatures(Oe.range((te-Ze)/Ge,dt,(te+1+Ze)/Ge,Xt),Oe.data,te,ke,Ge,Gt),te===0&&this._addTileFeatures(Oe.range(1-Ze/Ge,dt,1,Xt),Oe.data,Ge,ke,Ge,Gt),te===Ge-1&&this._addTileFeatures(Oe.range(0,dt,Ze/Ge,Xt),Oe.data,-1,ke,Ge,Gt),Gt.features.length?Gt:null}getClusterExpansionZoom(J){let te=this._getOriginZoom(J)-1;for(;te<=this.options.maxZoom;){const ke=this.getChildren(J);if(te++,ke.length!==1)break;J=ke[0].properties.cluster_id}return te}_appendLeaves(J,te,ke,Oe,Ge){const rt=this.getChildren(te);for(const it of rt){const Ze=it.properties;if(Ze&&Ze.cluster?Ge+Ze.point_count<=Oe?Ge+=Ze.point_count:Ge=this._appendLeaves(J,Ze.cluster_id,ke,Oe,Ge):Ge<Oe?Ge++:J.push(it),J.length===ke)break}return Ge}_createTree(J){const te=new a.KDBush(J.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ke=0;ke<J.length;ke+=this.stride)te.add(J[ke],J[ke+1]);return te.finish(),te.data=J,te}_addTileFeatures(J,te,ke,Oe,Ge,rt){for(const it of J){const Ze=it*this.stride,dt=te[Ze+sn]>1;let Xt,Gt,$t;if(dt)Xt=Yn(te,Ze,this.clusterProps),Gt=te[Ze],$t=te[Ze+1];else{const Q=this.points[te[Ze+At]];Xt=Q.properties;const[B,ce]=Q.geometry.coordinates;Gt=ir(B),$t=mt(ce)}const G={type:1,geometry:[[Math.round(this.options.extent*(Gt*Ge-ke)),Math.round(this.options.extent*($t*Ge-Oe))]],tags:Xt};let ee;ee=dt||this.options.generateId?te[Ze+At]:this.points[te[Ze+At]].id,ee!==void 0&&(G.id=ee),rt.features.push(G)}}_limitZoom(J){return Math.max(this.options.minZoom,Math.min(Math.floor(+J),this.options.maxZoom+1))}_cluster(J,te){const{radius:ke,extent:Oe,reduce:Ge,minPoints:rt}=this.options,it=ke/(Oe*Math.pow(2,te)),Ze=J.data,dt=[],Xt=this.stride;for(let Gt=0;Gt<Ze.length;Gt+=Xt){if(Ze[Gt+2]<=te)continue;Ze[Gt+2]=te;const $t=Ze[Gt],G=Ze[Gt+1],ee=J.within(Ze[Gt],Ze[Gt+1],it),Q=Ze[Gt+sn];let B=Q;for(const ce of ee){const Qe=ce*Xt;Ze[Qe+2]>te&&(B+=Ze[Qe+sn])}if(B>Q&&B>=rt){let ce,Qe=$t*Q,ot=G*Q,Lt=-1;const Ut=((Gt/Xt|0)<<5)+(te+1)+this.points.length;for(const Ln of ee){const ln=Ln*Xt;if(Ze[ln+2]<=te)continue;Ze[ln+2]=te;const or=Ze[ln+sn];Qe+=Ze[ln]*or,ot+=Ze[ln+1]*or,Ze[ln+4]=Ut,Ge&&(ce||(ce=this._map(Ze,Gt,!0),Lt=this.clusterProps.length,this.clusterProps.push(ce)),Ge(ce,this._map(Ze,ln)))}Ze[Gt+4]=Ut,dt.push(Qe/B,ot/B,1/0,Ut,-1,B),Ge&&dt.push(Lt)}else{for(let ce=0;ce<Xt;ce++)dt.push(Ze[Gt+ce]);if(B>1)for(const ce of ee){const Qe=ce*Xt;if(!(Ze[Qe+2]<=te)){Ze[Qe+2]=te;for(let ot=0;ot<Xt;ot++)dt.push(Ze[Qe+ot])}}}}return dt}_getOriginId(J){return J-this.points.length>>5}_getOriginZoom(J){return(J-this.points.length)%32}_map(J,te,ke){if(J[te+sn]>1){const rt=this.clusterProps[J[te+zn]];return ke?Object.assign({},rt):rt}const Oe=this.points[J[te+At]].properties,Ge=this.options.map(Oe);return ke&&Ge===Oe?Object.assign({},Ge):Ge}}function Mn(Ae,J,te){return{type:"Feature",id:Ae[J+At],properties:Yn(Ae,J,te),geometry:{type:"Point",coordinates:[(ke=Ae[J],360*(ke-.5)),bt(Ae[J+1])]}};var ke}function Yn(Ae,J,te){const ke=Ae[J+sn],Oe=ke>=1e4?`${Math.round(ke/1e3)}k`:ke>=1e3?Math.round(ke/100)/10+"k":ke,Ge=Ae[J+zn],rt=Ge===-1?{}:Object.assign({},te[Ge]);return Object.assign(rt,{cluster:!0,cluster_id:Ae[J+At],point_count:ke,point_count_abbreviated:Oe})}function ir(Ae){return Ae/360+.5}function mt(Ae){const J=Math.sin(Ae*Math.PI/180),te=.5-.25*Math.log((1+J)/(1-J))/Math.PI;return te<0?0:te>1?1:te}function bt(Ae){const J=(180-360*Ae)*Math.PI/180;return 360*Math.atan(Math.exp(J))/Math.PI-90}function xt(Ae,J,te,ke){for(var Oe,Ge=ke,rt=te-J>>1,it=te-J,Ze=Ae[J],dt=Ae[J+1],Xt=Ae[te],Gt=Ae[te+1],$t=J+3;$t<te;$t+=3){var G=Nt(Ae[$t],Ae[$t+1],Ze,dt,Xt,Gt);if(G>Ge)Oe=$t,Ge=G;else if(G===Ge){var ee=Math.abs($t-rt);ee<it&&(Oe=$t,it=ee)}}Ge>ke&&(Oe-J>3&&xt(Ae,J,Oe,ke),Ae[Oe+2]=Ge,te-Oe>3&&xt(Ae,Oe,te,ke))}function Nt(Ae,J,te,ke,Oe,Ge){var rt=Oe-te,it=Ge-ke;if(rt!==0||it!==0){var Ze=((Ae-te)*rt+(J-ke)*it)/(rt*rt+it*it);Ze>1?(te=Oe,ke=Ge):Ze>0&&(te+=rt*Ze,ke+=it*Ze)}return(rt=Ae-te)*rt+(it=J-ke)*it}function wt(Ae,J,te,ke){var Oe={id:Ae===void 0?null:Ae,type:J,geometry:te,tags:ke,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ge){var rt=Ge.geometry,it=Ge.type;if(it==="Point"||it==="MultiPoint"||it==="LineString")hn(Ge,rt);else if(it==="Polygon"||it==="MultiLineString")for(var Ze=0;Ze<rt.length;Ze++)hn(Ge,rt[Ze]);else if(it==="MultiPolygon")for(Ze=0;Ze<rt.length;Ze++)for(var dt=0;dt<rt[Ze].length;dt++)hn(Ge,rt[Ze][dt])}(Oe),Oe}function hn(Ae,J){for(var te=0;te<J.length;te+=3)Ae.minX=Math.min(Ae.minX,J[te]),Ae.minY=Math.min(Ae.minY,J[te+1]),Ae.maxX=Math.max(Ae.maxX,J[te]),Ae.maxY=Math.max(Ae.maxY,J[te+1])}function An(Ae,J,te,ke){if(J.geometry){var Oe=J.geometry.coordinates,Ge=J.geometry.type,rt=Math.pow(te.tolerance/((1<<te.maxZoom)*te.extent),2),it=[],Ze=J.id;if(te.promoteId?Ze=J.properties[te.promoteId]:te.generateId&&(Ze=ke||0),Ge==="Point")Fn(Oe,it);else if(Ge==="MultiPoint")for(var dt=0;dt<Oe.length;dt++)Fn(Oe[dt],it);else if(Ge==="LineString")Nn(Oe,it,rt,!1);else if(Ge==="MultiLineString"){if(te.lineMetrics){for(dt=0;dt<Oe.length;dt++)Nn(Oe[dt],it=[],rt,!1),Ae.push(wt(Ze,"LineString",it,J.properties));return}xr(Oe,it,rt,!1)}else if(Ge==="Polygon")xr(Oe,it,rt,!0);else{if(Ge!=="MultiPolygon"){if(Ge==="GeometryCollection"){for(dt=0;dt<J.geometry.geometries.length;dt++)An(Ae,{id:Ze,geometry:J.geometry.geometries[dt],properties:J.properties},te,ke);return}throw new Error("Input data is not a valid GeoJSON object.")}for(dt=0;dt<Oe.length;dt++){var Xt=[];xr(Oe[dt],Xt,rt,!0),it.push(Xt)}}Ae.push(wt(Ze,Ge,it,J.properties))}}function Fn(Ae,J){J.push(nr(Ae[0])),J.push(Zr(Ae[1])),J.push(0)}function Nn(Ae,J,te,ke){for(var Oe,Ge,rt=0,it=0;it<Ae.length;it++){var Ze=nr(Ae[it][0]),dt=Zr(Ae[it][1]);J.push(Ze),J.push(dt),J.push(0),it>0&&(rt+=ke?(Oe*dt-Ze*Ge)/2:Math.sqrt(Math.pow(Ze-Oe,2)+Math.pow(dt-Ge,2))),Oe=Ze,Ge=dt}var Xt=J.length-3;J[2]=1,xt(J,0,Xt,te),J[Xt+2]=1,J.size=Math.abs(rt),J.start=0,J.end=J.size}function xr(Ae,J,te,ke){for(var Oe=0;Oe<Ae.length;Oe++){var Ge=[];Nn(Ae[Oe],Ge,te,ke),J.push(Ge)}}function nr(Ae){return Ae/360+.5}function Zr(Ae){var J=Math.sin(Ae*Math.PI/180),te=.5-.25*Math.log((1+J)/(1-J))/Math.PI;return te<0?0:te>1?1:te}function Br(Ae,J,te,ke,Oe,Ge,rt,it){if(ke/=J,Ge>=(te/=J)&&rt<ke)return Ae;if(rt<te||Ge>=ke)return null;for(var Ze=[],dt=0;dt<Ae.length;dt++){var Xt=Ae[dt],Gt=Xt.geometry,$t=Xt.type,G=Oe===0?Xt.minX:Xt.minY,ee=Oe===0?Xt.maxX:Xt.maxY;if(G>=te&&ee<ke)Ze.push(Xt);else if(!(ee<te||G>=ke)){var Q=[];if($t==="Point"||$t==="MultiPoint")ui(Gt,Q,te,ke,Oe);else if($t==="LineString")gi(Gt,Q,te,ke,Oe,!1,it.lineMetrics);else if($t==="MultiLineString")Ri(Gt,Q,te,ke,Oe,!1);else if($t==="Polygon")Ri(Gt,Q,te,ke,Oe,!0);else if($t==="MultiPolygon")for(var B=0;B<Gt.length;B++){var ce=[];Ri(Gt[B],ce,te,ke,Oe,!0),ce.length&&Q.push(ce)}if(Q.length){if(it.lineMetrics&&$t==="LineString"){for(B=0;B<Q.length;B++)Ze.push(wt(Xt.id,$t,Q[B],Xt.tags));continue}$t!=="LineString"&&$t!=="MultiLineString"||(Q.length===1?($t="LineString",Q=Q[0]):$t="MultiLineString"),$t!=="Point"&&$t!=="MultiPoint"||($t=Q.length===3?"Point":"MultiPoint"),Ze.push(wt(Xt.id,$t,Q,Xt.tags))}}}return Ze.length?Ze:null}function ui(Ae,J,te,ke,Oe){for(var Ge=0;Ge<Ae.length;Ge+=3){var rt=Ae[Ge+Oe];rt>=te&&rt<=ke&&(J.push(Ae[Ge]),J.push(Ae[Ge+1]),J.push(Ae[Ge+2]))}}function gi(Ae,J,te,ke,Oe,Ge,rt){for(var it,Ze,dt=Xi(Ae),Xt=Oe===0?Nr:cr,Gt=Ae.start,$t=0;$t<Ae.length-3;$t+=3){var G=Ae[$t],ee=Ae[$t+1],Q=Ae[$t+2],B=Ae[$t+3],ce=Ae[$t+4],Qe=Oe===0?G:ee,ot=Oe===0?B:ce,Lt=!1;rt&&(it=Math.sqrt(Math.pow(G-B,2)+Math.pow(ee-ce,2))),Qe<te?ot>te&&(Ze=Xt(dt,G,ee,B,ce,te),rt&&(dt.start=Gt+it*Ze)):Qe>ke?ot<ke&&(Ze=Xt(dt,G,ee,B,ce,ke),rt&&(dt.start=Gt+it*Ze)):dr(dt,G,ee,Q),ot<te&&Qe>=te&&(Ze=Xt(dt,G,ee,B,ce,te),Lt=!0),ot>ke&&Qe<=ke&&(Ze=Xt(dt,G,ee,B,ce,ke),Lt=!0),!Ge&&Lt&&(rt&&(dt.end=Gt+it*Ze),J.push(dt),dt=Xi(Ae)),rt&&(Gt+=it)}var Ut=Ae.length-3;G=Ae[Ut],ee=Ae[Ut+1],Q=Ae[Ut+2],(Qe=Oe===0?G:ee)>=te&&Qe<=ke&&dr(dt,G,ee,Q),Ut=dt.length-3,Ge&&Ut>=3&&(dt[Ut]!==dt[0]||dt[Ut+1]!==dt[1])&&dr(dt,dt[0],dt[1],dt[2]),dt.length&&J.push(dt)}function Xi(Ae){var J=[];return J.size=Ae.size,J.start=Ae.start,J.end=Ae.end,J}function Ri(Ae,J,te,ke,Oe,Ge){for(var rt=0;rt<Ae.length;rt++)gi(Ae[rt],J,te,ke,Oe,Ge,!1)}function dr(Ae,J,te,ke){Ae.push(J),Ae.push(te),Ae.push(ke)}function Nr(Ae,J,te,ke,Oe,Ge){var rt=(Ge-J)/(ke-J);return Ae.push(Ge),Ae.push(te+(Oe-te)*rt),Ae.push(1),rt}function cr(Ae,J,te,ke,Oe,Ge){var rt=(Ge-te)/(Oe-te);return Ae.push(J+(ke-J)*rt),Ae.push(Ge),Ae.push(1),rt}function Cr(Ae,J){for(var te=[],ke=0;ke<Ae.length;ke++){var Oe,Ge=Ae[ke],rt=Ge.type;if(rt==="Point"||rt==="MultiPoint"||rt==="LineString")Oe=Oi(Ge.geometry,J);else if(rt==="MultiLineString"||rt==="Polygon"){Oe=[];for(var it=0;it<Ge.geometry.length;it++)Oe.push(Oi(Ge.geometry[it],J))}else if(rt==="MultiPolygon")for(Oe=[],it=0;it<Ge.geometry.length;it++){for(var Ze=[],dt=0;dt<Ge.geometry[it].length;dt++)Ze.push(Oi(Ge.geometry[it][dt],J));Oe.push(Ze)}te.push(wt(Ge.id,rt,Oe,Ge.tags))}return te}function Oi(Ae,J){var te=[];te.size=Ae.size,Ae.start!==void 0&&(te.start=Ae.start,te.end=Ae.end);for(var ke=0;ke<Ae.length;ke+=3)te.push(Ae[ke]+J,Ae[ke+1],Ae[ke+2]);return te}function Di(Ae,J){if(Ae.transformed)return Ae;var te,ke,Oe,Ge=1<<Ae.z,rt=Ae.x,it=Ae.y;for(te=0;te<Ae.features.length;te++){var Ze=Ae.features[te],dt=Ze.geometry,Xt=Ze.type;if(Ze.geometry=[],Xt===1)for(ke=0;ke<dt.length;ke+=2)Ze.geometry.push(wr(dt[ke],dt[ke+1],J,Ge,rt,it));else for(ke=0;ke<dt.length;ke++){var Gt=[];for(Oe=0;Oe<dt[ke].length;Oe+=2)Gt.push(wr(dt[ke][Oe],dt[ke][Oe+1],J,Ge,rt,it));Ze.geometry.push(Gt)}}return Ae.transformed=!0,Ae}function wr(Ae,J,te,ke,Oe,Ge){return[Math.round(te*(Ae*ke-Oe)),Math.round(te*(J*ke-Ge))]}function rr(Ae,J,te,ke,Oe){for(var Ge=J===Oe.maxZoom?0:Oe.tolerance/((1<<J)*Oe.extent),rt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:te,y:ke,z:J,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},it=0;it<Ae.length;it++){rt.numFeatures++,Fi(rt,Ae[it],Ge,Oe);var Ze=Ae[it].minX,dt=Ae[it].minY,Xt=Ae[it].maxX,Gt=Ae[it].maxY;Ze<rt.minX&&(rt.minX=Ze),dt<rt.minY&&(rt.minY=dt),Xt>rt.maxX&&(rt.maxX=Xt),Gt>rt.maxY&&(rt.maxY=Gt)}return rt}function Fi(Ae,J,te,ke){var Oe=J.geometry,Ge=J.type,rt=[];if(Ge==="Point"||Ge==="MultiPoint")for(var it=0;it<Oe.length;it+=3)rt.push(Oe[it]),rt.push(Oe[it+1]),Ae.numPoints++,Ae.numSimplified++;else if(Ge==="LineString")ao(rt,Oe,Ae,te,!1,!1);else if(Ge==="MultiLineString"||Ge==="Polygon")for(it=0;it<Oe.length;it++)ao(rt,Oe[it],Ae,te,Ge==="Polygon",it===0);else if(Ge==="MultiPolygon")for(var Ze=0;Ze<Oe.length;Ze++){var dt=Oe[Ze];for(it=0;it<dt.length;it++)ao(rt,dt[it],Ae,te,!0,it===0)}if(rt.length){var Xt=J.tags||null;if(Ge==="LineString"&&ke.lineMetrics){for(var Gt in Xt={},J.tags)Xt[Gt]=J.tags[Gt];Xt.mapbox_clip_start=Oe.start/Oe.size,Xt.mapbox_clip_end=Oe.end/Oe.size}var $t={geometry:rt,type:Ge==="Polygon"||Ge==="MultiPolygon"?3:Ge==="LineString"||Ge==="MultiLineString"?2:1,tags:Xt};J.id!==null&&($t.id=J.id),Ae.features.push($t)}}function ao(Ae,J,te,ke,Oe,Ge){var rt=ke*ke;if(ke>0&&J.size<(Oe?rt:ke))te.numPoints+=J.length/3;else{for(var it=[],Ze=0;Ze<J.length;Ze+=3)(ke===0||J[Ze+2]>rt)&&(te.numSimplified++,it.push(J[Ze]),it.push(J[Ze+1])),te.numPoints++;Oe&&function(dt,Xt){for(var Gt=0,$t=0,G=dt.length,ee=G-2;$t<G;ee=$t,$t+=2)Gt+=(dt[$t]-dt[ee])*(dt[$t+1]+dt[ee+1]);if(Gt>0===Xt)for($t=0,G=dt.length;$t<G/2;$t+=2){var Q=dt[$t],B=dt[$t+1];dt[$t]=dt[G-2-$t],dt[$t+1]=dt[G-1-$t],dt[G-2-$t]=Q,dt[G-1-$t]=B}}(it,Ge),Ae.push(it)}}function lo(Ae,J){var te=(J=this.options=function(Oe,Ge){for(var rt in Ge)Oe[rt]=Ge[rt];return Oe}(Object.create(this.options),J)).debug;if(te&&console.time("preprocess data"),J.maxZoom<0||J.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(J.promoteId&&J.generateId)throw new Error("promoteId and generateId cannot be used together.");var ke=function(Oe,Ge){var rt=[];if(Oe.type==="FeatureCollection")for(var it=0;it<Oe.features.length;it++)An(rt,Oe.features[it],Ge,it);else An(rt,Oe.type==="Feature"?Oe:{geometry:Oe},Ge);return rt}(Ae,J);this.tiles={},this.tileCoords=[],te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",J.indexMaxZoom,J.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ke=function(Oe,Ge){var rt=Ge.buffer/Ge.extent,it=Oe,Ze=Br(Oe,1,-1-rt,rt,0,-1,2,Ge),dt=Br(Oe,1,1-rt,2+rt,0,-1,2,Ge);return(Ze||dt)&&(it=Br(Oe,1,-rt,1+rt,0,-1,2,Ge)||[],Ze&&(it=Cr(Ze,1).concat(it)),dt&&(it=it.concat(Cr(dt,-1)))),it}(ke,J),ke.length&&this.splitTile(ke,0,0,0),te&&(ke.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ao(Ae,J,te){return 32*((1<<Ae)*te+J)+Ae}function Fo(Ae,J){const te=Ae.tileID.canonical;if(!this._geoJSONIndex)return J(null,null);const ke=this._geoJSONIndex.getTile(te.z,te.x,te.y);if(!ke)return J(null,null);const Oe=new class{constructor(rt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=rt.length,this._features=rt}feature(rt){return new class{constructor(it){this._feature=it,this.extent=a.EXTENT,this.type=it.type,this.properties=it.tags,"id"in it&&!isNaN(it.id)&&(this.id=parseInt(it.id,10))}loadGeometry(){if(this._feature.type===1){const it=[];for(const Ze of this._feature.geometry)it.push([new a.Point(Ze[0],Ze[1])]);return it}{const it=[];for(const Ze of this._feature.geometry){const dt=[];for(const Xt of Ze)dt.push(new a.Point(Xt[0],Xt[1]));it.push(dt)}return it}}toGeoJSON(it,Ze,dt){return se.call(this,it,Ze,dt)}}(this._features[rt])}}(ke.features);let Ge=Sn(Oe);Ge.byteOffset===0&&Ge.byteLength===Ge.buffer.byteLength||(Ge=new Uint8Array(Ge)),J(null,{vectorTile:Oe,rawData:Ge.buffer})}lo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},lo.prototype.splitTile=function(Ae,J,te,ke,Oe,Ge,rt){for(var it=[Ae,J,te,ke],Ze=this.options,dt=Ze.debug;it.length;){ke=it.pop(),te=it.pop(),J=it.pop(),Ae=it.pop();var Xt=1<<J,Gt=Ao(J,te,ke),$t=this.tiles[Gt];if(!$t&&(dt>1&&console.time("creation"),$t=this.tiles[Gt]=rr(Ae,J,te,ke,Ze),this.tileCoords.push({z:J,x:te,y:ke}),dt)){dt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",J,te,ke,$t.numFeatures,$t.numPoints,$t.numSimplified),console.timeEnd("creation"));var G="z"+J;this.stats[G]=(this.stats[G]||0)+1,this.total++}if($t.source=Ae,Oe){if(J===Ze.maxZoom||J===Oe)continue;var ee=1<<Oe-J;if(te!==Math.floor(Ge/ee)||ke!==Math.floor(rt/ee))continue}else if(J===Ze.indexMaxZoom||$t.numPoints<=Ze.indexMaxPoints)continue;if($t.source=null,Ae.length!==0){dt>1&&console.time("clipping");var Q,B,ce,Qe,ot,Lt,Ut=.5*Ze.buffer/Ze.extent,Ln=.5-Ut,ln=.5+Ut,or=1+Ut;Q=B=ce=Qe=null,ot=Br(Ae,Xt,te-Ut,te+ln,0,$t.minX,$t.maxX,Ze),Lt=Br(Ae,Xt,te+Ln,te+or,0,$t.minX,$t.maxX,Ze),Ae=null,ot&&(Q=Br(ot,Xt,ke-Ut,ke+ln,1,$t.minY,$t.maxY,Ze),B=Br(ot,Xt,ke+Ln,ke+or,1,$t.minY,$t.maxY,Ze),ot=null),Lt&&(ce=Br(Lt,Xt,ke-Ut,ke+ln,1,$t.minY,$t.maxY,Ze),Qe=Br(Lt,Xt,ke+Ln,ke+or,1,$t.minY,$t.maxY,Ze),Lt=null),dt>1&&console.timeEnd("clipping"),it.push(Q||[],J+1,2*te,2*ke),it.push(B||[],J+1,2*te,2*ke+1),it.push(ce||[],J+1,2*te+1,2*ke),it.push(Qe||[],J+1,2*te+1,2*ke+1)}}},lo.prototype.getTile=function(Ae,J,te){var ke=this.options,Oe=ke.extent,Ge=ke.debug;if(Ae<0||Ae>24)return null;var rt=1<<Ae,it=Ao(Ae,J=(J%rt+rt)%rt,te);if(this.tiles[it])return Di(this.tiles[it],Oe);Ge>1&&console.log("drilling down to z%d-%d-%d",Ae,J,te);for(var Ze,dt=Ae,Xt=J,Gt=te;!Ze&&dt>0;)dt--,Xt=Math.floor(Xt/2),Gt=Math.floor(Gt/2),Ze=this.tiles[Ao(dt,Xt,Gt)];return Ze&&Ze.source?(Ge>1&&console.log("found parent tile z%d-%d-%d",dt,Xt,Gt),Ge>1&&console.time("drilling down"),this.splitTile(Ze.source,dt,Xt,Gt,Ae,J,te),Ge>1&&console.timeEnd("drilling down"),this.tiles[it]?Di(this.tiles[it],Oe):null):null};class go extends a.VectorTileWorkerSource{constructor(J,te,ke,Oe,Ge){super(J,te,ke,Oe,Fo),Ge&&(this.loadGeoJSON=Ge)}loadData(J,te){const ke=J&&J.request,Oe=ke&&ke.collectResourceTiming;this.loadGeoJSON(J,(Ge,rt)=>{if(Ge||!rt)return te(Ge);if(typeof rt!="object")return te(new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`));{ne(rt,!0);try{if(J.filter){const Ze=a.createExpression(J.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ze.result==="error")throw new Error(Ze.value.map(Xt=>`${Xt.key}: ${Xt.message}`).join(", "));rt={type:"FeatureCollection",features:rt.features.filter(Xt=>Ze.value.evaluate({zoom:0},Xt))}}this._geoJSONIndex=J.cluster?new vn(function({superclusterOptions:Ze,clusterProperties:dt}){if(!dt||!Ze)return Ze;const Xt={},Gt={},$t={accumulated:null,zoom:0},G={properties:null},ee=Object.keys(dt);for(const Q of ee){const[B,ce]=dt[Q],Qe=a.createExpression(ce),ot=a.createExpression(typeof B=="string"?[B,["accumulated"],["get",Q]]:B);Xt[Q]=Qe.value,Gt[Q]=ot.value}return Ze.map=Q=>{G.properties=Q;const B={};for(const ce of ee)B[ce]=Xt[ce].evaluate($t,G);return B},Ze.reduce=(Q,B)=>{G.properties=B;for(const ce of ee)$t.accumulated=Q[ce],Q[ce]=Gt[ce].evaluate($t,G)},Ze}(J)).load(rt.features):function(Ze,dt){return new lo(Ze,dt)}(rt,J.geojsonVtOptions)}catch(Ze){return te(Ze)}this.loaded={};const it={};if(Oe){const Ze=a.getPerformanceMeasurement(ke);Ze&&(it.resourceTiming={},it.resourceTiming[J.source]=JSON.parse(JSON.stringify(Ze)))}te(null,it)}})}reloadTile(J,te){const ke=this.loaded;return ke&&ke[J.uid]?super.reloadTile(J,te):this.loadTile(J,te)}loadGeoJSON(J,te){if(J.request)a.getJSON(J.request,te);else{if(typeof J.data!="string")return te(new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`));try{return te(null,JSON.parse(J.data))}catch{return te(new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(J,te){try{te(null,this._geoJSONIndex.getClusterExpansionZoom(J.clusterId))}catch(ke){te(ke)}}getClusterChildren(J,te){try{te(null,this._geoJSONIndex.getChildren(J.clusterId))}catch(ke){te(ke)}}getClusterLeaves(J,te){try{te(null,this._geoJSONIndex.getLeaves(J.clusterId,J.limit,J.offset))}catch(ke){te(ke)}}}class rs{constructor(J){this.self=J,this.actor=new a.Actor(J,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:go},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(te,ke)=>{if(this.workerSourceTypes[te])throw new Error(`Worker source with name "${te}" already registered.`);this.workerSourceTypes[te]=ke},this.self.registerRTLTextPlugin=te=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=te.applyArabicShaping,a.plugin.processBidirectionalText=te.processBidirectionalText,a.plugin.processStyledBidirectionalText=te.processStyledBidirectionalText}}clearCaches(J,te,ke){delete this.layerIndexes[J],delete this.availableImages[J],delete this.workerSources[J],delete this.demWorkerSources[J],ke()}checkIfReady(J,te,ke){ke()}setReferrer(J,te){this.referrer=te}spriteLoaded(J,te){this.isSpriteLoaded[J]=te;for(const ke in this.workerSources[J]){const Oe=this.workerSources[J][ke];for(const Ge in Oe)Oe[Ge]instanceof a.VectorTileWorkerSource&&(Oe[Ge].isSpriteLoaded=te,Oe[Ge].fire(new a.Event("isSpriteLoaded")))}}setImages(J,te,ke){this.availableImages[J]=te;for(const Oe in this.workerSources[J]){const Ge=this.workerSources[J][Oe];for(const rt in Ge)Ge[rt].availableImages=te}ke()}enableTerrain(J,te,ke){this.terrain=te,ke()}setProjection(J,te){this.projections[J]=a.getProjection(te)}setLayers(J,te,ke){this.getLayerIndex(J).replace(te),ke()}updateLayers(J,te,ke){this.getLayerIndex(J).update(te.layers,te.removedIds),ke()}loadTile(J,te,ke){const Oe=this.enableTerrain?a.extend({enableTerrain:this.terrain},te):te;Oe.projection=this.projections[J]||this.defaultProjection,this.getWorkerSource(J,te.type,te.source).loadTile(Oe,ke)}loadDEMTile(J,te,ke){const Oe=this.enableTerrain?a.extend({buildQuadTree:this.terrain},te):te;this.getDEMWorkerSource(J,te.source).loadTile(Oe,ke)}reloadTile(J,te,ke){const Oe=this.enableTerrain?a.extend({enableTerrain:this.terrain},te):te;Oe.projection=this.projections[J]||this.defaultProjection,this.getWorkerSource(J,te.type,te.source).reloadTile(Oe,ke)}abortTile(J,te,ke){this.getWorkerSource(J,te.type,te.source).abortTile(te,ke)}removeTile(J,te,ke){this.getWorkerSource(J,te.type,te.source).removeTile(te,ke)}removeSource(J,te,ke){if(!this.workerSources[J]||!this.workerSources[J][te.type]||!this.workerSources[J][te.type][te.source])return;const Oe=this.workerSources[J][te.type][te.source];delete this.workerSources[J][te.type][te.source],Oe.removeSource!==void 0?Oe.removeSource(te,ke):ke()}loadWorkerSource(J,te,ke){try{this.self.importScripts(te.url),ke()}catch(Oe){ke(Oe.toString())}}syncRTLPluginState(J,te,ke){try{a.plugin.setState(te);const Oe=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&Oe!=null){this.self.importScripts(Oe);const Ge=a.plugin.isParsed();ke(Ge?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Oe}`),Ge)}}catch(Oe){ke(Oe.toString())}}getAvailableImages(J){let te=this.availableImages[J];return te||(te=[]),te}getLayerIndex(J){let te=this.layerIndexes[J];return te||(te=this.layerIndexes[J]=new j),te}getWorkerSource(J,te,ke){if(this.workerSources[J]||(this.workerSources[J]={}),this.workerSources[J][te]||(this.workerSources[J][te]={}),!this.workerSources[J][te][ke]){const Oe={send:(Ge,rt,it,Ze,dt,Xt)=>{this.actor.send(Ge,rt,it,J,dt,Xt)},scheduler:this.actor.scheduler};this.workerSources[J][te][ke]=new this.workerSourceTypes[te](Oe,this.getLayerIndex(J),this.getAvailableImages(J),this.isSpriteLoaded[J])}return this.workerSources[J][te][ke]}getDEMWorkerSource(J,te){return this.demWorkerSources[J]||(this.demWorkerSources[J]={}),this.demWorkerSources[J][te]||(this.demWorkerSources[J][te]=new F),this.demWorkerSources[J][te]}enforceCacheSizeLimit(J,te){a.enforceCacheSizeLimit(te)}getWorkerPerformanceMetrics(J,te,ke){ke(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new rs(self)),rs}),x(["./shared"],function(a){function M(g,s){if(Array.isArray(g)){if(!Array.isArray(s)||g.length!==s.length)return!1;for(let h=0;h<g.length;h++)if(!M(g[h],s[h]))return!1;return!0}if(typeof g=="object"&&g!==null&&s!==null){if(typeof s!="object"||Object.keys(g).length!==Object.keys(s).length)return!1;for(const h in g)if(!M(g[h],s[h]))return!1;return!0}return g===s}var R=j;function j(g){return!function(s){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var y,w,T=new Blob([""],{type:"text/javascript"}),P=URL.createObjectURL(T);try{w=new Worker(P),y=!0}catch{y=!1}return w&&w.terminate(),URL.revokeObjectURL(P),y}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var y=document.createElement("canvas");y.width=y.height=1;var w=y.getContext("2d");if(!w)return!1;var T=w.getImageData(0,0,1,1);return T&&T.width===y.width}()?(F[h=s&&s.failIfMajorPerformanceCaveat]===void 0&&(F[h]=function(y){var w,T=function(P){var I=document.createElement("canvas"),O=Object.create(j.webGLContextAttributes);return O.failIfMajorPerformanceCaveat=P,I.getContext("webgl",O)||I.getContext("experimental-webgl",O)}(y);if(!T)return!1;try{w=T.createShader(T.VERTEX_SHADER)}catch{return!1}return!(!w||T.isContextLost())&&(T.shaderSource(w,"void main() {}"),T.compileShader(w),T.getShaderParameter(w,T.COMPILE_STATUS)===!0)}(h)),F[h]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var h}(g)}var F={};function Z(g,s,h){const y=a.window.document.createElement(g);return s!==void 0&&(y.className=s),h&&h.appendChild(y),y}function Y(g,s,h){const y=a.window.document.createElementNS("http://www.w3.org/2000/svg",g);for(const w of Object.keys(s))y.setAttributeNS(null,w,s[w]);return h&&h.appendChild(y),y}j.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const ne=a.window.document&&a.window.document.documentElement.style,se=ne&&ne.userSelect!==void 0?"userSelect":"WebkitUserSelect";let xe;function Se(){ne&&se&&(xe=ne[se],ne[se]="none")}function _e(){ne&&se&&(ne[se]=xe)}function Ie(g){g.preventDefault(),g.stopPropagation(),a.window.removeEventListener("click",Ie,!0)}function Me(){a.window.addEventListener("click",Ie,!0),a.window.setTimeout(()=>{a.window.removeEventListener("click",Ie,!0)},0)}function Ve(g,s){const h=g.getBoundingClientRect();return qe(g,h,s)}function Ke(g,s){const h=g.getBoundingClientRect(),y=[];for(let w=0;w<s.length;w++)y.push(qe(g,h,s[w]));return y}function et(g){return a.window.InstallTrigger!==void 0&&g.button===2&&g.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:g.button}function qe(g,s,h){const y=g.offsetWidth===s.width?1:g.offsetWidth/s.width;return new a.Point((h.clientX-s.left)*y,(h.clientY-s.top)*y)}function ge(g,s){var h=s[0],y=s[1],w=s[2],T=s[3],P=h*T-w*y;return P?(g[0]=T*(P=1/P),g[1]=-y*P,g[2]=-w*P,g[3]=h*P,g):null}function We(g){const{userImage:s}=g;return!!(s&&s.render&&s.render())&&(g.data.replace(new Uint8Array(s.data.buffer)),!0)}class Ue extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(s){if(this.loaded!==s&&(this.loaded=s,s)){for(const{ids:h,callback:y}of this.requestors)this._notify(h,y);this.requestors=[]}}hasImage(s){return!!this.getImage(s)}getImage(s){return this.images[s]}addImage(s,h){this._validate(s,h)&&(this.images[s]=h)}_validate(s,h){let y=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${s}" has invalid "stretchX" value`))),y=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${s}" has invalid "stretchY" value`))),y=!1),this._validateContent(h.content,h)||(this.fire(new a.ErrorEvent(new Error(`Image "${s}" has invalid "content" value`))),y=!1),y}_validateStretch(s,h){if(!s)return!0;let y=0;for(const w of s){if(w[0]<y||w[1]<w[0]||h<w[1])return!1;y=w[1]}return!0}_validateContent(s,h){return!(s&&(s.length!==4||s[0]<0||h.data.width<s[0]||s[1]<0||h.data.height<s[1]||s[2]<0||h.data.width<s[2]||s[3]<0||h.data.height<s[3]||s[2]<s[0]||s[3]<s[1]))}updateImage(s,h){h.version=this.images[s].version+1,this.images[s]=h,this.updatedImages[s]=!0}removeImage(s){const h=this.images[s];delete this.images[s],delete this.patterns[s],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(s,h){let y=!0;if(!this.isLoaded())for(const w of s)this.images[w]||(y=!1);this.isLoaded()||y?this._notify(s,h):this.requestors.push({ids:s,callback:h})}_notify(s,h){const y={};for(const w of s){this.images[w]||this.fire(new a.Event("styleimagemissing",{id:w}));const T=this.images[w];T?y[w]={data:T.data.clone(),pixelRatio:T.pixelRatio,sdf:T.sdf,version:T.version,stretchX:T.stretchX,stretchY:T.stretchY,content:T.content,hasRenderCallback:!!(T.userImage&&T.userImage.render)}:a.warnOnce(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,y)}getPixelSize(){const{width:s,height:h}=this.atlasImage;return{width:s,height:h}}getPattern(s){const h=this.patterns[s],y=this.getImage(s);if(!y)return null;if(h&&h.position.version===y.version)return h.position;if(h)h.position.version=y.version;else{const w={w:y.data.width+2,h:y.data.height+2,x:0,y:0},T=new a.ImagePosition(w,y);this.patterns[s]={bin:w,position:T}}return this._updatePatternAtlas(),this.patterns[s].position}bind(s){const h=s.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(s,this.atlasImage,h.RGBA),this.atlasTexture&&this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const s=[];for(const T in this.patterns)s.push(this.patterns[T].bin);const{w:h,h:y}=a.potpack(s),w=this.atlasImage;w.resize({width:h||1,height:y||1});for(const T in this.patterns){const{bin:P}=this.patterns[T],I=P.x+1,O=P.y+1,$=this.images[T].data,U=$.width,H=$.height;a.RGBAImage.copy($,w,{x:0,y:0},{x:I,y:O},{width:U,height:H}),a.RGBAImage.copy($,w,{x:0,y:H-1},{x:I,y:O-1},{width:U,height:1}),a.RGBAImage.copy($,w,{x:0,y:0},{x:I,y:O+H},{width:U,height:1}),a.RGBAImage.copy($,w,{x:U-1,y:0},{x:I-1,y:O},{width:1,height:H}),a.RGBAImage.copy($,w,{x:0,y:0},{x:I+U,y:O},{width:1,height:H})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(s){for(const h of s){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const y=this.images[h];We(y)&&this.updateImage(h,y)}}}const lt=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(g,s){return function([h,y,w]){const T=a.degToRad(y+90),P=a.degToRad(w);return{x:h*Math.cos(T)*Math.sin(P),y:h*Math.sin(T)*Math.sin(P),z:h*Math.cos(P),azimuthal:y,polar:w}}(g.expression.evaluate(s))}interpolate(g,s,h){return{x:a.number(g.x,s.x,h),y:a.number(g.y,s.y,h),z:a.number(g.z,s.z,h),azimuthal:a.number(g.azimuthal,s.azimuthal,h),polar:a.number(g.polar,s.polar,h)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)});class ht extends a.Evented{constructor(s){super(),this._transitionable=new a.Transitionable(lt),this.setLight(s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,h={}){if(!this._validate(a.validateLight,s,h))for(const y in s){const w=s[y];a.endsWith(y,"-transition")?this._transitionable.setTransition(y.slice(0,-11),w):this._transitionable.setValue(y,w)}}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,h,y){return(!y||y.validate!==!1)&&a.emitValidationErrors(this,s.call(a.validateStyle,a.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const Wt=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)});let In=class extends a.Evented{constructor(g,s){super(),this._transitionable=new a.Transitionable(Wt),this.set(g),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=s}get(){return this._transitionable.serialize()}set(g){for(const s in g){const h=g[s];a.endsWith(s,"-transition")?this._transitionable.setTransition(s.slice(0,-11),h):this._transitionable.setValue(s,h)}}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}};function Sn(g,s,h,y){const w=a.smoothstep(45,65,h),[T,P]=qt(g,y),I=a.length(s);let O=1-Math.min(1,Math.exp((I-T)/(P-T)*-6));return O*=O*O,O=Math.min(1,1.00747*O),O*w*g.alpha}function qt(g,s){const h=.5/Math.tan(.5*s);return[g.range[0]+h,g.range[1]+h]}const Bt=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"high-color":new a.DataConstantProperty(a.spec.fog["high-color"]),"space-color":new a.DataConstantProperty(a.spec.fog["space-color"]),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"]),"star-intensity":new a.DataConstantProperty(a.spec.fog["star-intensity"])});class je extends a.Evented{constructor(s,h){super(),this._transitionable=new a.Transitionable(Bt),this.set(s),this._transitioning=this._transitionable.untransitioned(),this._transform=h}get state(){const s=this._transform,h=s.projection.name==="globe",y=a.globeToMercatorTransition(s.zoom),w=this.properties.get("range"),T=[.5,3];return{range:h?[a.number(T[0],w[0],y),a.number(T[1],w[1],y)]:w,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(s,h={}){if(!this._validate(a.validateFog,s,h)){for(const y of Object.keys(a.spec.fog))s&&s[y]===void 0&&(s[y]=a.spec.fog[y].default);for(const y in s){const w=s[y];a.endsWith(y,"-transition")?this._transitionable.setTransition(y.slice(0,-11),w):this._transitionable.setValue(y,w)}}}getOpacity(s){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.smoothstep(45,65,s))*h.a}getOpacityAtLatLng(s,h){return this._transform.projection.supportsFog?function(y,w,T){const P=a.MercatorCoordinate.fromLngLat(w),I=T.elevation?T.elevation.getAtPointOrZero(P):0,O=[P.x,P.y,I];return a.transformMat4(O,O,T.mercatorFogMatrix),Sn(y,O,T.pitch,T._fov)}(this.state,s,h):0}getFovAdjustedRange(s){return this._transform.projection.supportsFog?qt(this.state,s):[0,1]}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,h,y){return(!y||y.validate!==!1)&&a.emitValidationErrors(this,s.call(a.validateStyle,a.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class At{constructor(s,h){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const y=this.workerPool.acquire(this.id);for(let w=0;w<y.length;w++){const T=new At.Actor(y[w],h,this.id);T.name=`Worker ${w}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(s,h,y){a.asyncAll(this.actors,(w,T)=>{w.send(s,h,T)},y=y||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(s=>{s.remove()}),this.actors=[],this.workerPool.release(this.id)}}function sn(g,s,h){return s*(a.EXTENT/(g.tileSize*Math.pow(2,h-g.tileID.overscaledZ)))}At.Actor=a.Actor;class zn{constructor(s,h,y,w){this.screenBounds=s,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,w)}static createFromScreenPoints(s,h){let y,w;if(s instanceof a.Point||typeof s[0]=="number"){const T=a.Point.convert(s);y=[T],w=h.isPointAboveHorizon(T)}else{const T=a.Point.convert(s[0]),P=a.Point.convert(s[1]);y=[T,P],w=a.polygonizeBounds(T,P).every(I=>h.isPointAboveHorizon(I))}return new zn(y,h.getCameraPoint(),w,h)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(s){return a.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],s)}bufferedCameraGeometry(s){const h=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new a.Point(1,1)):this.screenBounds[1],w=a.polygonizeBounds(h,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<y.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?w[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(w[3]=this.cameraPoint)),a.bufferConvexPolygon(w,s)}bufferedCameraGeometryGlobe(s){const h=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new a.Point(1,1)):this.screenBounds[1],w=a.polygonizeBounds(h,y,s),T=this.cameraPoint.clone();switch(3*((T.y>h.y)+(T.y>y.y))+((T.x>h.x)+(T.x>y.x))){case 0:w[0]=T,w[4]=T.clone();break;case 1:w.splice(1,0,T);break;case 2:w[1]=T;break;case 3:w.splice(4,0,T);break;case 5:w.splice(2,0,T);break;case 6:w[3]=T;break;case 7:w.splice(3,0,T);break;case 8:w[2]=T}return w}containsTile(s,h,y,w=0){const T=s.queryPadding/h._pixelsPerMercatorPixel+1,P=y?this._bufferedCameraMercator(T,h):this._bufferedScreenMercator(T,h);let I=s.tileID.wrap+(P.unwrapped?w:0);const O=P.polygon.map(ye=>a.getTilePoint(s.tileTransform,ye,I));if(!a.polygonIntersectsBox(O,0,0,a.EXTENT,a.EXTENT))return;I=s.tileID.wrap+(this.screenGeometryMercator.unwrapped?w:0);const $=this.screenGeometryMercator.polygon.map(ye=>a.getTileVec3(s.tileTransform,ye,I)),U=$.map(ye=>new a.Point(ye[0],ye[1])),H=h.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),oe=a.getTileVec3(s.tileTransform,H,I),de=$.map(ye=>{const K=a.sub(ye,ye,oe);return a.normalize(K,K),new a.Ray(oe,K)}),me=sn(s,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:U,tilespaceRays:de,bufferedTilespaceGeometry:O,bufferedTilespaceBounds:(fe=a.getBounds(O),fe.min.x=a.clamp(fe.min.x,0,a.EXTENT),fe.min.y=a.clamp(fe.min.y,0,a.EXTENT),fe.max.x=a.clamp(fe.max.x,0,a.EXTENT),fe.max.y=a.clamp(fe.max.y,0,a.EXTENT),fe),tile:s,tileID:s.tileID,pixelToTileUnitsFactor:me};var fe}_bufferedScreenMercator(s,h){const y=Yn(s);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let w;return w=h.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(s),h):{polygon:this.bufferedScreenGeometry(s).map(T=>h.pointCoordinate3D(T)),unwrapped:!0},this._screenRaycastCache[y]=w,w}}_bufferedCameraMercator(s,h){const y=Yn(s);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let w;return w=h.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(s),h):{polygon:this.bufferedCameraGeometry(s).map(T=>h.pointCoordinate3D(T)),unwrapped:!0},this._cameraRaycastCache[y]=w,w}}_projectAndResample(s,h){const y=function(T,P){const I=a.multiply([],P.pixelMatrix,P.globeMatrix),O=[0,-a.GLOBE_RADIUS,0,1],$=[0,a.GLOBE_RADIUS,0,1],U=[0,0,0,1];a.transformMat4$1(O,O,I),a.transformMat4$1($,$,I),a.transformMat4$1(U,U,I);const H=new a.Point(O[0]/O[3],O[1]/O[3]),oe=new a.Point($[0]/$[3],$[1]/$[3]),de=a.polygonContainsPoint(T,H)&&O[3]<U[3],me=a.polygonContainsPoint(T,oe)&&$[3]<U[3];if(!de&&!me)return null;const fe=function(Ne,Je,Ye){for(let ut=1;ut<Ne.length;ut++){const Kt=Mn(Je.pointCoordinate3D(Ne[ut-1]).x),st=Mn(Je.pointCoordinate3D(Ne[ut]).x);if(Ye<0){if(Kt<st)return{idx:ut,t:-Kt/(st-1-Kt)}}else if(st<Kt)return{idx:ut,t:(1-Kt)/(st+1-Kt)}}return null}(T,P,de?-1:1);if(!fe)return null;const{idx:ye,t:K}=fe;let ue=ye>1?vn(T.slice(0,ye),P):[],Ee=ye<T.length?vn(T.slice(ye),P):[];ue=ue.map(Ne=>new a.Point(Mn(Ne.x),Ne.y)),Ee=Ee.map(Ne=>new a.Point(Mn(Ne.x),Ne.y));const Ce=[...ue];Ce.length===0&&Ce.push(Ee[Ee.length-1]);const Fe=a.number(Ce[Ce.length-1].y,(Ee.length===0?ue[0]:Ee[0]).y,K);let $e;return $e=de?[new a.Point(0,Fe),new a.Point(0,0),new a.Point(1,0),new a.Point(1,Fe)]:[new a.Point(1,Fe),new a.Point(1,1),new a.Point(0,1),new a.Point(0,Fe)],Ce.push(...$e),Ee.length===0?Ce.push(ue[0]):Ce.push(...Ee),{polygon:Ce.map(Ne=>new a.MercatorCoordinate(Ne.x,Ne.y)),unwrapped:!1}}(s,h);if(y)return y;const w=function(T,P){let I=!1,O=-1/0,$=0;for(let H=0;H<T.length-1;H++)T[H].x>O&&(O=T[H].x,$=H);for(let H=0;H<T.length-1;H++){const oe=($+H)%(T.length-1),de=T[oe],me=T[oe+1];Math.abs(de.x-me.x)>.5&&(de.x<me.x?(de.x+=1,oe===0&&(T[T.length-1].x+=1)):(me.x+=1,oe+1===T.length-1&&(T[0].x+=1)),I=!0)}const U=a.mercatorXfromLng(P.center.lng);return I&&U<Math.abs(U-1)&&T.forEach(H=>{H.x-=1}),{polygon:T,unwrapped:I}}(vn(s,h).map(T=>new a.Point(Mn(T.x),T.y)),h);return{polygon:w.polygon.map(T=>new a.MercatorCoordinate(T.x,T.y)),unwrapped:w.unwrapped}}}function vn(g,s){return a.resample(g,h=>{const y=s.pointCoordinate3D(h);h.x=y.x,h.y=y.y},1/256)}function Mn(g){return g<0?1+g%1:g%1}function Yn(g){return 100*g|0}function ir(g,s,h,y,w){const T=function(P,I){if(P)return w(P);if(I){g.url&&I.tiles&&g.tiles&&delete g.tiles;const O=a.pick(a.extend(I,g),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(O.vectorLayers=I.vector_layers,O.vectorLayerIds=O.vectorLayers.map($=>$.id)),O.tiles=s.canonicalizeTileset(O,g.url),w(null,O)}};return g.url?a.getJSON(s.transformRequest(s.normalizeSourceURL(g.url,null,h,y),a.ResourceType.Source),T):a.exported.frame(()=>T(null,g))}class mt{constructor(s,h,y){this.bounds=a.LngLatBounds.convert(this.validateBounds(s)),this.minzoom=h||0,this.maxzoom=y||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const h=Math.pow(2,s.z),y=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*h),w=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*h),T=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*h),P=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*h);return s.x>=y&&s.x<T&&s.y>=w&&s.y<P}}class bt{constructor(s,h,y){this.context=s;const w=s.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const xt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Nt{constructor(s,h,y,w){this.length=h.length,this.attributes=y,this.itemSize=h.bytesPerElement,this.dynamicDraw=w,this.context=s;const T=s.gl;this.buffer=T.createBuffer(),s.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,h){for(let y=0;y<this.attributes.length;y++){const w=h.attributes[this.attributes[y].name];w!==void 0&&s.enableVertexAttribArray(w)}}setVertexAttribPointers(s,h,y){for(let w=0;w<this.attributes.length;w++){const T=this.attributes[w],P=h.attributes[T.name];P!==void 0&&s.vertexAttribPointer(P,T.components,s[xt[T.type]],!1,this.itemSize,T.offset+this.itemSize*(y||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class wt{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class hn extends wt{getDefault(){return a.Color.transparent}set(s){const h=this.current;(s.r!==h.r||s.g!==h.g||s.b!==h.b||s.a!==h.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class An extends wt{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class Fn extends wt{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class Nn extends wt{getDefault(){return[!0,!0,!0,!0]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||s[3]!==h[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class xr extends wt{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class nr extends wt{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class Zr extends wt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const h=this.current;(s.func!==h.func||s.ref!==h.ref||s.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class Br extends wt{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class ui extends wt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=s,this.dirty=!1}}class gi extends wt{getDefault(){return[0,1]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class Xi extends wt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=s,this.dirty=!1}}class Ri extends wt{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class dr extends wt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.BLEND):h.disable(h.BLEND),this.current=s,this.dirty=!1}}class Nr extends wt{getDefault(){const s=this.gl;return[s.ONE,s.ZERO]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(s[0],s[1]),this.current=s,this.dirty=!1)}}class cr extends wt{getDefault(){return a.Color.transparent}set(s){const h=this.current;(s.r!==h.r||s.g!==h.g||s.b!==h.b||s.a!==h.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Cr extends wt{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquation(s),this.current=s,this.dirty=!1)}}class Oi extends wt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=s,this.dirty=!1}}class Di extends wt{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class wr extends wt{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}let rr,Fi=class extends wt{getDefault(){return null}set(g){(g!==this.current||this.dirty)&&(this.gl.useProgram(g),this.current=g,this.dirty=!1)}};class ao extends wt{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class lo extends wt{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||s[3]!==h[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Ao extends wt{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class Fo extends wt{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class go extends wt{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class rs extends wt{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class Ae extends wt{getDefault(){return null}set(s){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class J extends wt{constructor(s){super(s),this.vao=s.extVertexArrayObject}getDefault(){return null}set(s){this.vao&&(s!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(s),this.current=s,this.dirty=!1)}}class te extends wt{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class ke extends wt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class Oe extends wt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class Ge extends wt{constructor(s,h){super(s),this.context=s,this.parent=h}getDefault(){return null}}class rt extends Ge{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class it extends Ge{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Ze extends it{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class dt{constructor(s,h,y,w){this.context=s,this.width=h,this.height=y;const T=this.framebuffer=s.gl.createFramebuffer();this.colorAttachment=new rt(s,T),w&&(this.depthAttachment=new it(s,T))}destroy(){const s=this.context.gl,h=this.colorAttachment.get();if(h&&s.deleteTexture(h),this.depthAttachment){const y=this.depthAttachment.get();y&&s.deleteRenderbuffer(y)}s.deleteFramebuffer(this.framebuffer)}}class Xt{constructor(s,h=!1){if(this.gl=s,this.isWebGL2=h,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),h){const y=s;this.extVertexArrayObject={createVertexArrayOES:y.createVertexArray.bind(s),deleteVertexArrayOES:y.deleteVertexArray.bind(s),bindVertexArrayOES:y.bindVertexArray.bind(s)}}this.clearColor=new hn(this),this.clearDepth=new An(this),this.clearStencil=new Fn(this),this.colorMask=new Nn(this),this.depthMask=new xr(this),this.stencilMask=new nr(this),this.stencilFunc=new Zr(this),this.stencilOp=new Br(this),this.stencilTest=new ui(this),this.depthRange=new gi(this),this.depthTest=new Xi(this),this.depthFunc=new Ri(this),this.blend=new dr(this),this.blendFunc=new Nr(this),this.blendColor=new cr(this),this.blendEquation=new Cr(this),this.cullFace=new Oi(this),this.cullFaceSide=new Di(this),this.frontFace=new wr(this),this.program=new Fi(this),this.activeTexture=new ao(this),this.viewport=new lo(this),this.bindFramebuffer=new Ao(this),this.bindRenderbuffer=new Fo(this),this.bindTexture=new go(this),this.bindVertexBuffer=new rs(this),this.bindElementBuffer=new Ae(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new J(this),this.pixelStoreUnpack=new te(this),this.pixelStoreUnpackPremultiplyAlpha=new ke(this),this.pixelStoreUnpackFlipY=new Oe(this),this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=s.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=s.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=s.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),h||(this.extTextureHalfFloat=s.getExtension("OES_texture_half_float")),(h||this.extTextureHalfFloat&&s.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=s.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=h||s.getExtension("OES_standard_derivatives"),this.extTimerQuery=s.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,h){return new bt(this,s,h)}createVertexBuffer(s,h,y){return new Nt(this,s,h,y)}createRenderbuffer(s,h,y){const w=this.gl,T=w.createRenderbuffer();return this.bindRenderbuffer.set(T),w.renderbufferStorage(w.RENDERBUFFER,s,h,y),this.bindRenderbuffer.set(null),T}createFramebuffer(s,h,y){return new dt(this,s,h,y)}clear({color:s,depth:h,stencil:y}){const w=this.gl;let T=0;s&&(T|=w.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(T|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),y!==void 0&&(T|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),w.clear(T)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){M(s.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Gt extends a.Evented{constructor(s,h,y,w){if(super(),this.id=s,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(h,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(s){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,y=this.map._worldview;this._tileJSONRequest=ir(this._options,this.map._requestManager,h,y,(w,T)=>{this._tileJSONRequest=null,this._loaded=!0,w?(h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),y&&y.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${y}`),this.fire(new a.ErrorEvent(w))):T&&(a.extend(this,T),T.bounds&&(this.tileBounds=new mt(T.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(T.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),s&&s(w)})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}loadTile(s,h){const y=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(y,a.ResourceType.Tile),data:void 0,uid:s.uid,tileID:s.tileID,tileZoom:s.tileZoom,zoom:s.tileID.overscaledZ,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:s.isSymbolTile};if(w.request.collectResourceTiming=this._collectResourceTiming,s.actor&&s.state!=="expired")s.state==="loading"?s.reloadCallback=h:s.request=s.actor.send("reloadTile",w,T.bind(this));else if(s.actor=this._tileWorkers[y]=this._tileWorkers[y]||this.dispatcher.getActor(),this.dispatcher.ready)s.request=s.actor.send("loadTile",w,T.bind(this),void 0,!0);else{const P=a.loadVectorTile.call({deduped:this._deduped},w,(I,O)=>{I||!O?T.call(this,I):(w.data={cacheControl:O.cacheControl,expires:O.expires,rawData:O.rawData.slice(0)},s.actor&&s.actor.send("loadTile",w,T.bind(this),void 0,!0))},!0);s.request={cancel:P}}function T(P,I){return delete s.request,s.aborted?h(null):P&&P.status!==404?h(P):(I&&I.resourceTiming&&(s.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&s.setExpiryData(I),s.loadVectorData(I,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id})}unloadTile(s){s.unloadVectorData(),s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class $t extends a.Evented{constructor(s,h,y,w){super(),this.id=s,this.dispatcher=y,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},h),a.extend(this,a.pick(h,["url","scheme","tileSize"]))}load(s){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ir(this._options,this.map._requestManager,null,null,(h,y)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new a.ErrorEvent(h)):y&&(a.extend(this,y),y.bounds&&(this.tileBounds=new mt(y.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(y.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),s&&s(h)})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,h){const y=a.exported.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);s.request=a.getImage(this.map._requestManager.transformRequest(w,a.ResourceType.Tile),(T,P,I,O)=>(delete s.request,s.aborted?(s.state="unloaded",h(null)):T?(s.state="errored",h(T)):P?(this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:I,expires:O}),s.setTexture(P,this.map.painter),s.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),void h(null)):h(null)))}static loadTileData(s,h,y){s.setTexture(h,y)}static unloadTileData(s,h){s.texture&&h.saveTileTexture(s.texture)}abortTile(s,h){s.request&&(s.request.cancel(),delete s.request),h()}unloadTile(s,h){s.texture&&this.map.painter.saveTileTexture(s.texture),h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function G(g,s,h,y,w,T,P,I){const O=[g,h,w,s,y,T,1,1,1],$=[P,I,1],U=a.adjoint([],O),[H,oe,de]=a.transformMat3($,$,a.transpose(U,U));return a.multiply$1(O,[H,0,0,0,oe,0,0,0,de],O)}class ee extends a.Evented{constructor(s,h,y,w){super(),this.id=s,this.dispatcher=y,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=h,this._dirty=!1}load(s,h){this._loaded=h||!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(y,w)=>{if(this._imageRequest=null,this._loaded=!0,y)this.fire(new a.ErrorEvent(y));else if(w){const{HTMLImageElement:T}=a.window;this.image=w instanceof T?a.exported.getImageData(w):w,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,s&&(this.coordinates=s),this._finishLoading()}})}loaded(){return this._loaded}updateImage(s){return this.image&&s.url?(this._imageRequest&&s.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=s.url,this.load(s.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(s){this.coordinates=s,this._boundsArray=void 0;const h=s.map(a.MercatorCoordinate.fromLngLat);return this.tileID=function(y){let w=1/0,T=1/0,P=-1/0,I=-1/0;for(const H of y)w=Math.min(w,H.x),T=Math.min(T,H.y),P=Math.max(P,H.x),I=Math.max(I,H.y);const O=Math.max(P-w,I-T),$=Math.max(0,Math.floor(-Math.log(O)/Math.LN2)),U=Math.pow(2,$);return new a.CanonicalTileID($,Math.floor((w+P)/2*U),Math.floor((T+I)/2*U))}(h),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(s){for(const O in this.tiles){const $=this.tiles[O];$.state!=="loaded"&&($.state="loaded",$.texture=this.texture)}if(this._boundsArray)return;const h=a.tileTransform(this.tileID,this.map.transform.projection),[y,w,T,P]=this.coordinates.map(O=>{const $=h.projection.project(O[0],O[1]);return a.getTilePoint(h,$)._round()});this.perspectiveTransform=function(O,$,U,H,oe,de,me,fe,ye,K){const ue=G(0,0,O,0,0,$,O,$),Ee=G(U,H,oe,de,me,fe,ye,K);return a.multiply$1(Ee,a.adjoint(ue,ue),Ee),[Ee[6]/Ee[8]*O/a.EXTENT,Ee[7]/Ee[8]*$/a.EXTENT]}(this.width,this.height,y.x,y.y,w.x,w.y,P.x,P.y,T.x,T.y);const I=this._boundsArray=new a.StructArrayLayout4i8;I.emplaceBack(y.x,y.y,0,0),I.emplaceBack(w.x,w.y,a.EXTENT,0),I.emplaceBack(P.x,P.y,0,a.EXTENT),I.emplaceBack(T.x,T.y,a.EXTENT,a.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=s.createVertexBuffer(I,a.boundsAttributes.members),this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const s=this.map.painter.context,h=s.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new a.Texture(s,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(s)}loadTile(s,h){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={},h(null)):(s.state="errored",h(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Q={vector:Gt,raster:$t,"raster-dem":class extends $t{constructor(g,s,h,y){super(g,s,h,y),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}loadTile(g,s){const h=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(w,T){w&&(g.state="errored",s(w)),T&&(g.dem=T,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",s(null))}g.request=a.getImage(this.map._requestManager.transformRequest(h,a.ResourceType.Tile),(function(w,T,P,I){if(delete g.request,g.aborted)g.state="unloaded",s(null);else if(w)g.state="errored",s(w);else if(T){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:P,expires:I});const O=a.window.ImageBitmap&&T instanceof a.window.ImageBitmap&&(rr==null&&(rr=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&typeof a.window.createImageBitmap=="function"),rr),$=1-(T.width-a.prevPowerOfTwo(T.width))/2;$<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const U=O?T:a.exported.getImageData(T,$),H={uid:g.uid,coord:g.tileID,source:this.id,rawImageData:U,encoding:this.encoding,padding:$};g.actor&&g.state!=="expired"||(g.actor=this.dispatcher.getActor(),g.actor.send("loadDEMTile",H,y.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(g){const s=g.canonical,h=Math.pow(2,s.z),y=(s.x-1+h)%h,w=s.x===0?g.wrap-1:g.wrap,T=(s.x+1+h)%h,P=s.x+1===h?g.wrap+1:g.wrap,I={};return I[new a.OverscaledTileID(g.overscaledZ,w,s.z,y,s.y).key]={backfilled:!1},I[new a.OverscaledTileID(g.overscaledZ,P,s.z,T,s.y).key]={backfilled:!1},s.y>0&&(I[new a.OverscaledTileID(g.overscaledZ,w,s.z,y,s.y-1).key]={backfilled:!1},I[new a.OverscaledTileID(g.overscaledZ,g.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},I[new a.OverscaledTileID(g.overscaledZ,P,s.z,T,s.y-1).key]={backfilled:!1}),s.y+1<h&&(I[new a.OverscaledTileID(g.overscaledZ,w,s.z,y,s.y+1).key]={backfilled:!1},I[new a.OverscaledTileID(g.overscaledZ,g.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},I[new a.OverscaledTileID(g.overscaledZ,P,s.z,T,s.y+1).key]={backfilled:!1}),I}unloadTile(g){g.demTexture&&this.map.painter.saveTileTexture(g.demTexture),g.fbo&&(g.fbo.destroy(),delete g.fbo),g.dem&&delete g.dem,delete g.neighboringTiles,g.state="unloaded"}},geojson:class extends a.Evented{constructor(g,s,h,y){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(y),this._data=s.data,this._options=a.extend({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const w=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*w,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*w,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:a.EXTENT,radius:(s.clusterRadius!==void 0?s.clusterRadius:50)*w,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}getClusterExpansionZoom(g,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id},s),this}getClusterChildren(g,s){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id},s),this}getClusterLeaves(g,s,h,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:g,limit:s,offset:h},y),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const g=a.extend({},this.workerOptions),s=this._data;typeof s=="string"?(g.request=this.map._requestManager.transformRequest(a.exported.resolveURL(s),a.ResourceType.Source),g.request.collectResourceTiming=this._collectResourceTiming):g.data=JSON.stringify(s),this._pendingLoad=this.actor.send(`${this.type}.loadData`,g,(h,y)=>{if(this._loaded=!0,this._pendingLoad=null,h)this.fire(new a.ErrorEvent(h));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&y&&y.resourceTiming&&y.resourceTiming[this.id]&&(w.resourceTiming=y.resourceTiming[this.id]),this.fire(new a.Event("data",w)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(g,s){const h=g.actor?"reloadTile":"loadTile";g.actor=this.actor,g.request=this.actor.send(h,{type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(y,w)=>(delete g.request,g.unloadVectorData(),g.aborted?s(null):y?s(y):(g.loadVectorData(w,this.map.painter,h==="reloadTile"),s(null))),void 0,h==="loadTile")}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g){g.unloadVectorData(),this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends ee{constructor(g,s,h,y){super(g,s,h,y),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const s of g.urls)this.urls.push(this.map._requestManager.transformRequest(s,a.ResourceType.Source).url);a.getVideo(this.urls,(s,h)=>{this._loaded=!0,s?this.fire(new a.ErrorEvent(s)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const s=this.video.seekable;g<s.start(0)||g>s.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const g=this.map.painter.context,s=g.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(g,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(g)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:ee,canvas:class extends ee{constructor(g,s,h,y){super(g,s,h,y),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(T=>typeof T!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context;this.texture?(g||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(s,this.canvas,s.gl.RGBA,{premultiply:!0}),this._prepareData(s)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}},custom:class extends a.Evented{constructor(g,s,h,y){super(),this.id=g,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=s,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new mt(this._implementation.bounds,this.minzoom,this.maxzoom)),s.update=this._update.bind(this),s.clearTiles=this._clearTiles.bind(this),s.coveringTiles=this._coveringTiles.bind(this),a.extend(this,a.pick(s,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(g){this._map=g,this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(g),this.load()}onRemove(g){this._implementation.onRemove&&this._implementation.onRemove(g)}hasTile(g){if(this._implementation.hasTile){const{x:s,y:h,z:y}=g.canonical;return this._implementation.hasTile({x:s,y:h,z:y})}return!this.tileBounds||this.tileBounds.contains(g.canonical)}loadTile(g,s){const{x:h,y,z:w}=g.tileID.canonical,T=new a.window.AbortController;g.request=Promise.resolve(this._implementation.loadTile({x:h,y,z:w},{signal:T.signal})).then((function(P){return delete g.request,g.aborted?(g.state="unloaded",s(null)):P===void 0?(g.state="errored",s(null)):P===null?(this.loadTileData(g,{width:this.tileSize,height:this.tileSize,data:null}),g.state="loaded",s(null)):function(I){return I instanceof a.window.ImageData||I instanceof a.window.HTMLCanvasElement||I instanceof a.window.ImageBitmap||I instanceof a.window.HTMLImageElement}(P)?(this.loadTileData(g,P),g.state="loaded",void s(null)):(g.state="errored",s(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(P=>{P.code!==20&&(g.state="errored",s(P))}),g.request.cancel=()=>T.abort()}loadTileData(g,s){$t.loadTileData(g,s,this._map.painter)}unloadTileData(g){$t.unloadTileData(g,this._map.painter)}unloadTile(g,s){if(this.unloadTileData(g),this._implementation.unloadTile){const{x:h,y,z:w}=g.tileID.canonical;this._implementation.unloadTile({x:h,y,z:w})}s()}abortTile(g,s){g.request&&g.request.cancel&&(g.request.cancel(),delete g.request),s()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(g=>({x:g.canonical.x,y:g.canonical.y,z:g.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}}},B=function(g,s,h,y){const w=new Q[s.type](g,s,h,y);if(w.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${w.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],w),w};function ce(g,s){const h=a.identity([]);return a.scale(h,h,[.5*g.width,.5*-g.height,1]),a.translate(h,h,[1,-1,0]),a.multiply(h,h,g.calculateProjMatrix(s.toUnwrapped())),Float32Array.from(h)}function Qe(g,s,h,y,w,T,P,I=!1){const O=g.tilesIn(y,P,I);O.sort(Lt);const $=[];for(const H of O)$.push({wrappedTileID:H.tile.tileID.wrapped().key,queryResults:H.tile.queryRenderedFeatures(s,h,g._state,H,w,T,ce(g.transform,H.tile.tileID),I)});const U=function(H){const oe={},de={};for(const me of H){const fe=me.queryResults,ye=me.wrappedTileID,K=de[ye]=de[ye]||{};for(const ue in fe){const Ee=fe[ue],Ce=K[ue]=K[ue]||{},Fe=oe[ue]=oe[ue]||[];for(const $e of Ee)Ce[$e.featureIndex]||(Ce[$e.featureIndex]=!0,Fe.push($e))}}return oe}($);for(const H in U)U[H].forEach(oe=>{const de=oe.feature,me=de.layer;me&&me.type!=="background"&&me.type!=="sky"&&(de.source=me.source,me["source-layer"]&&(de.sourceLayer=me["source-layer"]),de.state=de.id!==void 0?g.getFeatureState(me["source-layer"],de.id):{})});return U}function ot(g,s){const h=g.getRenderableIds().map(T=>g.getTileByID(T)),y=[],w={};for(let T=0;T<h.length;T++){const P=h[T],I=P.tileID.canonical.key;w[I]||(w[I]=!0,P.querySourceFeatures(y,s))}return y}function Lt(g,s){const h=g.tileID,y=s.tileID;return h.overscaledZ-y.overscaledZ||h.canonical.y-y.canonical.y||h.wrap-y.wrap||h.canonical.x-y.canonical.x}function Ut(){return hl.workerClass!=null?new hl.workerClass:new a.window.Worker(hl.workerUrl)}const Ln="mapboxgl_preloaded_worker_pool";class ln{constructor(){this.active={}}acquire(s){if(!this.workers)for(this.workers=[];this.workers.length<ln.workerCount;)this.workers.push(new Ut);return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(h=>{h.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ln]}numActive(){return Object.keys(this.active).length}}let or;function Cn(){return or||(or=new ln),or}function ur(g,s){const h={};for(const y in g)y!=="ref"&&(h[y]=g[y]);return a.refProperties.forEach(y=>{y in s&&(h[y]=s[y])}),h}function hr(g){g=g.slice();const s=Object.create(null);for(let h=0;h<g.length;h++)s[g[h].id]=g[h];for(let h=0;h<g.length;h++)"ref"in g[h]&&(g[h]=ur(g[h],s[g[h].ref]));return g}ln.workerCount=2;const bn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Sr(g,s,h){h.push({command:bn.addSource,args:[g,s[g]]})}function fr(g,s,h){s.push({command:bn.removeSource,args:[g]}),h[g]=!0}function On(g,s,h,y){fr(g,h,y),Sr(g,s,h)}function Gn(g,s,h){let y;for(y in g[h])if(g[h].hasOwnProperty(y)&&y!=="data"&&!M(g[h][y],s[h][y]))return!1;for(y in s[h])if(s[h].hasOwnProperty(y)&&y!=="data"&&!M(g[h][y],s[h][y]))return!1;return!0}function yn(g,s,h,y,w,T){let P;for(P in s=s||{},g=g||{})g.hasOwnProperty(P)&&(M(g[P],s[P])||h.push({command:T,args:[y,P,s[P],w]}));for(P in s)s.hasOwnProperty(P)&&!g.hasOwnProperty(P)&&(M(g[P],s[P])||h.push({command:T,args:[y,P,s[P],w]}))}function Pn(g){return g.id}function mn(g,s){return g[s.id]=s,g}class Dn{constructor(s,h){this.reset(s,h)}reset(s,h){this.points=s||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=a.clamp(s,0,1);let h=1,y=this._distances[h];const w=s*this.paddedLength+this.padding;for(;y<w&&h<this._distances.length;)y=this._distances[++h];const T=h-1,P=this._distances[T],I=y-P,O=I>0?(w-P)/I:0;return this.points[T].mult(1-O).add(this.points[h].mult(O))}}class En{constructor(s,h,y){const w=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(s/y),this.yCellCount=Math.ceil(h/y);for(let P=0;P<this.xCellCount*this.yCellCount;P++)w.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=h,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,h,y,w,T){this._forEachCell(h,y,w,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(h),this.bboxes.push(y),this.bboxes.push(w),this.bboxes.push(T)}insertCircle(s,h,y,w){this._forEachCell(h-w,y-w,h+w,y+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(h),this.circles.push(y),this.circles.push(w)}_insertBoxCell(s,h,y,w,T,P){this.boxCells[T].push(P)}_insertCircleCell(s,h,y,w,T,P){this.circleCells[T].push(P)}_query(s,h,y,w,T,P){if(y<0||s>this.width||w<0||h>this.height)return!T&&[];const I=[];if(s<=0&&h<=0&&this.width<=y&&this.height<=w){if(T)return!0;for(let O=0;O<this.boxKeys.length;O++)I.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const $=this.circles[3*O],U=this.circles[3*O+1],H=this.circles[3*O+2];I.push({key:this.circleKeys[O],x1:$-H,y1:U-H,x2:$+H,y2:U+H})}return P?I.filter(P):I}return this._forEachCell(s,h,y,w,this._queryCell,I,{hitTest:T,seenUids:{box:{},circle:{}}},P),T?I.length>0:I}_queryCircle(s,h,y,w,T){const P=s-y,I=s+y,O=h-y,$=h+y;if(I<0||P>this.width||$<0||O>this.height)return!w&&[];const U=[];return this._forEachCell(P,O,I,$,this._queryCellCircle,U,{hitTest:w,circle:{x:s,y:h,radius:y},seenUids:{box:{},circle:{}}},T),w?U.length>0:U}query(s,h,y,w,T){return this._query(s,h,y,w,!1,T)}hitTest(s,h,y,w,T){return this._query(s,h,y,w,!0,T)}hitTestCircle(s,h,y,w){return this._queryCircle(s,h,y,!0,w)}_queryCell(s,h,y,w,T,P,I,O){const $=I.seenUids,U=this.boxCells[T];if(U!==null){const oe=this.bboxes;for(const de of U)if(!$.box[de]){$.box[de]=!0;const me=4*de;if(s<=oe[me+2]&&h<=oe[me+3]&&y>=oe[me+0]&&w>=oe[me+1]&&(!O||O(this.boxKeys[de]))){if(I.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[de],x1:oe[me],y1:oe[me+1],x2:oe[me+2],y2:oe[me+3]})}}}const H=this.circleCells[T];if(H!==null){const oe=this.circles;for(const de of H)if(!$.circle[de]){$.circle[de]=!0;const me=3*de;if(this._circleAndRectCollide(oe[me],oe[me+1],oe[me+2],s,h,y,w)&&(!O||O(this.circleKeys[de]))){if(I.hitTest)return P.push(!0),!0;{const fe=oe[me],ye=oe[me+1],K=oe[me+2];P.push({key:this.circleKeys[de],x1:fe-K,y1:ye-K,x2:fe+K,y2:ye+K})}}}}}_queryCellCircle(s,h,y,w,T,P,I,O){const $=I.circle,U=I.seenUids,H=this.boxCells[T];if(H!==null){const de=this.bboxes;for(const me of H)if(!U.box[me]){U.box[me]=!0;const fe=4*me;if(this._circleAndRectCollide($.x,$.y,$.radius,de[fe+0],de[fe+1],de[fe+2],de[fe+3])&&(!O||O(this.boxKeys[me])))return P.push(!0),!0}}const oe=this.circleCells[T];if(oe!==null){const de=this.circles;for(const me of oe)if(!U.circle[me]){U.circle[me]=!0;const fe=3*me;if(this._circlesCollide(de[fe],de[fe+1],de[fe+2],$.x,$.y,$.radius)&&(!O||O(this.circleKeys[me])))return P.push(!0),!0}}}_forEachCell(s,h,y,w,T,P,I,O){const $=this._convertToXCellCoord(s),U=this._convertToYCellCoord(h),H=this._convertToXCellCoord(y),oe=this._convertToYCellCoord(w);for(let de=$;de<=H;de++)for(let me=U;me<=oe;me++)if(T.call(this,s,h,y,w,this.xCellCount*me+de,P,I,O))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,h,y,w,T,P){const I=w-s,O=T-h,$=y+P;return $*$>I*I+O*O}_circleAndRectCollide(s,h,y,w,T,P,I){const O=(P-w)/2,$=Math.abs(s-(w+O));if($>O+y)return!1;const U=(I-T)/2,H=Math.abs(h-(T+U));if(H>U+y)return!1;if($<=O||H<=U)return!0;const oe=$-O,de=H-U;return oe*oe+de*de<=y*y}}const cn={unknown:0,flipRequired:1,flipNotRequired:2},yt=Math.tan(85*Math.PI/180);function Te(g,s,h,y,w,T,P){const I=a.create();if(h)if(T.name==="globe"){const O=a.calculateGlobeLabelMatrix(w,s);a.multiply(I,I,O)}else{const O=ge([],P);I[0]=O[0],I[1]=O[1],I[4]=O[2],I[5]=O[3],y||a.rotateZ(I,I,w.angle)}else a.multiply(I,w.labelPlaneMatrix,g);return I}function Dt(g,s,h,y,w,T,P){const I=Te(g,s,h,y,w,T,P);return T.name==="globe"&&h||(I[2]=I[6]=I[10]=I[14]=0),I}function Tt(g,s,h,y,w,T,P){if(h){if(T.name==="globe"){const I=Te(g,s,h,y,w,T,P);return a.invert(I,I),a.multiply(I,g,I),I}{const I=a.clone(g),O=a.identity([]);return O[0]=P[0],O[1]=P[1],O[4]=P[2],O[5]=P[3],a.multiply(I,I,O),y||a.rotateZ(I,I,-w.angle),I}}return w.glCoordMatrix}function It(g,s,h,y){const w=[g,s,h,1];h?a.transformMat4$1(w,w,y):xn(w,w,y);const T=w[3];return w[0]/=T,w[1]/=T,w[2]/=T,w}function tn(g,s){return Math.min(.5+g/s*.5,1.5)}function Bn(g,s){const h=g[0]/g[3],y=g[1]/g[3];return h>=-s[0]&&h<=s[0]&&y>=-s[1]&&y<=s[1]}function pr(g,s,h,y,w,T,P,I,O,$){const U=h.transform,H=y?g.textSizeData:g.iconSizeData,oe=a.evaluateSizeForZoom(H,h.transform.zoom),de=U.projection.name==="globe",me=[256/h.width*2+1,256/h.height*2+1],fe=y?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;fe.clear();let ye=null;de&&(ye=y?g.text.globeExtVertexArray:g.icon.globeExtVertexArray);const K=g.lineVertexArray,ue=y?g.text.placedSymbolArray:g.icon.placedSymbolArray,Ee=h.transform.width/h.transform.height;let Ce,Fe=!1;for(let $e=0;$e<ue.length;$e++){const Ne=ue.get($e),{numGlyphs:Je,writingMode:Ye}=Ne;if(Ye!==a.WritingMode.vertical||Fe||Ce===a.WritingMode.horizontal||(Fe=!0),Ce=Ye,(Ne.hidden||Ye===a.WritingMode.vertical)&&!Fe){ar(Je,fe);continue}Fe=!1;const ut=new a.Point(Ne.tileAnchorX,Ne.tileAnchorY);let{x:Kt,y:st,z:Mt}=U.projection.projectTilePoint(ut.x,ut.y,$.canonical);if(O){const[mr,kn,Zn]=O(ut);Kt+=mr,st+=kn,Mt+=Zn}const gt=[Kt,st,Mt,1];if(a.transformMat4$1(gt,gt,s),!Bn(gt,me)){ar(Je,fe);continue}const Zt=tn(h.transform.cameraToCenterDistance,gt[3]),at=a.evaluateSizeForFeature(H,oe,Ne),St=P?at/Zt:at*Zt,Ht=It(Kt,st,Mt,w);if(Ht[3]<=0){ar(Je,fe);continue}let Ft={};const Yt=P?null:O,$n=pe(Ne,St,!1,I,s,w,T,g.glyphOffsetArray,K,fe,ye,Ht,ut,Ft,Ee,Yt,U.projection,$,P);Fe=$n.useVertical,Yt&&$n.needsFlipping&&(Ft={}),($n.notEnoughRoom||Fe||$n.needsFlipping&&pe(Ne,St,!0,I,s,w,T,g.glyphOffsetArray,K,fe,ye,Ht,ut,Ft,Ee,Yt,U.projection,$,P).notEnoughRoom)&&ar(Je,fe)}y?(g.text.dynamicLayoutVertexBuffer.updateData(fe),ye&&g.text.globeExtVertexBuffer.updateData(ye)):(g.icon.dynamicLayoutVertexBuffer.updateData(fe),ye&&g.icon.globeExtVertexBuffer.updateData(ye))}function _r(g,s,h,y,w,T,P,I,O,$,U,H,oe,de,me,fe){const{lineStartIndex:ye,glyphStartIndex:K,segment:ue}=I,Ee=K+I.numGlyphs,Ce=ye+I.lineLength,Fe=s.getoffsetX(K),$e=s.getoffsetX(Ee-1),Ne=yr(g*Fe,h,y,w,T,P,ue,ye,Ce,O,$,U,H,oe,!0,de,me,fe);if(!Ne)return null;const Je=yr(g*$e,h,y,w,T,P,ue,ye,Ce,O,$,U,H,oe,!0,de,me,fe);return Je?{first:Ne,last:Je}:null}function sr(g,s,h,y){return g===a.WritingMode.horizontal&&Math.abs(y)>Math.abs(h)?{useVertical:!0}:g===a.WritingMode.vertical?y>0?{needsFlipping:!0}:null:s!==cn.unknown&&function(w,T){return w===0||Math.abs(T/w)>yt}(h,y)?s===cn.flipRequired?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null}function pe(g,s,h,y,w,T,P,I,O,$,U,H,oe,de,me,fe,ye,K,ue){const Ee=s/24,Ce=g.lineOffsetX*Ee,Fe=g.lineOffsetY*Ee,{lineStartIndex:$e,glyphStartIndex:Ne,numGlyphs:Je,segment:Ye,writingMode:ut,flipState:Kt}=g,st=$e+g.lineLength,Mt=gt=>{if(U){const[Ht,Ft,Yt]=gt.up,$n=$.length;a.updateGlobeVertexNormal(U,$n+0,Ht,Ft,Yt),a.updateGlobeVertexNormal(U,$n+1,Ht,Ft,Yt),a.updateGlobeVertexNormal(U,$n+2,Ht,Ft,Yt),a.updateGlobeVertexNormal(U,$n+3,Ht,Ft,Yt)}const[Zt,at,St]=gt.point;a.addDynamicAttributes($,Zt,at,St,gt.angle)};if(Je>1){const gt=_r(Ee,I,Ce,Fe,h,H,oe,g,O,T,de,fe,!1,ye,K,ue);if(!gt)return{notEnoughRoom:!0};if(y&&!h){let[Zt,at,St]=gt.first.point,[Ht,Ft,Yt]=gt.last.point;[Zt,at]=It(Zt,at,St,P),[Ht,Ft]=It(Ht,Ft,Yt,P);const $n=sr(ut,Kt,(Ht-Zt)*me,Ft-at);if(g.flipState=$n&&$n.needsFlipping?cn.flipRequired:cn.flipNotRequired,$n)return $n}Mt(gt.first);for(let Zt=Ne+1;Zt<Ne+Je-1;Zt++){const at=yr(Ee*I.getoffsetX(Zt),Ce,Fe,h,H,oe,Ye,$e,st,O,T,de,fe,!1,!1,ye,K,ue);if(!at)return $.length-=4*(Zt-Ne),{notEnoughRoom:!0};Mt(at)}Mt(gt.last)}else{if(y&&!h){const Zt=It(oe.x,oe.y,0,w),at=$e+Ye+1,St=new a.Point(O.getx(at),O.gety(at)),Ht=It(St.x,St.y,0,w),Ft=Ht[3]>0?Ht:Tn(oe,St,Zt,1,w,void 0,ye,K.canonical),Yt=sr(ut,Kt,(Ft[0]-Zt[0])*me,Ft[1]-Zt[1]);if(g.flipState=Yt&&Yt.needsFlipping?cn.flipRequired:cn.flipNotRequired,Yt)return Yt}const gt=yr(Ee*I.getoffsetX(Ne),Ce,Fe,h,H,oe,Ye,$e,st,O,T,de,fe,!1,!1,ye,K,ue);if(!gt)return{notEnoughRoom:!0};Mt(gt)}return{}}function wn(g,s,h,y,w){const{x:T,y:P,z:I}=y.projectTilePoint(g.x,g.y,s);if(!w)return It(T,P,I,h);const[O,$,U]=w(g);return It(T+O,P+$,I+U,h)}function Tn(g,s,h,y,w,T,P,I){const O=wn(g.sub(s)._unit()._add(g),I,w,P,T);return a.sub(O,h,O),a.normalize(O,O),a.scaleAndAdd(O,h,O,y)}function yr(g,s,h,y,w,T,P,I,O,$,U,H,oe,de,me,fe,ye,K){const ue=y?g-s:g+s;let Ee=ue>0?1:-1,Ce=0;y&&(Ee*=-1,Ce=Math.PI),Ee<0&&(Ce+=Math.PI);let Fe=I+P+(Ee>0?0:1)|0,$e=w,Ne=w,Je=0,Ye=0;const ut=Math.abs(ue),Kt=[],st=[];let Mt=T,gt=Mt;const Zt=()=>Tn(gt,Mt,Ne,ut-Je+1,U,oe,fe,ye.canonical);for(;Je+Ye<=ut;){if(Fe+=Ee,Fe<I||Fe>=O)return null;if(Ne=$e,gt=Mt,Kt.push(Ne),de&&st.push(gt),Mt=new a.Point($.getx(Fe),$.gety(Fe)),$e=H[Fe],!$e){const Zn=wn(Mt,ye.canonical,U,fe,oe);$e=Zn[3]>0?H[Fe]=Zn:Zt()}Je+=Ye,Ye=a.distance(Ne,$e)}me&&oe&&(H[Fe]&&($e=Zt(),Ye=a.distance(Ne,$e)),H[Fe]=$e);const at=(ut-Je)/Ye,St=Mt.sub(gt)._mult(at)._add(gt),Ht=a.sub([],$e,Ne),Ft=a.scaleAndAdd([],Ne,Ht,at);let Yt=[0,0,1],$n=Ht[0],mr=Ht[1];if(K&&(Yt=fe.upVector(ye.canonical,St.x,St.y),Yt[0]!==0||Yt[1]!==0||Yt[2]!==1)){const Zn=[Yt[2],0,-Yt[0]],zr=a.cross([],Yt,Zn);a.normalize(Zn,Zn),a.normalize(zr,zr),$n=a.dot(Ht,Zn),mr=a.dot(Ht,zr)}if(h){const Zn=a.cross([],Yt,Ht);a.normalize(Zn,Zn),a.scaleAndAdd(Ft,Ft,Zn,h*Ee)}const kn=Ce+Math.atan2(mr,$n);return Kt.push(Ft),de&&st.push(St),{point:Ft,angle:kn,path:Kt,tilePath:st,up:Yt}}function ar(g,s){const h=s.length,y=h+4*g;s.resize(y),s.float32.fill(-1/0,4*h,4*y)}function xn(g,s,h){const y=s[0],w=s[1];return g[0]=h[0]*y+h[4]*w+h[12],g[1]=h[1]*y+h[5]*w+h[13],g[3]=h[3]*y+h[7]*w+h[15],g}const Er=100;class ie{constructor(s,h,y=new En(s.width+200,s.height+200,25),w=new En(s.width+200,s.height+200,25)){this.transform=s,this.grid=y,this.ignoredGrid=w,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+Er,this.screenBottomBoundary=s.height+Er,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.fogState=h}placeCollisionBox(s,h,y,w,T,P,I,O){let $=y.projectedAnchorX,U=y.projectedAnchorY,H=y.projectedAnchorZ;const oe=y.elevation,de=y.tileID,me=s.getProjection();if(oe&&de){const[$e,Ne,Je]=me.upVector(de.canonical,y.tileAnchorX,y.tileAnchorY),Ye=me.upVectorScale(de.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;$+=$e*oe*Ye,U+=Ne*oe*Ye,H+=Je*oe*Ye}const fe=this.projectAndGetPerspectiveRatio(I,$,U,H,y.tileID,me.name==="globe"||!!oe||this.transform.pitch>0,me),ye=P*fe.perspectiveRatio,K=(y.x1*h+w.x-y.padding)*ye+fe.point.x,ue=(y.y1*h+w.y-y.padding)*ye+fe.point.y,Ee=(y.x2*h+w.x+y.padding)*ye+fe.point.x,Ce=(y.y2*h+w.y+y.padding)*ye+fe.point.y,Fe=fe.perspectiveRatio<=.55||fe.occluded;return!this.isInsideGrid(K,ue,Ee,Ce)||!T&&this.grid.hitTest(K,ue,Ee,Ce,O)||Fe?{box:[],offscreen:!1,occluded:fe.occluded}:{box:[K,ue,Ee,Ce],offscreen:this.isOffscreen(K,ue,Ee,Ce),occluded:!1}}placeCollisionCircles(s,h,y,w,T,P,I,O,$,U,H,oe,de,me,fe){const ye=[],K=this.transform.elevation,ue=s.getProjection(),Ee=K?K.getAtTileOffsetFunc(fe,this.transform.center.lat,this.transform.worldSize,ue):null,Ce=new a.Point(y.tileAnchorX,y.tileAnchorY);let{x:Fe,y:$e,z:Ne}=ue.projectTilePoint(Ce.x,Ce.y,fe.canonical);if(Ee){const[St,Ht,Ft]=Ee(Ce);Fe+=St,$e+=Ht,Ne+=Ft}const Je=ue.name==="globe",Ye=this.projectAndGetPerspectiveRatio(I,Fe,$e,Ne,fe,Je||!!K||this.transform.pitch>0,ue),{perspectiveRatio:ut}=Ye,Kt=(H?P/ut:P*ut)/a.ONE_EM,st=It(Fe,$e,Ne,O),Mt=Ye.signedDistanceFromCamera>0?_r(Kt,T,y.lineOffsetX*Kt,y.lineOffsetY*Kt,!1,st,Ce,y,w,O,{},K&&!H?Ee:null,H&&!!K,ue,fe,H):null;let gt=!1,Zt=!1,at=!0;if(Mt&&!Ye.occluded){const St=.5*de*ut+me,Ht=new a.Point(-100,-100),Ft=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),Yt=new Dn,{first:$n,last:mr}=Mt,kn=$n.path.length;let Zn=[];for(let jn=kn-1;jn>=1;jn--)Zn.push($n.path[jn]);for(let jn=1;jn<mr.path.length;jn++)Zn.push(mr.path[jn]);const zr=2.5*St;$&&(Zn=Zn.map(([jn,Jr,ti],oi)=>(Ee&&!Je&&(ti=Ee(oi<kn-1?$n.tilePath[kn-1-oi]:mr.tilePath[oi-kn+2])[2]),It(jn,Jr,ti,$))),Zn.some(jn=>jn[3]<=0)&&(Zn=[]));let Or=[];if(Zn.length>0){let jn=1/0,Jr=-1/0,ti=1/0,oi=-1/0;for(const di of Zn)jn=Math.min(jn,di[0]),ti=Math.min(ti,di[1]),Jr=Math.max(Jr,di[0]),oi=Math.max(oi,di[1]);Jr>=Ht.x&&jn<=Ft.x&&oi>=Ht.y&&ti<=Ft.y&&(Or=[Zn.map(di=>new a.Point(di[0],di[1]))],(jn<Ht.x||Jr>Ft.x||ti<Ht.y||oi>Ft.y)&&(Or=a.clipLine(Or,Ht.x,Ht.y,Ft.x,Ft.y)))}for(const jn of Or){Yt.reset(jn,.25*St);let Jr=0;Jr=Yt.length<=.5*St?1:Math.ceil(Yt.paddedLength/zr)+1;for(let ti=0;ti<Jr;ti++){const oi=ti/Math.max(Jr-1,1),di=Yt.lerp(oi),Lo=di.x+Er,qi=di.y+Er;ye.push(Lo,qi,St,0);const bs=Lo-St,us=qi-St,Qr=Lo+St,ni=qi+St;if(at=at&&this.isOffscreen(bs,us,Qr,ni),Zt=Zt||this.isInsideGrid(bs,us,Qr,ni),!h&&this.grid.hitTestCircle(Lo,qi,St,oe)&&(gt=!0,!U))return{circles:[],offscreen:!1,collisionDetected:gt,occluded:!1}}}}return{circles:!U&&gt||!Zt?[]:ye,offscreen:at,collisionDetected:gt,occluded:Ye.occluded}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let y=1/0,w=1/0,T=-1/0,P=-1/0;for(const U of s){const H=new a.Point(U.x+Er,U.y+Er);y=Math.min(y,H.x),w=Math.min(w,H.y),T=Math.max(T,H.x),P=Math.max(P,H.y),h.push(H)}const I=this.grid.query(y,w,T,P).concat(this.ignoredGrid.query(y,w,T,P)),O={},$={};for(const U of I){const H=U.key;if(O[H.bucketInstanceId]===void 0&&(O[H.bucketInstanceId]={}),O[H.bucketInstanceId][H.featureIndex])continue;const oe=[new a.Point(U.x1,U.y1),new a.Point(U.x2,U.y1),new a.Point(U.x2,U.y2),new a.Point(U.x1,U.y2)];a.polygonIntersectsPolygon(h,oe)&&(O[H.bucketInstanceId][H.featureIndex]=!0,$[H.bucketInstanceId]===void 0&&($[H.bucketInstanceId]=[]),$[H.bucketInstanceId].push(H.featureIndex))}return $}insertCollisionBox(s,h,y,w,T){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:w,collisionGroupID:T},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,h,y,w,T){const P=h?this.ignoredGrid:this.grid,I={bucketInstanceId:y,featureIndex:w,collisionGroupID:T};for(let O=0;O<s.length;O+=4)P.insertCircle(I,s[O],s[O+1],s[O+2])}projectAndGetPerspectiveRatio(s,h,y,w,T,P,I){const O=[h,y,w,1];let $=!1;w||this.transform.pitch>0?(a.transformMat4$1(O,O,s),this.fogState&&T&&I.name!=="globe"&&($=function(oe,de,me,fe,ye,K){const ue=K.calculateFogTileMatrix(ye),Ee=[de,me,fe];return a.transformMat4(Ee,Ee,ue),Sn(oe,Ee,K.pitch,K._fov)}(this.fogState,h,y,w,T.toUnwrapped(),this.transform)>.9)):xn(O,O,s);const U=O[3];return{point:new a.Point((O[0]/U+1)/2*this.transform.width+Er,(-O[1]/U+1)/2*this.transform.height+Er),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/U*.5,1.5),signedDistanceFromCamera:U,occluded:P&&O[2]>U||$}}isOffscreen(s,h,y,w){return y<Er||s>=this.screenRightBoundary||w<Er||h>this.screenBottomBoundary}isInsideGrid(s,h,y,w){return y>=0&&s<this.gridRightBoundary&&w>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const s=a.identity([]);return a.translate(s,s,[-100,-100,0]),s}}function ae(g,s,h){const y=s.createTileMatrix(g,g.worldSize,h.toUnwrapped());return a.multiply(new Float32Array(16),g.projMatrix,y)}function Le(g,s,h){if(s.projection.name===h.projection.name)return g.projMatrix;const y=h.clone();return y.setProjection(s.projection),ae(y,s.getProjection(),g)}function tt(g,s,h){return s.name===h.projection.name?g.projMatrix:ae(h,s,g)}class zt{constructor(s,h,y,w){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?h:-h))):w&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class an{constructor(s,h,y,w,T,P=!1){this.text=new zt(s?s.text:null,h,y,T),this.icon=new zt(s?s.icon:null,h,w,T),this.clipped=P}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Qn{constructor(s,h,y,w=!1){this.text=s,this.icon=h,this.skipFade=y,this.clipped=w}}class Fr{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class Vr{constructor(s,h,y,w,T){this.bucketInstanceId=s,this.featureIndex=h,this.sourceLayerIndex=y,this.bucketIndex=w,this.tileID=T}}class ro{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const h=++this.maxGroupID;this.collisionGroups[s]={ID:h,predicate:y=>y.collisionGroupID===h}}return this.collisionGroups[s]}}function Wi(g,s,h,y,w){const{horizontalAlign:T,verticalAlign:P}=a.getAnchorAlignment(g),I=-(T-.5)*s,O=-(P-.5)*h,$=a.evaluateVariableOffset(g,y);return new a.Point(I+$[0]*w,O+$[1]*w)}function Ps(g,s,h,y,w){const T=new a.Point(g,s);return h&&T._rotate(y?w:-w),T}class Gs{constructor(s,h,y,w,T){this.transform=s.clone(),this.projection=s.projection.name,this.collisionIndex=new ie(this.transform,T),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new ro(y),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,h,y,w){const T=y.getBucket(h),P=y.latestFeatureIndex;if(!T||!P||h.id!==T.layerIds[0])return;const I=T.layers[0].layout,O=y.collisionBoxArray,$=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),U=y.tileSize/a.EXTENT,H=y.tileID.toUnwrapped();this.transform.setProjection(T.projection);const oe=(de=y.tileID,me=T.getProjection(),fe=this.transform,me.name===this.projection?fe.calculateProjMatrix(de.toUnwrapped()):ae(fe,me,de));var de,me,fe;const ye=I.get("text-pitch-alignment")==="map",K=I.get("text-rotation-alignment")==="map";h.compileFilter();const ue=h.dynamicFilter(),Ee=h.dynamicFilterNeedsFeature(),Ce=this.transform.calculatePixelsToTileUnitsMatrix(y),Fe=Dt(oe,y.tileID.canonical,ye,K,this.transform,T.getProjection(),Ce);let $e=null;if(ye){const Ye=Tt(oe,y.tileID.canonical,ye,K,this.transform,T.getProjection(),Ce);$e=a.multiply([],this.transform.labelPlaneMatrix,Ye)}let Ne=null;ue&&y.latestFeatureIndex&&(Ne={unwrappedTileID:H,dynamicFilter:ue,dynamicFilterNeedsFeature:Ee,featureIndex:y.latestFeatureIndex}),this.retainedQueryData[T.bucketInstanceId]=new Vr(T.bucketInstanceId,P,T.sourceLayerIndex,T.index,y.tileID);const Je={bucket:T,layout:I,posMatrix:oe,textLabelPlaneMatrix:Fe,labelToScreenMatrix:$e,clippingData:Ne,scale:$,textPixelRatio:U,holdingForFade:y.holdingForFade(),collisionBoxArray:O,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(T.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(T.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(w)for(const Ye of T.sortKeyRanges){const{sortKey:ut,symbolInstanceStart:Kt,symbolInstanceEnd:st}=Ye;s.push({sortKey:ut,symbolInstanceStart:Kt,symbolInstanceEnd:st,parameters:Je})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:Je})}attemptAnchorPlacement(s,h,y,w,T,P,I,O,$,U,H,oe,de,me,fe,ye,K,ue){const{textOffset0:Ee,textOffset1:Ce,crossTileID:Fe}=oe,$e=[Ee,Ce],Ne=Wi(s,y,w,$e,T),Je=this.collisionIndex.placeCollisionBox(me,T,h,Ps(Ne.x,Ne.y,P,I,this.transform.angle),H,O,$,U.predicate);if(ye){const Ye=me.getSymbolInstanceIconSize(ue,this.transform.zoom,oe.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(me,Ye,ye,Ps(Ne.x,Ne.y,P,I,this.transform.angle),H,O,$,U.predicate).box.length===0)return}if(Je.box.length>0){let Ye;return this.prevPlacement&&this.prevPlacement.variableOffsets[Fe]&&this.prevPlacement.placements[Fe]&&this.prevPlacement.placements[Fe].text&&(Ye=this.prevPlacement.variableOffsets[Fe].anchor),this.variableOffsets[Fe]={textOffset:$e,width:y,height:w,anchor:s,textScale:T,prevAnchor:Ye},this.markUsedJustification(me,s,oe,fe),me.allowVerticalPlacement&&(this.markUsedOrientation(me,fe,oe),this.placedOrientations[Fe]=fe),{shift:Ne,placedGlyphBoxes:Je}}}placeLayerBucketPart(s,h,y,w){const{bucket:T,layout:P,posMatrix:I,textLabelPlaneMatrix:O,labelToScreenMatrix:$,clippingData:U,textPixelRatio:H,holdingForFade:oe,collisionBoxArray:de,partiallyEvaluatedTextSize:me,partiallyEvaluatedIconSize:fe,collisionGroup:ye}=s.parameters,K=P.get("text-optional"),ue=P.get("icon-optional"),Ee=P.get("text-allow-overlap"),Ce=P.get("icon-allow-overlap"),Fe=P.get("text-rotation-alignment")==="map",$e=P.get("text-pitch-alignment")==="map",Ne=P.get("icon-text-fit")!=="none",Je=P.get("symbol-z-order")==="viewport-y";this.transform.setProjection(T.projection);let Ye=Ee&&(Ce||!T.hasIconData()||ue),ut=Ce&&(Ee||!T.hasTextData()||K);!T.collisionArrays&&de&&T.deserializeCollisionBoxes(de),y&&w&&T.updateCollisionDebugBuffers(this.transform.zoom,de);const Kt=(st,Mt,gt)=>{const{crossTileID:Zt,numVerticalGlyphVertices:at}=st;if(U){const Qr={zoom:this.transform.zoom,pitch:this.transform.pitch};let ni=null;if(U.dynamicFilterNeedsFeature){const Wr=this.retainedQueryData[T.bucketInstanceId];ni=U.featureIndex.loadFeature({featureIndex:st.featureIndex,bucketIndex:Wr.bucketIndex,sourceLayerIndex:Wr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,U.dynamicFilter)(Qr,ni,this.retainedQueryData[T.bucketInstanceId].tileID.canonical,new a.Point(st.tileAnchorX,st.tileAnchorY),this.transform.calculateDistanceTileData(U.unwrappedTileID)))return this.placements[Zt]=new Qn(!1,!1,!1,!0),void h.add(Zt)}if(h.has(Zt))return;if(oe)return void(this.placements[Zt]=new Qn(!1,!1,!1));let St=!1,Ht=!1,Ft=!0,Yt=!1,$n=!1,mr=null,kn={box:null,offscreen:null,occluded:null},Zn={box:null},zr=null,Or=null,jn=null,Jr=0,ti=0,oi=0;gt.textFeatureIndex?Jr=gt.textFeatureIndex:st.useRuntimeCollisionCircles&&(Jr=st.featureIndex),gt.verticalTextFeatureIndex&&(ti=gt.verticalTextFeatureIndex);const di=Qr=>{Qr.tileID=this.retainedQueryData[T.bucketInstanceId].tileID;const ni=this.transform.elevation;(ni||Qr.elevation)&&(Qr.elevation=ni?ni.getAtTileOffset(Qr.tileID,Qr.tileAnchorX,Qr.tileAnchorY):0)},Lo=gt.textBox;if(Lo){di(Lo);const Qr=Wr=>{let Ei=a.WritingMode.horizontal;if(T.allowVerticalPlacement&&!Wr&&this.prevPlacement){const Ro=this.prevPlacement.placedOrientations[Zt];Ro&&(this.placedOrientations[Zt]=Ro,Ei=Ro,this.markUsedOrientation(T,Ei,st))}return Ei},ni=(Wr,Ei)=>{if(T.allowVerticalPlacement&&at>0&&gt.verticalTextBox){for(const Ro of T.writingModes)if(Ro===a.WritingMode.vertical?(kn=Ei(),Zn=kn):kn=Wr(),kn&&kn.box&&kn.box.length)break}else kn=Wr()};if(P.get("text-variable-anchor")){let Wr=P.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Zt]){const hi=this.prevPlacement.variableOffsets[Zt];Wr.indexOf(hi.anchor)>0&&(Wr=Wr.filter(Ko=>Ko!==hi.anchor),Wr.unshift(hi.anchor))}const Ei=(hi,Ko,Ac)=>{const yi=T.getSymbolInstanceTextSize(me,st,this.transform.zoom,Mt),dl=(hi.x2-hi.x1)*yi+2*hi.padding,Js=(hi.y2-hi.y1)*yi+2*hi.padding,ya=Ne&&!Ce?Ko:null;ya&&di(ya);let va={box:[],offscreen:!1,occluded:!1};const Pc=Ee?2*Wr.length:Wr.length;for(let Qs=0;Qs<Pc;++Qs){const zi=this.attemptAnchorPlacement(Wr[Qs%Wr.length],hi,dl,Js,yi,Fe,$e,H,I,ye,Qs>=Wr.length,st,Mt,T,Ac,ya,me,fe);if(zi&&(va=zi.placedGlyphBoxes,va&&va.box&&va.box.length)){St=!0,mr=zi.shift;break}}return va};ni(()=>Ei(Lo,gt.iconBox,a.WritingMode.horizontal),()=>{const hi=gt.verticalTextBox;return hi&&di(hi),T.allowVerticalPlacement&&!(kn&&kn.box&&kn.box.length)&&at>0&&hi?Ei(hi,gt.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),kn&&(St=kn.box,Ft=kn.offscreen,Yt=kn.occluded);const Ro=Qr(!(!kn||!kn.box));if(!St&&this.prevPlacement){const hi=this.prevPlacement.variableOffsets[Zt];hi&&(this.variableOffsets[Zt]=hi,this.markUsedJustification(T,hi.anchor,st,Ro))}}else{const Wr=(Ei,Ro)=>{const hi=T.getSymbolInstanceTextSize(me,st,this.transform.zoom,Mt),Ko=this.collisionIndex.placeCollisionBox(T,hi,Ei,new a.Point(0,0),Ee,H,I,ye.predicate);return Ko&&Ko.box&&Ko.box.length&&(this.markUsedOrientation(T,Ro,st),this.placedOrientations[Zt]=Ro),Ko};ni(()=>Wr(Lo,a.WritingMode.horizontal),()=>{const Ei=gt.verticalTextBox;return T.allowVerticalPlacement&&at>0&&Ei?(di(Ei),Wr(Ei,a.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Qr(!!(kn&&kn.box&&kn.box.length))}}if(zr=kn,St=zr&&zr.box&&zr.box.length>0,Ft=zr&&zr.offscreen,Yt=zr&&zr.occluded,st.useRuntimeCollisionCircles){const Qr=T.text.placedSymbolArray.get(st.centerJustifiedTextSymbolIndex>=0?st.centerJustifiedTextSymbolIndex:st.verticalPlacedTextSymbolIndex),ni=a.evaluateSizeForFeature(T.textSizeData,me,Qr),Wr=P.get("text-padding");Or=this.collisionIndex.placeCollisionCircles(T,Ee,Qr,T.lineVertexArray,T.glyphOffsetArray,ni,I,O,$,y,$e,ye.predicate,st.collisionCircleDiameter*ni/a.ONE_EM,Wr,this.retainedQueryData[T.bucketInstanceId].tileID),St=Ee||Or.circles.length>0&&!Or.collisionDetected,Ft=Ft&&Or.offscreen,Yt=Or.occluded}if(gt.iconFeatureIndex&&(oi=gt.iconFeatureIndex),gt.iconBox){const Qr=ni=>{di(ni);const Wr=Ne&&mr?Ps(mr.x,mr.y,Fe,$e,this.transform.angle):new a.Point(0,0),Ei=T.getSymbolInstanceIconSize(fe,this.transform.zoom,st.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(T,Ei,ni,Wr,Ce,H,I,ye.predicate)};Zn&&Zn.box&&Zn.box.length&&gt.verticalIconBox?(jn=Qr(gt.verticalIconBox),Ht=jn.box.length>0):(jn=Qr(gt.iconBox),Ht=jn.box.length>0),Ft=Ft&&jn.offscreen,$n=jn.occluded}const qi=K||st.numHorizontalGlyphVertices===0&&at===0,bs=ue||st.numIconVertices===0;if(qi||bs?bs?qi||(Ht=Ht&&St):St=Ht&&St:Ht=St=Ht&&St,St&&zr&&zr.box&&this.collisionIndex.insertCollisionBox(zr.box,P.get("text-ignore-placement"),T.bucketInstanceId,Zn&&Zn.box&&ti?ti:Jr,ye.ID),Ht&&jn&&this.collisionIndex.insertCollisionBox(jn.box,P.get("icon-ignore-placement"),T.bucketInstanceId,oi,ye.ID),Or&&(St&&this.collisionIndex.insertCollisionCircles(Or.circles,P.get("text-ignore-placement"),T.bucketInstanceId,Jr,ye.ID),y)){const Qr=T.bucketInstanceId;let ni=this.collisionCircleArrays[Qr];ni===void 0&&(ni=this.collisionCircleArrays[Qr]=new Fr);for(let Wr=0;Wr<Or.circles.length;Wr+=4)ni.circles.push(Or.circles[Wr+0]),ni.circles.push(Or.circles[Wr+1]),ni.circles.push(Or.circles[Wr+2]),ni.circles.push(Or.collisionDetected?1:0)}const us=T.projection.name!=="globe";Ye=Ye&&(us||!Yt),ut=ut&&(us||!$n),this.placements[Zt]=new Qn(St||Ye,Ht||ut,Ft||T.justReloaded),h.add(Zt)};if(Je){const st=T.getSortedSymbolIndexes(this.transform.angle);for(let Mt=st.length-1;Mt>=0;--Mt){const gt=st[Mt];Kt(T.symbolInstances.get(gt),gt,T.collisionArrays[gt])}}else for(let st=s.symbolInstanceStart;st<s.symbolInstanceEnd;st++)Kt(T.symbolInstances.get(st),st,T.collisionArrays[st]);if(y&&T.bucketInstanceId in this.collisionCircleArrays){const st=this.collisionCircleArrays[T.bucketInstanceId];a.invert(st.invProjMatrix,I),st.viewportMatrix=this.collisionIndex.getViewportMatrix()}T.justReloaded=!1}markUsedJustification(s,h,y,w){const{leftJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:O,crossTileID:$}=y,U=a.getAnchorJustification(h),H=w===a.WritingMode.vertical?O:U==="left"?T:U==="center"?P:U==="right"?I:-1;T>=0&&(s.text.placedSymbolArray.get(T).crossTileID=H>=0&&T!==H?0:$),P>=0&&(s.text.placedSymbolArray.get(P).crossTileID=H>=0&&P!==H?0:$),I>=0&&(s.text.placedSymbolArray.get(I).crossTileID=H>=0&&I!==H?0:$),O>=0&&(s.text.placedSymbolArray.get(O).crossTileID=H>=0&&O!==H?0:$)}markUsedOrientation(s,h,y){const w=h===a.WritingMode.horizontal||h===a.WritingMode.horizontalOnly?h:0,T=h===a.WritingMode.vertical?h:0,{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:$}=y,U=s.text.placedSymbolArray;P>=0&&(U.get(P).placedOrientation=w),I>=0&&(U.get(I).placedOrientation=w),O>=0&&(U.get(O).placedOrientation=w),$>=0&&(U.get($).placedOrientation=T)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let y=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const w=h?h.symbolFadeChange(s):1,T=h?h.opacities:{},P=h?h.variableOffsets:{},I=h?h.placedOrientations:{};for(const O in this.placements){const $=this.placements[O],U=T[O];U?(this.opacities[O]=new an(U,w,$.text,$.icon,null,$.clipped),y=y||$.text!==U.text.placed||$.icon!==U.icon.placed):(this.opacities[O]=new an(null,w,$.text,$.icon,$.skipFade,$.clipped),y=y||$.text||$.icon)}for(const O in T){const $=T[O];if(!this.opacities[O]){const U=new an($,w,!1,!1);U.isHidden()||(this.opacities[O]=U,y=y||$.text.placed||$.icon.placed)}}for(const O in P)this.variableOffsets[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.variableOffsets[O]=P[O]);for(const O in I)this.placedOrientations[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.placedOrientations[O]=I[O]);y?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:s)}updateLayerOpacities(s,h){const y=new Set;for(const w of h){const T=w.getBucket(s);T&&w.latestFeatureIndex&&s.id===T.layerIds[0]&&this.updateBucketOpacities(T,y,w.collisionBoxArray)}}updateBucketOpacities(s,h,y){s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const w=s.layers[0].layout,T=!!s.layers[0].dynamicFilter(),P=new an(null,0,!1,!1,!0),I=w.get("text-allow-overlap"),O=w.get("icon-allow-overlap"),$=w.get("text-variable-anchor"),U=w.get("text-rotation-alignment")==="map",H=w.get("text-pitch-alignment")==="map",oe=w.get("icon-text-fit")!=="none",de=new an(null,0,I&&(O||!s.hasIconData()||w.get("icon-optional")),O&&(I||!s.hasTextData()||w.get("text-optional")),!0);!s.collisionArrays&&y&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(y);const me=(ye,K,ue)=>{for(let Ee=0;Ee<K/4;Ee++)ye.opacityVertexArray.emplaceBack(ue)};let fe=0;for(let ye=0;ye<s.symbolInstances.length;ye++){const K=s.symbolInstances.get(ye),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:Ee,crossTileID:Ce,numIconVertices:Fe}=K,$e=h.has(Ce);let Ne=this.opacities[Ce];$e?Ne=P:Ne||(Ne=de,this.opacities[Ce]=Ne),h.add(Ce);const Je=ue>0||Ee>0,Ye=Fe>0,ut=this.placedOrientations[Ce],Kt=ut===a.WritingMode.vertical,st=ut===a.WritingMode.horizontal||ut===a.WritingMode.horizontalOnly;if(!Je&&!Ye||Ne.isHidden()||fe++,Je){const Mt=Ja(Ne.text);me(s.text,ue,Kt?Ui:Mt),me(s.text,Ee,st?Ui:Mt);const gt=Ne.text.isHidden(),{leftJustifiedTextSymbolIndex:Zt,centerJustifiedTextSymbolIndex:at,rightJustifiedTextSymbolIndex:St,verticalPlacedTextSymbolIndex:Ht}=K,Ft=s.text.placedSymbolArray,Yt=gt||Kt?1:0;Zt>=0&&(Ft.get(Zt).hidden=Yt),at>=0&&(Ft.get(at).hidden=Yt),St>=0&&(Ft.get(St).hidden=Yt),Ht>=0&&(Ft.get(Ht).hidden=gt||st?1:0);const $n=this.variableOffsets[Ce];$n&&this.markUsedJustification(s,$n.anchor,K,ut);const mr=this.placedOrientations[Ce];mr&&(this.markUsedJustification(s,"left",K,mr),this.markUsedOrientation(s,mr,K))}if(Ye){const Mt=Ja(Ne.icon),{placedIconSymbolIndex:gt,verticalPlacedIconSymbolIndex:Zt}=K,at=s.icon.placedSymbolArray,St=Ne.icon.isHidden()?1:0;gt>=0&&(me(s.icon,Fe,Kt?Ui:Mt),at.get(gt).hidden=St),Zt>=0&&(me(s.icon,K.numVerticalIconVertices,st?Ui:Mt),at.get(Zt).hidden=St)}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const Mt=s.collisionArrays[ye];if(Mt){let gt=new a.Point(0,0),Zt=!0;if(Mt.textBox||Mt.verticalTextBox){if($){const St=this.variableOffsets[Ce];St?(gt=Wi(St.anchor,St.width,St.height,St.textOffset,St.textScale),U&&gt._rotate(H?this.transform.angle:-this.transform.angle)):Zt=!1}T&&(Zt=!Ne.clipped),Mt.textBox&&ha(s.textCollisionBox.collisionVertexArray,Ne.text.placed,!Zt||Kt,gt.x,gt.y),Mt.verticalTextBox&&ha(s.textCollisionBox.collisionVertexArray,Ne.text.placed,!Zt||st,gt.x,gt.y)}const at=Zt&&!!(!st&&Mt.verticalIconBox);Mt.iconBox&&ha(s.iconCollisionBox.collisionVertexArray,Ne.icon.placed,at,oe?gt.x:0,oe?gt.y:0),Mt.verticalIconBox&&ha(s.iconCollisionBox.collisionVertexArray,Ne.icon.placed,!at,oe?gt.x:0,oe?gt.y:0)}}}if(s.fullyClipped=fe===0,s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){const ye=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=ye.invProjMatrix,s.placementViewportMatrix=ye.viewportMatrix,s.collisionCircleArray=ye.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,h){const y=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*y>s}setStale(){this.stale=!0}}function ha(g,s,h,y,w){g.emplaceBack(s?1:0,h?1:0,y||0,w||0),g.emplaceBack(s?1:0,h?1:0,y||0,w||0),g.emplaceBack(s?1:0,h?1:0,y||0,w||0),g.emplaceBack(s?1:0,h?1:0,y||0,w||0)}const Eo=Math.pow(2,25),_i=Math.pow(2,24),Fd=Math.pow(2,17),vh=Math.pow(2,16),To=Math.pow(2,9),Is=Math.pow(2,8),Ud=Math.pow(2,1);function Ja(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const s=g.placed?1:0,h=Math.floor(127*g.opacity);return h*Eo+s*_i+h*Fd+s*vh+h*To+s*Is+h*Ud+s}const Ui=0;class mu{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&s.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(s,h,y,w,T){const P=this._bucketParts;for(;this._currentTileIndex<s.length;)if(h.getBucketParts(P,w,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((I,O)=>I.sortKey-O.sortKey));this._currentPartIndex<P.length;){const I=P[this._currentPartIndex];if(h.placeLayerBucketPart(I,this._seenCrossTileIDs,y,I.symbolInstanceStart===0),this._currentPartIndex++,T())return!0}return!1}}class xl{constructor(s,h,y,w,T,P,I,O){this.placement=new Gs(s,T,P,I,O),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(s,h,y){const w=a.exported.now(),T=()=>{const P=a.exported.now()-w;return!this._forceFullPlacement&&P>2};for(;this._currentPlacementIndex>=0;){const P=h[s[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=I)&&(!P.maxzoom||P.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new mu(P)),this._inProgressLayer.continuePlacement(y[P.source],this.placement,this._showCollisionBoxes,P,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const Zs=512/a.EXTENT/2;class Yi{constructor(s,h,y){this.tileID=s,this.bucketInstanceId=y,this.index=new a.KDBush(h.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const w=s.canonical.x*a.EXTENT,T=s.canonical.y*a.EXTENT;for(let P=0;P<h.length;P++){const{key:I,crossTileID:O,tileAnchorX:$,tileAnchorY:U}=h.get(P),H=Math.floor((w+$)*Zs),oe=Math.floor((T+U)*Zs);this.index.add(H,oe),this.keys.push(I),this.crossTileIDs.push(O)}this.index.finish()}findMatches(s,h,y){const w=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),T=Zs/Math.pow(2,h.canonical.z-this.tileID.canonical.z),P=h.canonical.x*a.EXTENT,I=h.canonical.y*a.EXTENT;for(let O=0;O<s.length;O++){const $=s.get(O);if($.crossTileID)continue;const{key:U,tileAnchorX:H,tileAnchorY:oe}=$,de=Math.floor((P+H)*T),me=Math.floor((I+oe)*T),fe=this.index.range(de-w,me-w,de+w,me+w);for(const ye of fe){const K=this.crossTileIDs[ye];if(this.keys[ye]===U&&!y.has(K)){y.add(K),$.crossTileID=K;break}}}}}class oc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $d{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const h=Math.round((s-this.lng)/360);if(h!==0)for(const y in this.indexes){const w=this.indexes[y],T={};for(const P in w){const I=w[P];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+h),T[I.tileID.key]=I}this.indexes[y]=T}this.lng=s}addBucket(s,h,y){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let T=0;T<h.symbolInstances.length;T++)h.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]=new Set);const w=this.usedCrossTileIDs[s.overscaledZ];for(const T in this.indexes){const P=this.indexes[T];if(Number(T)>s.overscaledZ)for(const I in P){const O=P[I];O.tileID.isChildOf(s)&&O.findMatches(h.symbolInstances,s,w)}else{const I=P[s.scaledTo(Number(T)).key];I&&I.findMatches(h.symbolInstances,s,w)}}for(let T=0;T<h.symbolInstances.length;T++){const P=h.symbolInstances.get(T);P.crossTileID||(P.crossTileID=y.generate(),w.add(P.crossTileID))}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new Yi(s,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(s,h){for(const y of h.crossTileIDs)this.usedCrossTileIDs[s].delete(y)}removeStaleBuckets(s){let h=!1;for(const y in this.indexes){const w=this.indexes[y];for(const T in w)s[w[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,w[T]),delete w[T],h=!0)}return h}}class Pa{constructor(){this.layerIndexes={},this.crossTileIDs=new oc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,h,y,w){let T=this.layerIndexes[s.id];T===void 0&&(T=this.layerIndexes[s.id]=new $d);let P=!1;const I={};w.name!=="globe"&&T.handleWrapJump(y);for(const O of h){const $=O.getBucket(s);$&&s.id===$.layerIds[0]&&($.bucketInstanceId||($.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(O.tileID,$,this.crossTileIDs)&&(P=!0),I[$.bucketInstanceId]=!0)}return T.removeStaleBuckets(I)&&(P=!0),P}pruneUnusedLayers(s){const h={};s.forEach(y=>{h[y]=!0});for(const y in this.layerIndexes)h[y]||delete this.layerIndexes[y]}}const da=(g,s)=>a.emitValidationErrors(g,s&&s.filter(h=>h.identifier!=="source.canvas")),wl=a.pick(bn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Vd=a.pick(bn,["setCenter","setZoom","setBearing","setPitch"]),xh={version:8,layers:[],sources:{}},ys={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Ls extends a.Evented{constructor(s,h={}){super(),this.map=s,this.dispatcher=new At(Cn(),this),this.imageManager=new Ue,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(s._requestManager,h.localFontFamily?a.LocalGlyphMode.all:h.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,h.localFontFamily||h.localIdeographFontFamily),this.crossTileSymbolIndex=new Pa,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const y=this;this._rtlTextPluginCallback=Ls.registerForPluginStateChange(w=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(T,P)=>{if(a.triggerPluginCompletionEvent(T),P&&P.every(I=>I))for(const I in y._sourceCaches){const O=y._sourceCaches[I],$=O.getSource().type;$!=="vector"&&$!=="geojson"||O.reload()}})}),this.on("data",w=>{if(w.dataType!=="source"||w.sourceDataType!=="metadata")return;const T=this.getSource(w.sourceId);if(T&&T.vectorLayerIds)for(const P in this._layers){const I=this._layers[P];I.source===T.id&&this._validateLayer(I)}})}loadURL(s,h={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const y=typeof h.validate=="boolean"?h.validate:!a.isMapboxURL(s);s=this.map._requestManager.normalizeStyleURL(s,h.accessToken);const w=this.map._requestManager.transformRequest(s,a.ResourceType.Style);this._request=a.getJSON(w,(T,P)=>{this._request=null,T?this.fire(new a.ErrorEvent(T)):P&&this._load(P,y)})}loadJSON(s,h={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(s,h.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(xh,!1)}_updateLayerCount(s,h){const y=h?1:-1;s.is3D()&&(this._num3DLayers+=y),s.type==="circle"&&(this._numCircleLayers+=y),s.type==="symbol"&&(this._numSymbolLayers+=y)}_load(s,h){if(h&&da(this,a.validateStyle(s)))return;this._loaded=!0,this.stylesheet=a.clone$1(s),this._updateMapProjection();for(const w in s.sources)this.addSource(w,s.sources[w],{validate:!1});this._changed=!1,s.sprite?this._loadSprite(s.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(s.glyphs);const y=hr(this.stylesheet.layers);this._order=y.map(w=>w.id),this._layers={},this._serializedLayers={};for(const w of y){const T=a.createStyleLayer(w);T.setEventedParent(this,{layer:{id:T.id}}),this._layers[T.id]=T,this._serializedLayers[T.id]=T.serialize(),this._updateLayerCount(T,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ht(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(s){s?this.stylesheet.projection=s:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(s){this._spriteRequest=function(h,y,w){let T,P,I;const O=a.exported.devicePixelRatio>1?"@2x":"";let $=a.getJSON(y.transformRequest(y.normalizeSpriteURL(h,O,".json"),a.ResourceType.SpriteJSON),(oe,de)=>{$=null,I||(I=oe,T=de,H())}),U=a.getImage(y.transformRequest(y.normalizeSpriteURL(h,O,".png"),a.ResourceType.SpriteImage),(oe,de)=>{U=null,I||(I=oe,P=de,H())});function H(){if(I)w(I);else if(T&&P){const oe=a.exported.getImageData(P),de={};for(const me in T){const{width:fe,height:ye,x:K,y:ue,sdf:Ee,pixelRatio:Ce,stretchX:Fe,stretchY:$e,content:Ne}=T[me],Je=new a.RGBAImage({width:fe,height:ye});a.RGBAImage.copy(oe,Je,{x:K,y:ue},{x:0,y:0},{width:fe,height:ye}),de[me]={data:Je,pixelRatio:Ce,sdf:Ee,stretchX:Fe,stretchY:$e,content:Ne}}w(null,de)}}return{cancel(){$&&($.cancel(),$=null),U&&(U.cancel(),U=null)}}}(s,this.map._requestManager,(h,y)=>{if(this._spriteRequest=null,h)this.fire(new a.ErrorEvent(h));else if(y)for(const w in y)this.imageManager.addImage(w,y[w]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(s){const h=this.getSource(s.source);if(!h)return;const y=s.sourceLayer;y&&(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(y)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${y}" does not exist on source "${h.id}" as specified by style layer "${s.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const s in this._sourceCaches)if(!this._sourceCaches[s].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(s){const h=[];for(const y of s){const w=this._layers[y];w.type!=="custom"&&h.push(w.serialize())}return h}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const s in this._sourceCaches)if(this._sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(s){return!!this.terrain&&(typeof s.isLayerDraped=="function"?s.isLayerDraped():ys[s.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(s){if(!this._loaded)return;const h=this._changed;if(this._changed){const w=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);(w.length||T.length)&&this._updateWorkerLayers(w,T);for(const P in this._updatedSources){const I=this._updatedSources[P];I==="reload"?this._reloadSource(P):I==="clear"&&this._clearSource(P)}this._updateTilesForChangedImages();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(s);this.light.updateTransitions(s),this.fog&&this.fog.updateTransitions(s),this._resetUpdates()}const y={};for(const w in this._sourceCaches){const T=this._sourceCaches[w];y[w]=T.used,T.used=!1}for(const w of this._order){const T=this._layers[w];if(T.recalculate(s,this._availableImages),!T.isHidden(s.zoom)){const I=this._getLayerSourceCache(T);I&&(I.used=!0)}const P=this.map.painter;if(P){const I=T.getProgramIds();if(!I)continue;const O=T.getProgramConfiguration(s.zoom);for(const $ of I)P.useProgram($,O)}}for(const w in y){const T=this._sourceCaches[w];y[w]!==T.used&&T.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:T.getSource().id}))}this.light.recalculate(s),this.terrain&&this.terrain.recalculate(s),this.fog&&this.fog.recalculate(s),this.z=s.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),h&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=Object.keys(this._changedImages);if(s.length){for(const h in this._sourceCaches)this._sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],s);this._changedImages={}}}_updateWorkerLayers(s,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(s),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(s){if(this._checkLoaded(),da(this,a.validateStyle(s)))return!1;(s=a.clone$1(s)).layers=hr(s.layers);const h=function(w,T){if(!w)return[{command:bn.setStyle,args:[T]}];let P=[];try{if(!M(w.version,T.version))return[{command:bn.setStyle,args:[T]}];M(w.center,T.center)||P.push({command:bn.setCenter,args:[T.center]}),M(w.zoom,T.zoom)||P.push({command:bn.setZoom,args:[T.zoom]}),M(w.bearing,T.bearing)||P.push({command:bn.setBearing,args:[T.bearing]}),M(w.pitch,T.pitch)||P.push({command:bn.setPitch,args:[T.pitch]}),M(w.sprite,T.sprite)||P.push({command:bn.setSprite,args:[T.sprite]}),M(w.glyphs,T.glyphs)||P.push({command:bn.setGlyphs,args:[T.glyphs]}),M(w.transition,T.transition)||P.push({command:bn.setTransition,args:[T.transition]}),M(w.light,T.light)||P.push({command:bn.setLight,args:[T.light]}),M(w.fog,T.fog)||P.push({command:bn.setFog,args:[T.fog]}),M(w.projection,T.projection)||P.push({command:bn.setProjection,args:[T.projection]});const I={},O=[];(function(H,oe,de,me){let fe;for(fe in oe=oe||{},H=H||{})H.hasOwnProperty(fe)&&(oe.hasOwnProperty(fe)||fr(fe,de,me));for(fe in oe){if(!oe.hasOwnProperty(fe))continue;const ye=oe[fe];H.hasOwnProperty(fe)?M(H[fe],ye)||(H[fe].type==="geojson"&&ye.type==="geojson"&&Gn(H,oe,fe)?de.push({command:bn.setGeoJSONSourceData,args:[fe,ye.data]}):On(fe,oe,de,me)):Sr(fe,oe,de)}})(w.sources,T.sources,O,I);const $=[];w.layers&&w.layers.forEach(H=>{H.source&&I[H.source]?P.push({command:bn.removeLayer,args:[H.id]}):$.push(H)});let U=w.terrain;U&&I[U.source]&&(P.push({command:bn.setTerrain,args:[void 0]}),U=void 0),P=P.concat(O),M(U,T.terrain)||P.push({command:bn.setTerrain,args:[T.terrain]}),function(H,oe,de){oe=oe||[];const me=(H=H||[]).map(Pn),fe=oe.map(Pn),ye=H.reduce(mn,{}),K=oe.reduce(mn,{}),ue=me.slice(),Ee=Object.create(null);let Ce,Fe,$e,Ne,Je,Ye,ut;for(Ce=0,Fe=0;Ce<me.length;Ce++)$e=me[Ce],K.hasOwnProperty($e)?Fe++:(de.push({command:bn.removeLayer,args:[$e]}),ue.splice(ue.indexOf($e,Fe),1));for(Ce=0,Fe=0;Ce<fe.length;Ce++)$e=fe[fe.length-1-Ce],ue[ue.length-1-Ce]!==$e&&(ye.hasOwnProperty($e)?(de.push({command:bn.removeLayer,args:[$e]}),ue.splice(ue.lastIndexOf($e,ue.length-Fe),1)):Fe++,Ye=ue[ue.length-Ce],de.push({command:bn.addLayer,args:[K[$e],Ye]}),ue.splice(ue.length-Ce,0,$e),Ee[$e]=!0);for(Ce=0;Ce<fe.length;Ce++)if($e=fe[Ce],Ne=ye[$e],Je=K[$e],!Ee[$e]&&!M(Ne,Je))if(M(Ne.source,Je.source)&&M(Ne["source-layer"],Je["source-layer"])&&M(Ne.type,Je.type)){for(ut in yn(Ne.layout,Je.layout,de,$e,null,bn.setLayoutProperty),yn(Ne.paint,Je.paint,de,$e,null,bn.setPaintProperty),M(Ne.filter,Je.filter)||de.push({command:bn.setFilter,args:[$e,Je.filter]}),M(Ne.minzoom,Je.minzoom)&&M(Ne.maxzoom,Je.maxzoom)||de.push({command:bn.setLayerZoomRange,args:[$e,Je.minzoom,Je.maxzoom]}),Ne)Ne.hasOwnProperty(ut)&&ut!=="layout"&&ut!=="paint"&&ut!=="filter"&&ut!=="metadata"&&ut!=="minzoom"&&ut!=="maxzoom"&&(ut.indexOf("paint.")===0?yn(Ne[ut],Je[ut],de,$e,ut.slice(6),bn.setPaintProperty):M(Ne[ut],Je[ut])||de.push({command:bn.setLayerProperty,args:[$e,ut,Je[ut]]}));for(ut in Je)Je.hasOwnProperty(ut)&&!Ne.hasOwnProperty(ut)&&ut!=="layout"&&ut!=="paint"&&ut!=="filter"&&ut!=="metadata"&&ut!=="minzoom"&&ut!=="maxzoom"&&(ut.indexOf("paint.")===0?yn(Ne[ut],Je[ut],de,$e,ut.slice(6),bn.setPaintProperty):M(Ne[ut],Je[ut])||de.push({command:bn.setLayerProperty,args:[$e,ut,Je[ut]]}))}else de.push({command:bn.removeLayer,args:[$e]}),Ye=ue[ue.lastIndexOf($e)+1],de.push({command:bn.addLayer,args:[Je,Ye]})}($,T.layers,P)}catch(I){console.warn("Unable to compute style diff:",I),P=[{command:bn.setStyle,args:[T]}]}return P}(this.serialize(),s).filter(w=>!(w.command in Vd));if(h.length===0)return!1;const y=h.filter(w=>!(w.command in wl));if(y.length>0)throw new Error(`Unimplemented: ${y.map(w=>w.command).join(", ")}.`);return h.forEach(w=>{w.command!=="setTransition"&&w.command!=="setProjection"&&this[w.command].apply(this,w.args)}),this.stylesheet=s,this._updateMapProjection(),!0}addImage(s,h){return this.getImage(s)?this.fire(new a.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(s,h),this._afterImageUpdated(s),this)}updateImage(s,h){this.imageManager.updateImage(s,h)}getImage(s){return this.imageManager.getImage(s)}removeImage(s){return this.getImage(s)?(this.imageManager.removeImage(s),this._afterImageUpdated(s),this):this.fire(new a.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(),this._changedImages[s]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(s,h,y={}){if(this._checkLoaded(),this.getSource(s)!==void 0)throw new Error("There is already a source with this ID");if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(a.validateSource,`sources.${s}`,h,null,y))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const w=B(s,h,this.dispatcher,this);w.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(s),source:w.serialize(),sourceId:s}));const T=P=>{const I=(P?"symbol:":"other:")+s,O=this._sourceCaches[I]=new a.SourceCache(I,w,P);(P?this._symbolSourceCaches:this._otherSourceCaches)[s]=O,O.style=this,O.onAdd(this.map)};T(!1),h.type!=="vector"&&h.type!=="geojson"||T(!0),w.onAdd&&w.onAdd(this.map),this._changed=!0}removeSource(s){this._checkLoaded();const h=this.getSource(s);if(!h)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===s)return this.fire(new a.ErrorEvent(new Error(`Source "${s}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.get().source===s)return this.fire(new a.ErrorEvent(new Error(`Source "${s}" cannot be removed while terrain is using it.`)));const y=this._getSourceCaches(s);for(const w of y)delete this._sourceCaches[w.id],delete this._updatedSources[w.id],w.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles();return delete this._otherSourceCaches[s],delete this._symbolSourceCaches[s],h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(s,h){this._checkLoaded(),this.getSource(s).setData(h),this._changed=!0}getSource(s){const h=this._getSourceCache(s);return h&&h.getSource()}_getSources(){const s=[];for(const h in this._otherSourceCaches){const y=this._getSourceCache(h);y&&s.push(y.getSource())}return s}addLayer(s,h,y={}){this._checkLoaded();const w=s.id;if(this.getLayer(w))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${w}" already exists on this map`)));let T;if(s.type==="custom"){if(da(this,a.validateCustomStyleLayer(s)))return;T=a.createStyleLayer(s)}else{if(typeof s.source=="object"&&(this.addSource(w,s.source),s=a.clone$1(s),s=a.extend(s,{source:w})),this._validate(a.validateLayer,`layers.${w}`,s,{arrayIndex:-1},y))return;T=a.createStyleLayer(s),this._validateLayer(T),T.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[T.id]=T.serialize(),this._updateLayerCount(T,!0)}const P=h?this._order.indexOf(h):this._order.length;if(h&&P===-1)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`)));this._order.splice(P,0,w),this._layerOrderChanged=!0,this._layers[w]=T;const I=this._getLayerSourceCache(T);if(this._removedLayers[w]&&T.source&&I&&T.type!=="custom"){const O=this._removedLayers[w];delete this._removedLayers[w],O.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",I.pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(s,h){if(this._checkLoaded(),this._changed=!0,!this._layers[s])return void this.fire(new a.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be moved.`)));if(s===h)return;const y=this._order.indexOf(s);this._order.splice(y,1);const w=h?this._order.indexOf(h):this._order.length;h&&w===-1?this.fire(new a.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`))):(this._order.splice(w,0,s),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(s){this._checkLoaded();const h=this._layers[s];if(!h)return void this.fire(new a.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be removed.`)));h.setEventedParent(null),this._updateLayerCount(h,!1);const y=this._order.indexOf(s);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[s]=h,delete this._layers[s],delete this._serializedLayers[s],delete this._updatedLayers[s],delete this._updatedPaintProps[s],h.onRemove&&h.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(s){return this._layers[s]}hasLayer(s){return s in this._layers}hasLayerType(s){for(const h in this._layers)if(this._layers[h].type===s)return!0;return!1}setLayerZoomRange(s,h,y){this._checkLoaded();const w=this.getLayer(s);w?w.minzoom===h&&w.maxzoom===y||(h!=null&&(w.minzoom=h),y!=null&&(w.maxzoom=y),this._updateLayer(w)):this.fire(new a.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(s,h,y={}){this._checkLoaded();const w=this.getLayer(s);if(w){if(!M(w.filter,h))return h==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(a.validateFilter,`layers.${w.id}.filter`,h,{layerType:w.type},y)||(w.filter=a.clone$1(h),this._updateLayer(w)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be filtered.`)))}getFilter(s){const h=this.getLayer(s);return h&&a.clone$1(h.filter)}setLayoutProperty(s,h,y,w={}){this._checkLoaded();const T=this.getLayer(s);T?M(T.getLayoutProperty(h),y)||(T.setLayoutProperty(h,y,w),this._updateLayer(T)):this.fire(new a.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(s,h){const y=this.getLayer(s);if(y)return y.getLayoutProperty(h);this.fire(new a.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style.`)))}setPaintProperty(s,h,y,w={}){this._checkLoaded();const T=this.getLayer(s);T?M(T.getPaintProperty(h),y)||(T.setPaintProperty(h,y,w)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[s]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(s,h){const y=this.getLayer(s);return y&&y.getPaintProperty(h)}setFeatureState(s,h){this._checkLoaded();const y=s.source,w=s.sourceLayer,T=this.getSource(y);if(!T)return void this.fire(new a.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const P=T.type;if(P==="geojson"&&w)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(P==="vector"&&!w)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));s.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const I=this._getSourceCaches(y);for(const O of I)O.setFeatureState(w,s.id,h)}removeFeatureState(s,h){this._checkLoaded();const y=s.source,w=this.getSource(y);if(!w)return void this.fire(new a.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const T=w.type,P=T==="vector"?s.sourceLayer:void 0;if(T==="vector"&&!P)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&typeof s.id!="string"&&typeof s.id!="number")return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const I=this._getSourceCaches(y);for(const O of I)O.removeFeatureState(P,s.id,h)}getFeatureState(s){this._checkLoaded();const h=s.source,y=s.sourceLayer,w=this.getSource(h);if(w){if(w.type!=="vector"||y)return s.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(h)[0].getFeatureState(y,s.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const s={};for(const h in this._sourceCaches){const y=this._sourceCaches[h].getSource();s[y.id]||(s[y.id]=y.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:s,layers:this._serializeLayers(this._order)},h=>h!==void 0)}_updateLayer(s){this._updatedLayers[s.id]=!0;const h=this._getLayerSourceCache(s);s.source&&!this._updatedSources[s.source]&&h&&h.getSource().type!=="raster"&&(this._updatedSources[s.source]="reload",h.pause()),this._changed=!0,s.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(s){const h=P=>this._layers[P].type==="fill-extrusion",y={},w=[];for(let P=this._order.length-1;P>=0;P--){const I=this._order[P];if(h(I)){y[I]=P;for(const O of s){const $=O[I];if($)for(const U of $)w.push(U)}}}w.sort((P,I)=>I.intersectionZ-P.intersectionZ);const T=[];for(let P=this._order.length-1;P>=0;P--){const I=this._order[P];if(h(I))for(let O=w.length-1;O>=0;O--){const $=w[O].feature;if(y[$.layer.id]<P)break;T.push($),w.pop()}else for(const O of s){const $=O[I];if($)for(const U of $)T.push(U.feature)}}return T}queryRenderedFeatures(s,h,y){h&&h.filter&&this._validate(a.validateFilter,"queryRenderedFeatures.filter",h.filter,null,h);const w={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const O of h.layers){const $=this._layers[O];if(!$)return this.fire(new a.ErrorEvent(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];w[$.source]=!0}}const T=[];h.availableImages=this._availableImages;const P=h&&h.layers?h.layers.some(O=>{const $=this.getLayer(O);return $&&$.is3D()}):this.has3DLayers(),I=zn.createFromScreenPoints(s,y);for(const O in this._sourceCaches){const $=this._sourceCaches[O].getSource().id;h.layers&&!w[$]||T.push(Qe(this._sourceCaches[O],this._layers,this._serializedLayers,I,h,y,P,!!this.map._showQueryGeometry))}return this.placement&&T.push(function(O,$,U,H,oe,de,me){const fe={},ye=de.queryRenderedSymbols(H),K=[];for(const ue of Object.keys(ye).map(Number))K.push(me[ue]);K.sort(Lt);for(const ue of K){const Ee=ue.featureIndex.lookupSymbolFeatures(ye[ue.bucketInstanceId],$,ue.bucketIndex,ue.sourceLayerIndex,oe.filter,oe.layers,oe.availableImages,O);for(const Ce in Ee){const Fe=fe[Ce]=fe[Ce]||[],$e=Ee[Ce];$e.sort((Ne,Je)=>{const Ye=ue.featureSortOrder;if(Ye){const ut=Ye.indexOf(Ne.featureIndex);return Ye.indexOf(Je.featureIndex)-ut}return Je.featureIndex-Ne.featureIndex});for(const Ne of $e)Fe.push(Ne)}}for(const ue in fe)fe[ue].forEach(Ee=>{const Ce=Ee.feature,Fe=U(O[ue]);if(!Fe)return;const $e=Fe.getFeatureState(Ce.layer["source-layer"],Ce.id);Ce.source=Ce.layer.source,Ce.layer["source-layer"]&&(Ce.sourceLayer=Ce.layer["source-layer"]),Ce.state=$e});return fe}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),I.screenGeometry,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(s,h){h&&h.filter&&this._validate(a.validateFilter,"querySourceFeatures.filter",h.filter,null,h);const y=this._getSourceCaches(s);let w=[];for(const T of y)w=w.concat(ot(T,h));return w}addSourceType(s,h,y){return Ls.getSourceType(s)?y(new Error(`A source type called "${s}" already exists.`)):(Ls.setSourceType(s,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:h.workerSourceURL},y):y(null,null))}getLight(){return this.light.getLight()}setLight(s,h={}){this._checkLoaded();const y=this.light.getLight();let w=!1;for(const P in s)if(!M(s[P],y[P])){w=!0;break}if(!w)return;const T=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(s,h),this.light.updateTransitions(T)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(s,h=1){if(this._checkLoaded(),!s)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let y=s;if(h===1){if(typeof y.source=="object"){const w="terrain-dem-src";this.addSource(w,y.source),y=a.clone$1(y),y=a.extend(y,{source:w})}if(this._validate(a.validateTerrain,"terrain",y))return}if(!this.terrain||this.terrain&&h!==this.terrain.drapeRenderMode){if(!y)return;this._createTerrain(y,h)}else{const w=this.terrain,T=w.get();for(const P of Object.keys(a.spec.terrain))!y.hasOwnProperty(P)&&a.spec.terrain[P].default&&(y[P]=a.spec.terrain[P].default);for(const P in y)if(!M(y[P],T[P])){w.set(y),this.stylesheet.terrain=y;const I=this._setTransitionParameters({duration:0});w.updateTransitions(I);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(s){const h=this.fog=new je(s,this.map.transform);this.stylesheet.fog=s;const y=this._setTransitionParameters({duration:0});h.updateTransitions(y)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const s of this.map._markers)s._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(s){if(this._checkLoaded(),!s)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog,y=h.get();Object.keys(s).length===0&&h.set(s);for(const w in s)if(!M(s[w],y[w])){h.set(s),this.stylesheet.fog=s;const T=this._setTransitionParameters({duration:0});h.updateTransitions(T);break}}else this._createFog(s);this._markersNeedUpdate=!0}_setTransitionParameters(s){return{now:a.exported.now(),transition:a.extend(s,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const s=this._order.filter(y=>this.isLayerDraped(this._layers[y])),h=this._order.filter(y=>!this.isLayerDraped(this._layers[y]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...s),this._drapedFirstOrder.push(...h)}_createTerrain(s,h){const y=this.terrain=new In(s,h);this.stylesheet.terrain=s,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const w=this._setTransitionParameters({duration:0});y.updateTransitions(w)}_force3DLayerUpdate(){for(const s in this._layers){const h=this._layers[s];h.type==="fill-extrusion"&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const s in this._layers){const h=this._layers[s];h.type==="symbol"&&this._updateLayer(h)}}_validate(s,h,y,w,T={}){return(!T||T.validate!==!1)&&da(this,s.call(a.validateStyle,a.extend({key:h,style:this.serialize(),value:y,styleSpec:a.spec},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const s in this._layers)this._layers[s].setEventedParent(null);for(const s in this._sourceCaches)this._sourceCaches[s].clearTiles(),this._sourceCaches[s].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(s){const h=this._getSourceCaches(s);for(const y of h)y.clearTiles()}_reloadSource(s){const h=this._getSourceCaches(s);for(const y of h)y.resume(),y.reload()}_reloadSources(){for(const s of this._getSources())s.reload&&s.reload()}_updateSources(s){for(const h in this._sourceCaches)this._sourceCaches[h].update(s)}_generateCollisionBoxes(){for(const s in this._sourceCaches){const h=this._sourceCaches[s];h.resume(),h.reload()}}_updatePlacement(s,h,y,w,T=!1){let P=!1,I=!1;const O={};for(const $ of this._order){const U=this._layers[$];if(U.type!=="symbol")continue;if(!O[U.source]){const oe=this._getLayerSourceCache(U);if(!oe)continue;O[U.source]=oe.getRenderableIds(!0).map(de=>oe.getTileByID(de)).sort((de,me)=>me.tileID.overscaledZ-de.tileID.overscaledZ||(de.tileID.isLessThan(me.tileID)?-1:1))}const H=this.crossTileSymbolIndex.addLayer(U,O[U.source],s.center.lng,s.projection);P=P||H}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),T=T||this._layerOrderChanged||y===0,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(T||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),s.zoom))&&(this.pauseablePlacement=new xl(s,this._order,T,h,y,w,this.placement,this.fog&&s.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),I=!0),P&&this.pauseablePlacement.placement.setStale()),I||P)for(const $ of this._order){const U=this._layers[$];U.type==="symbol"&&this.placement.updateLayerOpacities(U,O[U.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const s in this._sourceCaches)this._sourceCaches[s].releaseSymbolFadeTiles()}getImages(s,h,y){this.imageManager.getImages(h.icons,y),this._updateTilesForChangedImages();const w=T=>{T&&T.setDependencies(h.tileID.key,h.type,h.icons)};w(this._otherSourceCaches[h.source]),w(this._symbolSourceCaches[h.source])}getGlyphs(s,h,y){this.glyphManager.getGlyphs(h.stacks,y)}getResource(s,h,y){return a.makeRequest(h,y)}_getSourceCache(s){return this._otherSourceCaches[s]}_getLayerSourceCache(s){return s.type==="symbol"?this._symbolSourceCaches[s.source]:this._otherSourceCaches[s.source]}_getSourceCaches(s){const h=[];return this._otherSourceCaches[s]&&h.push(this._otherSourceCaches[s]),this._symbolSourceCaches[s]&&h.push(this._symbolSourceCaches[s]),h}_isSourceCacheLoaded(s){const h=this._getSourceCaches(s);return h.length===0?(this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${s}'`))),!1):h.every(y=>y.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ls.getSourceType=function(g){return Q[g]},Ls.setSourceType=function(g,s){Q[g]=s},Ls.registerForPluginStateChange=a.registerForPluginStateChange;var sc=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Qa="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Rs=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,el=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,fa=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Uo={},Hs={};const bl=[];pa(sc,bl),pa(Rs,bl),pa(el,bl),pa(fa,bl),Uo=Hr("",Rs),Hs=Hr(fa,el);const ac=Hr(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),wh=sc,gu=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var _u={background:Hr(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Hr(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Hr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Hr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Hr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Hr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Hr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Hr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Hr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Hr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Hr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Hr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Hr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Hr(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Hr(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Hr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Hr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Hr(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Hr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Hr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Hr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Hr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Hr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Hr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Hr(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Hr(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Qa),skyboxGradient:Hr(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Qa),skyboxCapture:Hr(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Hr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Hr(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function pa(g,s){const h=g.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let y of h)if(y=y.trim(),y[0]==="#"&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const w=y.split(" ");for(const T of w)s.includes(T)||s.push(T)}}function Hr(g,s){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,y=s.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),w={},T=[...bl];return pa(g,T),pa(s,T),{fragmentSource:g=g.replace(h,(P,I,O,$,U)=>(w[U]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${U}
varying ${O} ${$} ${U};
#else
uniform ${O} ${$} u_${U};
#endif
`:`
#ifdef HAS_UNIFORM_u_${U}
    ${O} ${$} ${U} = u_${U};
#endif
`)),vertexSource:s=s.replace(h,(P,I,O,$,U)=>{const H=$==="float"?"vec2":"vec4",oe=U.match(/color/)?"color":H;return w[U]?I==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
attribute ${O} ${H} a_${U};
varying ${O} ${$} ${U};
#else
uniform ${O} ${$} u_${U};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = a_${U};
#else
    ${O} ${$} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = unpack_mix_${oe}(a_${U}, u_${U}_t);
#else
    ${O} ${$} ${U} = u_${U};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
attribute ${O} ${H} a_${U};
#else
uniform ${O} ${$} u_${U};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${O} ${$} ${U} = a_${U};
#else
    ${O} ${$} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${O} ${$} ${U} = unpack_mix_${oe}(a_${U}, u_${U}_t);
#else
    ${O} ${$} ${U} = u_${U};
#endif
`}),staticAttributes:y,usedDefines:T}}class hp{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(s,h,y,w,T,P,I){this.context=s;let O=this.boundPaintVertexBuffers.length!==w.length;for(let U=0;!O&&U<w.length;U++)this.boundPaintVertexBuffers[U]!==w[U]&&(O=!0);let $=this.boundDynamicVertexBuffers.length!==I.length;for(let U=0;!$&&U<I.length;U++)this.boundDynamicVertexBuffers[U]!==I[U]&&($=!0);if(!s.extVertexArrayObject||!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==y||O||$||this.boundIndexBuffer!==T||this.boundVertexOffset!==P)this.freshBind(h,y,w,T,P,I);else{s.bindVertexArrayOES.set(this.vao);for(const U of I)U&&U.bind();T&&T.dynamicDraw&&T.bind()}}freshBind(s,h,y,w,T,P){let I;const O=s.numAttributes,$=this.context,U=$.gl;if($.extVertexArrayObject)this.vao&&this.destroy(),this.vao=$.extVertexArrayObject.createVertexArrayOES(),$.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=s,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=w,this.boundVertexOffset=T,this.boundDynamicVertexBuffers=P;else{I=$.currentNumAttributes||0;for(let H=O;H<I;H++)U.disableVertexAttribArray(H)}h.enableAttributes(U,s),h.bind(),h.setVertexAttribPointers(U,s,T);for(const H of y)H.enableAttributes(U,s),H.bind(),H.setVertexAttribPointers(U,s,T);for(const H of P)H&&(H.enableAttributes(U,s),H.bind(),H.setVertexAttribPointers(U,s,T));w&&w.bind(),$.currentNumAttributes=O}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Wd(g,s){const h=Math.pow(2,s.canonical.z),y=s.canonical.y;return[new a.MercatorCoordinate(0,y/h).toLngLat().lat,new a.MercatorCoordinate(0,(y+1)/h).toLngLat().lat]}function dp(g,s,h,y,w,T,P){const I=g.context,O=I.gl,$=h.fbo;if(!$)return;g.prepareDrawTile();const U=g.useProgram("hillshade");I.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,$.colorAttachment.get());const H=((fe,ye,K,ue)=>{const Ee=K.paint.get("hillshade-shadow-color"),Ce=K.paint.get("hillshade-highlight-color"),Fe=K.paint.get("hillshade-accent-color");let $e=K.paint.get("hillshade-illumination-direction")*(Math.PI/180);K.paint.get("hillshade-illumination-anchor")==="viewport"&&($e-=fe.transform.angle);const Ne=!fe.options.moving;return{u_matrix:ue||fe.transform.calculateProjMatrix(ye.tileID.toUnwrapped(),Ne),u_image:0,u_latrange:Wd(0,ye.tileID),u_light:[K.paint.get("hillshade-exaggeration"),$e],u_shadow:Ee,u_highlight:Ce,u_accent:Fe}})(g,h,y,g.terrain?s.projMatrix:null);g.prepareDrawProgram(I,U,s.toUnwrapped());const{tileBoundsBuffer:oe,tileBoundsIndexBuffer:de,tileBoundsSegments:me}=g.getTileBoundsBuffers(h);U.draw(I,O.TRIANGLES,w,T,P,a.CullFaceMode.disabled,H,y.id,oe,de,me)}function qd(g,s,h){if(!s.needsDEMTextureUpload)return;const y=g.context,w=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||g.getTileTexture(h.stride);const T=h.getPixels();s.demTexture?s.demTexture.update(T,{premultiply:!1}):s.demTexture=new a.Texture(y,T,w.RGBA,{premultiply:!1}),s.needsDEMTextureUpload=!1}function bh(g,s,h,y,w,T){const P=g.context,I=P.gl;if(!s.dem)return;const O=s.dem;if(P.activeTexture.set(I.TEXTURE1),qd(g,s,O),!s.demTexture)return;s.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);const $=O.dim;P.activeTexture.set(I.TEXTURE0);let U=s.fbo;if(!U){const me=new a.Texture(P,{width:$,height:$,data:null},I.RGBA);me.bind(I.LINEAR,I.CLAMP_TO_EDGE),U=s.fbo=P.createFramebuffer($,$,!0),U.colorAttachment.set(me.texture)}P.bindFramebuffer.set(U.framebuffer),P.viewport.set([0,0,$,$]);const{tileBoundsBuffer:H,tileBoundsIndexBuffer:oe,tileBoundsSegments:de}=g.getMercatorTileBoundsBuffers();g.useProgram("hillshadePrepare").draw(P,I.TRIANGLES,y,w,T,a.CullFaceMode.disabled,((me,fe)=>{const ye=fe.stride,K=a.create();return a.ortho(K,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(K,K,[0,-a.EXTENT,0]),{u_matrix:K,u_image:1,u_dimension:[ye,ye],u_zoom:me.overscaledZ,u_unpack:fe.unpackVector}})(s.tileID,O),h.id,H,oe,de),s.needsHillshadePrepare=!1}const Gd=g=>({u_matrix:new a.UniformMatrix4f(g),u_image0:new a.Uniform1i(g),u_skirt_height:new a.Uniform1f(g)}),lc=(g,s)=>({u_matrix:g,u_image0:0,u_skirt_height:s}),Eh=(g,s,h,y,w,T,P,I,O,$,U,H,oe,de,me)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:s,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:h,u_zoom_transition:w,u_merc_center:T,u_image0:0,u_frustum_tl:P,u_frustum_tr:I,u_frustum_br:O,u_frustum_bl:$,u_globe_pos:U,u_globe_radius:H,u_viewport:oe,u_grid_matrix:me?Float32Array.from(me):new Float32Array(9),u_skirt_height:de});function cc(g,s){return g!=null&&s!=null&&!(!g.hasData()||!s.hasData())&&g.demTexture!=null&&s.demTexture!=null&&g.tileID.key!==s.tileID.key}const Ia=new class{constructor(){this.operations={}}newMorphing(g,s,h,y,w){if(g in this.operations){const T=this.operations[g];T.to.tileID.key!==h.tileID.key&&(T.queued=h)}else this.operations[g]={startTime:y,phase:0,duration:w,from:s,to:h,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const s=this.operations[g];return{from:s.from,to:s.to,phase:s.phase}}update(g){for(const s in this.operations){const h=this.operations[s];for(h.phase=(g-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,g)){delete this.operations[s];break}}}_nextOp(g,s){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=s,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},tl={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Th(g){return 6*Math.pow(1.5,22-g)}function fp(g,s){const h=1<<g.z;return!s&&(g.x===0||g.x===h-1)||g.y===0||g.y===h-1}const yu=g=>({u_matrix:g});function Zd(g,s,h,y,w){if(w>0){const T=a.exported.now(),P=(T-g.timeAdded)/w,I=s?(T-s.timeAdded)/w:-1,O=h.getSource(),$=y.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),U=!s||Math.abs(s.tileID.overscaledZ-$)>Math.abs(g.tileID.overscaledZ-$),H=U&&g.refreshedUponExpiration?1:a.clamp(U?P:1-I,0,1);return g.refreshedUponExpiration&&P>=1&&(g.refreshedUponExpiration=!1),s?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}class vu extends a.SourceCache{constructor(s){const h={type:"raster-dem",maxzoom:s.transform.maxZoom},y=new At(Cn(),null),w=B("mock-dem",h,y,s.style);super("mock-dem",w,!1),w.setEventedParent(this),this._sourceLoaded=!0}_loadTile(s,h){s.state="loaded",h(null)}}class Ch extends a.SourceCache{constructor(s){const h=B("proxy",{type:"geojson",maxzoom:s.transform.maxZoom},new At(Cn(),null),s.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=s,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(s,h,y){if(s.freezeTileCoverage)return;this.transform=s;const w=s.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((T,P)=>{if(T[P.key]="",!this._tiles[P.key]){const I=new a.Tile(P,this._source.tileSize*P.overscaleFactor(),s.tileZoom);I.state="loaded",this._tiles[P.key]=I}return T},{});for(const T in this._tiles)T in w||(this.freeFBO(T),this._tiles[T].unloadVectorData(),delete this._tiles[T])}freeFBO(s){const h=this.proxyCachedFBO[s];if(h!==void 0){const y=Object.values(h);this.renderCachePool.push(...y),delete this.proxyCachedFBO[s]}}deallocRenderCache(){this.renderCache.forEach(s=>s.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Sh extends a.OverscaledTileID{constructor(s,h,y){super(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y),this.proxyTileKey=h,this.projMatrix=y}}class Hd extends a.Elevation{constructor(s,h){super(),this.painter=s,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,w,T]=function(O){const $=new a.StructArrayLayout2i4,U=new a.StructArrayLayout3ui6,H=131;$.reserve(17161),U.reserve(33800);const oe=a.EXTENT/128,de=a.EXTENT+oe/2,me=de+oe;for(let ye=-oe;ye<me;ye+=oe)for(let K=-oe;K<me;K+=oe){const ue=K<0||K>de||ye<0||ye>de?24575:0,Ee=a.clamp(Math.round(K),0,a.EXTENT),Ce=a.clamp(Math.round(ye),0,a.EXTENT);$.emplaceBack(Ee+ue,Ce)}const fe=(ye,K)=>{const ue=K*H+ye;U.emplaceBack(ue+1,ue,ue+H),U.emplaceBack(ue+H,ue+H+1,ue+1)};for(let ye=1;ye<129;ye++)for(let K=1;K<129;K++)fe(K,ye);return[0,129].forEach(ye=>{for(let K=0;K<130;K++)fe(K,ye),fe(ye,K)}),[$,U,32768]}(),P=s.context;this.gridBuffer=P.createVertexBuffer(y,a.posAttributes.members),this.gridIndexBuffer=P.createIndexBuffer(w),this.gridSegments=a.SegmentVector.simpleSegment(0,0,y.length,w.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,y.length,T),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ch(h.map),this.orthoMatrix=a.create(),a.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.EXTENT,0,a.EXTENT,0,1);const I=P.gl;this._overlapStencilMode=new a.StencilMode({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=s.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new vu(h.map)}set style(s){s.on("data",this._onStyleDataEvent.bind(this)),s.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=s,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(s,h,y){if(s&&s.terrain){this._style!==s&&(this.style=s),this.enabled=!0;const w=s.terrain.properties;this.sourceCache=s.terrain.drapeRenderMode===0?this._mockSourceCache:s._getSourceCache(w.get("source")),this._exaggeration=w.get("exaggeration");const T=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const P=this.getScaledDemTileSize();this.sourceCache.update(h,P,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,T(),this._initializing=!0),T(),h.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(s){this._findCoveringTileCache[s]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const s=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||s.efficiency!==100&&a.warnOnce(`Terrain render cache efficiency is not optimal (${s.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${s.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(s){s.coord&&s.dataType==="source"?this._clearRenderCacheForTile(s.sourceCacheId,s.coord):s.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const s in this._style._sourceCaches)this._style._sourceCaches[s].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(s=>s.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const s=2*this.proxySourceCache.getSource().tileSize;return[s,s]}set useVertexMorphing(s){this._useVertexMorphing=s}updateTileBinding(s){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=y._centerAltitude===0&&this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(y.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=h.getIds().map(O=>{const $=h.getTileByID(O).tileID;return $.projMatrix=y.calculateProjMatrix($.toUnwrapped()),$});(function(O,$){const U=$.transform.pointCoordinate($.transform.getCameraPoint()),H=new a.Point(U.x,U.y);O.sort((oe,de)=>{if(de.overscaledZ-oe.overscaledZ)return de.overscaledZ-oe.overscaledZ;const me=new a.Point(oe.canonical.x+(1<<oe.canonical.z)*oe.wrap,oe.canonical.y),fe=new a.Point(de.canonical.x+(1<<de.canonical.z)*de.wrap,de.canonical.y),ye=H.mult(1<<oe.canonical.z);return ye.x-=.5,ye.y-=.5,ye.distSqr(me)-ye.distSqr(fe)})})(w,this.painter),this._previousZoom=y.zoom;const T=this.proxyToSource||{};this.proxyToSource={},w.forEach(O=>{this.proxyToSource[O.key]={}}),this.terrainTileForTile={};const P=this._style._sourceCaches;for(const O in P){const $=P[O];if(!$.used||($!==this.sourceCache&&this.resetTileLookupCache($.id),this._setupProxiedCoordsForOrtho($,s[O],T),$.usedForTerrain))continue;const U=s[O];$.getSource().reparseOverscaled&&this._assignTerrainTiles(U)}this.proxiedCoords[h.id]=w.map(O=>new Sh(O,O.key,this.orthoMatrix)),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(T),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const I={};this._visibleDemTiles=[];for(const O of this.proxyCoords){const $=this.terrainTileForTile[O.key];if(!$)continue;const U=$.tileID.key;U in I||(this._visibleDemTiles.push($),I[U]=U)}}_assignTerrainTiles(s){this._initializing||s.forEach(h=>{if(this.terrainTileForTile[h.key])return;const y=this._findTileCoveringTileID(h,this.sourceCache);y&&(this.terrainTileForTile[h.key]=y)})}_prepareDEMTextures(){const s=this.painter.context,h=s.gl;for(const y in this.terrainTileForTile){const w=this.terrainTileForTile[y],T=w.dem;!T||w.demTexture&&!w.needsDEMTextureUpload||(s.activeTexture.set(h.TEXTURE1),qd(this.painter,w,T))}}_prepareDemTileUniforms(s,h,y,w){if(!h||h.demTexture==null)return!1;const T=s.tileID.canonical,P=Math.pow(2,h.tileID.canonical.z-T.z),I=w||"";return y[`u_dem_tl${I}`]=[T.x*P%1,T.y*P%1],y[`u_dem_scale${I}`]=P,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const s=this.painter.context,h=s.gl;if(!this._emptyDepthBufferTexture){const y=new a.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new a.Texture(s,y,h.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let s=0;const h=this._visibleDemTiles.reduce((y,w)=>{if(!w.dem)return y;const T=w.dem.tree.minimums[0];return T>0&&s++,y+T},0);return s?h/s:0}_updateEmptyDEMTexture(){const s=this.painter.context,h=s.gl;s.activeTexture.set(h.TEXTURE2);const y=this._getLoadedAreaMinimum(),w=new a.RGBAImage({width:1,height:1},new Uint8Array(a.DEMData.pack(y,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let T=this._emptyDEMTexture;return T?T.update(w,{premultiply:!1}):T=this._emptyDEMTexture=new a.Texture(s,w,h.RGBA,{premultiply:!1}),T}setupElevationDraw(s,h,y){const w=this.painter.context,T=w.gl,P=(I=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(I),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var I;P.u_dem_size=this.sourceCache.getSource().tileSize,P.u_exaggeration=this.exaggeration();let O=null,$=null,U=1;if(y&&y.morphing&&this._useVertexMorphing){const H=y.morphing.srcDemTile,oe=y.morphing.dstDemTile;U=y.morphing.phase,H&&oe&&(this._prepareDemTileUniforms(s,H,P,"_prev")&&($=H),this._prepareDemTileUniforms(s,oe,P)&&(O=oe))}if($&&O?(w.activeTexture.set(T.TEXTURE2),O.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),w.activeTexture.set(T.TEXTURE4),$.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),P.u_dem_lerp=U):(O=this.terrainTileForTile[s.tileID.key],w.activeTexture.set(T.TEXTURE2),(this._prepareDemTileUniforms(s,O,P)?O.demTexture:this.emptyDEMTexture).bind(T.NEAREST,T.CLAMP_TO_EDGE)),w.activeTexture.set(T.TEXTURE3),y&&y.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),this._depthFBO&&(P.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),P.u_depth_size_inv=[1,1]),y&&y.useMeterToDem&&O){const H=(1<<O.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;P.u_meter_to_dem=H}if(y&&y.labelPlaneMatrixInv&&(P.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),h.setTerrainUniformValues(w,P),this.painter.transform.projection.name==="globe"){const H=this.globeUniformValues(this.painter.transform,s.tileID.canonical,y&&y.useDenormalizedUpVectorScale);h.setGlobeUniformValues(w,H)}}globeUniformValues(s,h,y){const w=s.projection;return{u_tile_tl_up:w.upVector(h,0,0),u_tile_tr_up:w.upVector(h,a.EXTENT,0),u_tile_br_up:w.upVector(h,a.EXTENT,a.EXTENT),u_tile_bl_up:w.upVector(h,0,a.EXTENT),u_tile_up_scale:y?a.globeMetersToEcef(1):w.upVectorScale(h,s.center.lat,s.worldSize).metersToTile}}renderToBackBuffer(s){const h=this.painter,y=this.painter.context;s.length!==0&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(w,T,P,I,O){if(w.transform.projection.name==="globe")(function($,U,H,oe,de){const me=$.context,fe=me.gl;let ye,K;const ue=$.options.showTerrainWireframe?2:0,Ee=$.transform,Ce=a.globeUseCustomAntiAliasing($,me,Ee),Fe=(Zt,at)=>{if(K===Zt)return;const St=[tl[Zt],"PROJECTION_GLOBE_VIEW"];Ce&&St.push("CUSTOM_ANTIALIASING"),at&&St.push(tl[ue]),ye=$.useProgram("globeRaster",null,St),K=Zt},$e=$.colorModeForRenderPass(),Ne=new a.DepthMode(fe.LEQUAL,a.DepthMode.ReadWrite,$.depthRangeFor3D);Ia.update(de);const Je=a.calculateGlobeMercatorMatrix(Ee),Ye=[a.mercatorXfromLng(Ee.center.lng),a.mercatorYfromLat(Ee.center.lat)],ut=ue?[!1,!0]:[!1],Kt=$.globeSharedBuffers,st=[Ee.width*a.exported.devicePixelRatio,Ee.height*a.exported.devicePixelRatio],Mt=Float32Array.from(Ee.globeMatrix),gt={useDenormalizedUpVectorScale:!0};if(ut.forEach(Zt=>{const at=$.transform,St=Th(at.zoom)*U.exaggeration();K=-1;const Ht=Zt?fe.LINES:fe.TRIANGLES;for(const Ft of oe){const Yt=H.getTile(Ft),$n=a.StencilMode.disabled,mr=U.prevTerrainTileForTile[Ft.key],kn=U.terrainTileForTile[Ft.key];cc(mr,kn)&&Ia.newMorphing(Ft.key,mr,kn,de,250),me.activeTexture.set(fe.TEXTURE0),Yt.texture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE);const Zn=Ia.getMorphValuesForProxy(Ft.key),zr=Zn?1:0;Zn&&a.extend$1(gt,{morphing:{srcDemTile:Zn.from,dstDemTile:Zn.to,phase:a.easeCubicInOut(Zn.phase)}});const Or=a.tileCornersToBounds(Ft.canonical),jn=a.getLatitudinalLod(Or.getCenter().lat),Jr=a.getGridMatrix(Ft.canonical,Or,jn,at.worldSize/at._pixelsPerMercatorPixel),ti=a.globeNormalizeECEF(a.globeTileBounds(Ft.canonical)),oi=Eh(at.projMatrix,Mt,Je,ti,a.globeToMercatorTransition(at.zoom),Ye,at.frustumCorners.TL,at.frustumCorners.TR,at.frustumCorners.BR,at.frustumCorners.BL,at.globeCenterInViewSpace,at.globeRadius,st,St,Jr);if(Fe(zr,Zt),U.setupElevationDraw(Yt,ye,gt),$.prepareDrawProgram(me,ye,Ft.toUnwrapped()),Kt){const[di,Lo,qi]=Zt?Kt.getWirefameBuffers($.context,jn):Kt.getGridBuffers(jn,St!==0);ye.draw(me,Ht,Ne,$n,$e,a.CullFaceMode.backCCW,oi,"globe_raster",di,Lo,qi)}}}),Kt){const Zt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ce&&Zt.push("CUSTOM_ANTIALIASING"),ye=$.useProgram("globeRaster",null,Zt);for(const at of oe){const{x:St,y:Ht,z:Ft}=at.canonical,Yt=Ht===0,$n=Ht===(1<<Ft)-1,[mr,kn,Zn,zr]=Kt.getPoleBuffers(Ft);if(zr&&(Yt||$n)){const Or=H.getTile(at);me.activeTexture.set(fe.TEXTURE0),Or.texture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE);let jn=a.globePoleMatrixForTile(Ft,St,Ee);const Jr=a.globeNormalizeECEF(a.globeTileBounds(at.canonical)),ti=(oi,di)=>oi.draw(me,fe.TRIANGLES,Ne,a.StencilMode.disabled,$e,a.CullFaceMode.disabled,Eh(Ee.projMatrix,jn,jn,Jr,0,Ye,Ee.frustumCorners.TL,Ee.frustumCorners.TR,Ee.frustumCorners.BR,Ee.frustumCorners.BL,Ee.globeCenterInViewSpace,Ee.globeRadius,st,0),"globe_pole_raster",di,Zn,zr);U.setupElevationDraw(Or,ye,gt),$.prepareDrawProgram(me,ye,at.toUnwrapped()),Yt&&ti(ye,mr),$n&&(jn=a.scale(a.create(),jn,[1,-1,1]),ti(ye,kn))}}}})(w,T,P,I,O);else{const $=w.context,U=$.gl;let H,oe;const de=w.options.showTerrainWireframe?2:0,me=(Ee,Ce)=>{if(oe===Ee)return;const Fe=[tl[Ee]];Ce&&Fe.push(tl[de]),H=w.useProgram("terrainRaster",null,Fe),oe=Ee},fe=w.colorModeForRenderPass(),ye=new a.DepthMode(U.LEQUAL,a.DepthMode.ReadWrite,w.depthRangeFor3D);Ia.update(O);const K=w.transform,ue=Th(K.zoom)*T.exaggeration();(de?[!1,!0]:[!1]).forEach(Ee=>{oe=-1;const Ce=Ee?U.LINES:U.TRIANGLES,[Fe,$e]=Ee?T.getWirefameBuffer():[T.gridIndexBuffer,T.gridSegments];for(const Ne of I){const Je=P.getTile(Ne),Ye=a.StencilMode.disabled,ut=T.prevTerrainTileForTile[Ne.key],Kt=T.terrainTileForTile[Ne.key];cc(ut,Kt)&&Ia.newMorphing(Ne.key,ut,Kt,O,250),$.activeTexture.set(U.TEXTURE0),Je.texture.bind(U.LINEAR,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST);const st=Ia.getMorphValuesForProxy(Ne.key),Mt=st?1:0;let gt;st&&(gt={morphing:{srcDemTile:st.from,dstDemTile:st.to,phase:a.easeCubicInOut(st.phase)}});const Zt=lc(Ne.projMatrix,fp(Ne.canonical,K.renderWorldCopies)?ue/10:ue);me(Mt,Ee),T.setupElevationDraw(Je,H,gt),w.prepareDrawProgram($,H,Ne.toUnwrapped()),H.draw($,Ce,ye,Ye,fe,a.CullFaceMode.backCCW,Zt,"terrain_raster",T.gridBuffer,Fe,$e)}})}}(h,this,this.proxySourceCache,s,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),s.splice(0,s.length))}renderBatch(s){if(this._drapedRenderBatches.length===0)return s+1;this.renderingToTexture=!0;const h=this.painter,y=this.painter.context,w=this.proxySourceCache,T=this.proxiedCoords[w.id],P=this._drapedRenderBatches.shift(),I=[],O=h.style.order;let $=0;for(const U of T){const H=w.getTileByID(U.proxyTileKey),oe=w.proxyCachedFBO[U.key]?w.proxyCachedFBO[U.key][s]:void 0,de=oe!==void 0?w.renderCache[oe]:this.pool[$++],me=oe!==void 0;if(H.texture=de.tex,me&&!de.dirty){I.push(H.tileID);continue}let fe;y.bindFramebuffer.set(de.fb.framebuffer),this.renderedToTile=!1,de.dirty&&(y.clear({color:a.Color.transparent,stencil:0}),de.dirty=!1);for(let ye=P.start;ye<=P.end;++ye){const K=h.style._layers[O[ye]];if(K.isHidden(h.transform.zoom))continue;const ue=h.style._getLayerSourceCache(K),Ee=ue?this.proxyToSource[U.key][ue.id]:[U];if(!Ee)continue;const Ce=Ee;y.viewport.set([0,0,de.fb.width,de.fb.height]),fe!==(ue?ue.id:null)&&(this._setupStencil(de,Ee,K,ue),fe=ue?ue.id:null),h.renderLayer(h,ue,K,Ce)}this.renderedToTile?(de.dirty=!0,I.push(H.tileID)):me||--$,$===5&&($=0,this.renderToBackBuffer(I))}return this.renderToBackBuffer(I),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,h.width,h.height]),P.end+1}postRender(){}renderCacheEfficiency(s){const h=s.order.length;if(h===0)return{efficiency:100};let y,w=0,T=0,P=!1;for(let I=0;I<h;++I){const O=s._layers[s.order[I]];this._style.isLayerDraped(O)?(P&&++w,++T):P||(P=!0,y=O.id)}return T===0?{efficiency:100}:{efficiency:100*(1-w/T),firstUndrapedLayer:y}}getMinElevationBelowMSL(){let s=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{s=Math.min(s,h.dem.tree.minimums[0])}),s===0?s:(s-30)*this._exaggeration}raycast(s,h,y){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter(T=>T.dem).map(T=>{const P=T.tileID,I=1<<P.overscaledZ,{x:O,y:$}=P.canonical,U=O/I,H=(O+1)/I,oe=$/I,de=($+1)/I;return{minx:U,miny:oe,maxx:H,maxy:de,t:T.dem.tree.raycastRoot(U,oe,H,de,s,h,y),tile:T}});w.sort((T,P)=>(T.t!==null?T.t:Number.MAX_VALUE)-(P.t!==null?P.t:Number.MAX_VALUE));for(const T of w){if(T.t==null)return null;const P=T.tile.dem.tree.raycast(T.minx,T.miny,T.maxx,T.maxy,s,h,y);if(P!=null)return P}return null}_createFBO(){const s=this.painter.context,h=s.gl,y=this.drapeBufferSize;s.activeTexture.set(h.TEXTURE0);const w=new a.Texture(s,{width:y[0],height:y[1],data:null},h.RGBA);w.bind(h.LINEAR,h.CLAMP_TO_EDGE);const T=s.createFramebuffer(y[0],y[1],!1);return T.colorAttachment.set(w.texture),T.depthAttachment=new Ze(s,T.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=s.createRenderbuffer(s.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,T.depthAttachment.set(this._sharedDepthStencil),s.clear({stencil:0})):T.depthAttachment.set(this._sharedDepthStencil),s.extTextureFilterAnisotropic&&!s.extTextureFilterAnisotropicForceOff&&h.texParameterf(h.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax),{fb:T,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const s in this._style._sourceCaches)if(this._style._sourceCaches[s].hasTransition())return!0;return this._style.order.some(s=>{const h=this._style._layers[s],y=h.isHidden(this.painter.transform.zoom);return h.type==="custom"?!y&&h.shouldRedrape():!y&&h.hasTransition()})}_clearLineLayersFromRenderCache(){let s=!1;for(const y of this._style._getSources())if(y instanceof Gt){s=!0;break}if(!s)return;const h={};for(let y=0;y<this._style.order.length;++y){const w=this._style._layers[this._style.order[y]],T=this._style._getLayerSourceCache(w);if(T&&!h[T.id]&&!w.isHidden(this.painter.transform.zoom)&&w.type==="line"&&w.widthExpression()instanceof a.ZoomDependentExpression){h[T.id]=!0;for(const P of this.proxyCoords){const I=this.proxyToSource[P.key][T.id];if(I)for(const O of I)this._clearRenderCacheForTile(T.id,O)}}}}_clearRasterLayersFromRenderCache(){let s=!1;for(const y in this._style._sourceCaches)if(this._style._sourceCaches[y]._source instanceof $t){s=!0;break}if(!s)return;const h={};for(let y=0;y<this._style.order.length;++y){const w=this._style._layers[this._style.order[y]],T=this._style._getLayerSourceCache(w);if(!T||h[T.id]||w.isHidden(this.painter.transform.zoom)||w.type!=="raster")continue;const P=w.paint.get("raster-fade-duration");for(const I of this.proxyCoords){const O=this.proxyToSource[I.key][T.id];if(O)for(const $ of O){const U=Zd(T.getTile($),T.findLoadedParent($,0),T,this.painter.transform,P);(U.opacity!==1||U.mix!==0)&&this._clearRenderCacheForTile(T.id,$)}}}}_setupDrapedRenderBatches(){const s=this._style.order,h=s.length;if(h===0)return;const y=[];let w,T=0,P=this._style._layers[s[T]];for(;!this._style.isLayerDraped(P)&&P.isHidden(this.painter.transform.zoom)&&++T<h;)P=this._style._layers[s[T]];for(;T<h;++T){const I=this._style._layers[s[T]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?w===void 0&&(w=T):w!==void 0&&(y.push({start:w,end:T-1}),w=void 0))}w!==void 0&&y.push({start:w,end:T-1}),this._drapedRenderBatches=y}_setupRenderCache(s){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const P=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let I=0;I<P.length;++I){const O=Object.values(P[I]);h.renderCachePool.push(...O)}}return}this._clearRasterLayersFromRenderCache();const y=this.proxyCoords,w=this._tilesDirty;for(let P=y.length-1;P>=0;P--){const I=y[P];if(h.getTileByID(I.key),h.proxyCachedFBO[I.key]!==void 0){const O=s[I.key],$=this.proxyToSource[I.key];let U=0;for(const H in $){const oe=$[H],de=O[H];if(!de||de.length!==oe.length||oe.some((me,fe)=>me!==de[fe]||w[H]&&w[H].hasOwnProperty(me.key))){U=-1;break}++U}for(const H in h.proxyCachedFBO[I.key])h.renderCache[h.proxyCachedFBO[I.key][H]].dirty=U<0||U!==Object.values(O).length}}const T=[...this._drapedRenderBatches];T.sort((P,I)=>I.end-I.start-(P.end-P.start));for(const P of T)for(const I of y){if(h.proxyCachedFBO[I.key])continue;let O=h.renderCachePool.pop();O===void 0&&h.renderCache.length<50&&(O=h.renderCache.length,h.renderCache.push(this._createFBO())),O!==void 0&&(h.proxyCachedFBO[I.key]={},h.proxyCachedFBO[I.key][P.start]=O,h.renderCache[O].dirty=!0)}this._tilesDirty={}}_setupStencil(s,h,y,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const T=this.painter.context,P=T.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let I;if(y.isTileClipped())I=h.length,this._overlapStencilMode.test={func:P.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:P.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(T.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(s){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[s.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(s,h){const y=this.painter,w=this.painter.context,T=w.gl;y._tileClippingMaskIDs={},w.setColorMode(a.ColorMode.disabled),w.setDepthMode(a.DepthMode.disabled);const P=y.useProgram("clippingMask");for(const I of s){const O=y._tileClippingMaskIDs[I.key]=--h;P.draw(w,T.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:T.ALWAYS,mask:0},O,255,T.KEEP,T.KEEP,T.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,yu(I.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(s){const h=this.painter.transform;if(s.x<0||s.x>h.width||s.y<0||s.y>h.height)return null;const y=[s.x,s.y,1,1];a.transformMat4$1(y,y,h.pixelMatrixInverse),a.scale$1(y,y,1/y[3]),y[0]/=h.worldSize,y[1]/=h.worldSize;const w=h._camera.position,T=a.mercatorZfromAltitude(1,h.center.lat),P=[w[0],w[1],w[2]/T,0],I=a.subtract([],y.slice(0,3),P);a.normalize(I,I);const O=this.raycast(P,I,this._exaggeration);return O!==null&&O?(a.scaleAndAdd(P,P,I,O),P[3]=P[2],P[2]*=T,P):null}drawDepth(){const s=this.painter,h=s.context,y=this.proxySourceCache,w=Math.ceil(s.width),T=Math.ceil(s.height);if(!this._depthFBO||this._depthFBO.width===w&&this._depthFBO.height===T||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const P=h.gl,I=h.createFramebuffer(w,T,!0);h.activeTexture.set(P.TEXTURE0);const O=new a.Texture(h,{width:w,height:T,data:null},P.RGBA);O.bind(P.NEAREST,P.CLAMP_TO_EDGE),I.colorAttachment.set(O.texture);const $=h.createRenderbuffer(h.gl.DEPTH_COMPONENT16,w,T);I.depthAttachment.set($),this._depthFBO=I,this._depthTexture=O}h.bindFramebuffer.set(this._depthFBO.framebuffer),h.viewport.set([0,0,w,T]),function(P,I,O,$){if(P.transform.projection.name==="globe")return;const U=P.context,H=U.gl;U.clear({depth:1});const oe=P.useProgram("terrainDepth"),de=new a.DepthMode(H.LESS,a.DepthMode.ReadWrite,P.depthRangeFor3D);for(const me of $){const fe=O.getTile(me),ye=lc(me.projMatrix,0);I.setupElevationDraw(fe,oe),oe.draw(U,H.TRIANGLES,de,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,ye,"terrain_depth",I.gridBuffer,I.gridIndexBuffer,I.gridNoSkirtSegments)}}(s,this,y,this.proxyCoords)}_setupProxiedCoordsForOrtho(s,h,y){if(s.getSource()instanceof ee)return this._setupProxiedCoordsForImageSource(s,h,y);this._findCoveringTileCache[s.id]=this._findCoveringTileCache[s.id]||{};const w=this.proxiedCoords[s.id]=[],T=this.proxyCoords;for(let I=0;I<T.length;I++){const O=T[I],$=this._findTileCoveringTileID(O,s);if($){const U=this._createProxiedId(O,$,y[O.key]&&y[O.key][s.id]);w.push(U),this.proxyToSource[O.key][s.id]=[U]}}let P=!1;for(let I=0;I<h.length;I++){const O=s.getTile(h[I]);if(!O||!O.hasData())continue;const $=this._findTileCoveringTileID(O.tileID,this.proxySourceCache);if($&&$.tileID.canonical.z!==O.tileID.canonical.z){const U=this.proxyToSource[$.tileID.key][s.id],H=this._createProxiedId($.tileID,O,y[$.tileID.key]&&y[$.tileID.key][s.id]);U?U.splice(U.length-1,0,H):this.proxyToSource[$.tileID.key][s.id]=[H],w.push(H),P=!0}}this._sourceTilesOverlap[s.id]=P}_setupProxiedCoordsForImageSource(s,h,y){if(!s.getSource().loaded())return;const w=this.proxiedCoords[s.id]=[],T=this.proxyCoords,P=s.getSource(),I=new a.Point(P.tileID.x,P.tileID.y)._div(1<<P.tileID.z),O=P.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((U,H)=>(U.min.x=Math.min(U.min.x,H.x-I.x),U.min.y=Math.min(U.min.y,H.y-I.y),U.max.x=Math.max(U.max.x,H.x-I.x),U.max.y=Math.max(U.max.y,H.y-I.y),U),{min:new a.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),$=(U,H)=>{const oe=U.wrap+U.canonical.x/(1<<U.canonical.z),de=U.canonical.y/(1<<U.canonical.z),me=a.EXTENT/(1<<U.canonical.z),fe=H.wrap+H.canonical.x/(1<<H.canonical.z),ye=H.canonical.y/(1<<H.canonical.z);return oe+me<fe+O.min.x||oe>fe+O.max.x||de+me<ye+O.min.y||de>ye+O.max.y};for(let U=0;U<T.length;U++){const H=T[U];for(let oe=0;oe<h.length;oe++){const de=s.getTile(h[oe]);if(!de||!de.hasData()||$(H,de.tileID))continue;const me=this._createProxiedId(H,de,y[H.key]&&y[H.key][s.id]),fe=this.proxyToSource[H.key][s.id];fe?fe.push(me):this.proxyToSource[H.key][s.id]=[me],w.push(me)}}}_createProxiedId(s,h,y){let w=this.orthoMatrix;if(y){const T=y.find(P=>P.key===h.tileID.key);if(T)return T}if(h.tileID.key!==s.key){const T=s.canonical.z-h.tileID.canonical.z;let P,I,O;w=a.create();const $=h.tileID.wrap-s.wrap<<s.overscaledZ;T>0?(P=a.EXTENT>>T,I=P*((h.tileID.canonical.x<<T)-s.canonical.x+$),O=P*((h.tileID.canonical.y<<T)-s.canonical.y)):(P=a.EXTENT<<-T,I=a.EXTENT*(h.tileID.canonical.x-(s.canonical.x+$<<-T)),O=a.EXTENT*(h.tileID.canonical.y-(s.canonical.y<<-T))),a.ortho(w,0,P,0,P,0,1),a.translate(w,w,[I,O,0])}return new Sh(h.tileID,s.key,w)}_findTileCoveringTileID(s,h){let y=h.getTile(s);if(y&&y.hasData())return y;const w=this._findCoveringTileCache[h.id],T=w[s.key];if(y=T?h.getTileByID(T):null,y&&y.hasData()||T===null)return y;let P=y?y.tileID:s,I=P.overscaledZ;const O=h.getSource().minzoom,$=[];if(!T){const H=h.getSource().maxzoom;if(s.canonical.z>=H){const oe=s.canonical.z-H;h.getSource().reparseOverscaled?(I=Math.max(s.canonical.z+2,h.transform.tileZoom),P=new a.OverscaledTileID(I,s.wrap,H,s.canonical.x>>oe,s.canonical.y>>oe)):oe!==0&&(I=H,P=new a.OverscaledTileID(I,s.wrap,H,s.canonical.x>>oe,s.canonical.y>>oe))}P.key!==s.key&&($.push(P.key),y=h.getTile(P))}const U=H=>{$.forEach(oe=>{w[oe]=H}),$.length=0};for(I-=1;I>=O&&(!y||!y.hasData());I--){y&&U(y.tileID.key);const H=P.calculateScaledKey(I);if(y=h.getTileByID(H),y&&y.hasData())break;const oe=w[H];if(oe===null)break;oe===void 0?$.push(H):y=h.getTileByID(oe)}return U(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(s){return this.enabled?this._findTileCoveringTileID(s,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(s,h){let y=this._tilesDirty[s];y||(y=this._tilesDirty[s]={}),y[h.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const s=function(h){let y=0;const w=new a.StructArrayLayout2ui4,T=131;for(let P=1;P<129;P++){for(let I=1;I<129;I++)y=P*T+I,w.emplaceBack(y,y+1),w.emplaceBack(y,y+T),w.emplaceBack(y+1,y+T),P===128&&w.emplaceBack(y+T,y+T+1);w.emplaceBack(y+1,y+1+T)}return w}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(s),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,s.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class qr{static cacheKey(s,h,y,w){let T=`${h}${w?w.cacheKey:""}`;for(const P of y)s.usedDefines.includes(P)&&(T+=`/${P}`);return T}constructor(s,h,y,w,T,P){const I=s.gl;this.program=I.createProgram();const O=function(K){const ue=[];for(let Ee=0;Ee<K.length;Ee++){if(K[Ee]===null)continue;const Ce=K[Ee].split(" ");ue.push(Ce.pop())}return ue}(y.staticAttributes),$=w?w.getBinderAttributes():[],U=O.concat($);let H=w?w.defines():[];H=H.concat(P.map(K=>`#define ${K}`));const oe=s.isWebGL2?`#version 300 es
`:"",de=oe+H.concat(s.extStandardDerivatives&&oe.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(gu):gu,gu,wh,ac.fragmentSource,Hs.fragmentSource,y.fragmentSource).join(`
`),me=oe+H.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,wh,ac.vertexSource,Hs.vertexSource,Uo.vertexSource,y.vertexSource).join(`
`),fe=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(fe,de),I.compileShader(fe),I.attachShader(this.program,fe);const ye=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(ye,me),I.compileShader(ye),I.attachShader(this.program,ye),this.attributes={},this.numAttributes=U.length;for(let K=0;K<this.numAttributes;K++)U[K]&&(I.bindAttribLocation(this.program,K,U[K]),this.attributes[U[K]]=K);I.linkProgram(this.program),I.deleteShader(ye),I.deleteShader(fe),this.fixedUniforms=T(s),this.binderUniforms=w?w.getUniforms(s):[],P.includes("TERRAIN")&&(this.terrainUniforms=(K=>({u_dem:new a.Uniform1i(K),u_dem_prev:new a.Uniform1i(K),u_dem_unpack:new a.Uniform4f(K),u_dem_tl:new a.Uniform2f(K),u_dem_scale:new a.Uniform1f(K),u_dem_tl_prev:new a.Uniform2f(K),u_dem_scale_prev:new a.Uniform1f(K),u_dem_size:new a.Uniform1f(K),u_dem_lerp:new a.Uniform1f(K),u_exaggeration:new a.Uniform1f(K),u_depth:new a.Uniform1i(K),u_depth_size_inv:new a.Uniform2f(K),u_meter_to_dem:new a.Uniform1f(K),u_label_plane_matrix_inv:new a.UniformMatrix4f(K)}))(s)),P.includes("GLOBE")&&(this.globeUniforms=(K=>({u_tile_tl_up:new a.Uniform3f(K),u_tile_tr_up:new a.Uniform3f(K),u_tile_br_up:new a.Uniform3f(K),u_tile_bl_up:new a.Uniform3f(K),u_tile_up_scale:new a.Uniform1f(K)}))(s)),P.includes("FOG")&&(this.fogUniforms=(K=>({u_fog_matrix:new a.UniformMatrix4f(K),u_fog_range:new a.Uniform2f(K),u_fog_color:new a.Uniform4f(K),u_fog_horizon_blend:new a.Uniform1f(K),u_fog_temporal_offset:new a.Uniform1f(K),u_frustum_tl:new a.Uniform3f(K),u_frustum_tr:new a.Uniform3f(K),u_frustum_br:new a.Uniform3f(K),u_frustum_bl:new a.Uniform3f(K),u_globe_pos:new a.Uniform3f(K),u_globe_radius:new a.Uniform1f(K),u_globe_transition:new a.Uniform1f(K),u_is_globe:new a.Uniform1i(K),u_viewport:new a.Uniform2f(K)}))(s))}}setTerrainUniformValues(s,h){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const w in h)y[w]&&y[w].set(this.program,w,h[w])}}setGlobeUniformValues(s,h){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const w in h)y[w]&&y[w].set(this.program,w,h[w])}}setFogUniformValues(s,h){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const w in h)y[w].set(this.program,w,h[w])}}draw(s,h,y,w,T,P,I,O,$,U,H,oe,de,me,fe){const ye=s.gl;if(this.failedToCreate)return;s.program.set(this.program),s.setDepthMode(y),s.setStencilMode(w),s.setColorMode(T),s.setCullFace(P);for(const ue of Object.keys(this.fixedUniforms))this.fixedUniforms[ue].set(this.program,ue,I[ue]);me&&me.setUniforms(this.program,s,this.binderUniforms,oe,{zoom:de});const K={[ye.LINES]:2,[ye.TRIANGLES]:3,[ye.LINE_STRIP]:1}[h];for(const ue of H.get()){const Ee=ue.vaos||(ue.vaos={});(Ee[O]||(Ee[O]=new hp)).bind(s,this,$,me?me.getPaintVertexBuffers():[],U,ue.vertexOffset,fe||[]),ye.drawElements(h,ue.primitiveLength*K,ye.UNSIGNED_SHORT,ue.primitiveOffset*K*2)}}}function xu(g,s){const h=Math.pow(2,s.tileID.overscaledZ),y=s.tileSize*Math.pow(2,g.transform.tileZoom)/h,w=y*(s.tileID.canonical.x+s.tileID.wrap*h),T=y*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_tile_units_to_pixels:1/sn(s,1,g.transform.tileZoom),u_pixel_coord_upper:[w>>16,T>>16],u_pixel_coord_lower:[65535&w,65535&T]}}const pp=a.create(),Kd=(g,s,h,y,w,T,P,I,O,$,U)=>{const H=s.style.light,oe=H.properties.get("position"),de=[oe.x,oe.y,oe.z],me=a.create$1();H.properties.get("anchor")==="viewport"&&(a.fromRotation(me,-s.transform.angle),a.transformMat3(de,de,me));const fe=H.properties.get("color"),ye=s.transform,K={u_matrix:g,u_lightpos:de,u_lightintensity:H.properties.get("intensity"),u_lightcolor:[fe.r,fe.g,fe.b],u_vertical_gradient:+h,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:pp,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:w,u_edge_radius:T};return ye.projection.name==="globe"&&(K.u_tile_id=[P.canonical.x,P.canonical.y,1<<P.canonical.z],K.u_zoom_transition=O,K.u_inv_rot_matrix=U,K.u_merc_center=$,K.u_up_dir=ye.projection.upVector(new a.CanonicalTileID(0,0,0),$[0]*a.EXTENT,$[1]*a.EXTENT),K.u_height_lift=I),K},mp=(g,s,h,y,w,T,P,I,O,$,U,H)=>{const oe=Kd(g,s,h,y,w,T,P,O,$,U,H),de={u_height_factor:-Math.pow(2,P.overscaledZ)/I.tileSize/8};return a.extend(oe,xu(s,I),de)},El=g=>({u_matrix:g}),Xd=(g,s,h)=>a.extend(El(g),xu(s,h)),Km=(g,s)=>({u_matrix:g,u_world:s}),Yd=(g,s,h,y)=>a.extend(Xd(g,s,h),{u_world:y}),wu=a.create(),Jd=(g,s,h,y,w,T)=>{const P=g.transform,I=P.projection.name==="globe";let O;if(T.paint.get("circle-pitch-alignment")==="map")if(I){const U=a.globePixelsToTileUnits(P.zoom,s.canonical)*P._pixelsPerMercatorPixel;O=Float32Array.from([U,0,0,U])}else O=P.calculatePixelsToTileUnitsMatrix(h);else O=new Float32Array([P.pixelsToGLUnits[0],0,0,P.pixelsToGLUnits[1]]);const $={u_camera_to_center_distance:P.cameraToCenterDistance,u_matrix:g.translatePosMatrix(s.projMatrix,h,T.paint.get("circle-translate"),T.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:O,u_inv_rot_matrix:wu,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){$.u_inv_rot_matrix=y,$.u_merc_center=w,$.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],$.u_zoom_transition=a.globeToMercatorTransition(P.zoom);const U=w[0]*a.EXTENT,H=w[1]*a.EXTENT;$.u_up_dir=P.projection.upVector(new a.CanonicalTileID(0,0,0),U,H)}return $},kh=g=>{const s=[];return g.paint.get("circle-pitch-alignment")==="map"&&s.push("PITCH_WITH_MAP"),g.paint.get("circle-pitch-scale")==="map"&&s.push("SCALE_WITH_MAP"),s},Mh=(g,s,h,y)=>{const w=a.EXTENT/h.tileSize;return{u_matrix:g,u_camera_to_center_distance:s.getCameraToCenterDistance(y),u_extrude_scale:[s.pixelsToGLUnits[0]/w,s.pixelsToGLUnits[1]/w]}},bu=(g,s,h=1)=>({u_matrix:g,u_color:s,u_overlay:0,u_overlay_scale:h}),Qd=a.create(),ef=(g,s,h,y,w,T,P)=>{const I=g.transform,O=I.projection.name==="globe",$=O?a.globePixelsToTileUnits(I.zoom,s.canonical)*I._pixelsPerMercatorPixel:sn(h,1,T),U={u_matrix:s.projMatrix,u_extrude_scale:$,u_intensity:P,u_inv_rot_matrix:Qd,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){U.u_inv_rot_matrix=y,U.u_merc_center=w,U.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],U.u_zoom_transition=a.globeToMercatorTransition(I.zoom);const H=w[0]*a.EXTENT,oe=w[1]*a.EXTENT;U.u_up_dir=I.projection.upVector(new a.CanonicalTileID(0,0,0),H,oe)}return U},uc=(g,s,h,y,w,T,P)=>{const I=g.transform,O=I.calculatePixelsToTileUnitsMatrix(s);return{u_matrix:tf(g,s,h,y),u_pixels_to_tile_units:O,u_device_pixel_ratio:T,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:w,u_texsize:dc(h)?s.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:hc(s,g.transform),u_alpha_discard_threshold:0,u_trim_offset:P}},Eu=(g,s,h,y,w)=>{const T=g.transform;return{u_matrix:tf(g,s,h,y),u_texsize:s.imageAtlasTexture.size,u_pixels_to_tile_units:T.calculatePixelsToTileUnitsMatrix(s),u_device_pixel_ratio:w,u_image:0,u_tile_units_to_pixels:hc(s,T),u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function hc(g,s){return 1/sn(g,1,s.tileZoom)}function tf(g,s,h,y){return g.translatePosMatrix(y||s.tileID.projMatrix,s,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}function dc(g){const s=g.paint.get("line-dasharray").value;return s.value||s.kind!=="constant"}const Ah=(g,s,h,y,w,T)=>{return{u_matrix:g,u_tl_parent:s,u_scale_parent:h,u_fade_t:y.mix,u_opacity:y.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(I=w.paint.get("raster-saturation"),I>0?1-1/(1.001-I):-I),u_contrast_factor:(P=w.paint.get("raster-contrast"),P>0?1/(1-P):1+P),u_spin_weights:is(w.paint.get("raster-hue-rotate")),u_perspective_transform:T};var P,I};function is(g){g*=Math.PI/180;const s=Math.sin(g),h=Math.cos(g);return[(2*h+1)/3,(-Math.sqrt(3)*s-h+1)/3,(Math.sqrt(3)*s-h+1)/3]}const nl=a.create(),nf=(g,s,h,y,w,T,P,I,O,$,U,H,oe,de,me,fe)=>{const ye=w.transform,K={u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:ye.cameraToCenterDistance,u_rotate_symbol:+h,u_aspect_ratio:ye.width/ye.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:P,u_coord_matrix:I,u_is_text:+O,u_pitch_with_map:+y,u_texsize:$,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:nl,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:nl,u_up_vector:[0,-1,0]};return fe.name==="globe"&&(K.u_tile_id=[U.canonical.x,U.canonical.y,1<<U.canonical.z],K.u_zoom_transition=H,K.u_inv_rot_matrix=de,K.u_merc_center=oe,K.u_camera_forward=ye._camera.forward(),K.u_ecef_origin=a.globeECEFOrigin(ye.globeMatrix,U.toUnwrapped()),K.u_tile_matrix=Float32Array.from(ye.globeMatrix),K.u_up_vector=me),K},Tl=(g,s,h,y,w,T,P,I,O,$,U,H,oe,de,me,fe,ye)=>a.extend(nf(g,s,h,y,w,T,P,I,O,$,H,oe,de,me,fe,ye),{u_gamma_scale:y?w.transform.cameraToCenterDistance*Math.cos(w.terrain?0:w.transform._pitch):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:1}),gp=(g,s,h,y,w,T,P,I,O,$,U,H,oe,de,me,fe)=>a.extend(Tl(g,s,h,y,w,T,P,I,!0,O,!0,U,H,oe,de,me,fe),{u_texsize_icon:$,u_texture_icon:1}),Ph=(g,s,h)=>({u_matrix:g,u_opacity:s,u_color:h}),rf=(g,s,h,y,w)=>a.extend(function(T,P,I){const O=P.imageManager.getPattern(T.toString()),{width:$,height:U}=P.imageManager.getPixelSize(),H=Math.pow(2,I.tileID.overscaledZ),oe=I.tileSize*Math.pow(2,P.transform.tileZoom)/H,de=oe*(I.tileID.canonical.x+I.tileID.wrap*H),me=oe*I.tileID.canonical.y;return{u_image:0,u_pattern_tl:O.tl,u_pattern_br:O.br,u_texsize:[$,U],u_pattern_size:O.displaySize,u_tile_units_to_pixels:1/sn(I,1,P.transform.tileZoom),u_pixel_coord_upper:[de>>16,me>>16],u_pixel_coord_lower:[65535&de,65535&me]}}(y,h,w),{u_matrix:g,u_opacity:s}),Tu={fillExtrusion:g=>({u_matrix:new a.UniformMatrix4f(g),u_lightpos:new a.Uniform3f(g),u_lightintensity:new a.Uniform1f(g),u_lightcolor:new a.Uniform3f(g),u_vertical_gradient:new a.Uniform1f(g),u_opacity:new a.Uniform1f(g),u_edge_radius:new a.Uniform1f(g),u_ao:new a.Uniform2f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_up_dir:new a.Uniform3f(g),u_height_lift:new a.Uniform1f(g)}),fillExtrusionPattern:g=>({u_matrix:new a.UniformMatrix4f(g),u_lightpos:new a.Uniform3f(g),u_lightintensity:new a.Uniform1f(g),u_lightcolor:new a.Uniform3f(g),u_vertical_gradient:new a.Uniform1f(g),u_height_factor:new a.Uniform1f(g),u_edge_radius:new a.Uniform1f(g),u_ao:new a.Uniform2f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_up_dir:new a.Uniform3f(g),u_height_lift:new a.Uniform1f(g),u_image:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_pixel_coord_upper:new a.Uniform2f(g),u_pixel_coord_lower:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g),u_opacity:new a.Uniform1f(g)}),fill:g=>({u_matrix:new a.UniformMatrix4f(g)}),fillPattern:g=>({u_matrix:new a.UniformMatrix4f(g),u_image:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_pixel_coord_upper:new a.Uniform2f(g),u_pixel_coord_lower:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g)}),fillOutline:g=>({u_matrix:new a.UniformMatrix4f(g),u_world:new a.Uniform2f(g)}),fillOutlinePattern:g=>({u_matrix:new a.UniformMatrix4f(g),u_world:new a.Uniform2f(g),u_image:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_pixel_coord_upper:new a.Uniform2f(g),u_pixel_coord_lower:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g)}),circle:g=>({u_camera_to_center_distance:new a.Uniform1f(g),u_extrude_scale:new a.UniformMatrix2f(g),u_device_pixel_ratio:new a.Uniform1f(g),u_matrix:new a.UniformMatrix4f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_up_dir:new a.Uniform3f(g)}),collisionBox:g=>({u_matrix:new a.UniformMatrix4f(g),u_camera_to_center_distance:new a.Uniform1f(g),u_extrude_scale:new a.Uniform2f(g)}),collisionCircle:g=>({u_matrix:new a.UniformMatrix4f(g),u_inv_matrix:new a.UniformMatrix4f(g),u_camera_to_center_distance:new a.Uniform1f(g),u_viewport_size:new a.Uniform2f(g)}),debug:g=>({u_color:new a.UniformColor(g),u_matrix:new a.UniformMatrix4f(g),u_overlay:new a.Uniform1i(g),u_overlay_scale:new a.Uniform1f(g)}),clippingMask:g=>({u_matrix:new a.UniformMatrix4f(g)}),heatmap:g=>({u_extrude_scale:new a.Uniform1f(g),u_intensity:new a.Uniform1f(g),u_matrix:new a.UniformMatrix4f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_up_dir:new a.Uniform3f(g)}),heatmapTexture:g=>({u_image:new a.Uniform1i(g),u_color_ramp:new a.Uniform1i(g),u_opacity:new a.Uniform1f(g)}),hillshade:g=>({u_matrix:new a.UniformMatrix4f(g),u_image:new a.Uniform1i(g),u_latrange:new a.Uniform2f(g),u_light:new a.Uniform2f(g),u_shadow:new a.UniformColor(g),u_highlight:new a.UniformColor(g),u_accent:new a.UniformColor(g)}),hillshadePrepare:g=>({u_matrix:new a.UniformMatrix4f(g),u_image:new a.Uniform1i(g),u_dimension:new a.Uniform2f(g),u_zoom:new a.Uniform1f(g),u_unpack:new a.Uniform4f(g)}),line:g=>({u_matrix:new a.UniformMatrix4f(g),u_pixels_to_tile_units:new a.UniformMatrix2f(g),u_device_pixel_ratio:new a.Uniform1f(g),u_units_to_pixels:new a.Uniform2f(g),u_dash_image:new a.Uniform1i(g),u_gradient_image:new a.Uniform1i(g),u_image_height:new a.Uniform1f(g),u_texsize:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g),u_alpha_discard_threshold:new a.Uniform1f(g),u_trim_offset:new a.Uniform2f(g)}),linePattern:g=>({u_matrix:new a.UniformMatrix4f(g),u_texsize:new a.Uniform2f(g),u_pixels_to_tile_units:new a.UniformMatrix2f(g),u_device_pixel_ratio:new a.Uniform1f(g),u_image:new a.Uniform1i(g),u_units_to_pixels:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g),u_alpha_discard_threshold:new a.Uniform1f(g)}),raster:g=>({u_matrix:new a.UniformMatrix4f(g),u_tl_parent:new a.Uniform2f(g),u_scale_parent:new a.Uniform1f(g),u_fade_t:new a.Uniform1f(g),u_opacity:new a.Uniform1f(g),u_image0:new a.Uniform1i(g),u_image1:new a.Uniform1i(g),u_brightness_low:new a.Uniform1f(g),u_brightness_high:new a.Uniform1f(g),u_saturation_factor:new a.Uniform1f(g),u_contrast_factor:new a.Uniform1f(g),u_spin_weights:new a.Uniform3f(g),u_perspective_transform:new a.Uniform2f(g)}),symbolIcon:g=>({u_is_size_zoom_constant:new a.Uniform1i(g),u_is_size_feature_constant:new a.Uniform1i(g),u_size_t:new a.Uniform1f(g),u_size:new a.Uniform1f(g),u_camera_to_center_distance:new a.Uniform1f(g),u_rotate_symbol:new a.Uniform1i(g),u_aspect_ratio:new a.Uniform1f(g),u_fade_change:new a.Uniform1f(g),u_matrix:new a.UniformMatrix4f(g),u_label_plane_matrix:new a.UniformMatrix4f(g),u_coord_matrix:new a.UniformMatrix4f(g),u_is_text:new a.Uniform1i(g),u_pitch_with_map:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_camera_forward:new a.Uniform3f(g),u_tile_matrix:new a.UniformMatrix4f(g),u_up_vector:new a.Uniform3f(g),u_ecef_origin:new a.Uniform3f(g),u_texture:new a.Uniform1i(g)}),symbolSDF:g=>({u_is_size_zoom_constant:new a.Uniform1i(g),u_is_size_feature_constant:new a.Uniform1i(g),u_size_t:new a.Uniform1f(g),u_size:new a.Uniform1f(g),u_camera_to_center_distance:new a.Uniform1f(g),u_rotate_symbol:new a.Uniform1i(g),u_aspect_ratio:new a.Uniform1f(g),u_fade_change:new a.Uniform1f(g),u_matrix:new a.UniformMatrix4f(g),u_label_plane_matrix:new a.UniformMatrix4f(g),u_coord_matrix:new a.UniformMatrix4f(g),u_is_text:new a.Uniform1i(g),u_pitch_with_map:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_texture:new a.Uniform1i(g),u_gamma_scale:new a.Uniform1f(g),u_device_pixel_ratio:new a.Uniform1f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_camera_forward:new a.Uniform3f(g),u_tile_matrix:new a.UniformMatrix4f(g),u_up_vector:new a.Uniform3f(g),u_ecef_origin:new a.Uniform3f(g),u_is_halo:new a.Uniform1i(g)}),symbolTextAndIcon:g=>({u_is_size_zoom_constant:new a.Uniform1i(g),u_is_size_feature_constant:new a.Uniform1i(g),u_size_t:new a.Uniform1f(g),u_size:new a.Uniform1f(g),u_camera_to_center_distance:new a.Uniform1f(g),u_rotate_symbol:new a.Uniform1i(g),u_aspect_ratio:new a.Uniform1f(g),u_fade_change:new a.Uniform1f(g),u_matrix:new a.UniformMatrix4f(g),u_label_plane_matrix:new a.UniformMatrix4f(g),u_coord_matrix:new a.UniformMatrix4f(g),u_is_text:new a.Uniform1i(g),u_pitch_with_map:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_texsize_icon:new a.Uniform2f(g),u_texture:new a.Uniform1i(g),u_texture_icon:new a.Uniform1i(g),u_gamma_scale:new a.Uniform1f(g),u_device_pixel_ratio:new a.Uniform1f(g),u_is_halo:new a.Uniform1i(g)}),background:g=>({u_matrix:new a.UniformMatrix4f(g),u_opacity:new a.Uniform1f(g),u_color:new a.UniformColor(g)}),backgroundPattern:g=>({u_matrix:new a.UniformMatrix4f(g),u_opacity:new a.Uniform1f(g),u_image:new a.Uniform1i(g),u_pattern_tl:new a.Uniform2f(g),u_pattern_br:new a.Uniform2f(g),u_texsize:new a.Uniform2f(g),u_pattern_size:new a.Uniform2f(g),u_pixel_coord_upper:new a.Uniform2f(g),u_pixel_coord_lower:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g)}),terrainRaster:Gd,terrainDepth:Gd,skybox:g=>({u_matrix:new a.UniformMatrix4f(g),u_sun_direction:new a.Uniform3f(g),u_cubemap:new a.Uniform1i(g),u_opacity:new a.Uniform1f(g),u_temporal_offset:new a.Uniform1f(g)}),skyboxGradient:g=>({u_matrix:new a.UniformMatrix4f(g),u_color_ramp:new a.Uniform1i(g),u_center_direction:new a.Uniform3f(g),u_radius:new a.Uniform1f(g),u_opacity:new a.Uniform1f(g),u_temporal_offset:new a.Uniform1f(g)}),skyboxCapture:g=>({u_matrix_3f:new a.UniformMatrix3f(g),u_sun_direction:new a.Uniform3f(g),u_sun_intensity:new a.Uniform1f(g),u_color_tint_r:new a.Uniform4f(g),u_color_tint_m:new a.Uniform4f(g),u_luminance:new a.Uniform1f(g)}),globeRaster:g=>({u_proj_matrix:new a.UniformMatrix4f(g),u_globe_matrix:new a.UniformMatrix4f(g),u_normalize_matrix:new a.UniformMatrix4f(g),u_merc_matrix:new a.UniformMatrix4f(g),u_zoom_transition:new a.Uniform1f(g),u_merc_center:new a.Uniform2f(g),u_image0:new a.Uniform1i(g),u_grid_matrix:new a.UniformMatrix3f(g),u_skirt_height:new a.Uniform1f(g),u_frustum_tl:new a.Uniform3f(g),u_frustum_tr:new a.Uniform3f(g),u_frustum_br:new a.Uniform3f(g),u_frustum_bl:new a.Uniform3f(g),u_globe_pos:new a.Uniform3f(g),u_globe_radius:new a.Uniform1f(g),u_viewport:new a.Uniform2f(g)}),globeAtmosphere:g=>({u_frustum_tl:new a.Uniform3f(g),u_frustum_tr:new a.Uniform3f(g),u_frustum_br:new a.Uniform3f(g),u_frustum_bl:new a.Uniform3f(g),u_horizon:new a.Uniform1f(g),u_transition:new a.Uniform1f(g),u_fadeout_range:new a.Uniform1f(g),u_color:new a.Uniform4f(g),u_high_color:new a.Uniform4f(g),u_space_color:new a.Uniform4f(g),u_star_intensity:new a.Uniform1f(g),u_star_density:new a.Uniform1f(g),u_star_size:new a.Uniform1f(g),u_temporal_offset:new a.Uniform1f(g),u_horizon_angle:new a.Uniform1f(g),u_rotation_matrix:new a.UniformMatrix4f(g)})};let Cu;function fc(g,s,h,y,w,T,P){const I=g.context,O=I.gl,$=g.transform,U=g.useProgram("collisionBox"),H=[];let oe=0,de=0;for(let Ce=0;Ce<y.length;Ce++){const Fe=y[Ce],$e=s.getTile(Fe),Ne=$e.getBucket(h);if(!Ne)continue;const Je=Le(Fe,Ne,$);let Ye=Je;w[0]===0&&w[1]===0||(Ye=g.translatePosMatrix(Je,$e,w,T));const ut=P?Ne.textCollisionBox:Ne.iconCollisionBox,Kt=Ne.collisionCircleArray;if(Kt.length>0){const st=a.create(),Mt=Ye;a.mul(st,Ne.placementInvProjMatrix,$.glCoordMatrix),a.mul(st,st,Ne.placementViewportMatrix),H.push({circleArray:Kt,circleOffset:de,transform:Mt,invTransform:st,projection:Ne.getProjection()}),oe+=Kt.length/4,de=oe}ut&&(g.terrain&&g.terrain.setupElevationDraw($e,U),U.draw(I,O.LINES,a.DepthMode.disabled,a.StencilMode.disabled,g.colorModeForRenderPass(),a.CullFaceMode.disabled,Mh(Ye,$,$e,Ne.getProjection()),h.id,ut.layoutVertexBuffer,ut.indexBuffer,ut.segments,null,$.zoom,null,[ut.collisionVertexBuffer,ut.collisionVertexBufferExt]))}if(!P||!H.length)return;const me=g.useProgram("collisionCircle"),fe=new a.StructArrayLayout2f1f2i16;fe.resize(4*oe),fe._trim();let ye=0;for(const Ce of H)for(let Fe=0;Fe<Ce.circleArray.length/4;Fe++){const $e=4*Fe,Ne=Ce.circleArray[$e+0],Je=Ce.circleArray[$e+1],Ye=Ce.circleArray[$e+2],ut=Ce.circleArray[$e+3];fe.emplace(ye++,Ne,Je,Ye,ut,0),fe.emplace(ye++,Ne,Je,Ye,ut,1),fe.emplace(ye++,Ne,Je,Ye,ut,2),fe.emplace(ye++,Ne,Je,Ye,ut,3)}(!Cu||Cu.length<2*oe)&&(Cu=function(Ce){const Fe=2*Ce,$e=new a.StructArrayLayout3ui6;$e.resize(Fe),$e._trim();for(let Ne=0;Ne<Fe;Ne++){const Je=6*Ne;$e.uint16[Je+0]=4*Ne+0,$e.uint16[Je+1]=4*Ne+1,$e.uint16[Je+2]=4*Ne+2,$e.uint16[Je+3]=4*Ne+2,$e.uint16[Je+4]=4*Ne+3,$e.uint16[Je+5]=4*Ne+0}return $e}(oe));const K=I.createIndexBuffer(Cu,!0),ue=I.createVertexBuffer(fe,a.collisionCircleLayout.members,!0);for(const Ce of H){const Fe={u_matrix:Ce.transform,u_inv_matrix:Ce.invTransform,u_camera_to_center_distance:(Ee=$).getCameraToCenterDistance(Ce.projection),u_viewport_size:[Ee.width,Ee.height]};me.draw(I,O.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,g.colorModeForRenderPass(),a.CullFaceMode.disabled,Fe,h.id,ue,K,a.SegmentVector.simpleSegment(0,2*Ce.circleOffset,Ce.circleArray.length,Ce.circleArray.length/2),null,$.zoom)}var Ee;ue.destroy(),K.destroy()}const of=a.create();function sf({width:g,height:s,anchor:h,textOffset:y,textScale:w},T){const{horizontalAlign:P,verticalAlign:I}=a.getAnchorAlignment(h),O=-(P-.5)*g,$=-(I-.5)*s,U=a.evaluateVariableOffset(h,y);return new a.Point((O/w+U[0])*T,($/w+U[1])*T)}function Xm(g,s,h,y,w,T,P,I,O,$,U){const H=g.text.placedSymbolArray,oe=g.text.dynamicLayoutVertexArray,de=g.icon.dynamicLayoutVertexArray,me={},fe=g.getProjection(),ye=tt(I,fe,T),K=T.elevation,ue=fe.upVectorScale(I.canonical,T.center.lat,T.worldSize).metersToTile;oe.clear();for(let Ee=0;Ee<H.length;Ee++){const Ce=H.get(Ee),{tileAnchorX:Fe,tileAnchorY:$e,numGlyphs:Ne}=Ce,Je=Ce.hidden||!Ce.crossTileID||g.allowVerticalPlacement&&!Ce.placedOrientation?null:y[Ce.crossTileID];if(Je){let Ye=0,ut=0,Kt=0;if(K){const Yt=K?K.getAtTileOffset(I,Fe,$e):0,[$n,mr,kn]=fe.upVector(I.canonical,Fe,$e);Ye=Yt*$n*ue,ut=Yt*mr*ue,Kt=Yt*kn*ue}let[st,Mt,gt,Zt]=It(Ce.projectedAnchorX+Ye,Ce.projectedAnchorY+ut,Ce.projectedAnchorZ+Kt,h?ye:P);const at=tn(T.getCameraToCenterDistance(fe),Zt);let St=w.evaluateSizeForFeature(g.textSizeData,$,Ce)*at/a.ONE_EM;h&&(St*=g.tilePixelRatio/O);const Ht=sf(Je,St);h?({x:st,y:Mt,z:gt}=fe.projectTilePoint(Fe+Ht.x,$e+Ht.y,I.canonical),[st,Mt,gt]=It(st+Ye,Mt+ut,gt+Kt,P)):(s&&Ht._rotate(-T.angle),st+=Ht.x,Mt+=Ht.y,gt=0);const Ft=g.allowVerticalPlacement&&Ce.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let Yt=0;Yt<Ne;Yt++)a.addDynamicAttributes(oe,st,Mt,gt,Ft);U&&Ce.associatedIconIndex>=0&&(me[Ce.associatedIconIndex]={x:st,y:Mt,z:gt,angle:Ft})}else ar(Ne,oe)}if(U){de.clear();const Ee=g.icon.placedSymbolArray;for(let Ce=0;Ce<Ee.length;Ce++){const Fe=Ee.get(Ce),{numGlyphs:$e}=Fe,Ne=me[Ce];if(Fe.hidden||!Ne)ar($e,de);else{const{x:Je,y:Ye,z:ut,angle:Kt}=Ne;for(let st=0;st<$e;st++)a.addDynamicAttributes(de,Je,Ye,ut,Kt)}}g.icon.dynamicLayoutVertexBuffer.updateData(de)}g.text.dynamicLayoutVertexBuffer.updateData(oe)}function af(g,s,h){return h.iconsInText&&s?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function _p(g,s,h,y,w,T,P,I,O,$,U,H){const oe=g.context,de=oe.gl,me=g.transform,fe=I==="map",ye=O==="map",K=fe&&h.layout.get("symbol-placement")!=="point",ue=fe&&!ye&&!K,Ee=h.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Ce=!1;const Fe=g.depthModeForSublayer(0,a.DepthMode.ReadOnly),$e=[a.mercatorXfromLng(me.center.lng),a.mercatorYfromLat(me.center.lat)],Ne=h.layout.get("text-variable-anchor"),Je=me.projection.name==="globe",Ye=[],ut=[0,-1,0];let Kt=ut;!Je&&!me.mercatorFromTransition||fe||(Kt=function(st){const Mt=st._camera.getWorldToCamera(st.worldSize,1),gt=a.multiply([],Mt,st.globeMatrix);a.invert(gt,gt);const Zt=[0,0,0],at=[0,1,0,0];return a.transformMat4$1(at,at,gt),Zt[0]=at[0],Zt[1]=at[1],Zt[2]=at[2],a.normalize(Zt,Zt),Zt}(me));for(const st of y){const Mt=s.getTile(st),gt=Mt.getBucket(h);if(!gt||gt.projection.name==="mercator"&&Je)continue;const Zt=w?gt.text:gt.icon;if(!Zt||gt.fullyClipped||!Zt.segments.get().length)continue;const at=Zt.programConfigurations.get(h.id),St=w||gt.sdfIcons,Ht=w?gt.textSizeData:gt.iconSizeData,Ft=ye||me.pitch!==0,Yt=a.evaluateSizeForZoom(Ht,me.zoom);let $n,mr,kn,Zn,zr=[0,0],Or=null;if(w)mr=Mt.glyphAtlasTexture,kn=de.LINEAR,$n=Mt.glyphAtlasTexture.size,gt.iconsInText&&(zr=Mt.imageAtlasTexture.size,Or=Mt.imageAtlasTexture,Zn=Ft||g.options.rotating||g.options.zooming||Ht.kind==="composite"||Ht.kind==="camera"?de.LINEAR:de.NEAREST);else{const Js=h.layout.get("icon-size").constantOr(0)!==1||gt.iconsNeedLinear;mr=Mt.imageAtlasTexture,kn=St||g.options.rotating||g.options.zooming||Js||Ft?de.LINEAR:de.NEAREST,$n=Mt.imageAtlasTexture.size}const jn=gt.projection.name==="globe",Jr=jn?Kt:ut,ti=jn?a.globeToMercatorTransition(me.zoom):0,oi=tt(st,gt.getProjection(),me),di=me.calculatePixelsToTileUnitsMatrix(Mt),Lo=Te(oi,Mt.tileID.canonical,ye,fe,me,gt.getProjection(),di),qi=g.terrain&&ye&&K?a.invert(a.create(),Lo):of,bs=Tt(oi,Mt.tileID.canonical,ye,fe,me,gt.getProjection(),di),us=Ne&&gt.hasTextData(),Qr=h.layout.get("icon-text-fit")!=="none"&&us&&gt.hasIconData();if(K){const Js=me.elevation,ya=Js?Js.getAtTileOffsetFunc(st,me.center.lat,me.worldSize,gt.getProjection()):null,va=Dt(oi,Mt.tileID.canonical,ye,fe,me,gt.getProjection(),di);pr(gt,oi,g,w,va,bs,ye,$,ya,st)}const ni=K||w&&Ne||Qr,Wr=g.translatePosMatrix(oi,Mt,T,P),Ei=ni?of:Lo,Ro=g.translatePosMatrix(bs,Mt,T,P,!0),hi=gt.getProjection().createInversionMatrix(me,st.canonical),Ko=[];g.terrainRenderModeElevated()&&ye&&Ko.push("PITCH_WITH_MAP_TERRAIN"),jn&&Ko.push("PROJECTION_GLOBE_VIEW"),ni&&Ko.push("PROJECTED_POS_ON_VIEWPORT");const Ac=St&&h.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let yi;yi=St?gt.iconsInText?gp(Ht.kind,Yt,ue,ye,g,Wr,Ei,Ro,$n,zr,st,ti,$e,hi,Jr,gt.getProjection()):Tl(Ht.kind,Yt,ue,ye,g,Wr,Ei,Ro,w,$n,!0,st,ti,$e,hi,Jr,gt.getProjection()):nf(Ht.kind,Yt,ue,ye,g,Wr,Ei,Ro,w,$n,st,ti,$e,hi,Jr,gt.getProjection());const dl={program:g.useProgram(af(St,w,gt),at,Ko),buffers:Zt,uniformValues:yi,atlasTexture:mr,atlasTextureIcon:Or,atlasInterpolation:kn,atlasInterpolationIcon:Zn,isSDF:St,hasHalo:Ac,tile:Mt,labelPlaneMatrixInv:qi};if(Ee&&gt.canOverlap){Ce=!0;const Js=Zt.segments.get();for(const ya of Js)Ye.push({segments:new a.SegmentVector([ya]),sortKey:ya.sortKey,state:dl})}else Ye.push({segments:Zt.segments,sortKey:0,state:dl})}Ce&&Ye.sort((st,Mt)=>st.sortKey-Mt.sortKey);for(const st of Ye){const Mt=st.state;if(g.terrain&&g.terrain.setupElevationDraw(Mt.tile,Mt.program,{useDepthForOcclusion:!Je,labelPlaneMatrixInv:Mt.labelPlaneMatrixInv}),oe.activeTexture.set(de.TEXTURE0),Mt.atlasTexture.bind(Mt.atlasInterpolation,de.CLAMP_TO_EDGE),Mt.atlasTextureIcon&&(oe.activeTexture.set(de.TEXTURE1),Mt.atlasTextureIcon&&Mt.atlasTextureIcon.bind(Mt.atlasInterpolationIcon,de.CLAMP_TO_EDGE)),Mt.isSDF){const gt=Mt.uniformValues;Mt.hasHalo&&(gt.u_is_halo=1,Su(Mt.buffers,st.segments,h,g,Mt.program,Fe,U,H,gt)),gt.u_is_halo=0}Su(Mt.buffers,st.segments,h,g,Mt.program,Fe,U,H,Mt.uniformValues)}}function Su(g,s,h,y,w,T,P,I,O){const $=y.context,U=[g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer,g.globeExtVertexBuffer];w.draw($,$.gl.TRIANGLES,T,P,I,a.CullFaceMode.disabled,O,h.id,g.layoutVertexBuffer,g.indexBuffer,s,h.paint,y.transform.zoom,g.programConfigurations.get(h.id),U)}function Os(g,s,h,y,w,T,P){const I=g.context.gl,O=h.paint.get("fill-pattern"),$=O&&O.constantOr(1);let U,H,oe,de,me;P?(H=$&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",U=I.LINES):(H=$?"fillPattern":"fill",U=I.TRIANGLES);for(const fe of y){const ye=s.getTile(fe);if($&&!ye.patternsLoaded())continue;const K=ye.getBucket(h);if(!K)continue;g.prepareDrawTile();const ue=K.programConfigurations.get(h.id),Ee=g.useProgram(H,ue);$&&(g.context.activeTexture.set(I.TEXTURE0),ye.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),ue.updatePaintBuffers());const Ce=O.constantOr(null);if(Ce&&ye.imageAtlas){const $e=ye.imageAtlas.patternPositions[Ce.toString()];$e&&ue.setConstantPatternPositions($e)}const Fe=g.translatePosMatrix(fe.projMatrix,ye,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(P){de=K.indexBuffer2,me=K.segments2;const $e=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[I.drawingBufferWidth,I.drawingBufferHeight];oe=H==="fillOutlinePattern"&&$?Yd(Fe,g,ye,$e):Km(Fe,$e)}else de=K.indexBuffer,me=K.segments,oe=$?Xd(Fe,g,ye):El(Fe);g.prepareDrawProgram(g.context,Ee,fe.toUnwrapped()),Ee.draw(g.context,U,w,g.stencilModeForClipping(fe),T,a.CullFaceMode.disabled,oe,h.id,K.layoutVertexBuffer,de,me,h.paint,g.transform.zoom,ue)}}function rl(g,s,h,y,w,T,P){const I=g.context,O=I.gl,$=g.transform,U=h.paint.get("fill-extrusion-pattern"),H=U.constantOr(1),oe=h.paint.get("fill-extrusion-opacity"),de=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),h.paint.get("fill-extrusion-ambient-occlusion-radius")],me=h.layout.get("fill-extrusion-edge-radius"),fe=me>0&&!h.paint.get("fill-extrusion-rounded-roof"),ye=fe?0:me,K=$.projection.name==="globe"?a.fillExtrusionHeightLift():0,ue=$.projection.name==="globe",Ee=ue?a.globeToMercatorTransition($.zoom):0,Ce=[a.mercatorXfromLng($.center.lng),a.mercatorYfromLat($.center.lat)],Fe=[];ue&&Fe.push("PROJECTION_GLOBE_VIEW"),de[0]>0&&Fe.push("FAUX_AO"),fe&&Fe.push("ZERO_ROOF_RADIUS");for(const $e of y){const Ne=s.getTile($e),Je=Ne.getBucket(h);if(!Je||Je.projection.name!==$.projection.name)continue;const Ye=Je.programConfigurations.get(h.id),ut=g.useProgram(H?"fillExtrusionPattern":"fillExtrusion",Ye,Fe);if(g.terrain){const St=g.terrain;if(g.style.terrainSetForDrapingOnly())St.setupElevationDraw(Ne,ut,{useMeterToDem:!0});else{if(!Je.enableTerrain)continue;if(St.setupElevationDraw(Ne,ut,{useMeterToDem:!0}),lf(I,s,$e,Je,h,St),!Je.centroidVertexBuffer){const Ht=ut.attributes.a_centroid_pos;Ht!==void 0&&O.vertexAttrib2f(Ht,0,0)}}}H&&(g.context.activeTexture.set(O.TEXTURE0),Ne.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Ye.updatePaintBuffers());const Kt=U.constantOr(null);if(Kt&&Ne.imageAtlas){const St=Ne.imageAtlas.patternPositions[Kt.toString()];St&&Ye.setConstantPatternPositions(St)}const st=g.translatePosMatrix($e.projMatrix,Ne,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Mt=$.projection.createInversionMatrix($,$e.canonical),gt=h.paint.get("fill-extrusion-vertical-gradient"),Zt=H?mp(st,g,gt,oe,de,ye,$e,Ne,K,Ee,Ce,Mt):Kd(st,g,gt,oe,de,ye,$e,K,Ee,Ce,Mt);g.prepareDrawProgram(I,ut,$e.toUnwrapped());const at=[];g.terrain&&at.push(Je.centroidVertexBuffer),ue&&at.push(Je.layoutVertexExtBuffer),ut.draw(I,I.gl.TRIANGLES,w,T,P,a.CullFaceMode.backCCW,Zt,h.id,Je.layoutVertexBuffer,Je.indexBuffer,Je.segments,h.paint,g.transform.zoom,Ye,at)}}function lf(g,s,h,y,w,T){const P=[K=>{let ue=K.canonical.x-1,Ee=K.wrap;return ue<0&&(ue=(1<<K.canonical.z)-1,Ee--),new a.OverscaledTileID(K.overscaledZ,Ee,K.canonical.z,ue,K.canonical.y)},K=>{let ue=K.canonical.x+1,Ee=K.wrap;return ue===1<<K.canonical.z&&(ue=0,Ee++),new a.OverscaledTileID(K.overscaledZ,Ee,K.canonical.z,ue,K.canonical.y)},K=>new a.OverscaledTileID(K.overscaledZ,K.wrap,K.canonical.z,K.canonical.x,(K.canonical.y===0?1<<K.canonical.z:K.canonical.y)-1),K=>new a.OverscaledTileID(K.overscaledZ,K.wrap,K.canonical.z,K.canonical.x,K.canonical.y===(1<<K.canonical.z)-1?0:K.canonical.y+1)],I=K=>{const ue=s.getSource().minzoom,Ee=Fe=>{const $e=s.getTileByID(Fe);if($e&&$e.hasData())return $e.getBucket(w)},Ce=[0,-1,1];for(const Fe of Ce){if(K.overscaledZ+Fe<ue)continue;const $e=Ee(K.calculateScaledKey(K.overscaledZ+Fe));if($e)return $e}},O=[0,0,0],$=(K,ue)=>(O[0]=Math.min(K.min.y,ue.min.y),O[1]=Math.max(K.max.y,ue.max.y),O[2]=a.EXTENT-ue.min.x>K.max.x?ue.min.x-a.EXTENT:K.max.x,O),U=(K,ue)=>(O[0]=Math.min(K.min.x,ue.min.x),O[1]=Math.max(K.max.x,ue.max.x),O[2]=a.EXTENT-ue.min.y>K.max.y?ue.min.y-a.EXTENT:K.max.y,O),H=[(K,ue)=>$(K,ue),(K,ue)=>$(ue,K),(K,ue)=>U(K,ue),(K,ue)=>U(ue,K)],oe=new a.Point(0,0);let de,me,fe;const ye=(K,ue,Ee,Ce,Fe)=>{const $e=[[Ce?Ee:K,Ce?K:Ee,0],[Ce?Ee:ue,Ce?ue:Ee,0]],Ne=Fe<0?a.EXTENT+Fe:Fe,Je=[Ce?Ne:(K+ue)/2,Ce?(K+ue)/2:Ne,0];return Ee===0&&Fe<0||Ee!==0&&Fe>0?T.getForTilePoints(fe,[Je],!0,me):$e.push(Je),T.getForTilePoints(h,$e,!0,de),Math.max($e[0][2],$e[1][2],Je[2])/T.exaggeration()};for(let K=0;K<4;K++){const ue=(K<2?1:5)-K,Ee=y.borders[K];if(Ee.length===0)continue;const Ce=fe=P[K](h),Fe=I(Ce);if(!(Fe&&Fe instanceof a.FillExtrusionBucket&&Fe.enableTerrain)||y.borderDoneWithNeighborZ[K]===Fe.canonical.z&&Fe.borderDoneWithNeighborZ[ue]===y.canonical.z||(me=T.findDEMTileFor(Ce),!me||!me.dem))continue;if(!de){const Ye=T.findDEMTileFor(h);if(!Ye||!Ye.dem)return;de=Ye}const $e=Fe.borders[ue];let Ne=0;const Je=Fe.borderDoneWithNeighborZ[ue]!==y.canonical.z;if(y.canonical.z===Fe.canonical.z){for(let Ye=0;Ye<Ee.length;Ye++){const ut=y.featuresOnBorder[Ee[Ye]],Kt=ut.borders[K];let st;for(;Ne<$e.length&&(st=Fe.featuresOnBorder[$e[Ne]],!(st.borders[ue][1]>Kt[0]+3));)Je&&Fe.encodeCentroid(void 0,st,!1),Ne++;if(st&&Ne<$e.length){const Mt=Ne;let gt=0;for(;!(st.borders[ue][0]>Kt[1]-3)&&(gt++,++Ne!==$e.length);)st=Fe.featuresOnBorder[$e[Ne]];if(st=Fe.featuresOnBorder[$e[Mt]],ut.intersectsCount()>1||st.intersectsCount()>1||gt!==1){gt!==1&&(Ne=Mt),y.encodeCentroid(void 0,ut,!1),Je&&Fe.encodeCentroid(void 0,st,!1);continue}const Zt=H[K](ut,st),at=K%2?a.EXTENT-1:0;oe.x=ye(Zt[0],Math.min(a.EXTENT-1,Zt[1]),at,K<2,Zt[2]),oe.y=0,y.encodeCentroid(oe,ut,!1),Je&&Fe.encodeCentroid(oe,st,!1)}else y.encodeCentroid(void 0,ut,!1)}y.borderDoneWithNeighborZ[K]=Fe.canonical.z,y.needsCentroidUpdate=!0,Je&&(Fe.borderDoneWithNeighborZ[ue]=y.canonical.z,Fe.needsCentroidUpdate=!0)}else{for(const Ye of Ee)y.encodeCentroid(void 0,y.featuresOnBorder[Ye],!1);if(Je){for(const Ye of $e)Fe.encodeCentroid(void 0,Fe.featuresOnBorder[Ye],!1);Fe.borderDoneWithNeighborZ[ue]=y.canonical.z,Fe.needsCentroidUpdate=!0}y.borderDoneWithNeighborZ[K]=Fe.canonical.z,y.needsCentroidUpdate=!0}}(y.needsCentroidUpdate||!y.centroidVertexBuffer&&y.centroidVertexArray.length!==0)&&y.uploadCentroid(g)}const Cl=new a.Color(1,0,0,1),yp=new a.Color(0,1,0,1),vp=new a.Color(0,0,1,1),cf=new a.Color(1,0,1,1),Ym=new a.Color(0,1,1,1);function Jm(g,s,h){const y=g.context,w=g.transform,T=y.gl,P=w.projection.name==="globe",I=P?["PROJECTION_GLOBE_VIEW"]:null;let O=h.projMatrix;if(P&&a.globeToMercatorTransition(w.zoom)>0){const ut=a.transitionTileAABBinECEF(h.canonical,w),Kt=a.globeDenormalizeECEF(ut);O=a.multiply(new Float32Array(16),w.globeMatrix,Kt),a.multiply(O,w.projMatrix,O)}const $=g.useProgram("debug",null,I),U=s.getTileByID(h.key);g.terrain&&g.terrain.setupElevationDraw(U,$);const H=a.DepthMode.disabled,oe=a.StencilMode.disabled,de=g.colorModeForRenderPass(),me="$debug";y.activeTexture.set(T.TEXTURE0),g.emptyTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),P?U._makeGlobeTileDebugBuffers(g.context,w):U._makeDebugTileBoundsBuffers(g.context,w.projection);const fe=U._tileDebugBuffer||g.debugBuffer,ye=U._tileDebugIndexBuffer||g.debugIndexBuffer,K=U._tileDebugSegments||g.debugSegments;$.draw(y,T.LINE_STRIP,H,oe,de,a.CullFaceMode.disabled,bu(O,a.Color.red),me,fe,ye,K,null,null,null,[U._globeTileDebugBorderBuffer]);const ue=U.latestRawTileData,Ee=Math.floor((ue&&ue.byteLength||0)/1024),Ce=s.getTile(h).tileSize,Fe=512/Math.min(Ce,512)*(h.overscaledZ/w.zoom)*.5;let $e=h.canonical.toString();h.overscaledZ!==h.canonical.z&&($e+=` => ${h.overscaledZ}`),$e+=` ${Ee}kb`,function(ut,Kt){ut.initDebugOverlayCanvas();const st=ut.debugOverlayCanvas,Mt=ut.context.gl,gt=ut.debugOverlayCanvas.getContext("2d");gt.clearRect(0,0,st.width,st.height),gt.shadowColor="white",gt.shadowBlur=2,gt.lineWidth=1.5,gt.strokeStyle="white",gt.textBaseline="top",gt.font="bold 36px Open Sans, sans-serif",gt.fillText(Kt,5,5),gt.strokeText(Kt,5,5),ut.debugOverlayTexture.update(st),ut.debugOverlayTexture.bind(Mt.LINEAR,Mt.CLAMP_TO_EDGE)}(g,$e);const Ne=U._tileDebugTextBuffer||g.debugBuffer,Je=U._tileDebugTextIndexBuffer||g.quadTriangleIndexBuffer,Ye=U._tileDebugTextSegments||g.debugSegments;$.draw(y,T.TRIANGLES,H,oe,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,bu(O,a.Color.transparent,Fe),me,Ne,Je,Ye,null,null,null,[U._globeTileDebugTextBuffer])}function Sl(g,s,h,y){ma(g,0,s+h/2,g.transform.width,h,y)}function pc(g,s,h,y){ma(g,s-h/2,0,h,g.transform.height,y)}function ma(g,s,h,y,w,T){const P=g.context,I=P.gl;I.enable(I.SCISSOR_TEST),I.scissor(s*a.exported.devicePixelRatio,h*a.exported.devicePixelRatio,y*a.exported.devicePixelRatio,w*a.exported.devicePixelRatio),P.clear({color:T}),I.disable(I.SCISSOR_TEST)}const Ih=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:uf}=Ih;function Ds(g,s,h,y){g.emplaceBack(s,h,y)}class La{constructor(s){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,Ds(this.vertexArray,-1,-1,1),Ds(this.vertexArray,1,-1,1),Ds(this.vertexArray,-1,1,1),Ds(this.vertexArray,1,1,1),Ds(this.vertexArray,-1,-1,-1),Ds(this.vertexArray,1,-1,-1),Ds(this.vertexArray,-1,1,-1),Ds(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=s.createVertexBuffer(this.vertexArray,uf),this.indexBuffer=s.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function os(g,s,h,y,w,T){const P=g.gl,I=s.paint.get("sky-atmosphere-color"),O=s.paint.get("sky-atmosphere-halo-color"),$=s.paint.get("sky-atmosphere-sun-intensity"),U=((H,oe,de,me,fe)=>({u_matrix_3f:H,u_sun_direction:oe,u_sun_intensity:de,u_color_tint_r:[me.r,me.g,me.b,me.a],u_color_tint_m:[fe.r,fe.g,fe.b,fe.a],u_luminance:5e-5}))(a.fromMat4(a.create$1(),y),w,$,I,O);P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_CUBE_MAP_POSITIVE_X+T,s.skyboxTexture,0),h.draw(g,P.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,U,"skyboxCapture",s.skyboxGeometry.vertexBuffer,s.skyboxGeometry.indexBuffer,s.skyboxGeometry.segment)}const mc=a.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class ku{constructor(s){const h=new a.StructArrayLayout5f20;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);const y=new a.StructArrayLayout3ui6;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=s.createVertexBuffer(h,mc.members),this.indexBuffer=s.createIndexBuffer(y),this.segments=a.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const il={symbol:function(g,s,h,y,w){if(g.renderPass!=="translucent")return;const T=a.StencilMode.disabled,P=g.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(I,O,$,U,H,oe,de){const me=O.transform,fe=H==="map",ye=oe==="map";for(const K of I){const ue=U.getTile(K),Ee=ue.getBucket($);if(!Ee||!Ee.text||!Ee.text.segments.get().length)continue;const Ce=a.evaluateSizeForZoom(Ee.textSizeData,me.zoom),Fe=tt(K,Ee.getProjection(),me),$e=me.calculatePixelsToTileUnitsMatrix(ue),Ne=Te(Fe,ue.tileID.canonical,ye,fe,me,Ee.getProjection(),$e),Je=$.layout.get("icon-text-fit")!=="none"&&Ee.hasIconData();if(Ce){const Ye=Math.pow(2,me.zoom-ue.tileID.overscaledZ);Xm(Ee,fe,ye,de,a.symbolSize,me,Ne,K,Ye,Ce,Je)}}}(y,g,h,s,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),w),h.paint.get("icon-opacity").constantOr(1)!==0&&_p(g,s,h,y,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),T,P),h.paint.get("text-opacity").constantOr(1)!==0&&_p(g,s,h,y,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),T,P),s.map.showCollisionBoxes&&(fc(g,s,h,y,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),fc(g,s,h,y,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(g,s,h,y){if(g.renderPass!=="translucent")return;const w=h.paint.get("circle-opacity"),T=h.paint.get("circle-stroke-width"),P=h.paint.get("circle-stroke-opacity"),I=h.layout.get("circle-sort-key").constantOr(1)!==void 0;if(w.constantOr(1)===0&&(T.constantOr(1)===0||P.constantOr(1)===0))return;const O=g.context,$=O.gl,U=g.transform,H=g.depthModeForSublayer(0,a.DepthMode.ReadOnly),oe=a.StencilMode.disabled,de=g.colorModeForRenderPass(),me=U.projection.name==="globe",fe=[a.mercatorXfromLng(U.center.lng),a.mercatorYfromLat(U.center.lat)],ye=[];for(let ue=0;ue<y.length;ue++){const Ee=y[ue],Ce=s.getTile(Ee),Fe=Ce.getBucket(h);if(!Fe||Fe.projection.name!==U.projection.name)continue;const $e=Fe.programConfigurations.get(h.id),Ne=kh(h);me&&Ne.push("PROJECTION_GLOBE_VIEW");const Je=g.useProgram("circle",$e,Ne),Ye=Fe.layoutVertexBuffer,ut=Fe.globeExtVertexBuffer,Kt=Fe.indexBuffer,st=U.projection.createInversionMatrix(U,Ee.canonical),Mt={programConfiguration:$e,program:Je,layoutVertexBuffer:Ye,globeExtVertexBuffer:ut,indexBuffer:Kt,uniformValues:Jd(g,Ee,Ce,st,fe,h),tile:Ce};if(I){const gt=Fe.segments.get();for(const Zt of gt)ye.push({segments:new a.SegmentVector([Zt]),sortKey:Zt.sortKey,state:Mt})}else ye.push({segments:Fe.segments,sortKey:0,state:Mt})}I&&ye.sort((ue,Ee)=>ue.sortKey-Ee.sortKey);const K={useDepthForOcclusion:!me};for(const ue of ye){const{programConfiguration:Ee,program:Ce,layoutVertexBuffer:Fe,globeExtVertexBuffer:$e,indexBuffer:Ne,uniformValues:Je,tile:Ye}=ue.state,ut=ue.segments;g.terrain&&g.terrain.setupElevationDraw(Ye,Ce,K),g.prepareDrawProgram(O,Ce,Ye.tileID.toUnwrapped()),Ce.draw(O,$.TRIANGLES,H,oe,de,a.CullFaceMode.disabled,Je,h.id,Fe,Ne,ut,h.paint,U.zoom,Ee,[$e])}},heatmap:function(g,s,h,y){if(h.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const w=g.context,T=w.gl,P=a.StencilMode.disabled,I=new a.ColorMode([T.ONE,T.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(de,me,fe,ye){const K=de.gl,ue=me.width*ye,Ee=me.height*ye;de.activeTexture.set(K.TEXTURE1),de.viewport.set([0,0,ue,Ee]);let Ce=fe.heatmapFbo;if(!Ce||Ce&&(Ce.width!==ue||Ce.height!==Ee)){Ce&&Ce.destroy();const Fe=K.createTexture();K.bindTexture(K.TEXTURE_2D,Fe),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MIN_FILTER,K.LINEAR),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MAG_FILTER,K.LINEAR),Ce=fe.heatmapFbo=de.createFramebuffer(ue,Ee,!1),function($e,Ne,Je,Ye,ut,Kt){const st=$e.gl;st.texImage2D(st.TEXTURE_2D,0,$e.isWebGL2&&$e.extRenderToTextureHalfFloat?st.RGBA16F:st.RGBA,ut,Kt,0,st.RGBA,$e.extRenderToTextureHalfFloat?$e.isWebGL2?st.HALF_FLOAT:$e.extTextureHalfFloat.HALF_FLOAT_OES:st.UNSIGNED_BYTE,null),Ye.colorAttachment.set(Je)}(de,0,Fe,Ce,ue,Ee)}else K.bindTexture(K.TEXTURE_2D,Ce.colorAttachment.get()),de.bindFramebuffer.set(Ce.framebuffer)})(w,g,h,g.transform.projection.name==="globe"?.5:.25),w.clear({color:a.Color.transparent});const O=g.transform,$=O.projection.name==="globe",U=$?["PROJECTION_GLOBE_VIEW"]:null,H=$?a.CullFaceMode.frontCCW:a.CullFaceMode.disabled,oe=[a.mercatorXfromLng(O.center.lng),a.mercatorYfromLat(O.center.lat)];for(let de=0;de<y.length;de++){const me=y[de];if(s.hasRenderableParent(me))continue;const fe=s.getTile(me),ye=fe.getBucket(h);if(!ye||ye.projection.name!==O.projection.name)continue;const K=ye.programConfigurations.get(h.id),ue=g.useProgram("heatmap",K,U),{zoom:Ee}=g.transform;g.terrain&&g.terrain.setupElevationDraw(fe,ue),g.prepareDrawProgram(w,ue,me.toUnwrapped());const Ce=O.projection.createInversionMatrix(O,me.canonical);ue.draw(w,T.TRIANGLES,a.DepthMode.disabled,P,I,H,ef(g,me,fe,Ce,oe,Ee,h.paint.get("heatmap-intensity")),h.id,ye.layoutVertexBuffer,ye.indexBuffer,ye.segments,h.paint,g.transform.zoom,K,$?[ye.globeExtVertexBuffer]:null)}w.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),function(w,T){const P=w.context,I=P.gl,O=T.heatmapFbo;if(!O)return;P.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,O.colorAttachment.get()),P.activeTexture.set(I.TEXTURE1);let $=T.colorRampTexture;$||($=T.colorRampTexture=new a.Texture(P,T.colorRamp,I.RGBA)),$.bind(I.LINEAR,I.CLAMP_TO_EDGE),w.useProgram("heatmapTexture").draw(P,I.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,w.colorModeForRenderPass(),a.CullFaceMode.disabled,((U,H,oe,de)=>({u_image:0,u_color_ramp:1,u_opacity:H.paint.get("heatmap-opacity")}))(0,T),T.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,T.paint,w.transform.zoom)}(g,h))},line:function(g,s,h,y){if(g.renderPass!=="translucent")return;const w=h.paint.get("line-opacity"),T=h.paint.get("line-width");if(w.constantOr(1)===0||T.constantOr(1)===0)return;const P=g.depthModeForSublayer(0,a.DepthMode.ReadOnly),I=g.colorModeForRenderPass(),O=g.terrain&&g.terrain.renderingToTexture?1:a.exported.devicePixelRatio,$=h.paint.get("line-dasharray"),U=$.constantOr(1),H=h.layout.get("line-cap"),oe=h.paint.get("line-pattern"),de=oe.constantOr(1),me=h.paint.get("line-gradient"),fe=de?"linePattern":"line",ye=g.context,K=ye.gl,ue=(Ce=>{const Fe=[];dc(Ce)&&Fe.push("RENDER_LINE_DASH"),Ce.paint.get("line-gradient")&&Fe.push("RENDER_LINE_GRADIENT");const $e=Ce.paint.get("line-trim-offset");$e[0]===0&&$e[1]===0||Fe.push("RENDER_LINE_TRIM_OFFSET");const Ne=Ce.paint.get("line-pattern").constantOr(1),Je=Ce.paint.get("line-opacity").constantOr(1)!==1;return!Ne&&Je&&Fe.push("RENDER_LINE_ALPHA_DISCARD"),Fe})(h);let Ee=ue.includes("RENDER_LINE_ALPHA_DISCARD");g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(Ee=!1);for(const Ce of y){const Fe=s.getTile(Ce);if(de&&!Fe.patternsLoaded())continue;const $e=Fe.getBucket(h);if(!$e)continue;g.prepareDrawTile();const Ne=$e.programConfigurations.get(h.id),Je=g.useProgram(fe,Ne,ue),Ye=oe.constantOr(null);if(Ye&&Fe.imageAtlas){const St=Fe.imageAtlas.patternPositions[Ye.toString()];St&&Ne.setConstantPatternPositions(St)}const ut=$.constantOr(null),Kt=H.constantOr(null);if(!de&&ut&&Kt&&Fe.lineAtlas){const St=Fe.lineAtlas.getDash(ut,Kt);St&&Ne.setConstantPatternPositions(St)}let[st,Mt]=h.paint.get("line-trim-offset");(Kt==="round"||Kt==="square")&&st!==Mt&&(st===0&&(st-=1),Mt===1&&(Mt+=1));const gt=g.terrain?Ce.projMatrix:null,Zt=de?Eu(g,Fe,h,gt,O):uc(g,Fe,h,gt,$e.lineClipsArray.length,O,[st,Mt]);if(me){const St=$e.gradients[h.id];let Ht=St.texture;if(h.gradientVersion!==St.version){let Ft=256;if(h.stepInterpolant){const Yt=s.getSource().maxzoom,$n=Ce.canonical.z===Yt?Math.ceil(1<<g.transform.maxZoom-Ce.canonical.z):1;Ft=a.clamp(a.nextPowerOfTwo($e.maxLineLength/a.EXTENT*1024*$n),256,ye.maxTextureSize)}St.gradient=a.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:Ft,image:St.gradient||void 0,clips:$e.lineClipsArray}),St.texture?St.texture.update(St.gradient):St.texture=new a.Texture(ye,St.gradient,K.RGBA),St.version=h.gradientVersion,Ht=St.texture}ye.activeTexture.set(K.TEXTURE1),Ht.bind(h.stepInterpolant?K.NEAREST:K.LINEAR,K.CLAMP_TO_EDGE)}U&&(ye.activeTexture.set(K.TEXTURE0),Fe.lineAtlasTexture.bind(K.LINEAR,K.REPEAT),Ne.updatePaintBuffers()),de&&(ye.activeTexture.set(K.TEXTURE0),Fe.imageAtlasTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),Ne.updatePaintBuffers()),g.prepareDrawProgram(ye,Je,Ce.toUnwrapped());const at=St=>{Je.draw(ye,K.TRIANGLES,P,St,I,a.CullFaceMode.disabled,Zt,h.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,h.paint,g.transform.zoom,Ne,[$e.layoutVertexBuffer2])};if(Ee){const St=g.stencilModeForClipping(Ce).ref;St===0&&g.terrain&&ye.clear({stencil:0});const Ht={func:K.EQUAL,mask:255};Zt.u_alpha_discard_threshold=.8,at(new a.StencilMode(Ht,St,255,K.KEEP,K.KEEP,K.INVERT)),Zt.u_alpha_discard_threshold=0,at(new a.StencilMode(Ht,St,255,K.KEEP,K.KEEP,K.KEEP))}else at(g.stencilModeForClipping(Ce))}Ee&&(g.resetStencilClippingMasks(),g.terrain&&ye.clear({stencil:0}))},fill:function(g,s,h,y){const w=h.paint.get("fill-color"),T=h.paint.get("fill-opacity");if(T.constantOr(1)===0)return;const P=g.colorModeForRenderPass(),I=h.paint.get("fill-pattern"),O=g.opaquePassEnabledForLayer()&&!I.constantOr(1)&&w.constantOr(a.Color.transparent).a===1&&T.constantOr(0)===1?"opaque":"translucent";if(g.renderPass===O){const $=g.depthModeForSublayer(1,g.renderPass==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);Os(g,s,h,y,$,P,!1)}if(g.renderPass==="translucent"&&h.paint.get("fill-antialias")){const $=g.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);Os(g,s,h,y,$,P,!0)}},"fill-extrusion":function(g,s,h,y){const w=h.paint.get("fill-extrusion-opacity");if(w!==0&&g.renderPass==="translucent"){const T=new a.DepthMode(g.context.gl.LEQUAL,a.DepthMode.ReadWrite,g.depthRangeFor3D);if(w!==1||h.paint.get("fill-extrusion-pattern").constantOr(1))rl(g,s,h,y,T,a.StencilMode.disabled,a.ColorMode.disabled),rl(g,s,h,y,T,g.stencilModeFor3D(),g.colorModeForRenderPass()),g.resetStencilClippingMasks();else{const P=g.colorModeForRenderPass();rl(g,s,h,y,T,a.StencilMode.disabled,P)}}},hillshade:function(g,s,h,y){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent")return;const w=g.context,T=g.depthModeForSublayer(0,a.DepthMode.ReadOnly),P=g.colorModeForRenderPass(),I=g.terrain&&g.terrain.renderingToTexture,[O,$]=g.renderPass!=="translucent"||I?[{},y]:g.stencilConfigForOverlap(y);for(const U of $){const H=s.getTile(U);if(H.needsHillshadePrepare&&g.renderPass==="offscreen")bh(g,H,h,T,a.StencilMode.disabled,P);else if(g.renderPass==="translucent"){const oe=I&&g.terrain?g.terrain.stencilModeForRTTOverlap(U):O[U.overscaledZ];dp(g,U,H,h,T,oe,P)}}w.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,s,h,y,w,T){if(g.renderPass!=="translucent"||h.paint.get("raster-opacity")===0||!y.length)return;const P=g.context,I=P.gl,O=s.getSource(),$=g.useProgram("raster"),U=g.colorModeForRenderPass(),H=g.terrain&&g.terrain.renderingToTexture,[oe,de]=O instanceof ee||H?[{},y]:g.stencilConfigForOverlap(y),me=de[de.length-1].overscaledZ,fe=!g.options.moving;for(const ye of de){const K=H?a.DepthMode.disabled:g.depthModeForSublayer(ye.overscaledZ-me,h.paint.get("raster-opacity")===1?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,I.LESS),ue=ye.toUnwrapped(),Ee=s.getTile(ye);if(H&&(!Ee||!Ee.hasData()))continue;const Ce=H?ye.projMatrix:g.transform.calculateProjMatrix(ue,fe),Fe=g.terrain&&H?g.terrain.stencilModeForRTTOverlap(ye):oe[ye.overscaledZ],$e=T?0:h.paint.get("raster-fade-duration");Ee.registerFadeDuration($e);const Ne=s.findLoadedParent(ye,0),Je=Zd(Ee,Ne,s,g.transform,$e);let Ye,ut;g.terrain&&g.terrain.prepareDrawTile();const Kt=h.paint.get("raster-resampling")==="nearest"?I.NEAREST:I.LINEAR;P.activeTexture.set(I.TEXTURE0),Ee.texture.bind(Kt,I.CLAMP_TO_EDGE),P.activeTexture.set(I.TEXTURE1),Ne?(Ne.texture.bind(Kt,I.CLAMP_TO_EDGE),Ye=Math.pow(2,Ne.tileID.overscaledZ-Ee.tileID.overscaledZ),ut=[Ee.tileID.canonical.x*Ye%1,Ee.tileID.canonical.y*Ye%1]):Ee.texture.bind(Kt,I.CLAMP_TO_EDGE),Ee.texture.useMipmap&&P.extTextureFilterAnisotropic&&g.transform.pitch>20&&I.texParameterf(I.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax);const st=Ah(Ce,ut||[0,0],Ye||1,Je,h,O instanceof ee?O.perspectiveTransform:[0,0]);if(g.prepareDrawProgram(P,$,ue),O instanceof ee)O.boundsBuffer&&O.boundsSegments&&$.draw(P,I.TRIANGLES,K,a.StencilMode.disabled,U,a.CullFaceMode.disabled,st,h.id,O.boundsBuffer,g.quadTriangleIndexBuffer,O.boundsSegments);else{const{tileBoundsBuffer:Mt,tileBoundsIndexBuffer:gt,tileBoundsSegments:Zt}=g.getTileBoundsBuffers(Ee);$.draw(P,I.TRIANGLES,K,Fe,U,a.CullFaceMode.disabled,st,h.id,Mt,gt,Zt)}}g.resetStencilClippingMasks()},background:function(g,s,h,y){const w=h.paint.get("background-color"),T=h.paint.get("background-opacity");if(T===0)return;const P=g.context,I=P.gl,O=g.transform,$=O.tileSize,U=h.paint.get("background-pattern");if(g.isPatternMissing(U))return;const H=!U&&w.a===1&&T===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==H)return;const oe=a.StencilMode.disabled,de=g.depthModeForSublayer(0,H==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),me=g.colorModeForRenderPass(),fe=g.useProgram(U?"backgroundPattern":"background");let ye,K=y;K||(ye=g.getBackgroundTiles(),K=Object.values(ye).map(ue=>ue.tileID)),U&&(P.activeTexture.set(I.TEXTURE0),g.imageManager.bind(g.context));for(const ue of K){const Ee=ue.toUnwrapped(),Ce=y?ue.projMatrix:g.transform.calculateProjMatrix(Ee);g.prepareDrawTile();const Fe=s?s.getTile(ue):ye?ye[ue.key]:new a.Tile(ue,$,O.zoom,g),$e=U?rf(Ce,T,g,U,{tileID:ue,tileSize:$}):Ph(Ce,T,w);g.prepareDrawProgram(P,fe,Ee);const{tileBoundsBuffer:Ne,tileBoundsIndexBuffer:Je,tileBoundsSegments:Ye}=g.getTileBoundsBuffers(Fe);fe.draw(P,I.TRIANGLES,de,oe,me,a.CullFaceMode.disabled,$e,h.id,Ne,Je,Ye)}},sky:function(g,s,h){const y=g.transform,w=y.projection.name==="mercator"||y.projection.name==="globe"?1:a.smoothstep(7,8,y.zoom),T=h.paint.get("sky-opacity")*w;if(T===0)return;const P=g.context,I=h.paint.get("sky-type"),O=new a.DepthMode(P.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),$=g.frameCounter/1e3%1;I==="atmosphere"?g.renderPass==="offscreen"?h.needsSkyboxCapture(g)&&(function(U,H,oe,de){const me=U.context,fe=me.gl;let ye=H.skyboxFbo;if(!ye){ye=H.skyboxFbo=me.createFramebuffer(32,32,!1),H.skyboxGeometry=new La(me),H.skyboxTexture=me.gl.createTexture(),fe.bindTexture(fe.TEXTURE_CUBE_MAP,H.skyboxTexture),fe.texParameteri(fe.TEXTURE_CUBE_MAP,fe.TEXTURE_WRAP_S,fe.CLAMP_TO_EDGE),fe.texParameteri(fe.TEXTURE_CUBE_MAP,fe.TEXTURE_WRAP_T,fe.CLAMP_TO_EDGE),fe.texParameteri(fe.TEXTURE_CUBE_MAP,fe.TEXTURE_MIN_FILTER,fe.LINEAR),fe.texParameteri(fe.TEXTURE_CUBE_MAP,fe.TEXTURE_MAG_FILTER,fe.LINEAR);for(let Ce=0;Ce<6;++Ce)fe.texImage2D(fe.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,fe.RGBA,32,32,0,fe.RGBA,fe.UNSIGNED_BYTE,null)}me.bindFramebuffer.set(ye.framebuffer),me.viewport.set([0,0,32,32]);const K=H.getCenter(U,!0),ue=U.useProgram("skyboxCapture"),Ee=new Float64Array(16);a.identity(Ee),a.rotateY(Ee,Ee,.5*-Math.PI),os(me,H,ue,Ee,K,0),a.identity(Ee),a.rotateY(Ee,Ee,.5*Math.PI),os(me,H,ue,Ee,K,1),a.identity(Ee),a.rotateX(Ee,Ee,.5*-Math.PI),os(me,H,ue,Ee,K,2),a.identity(Ee),a.rotateX(Ee,Ee,.5*Math.PI),os(me,H,ue,Ee,K,3),a.identity(Ee),os(me,H,ue,Ee,K,4),a.identity(Ee),a.rotateY(Ee,Ee,Math.PI),os(me,H,ue,Ee,K,5),me.viewport.set([0,0,U.width,U.height])}(g,h),h.markSkyboxValid(g)):g.renderPass==="sky"&&function(U,H,oe,de,me){const fe=U.context,ye=fe.gl,K=U.transform,ue=U.useProgram("skybox");fe.activeTexture.set(ye.TEXTURE0),ye.bindTexture(ye.TEXTURE_CUBE_MAP,H.skyboxTexture);const Ee=((Ce,Fe,$e,Ne,Je)=>({u_matrix:Ce,u_sun_direction:Fe,u_cubemap:0,u_opacity:Ne,u_temporal_offset:Je}))(K.skyboxMatrix,H.getCenter(U,!1),0,de,me);U.prepareDrawProgram(fe,ue),ue.draw(fe,ye.TRIANGLES,oe,a.StencilMode.disabled,U.colorModeForRenderPass(),a.CullFaceMode.backCW,Ee,"skybox",H.skyboxGeometry.vertexBuffer,H.skyboxGeometry.indexBuffer,H.skyboxGeometry.segment)}(g,h,O,T,$):I==="gradient"&&g.renderPass==="sky"&&function(U,H,oe,de,me){const fe=U.context,ye=fe.gl,K=U.transform,ue=U.useProgram("skyboxGradient");H.skyboxGeometry||(H.skyboxGeometry=new La(fe)),fe.activeTexture.set(ye.TEXTURE0);let Ee=H.colorRampTexture;Ee||(Ee=H.colorRampTexture=new a.Texture(fe,H.colorRamp,ye.RGBA)),Ee.bind(ye.LINEAR,ye.CLAMP_TO_EDGE);const Ce=((Fe,$e,Ne,Je,Ye)=>({u_matrix:Fe,u_color_ramp:0,u_center_direction:$e,u_radius:a.degToRad(Ne),u_opacity:Je,u_temporal_offset:Ye}))(K.skyboxMatrix,H.getCenter(U,!1),H.paint.get("sky-gradient-radius"),de,me);U.prepareDrawProgram(fe,ue),ue.draw(fe,ye.TRIANGLES,oe,a.StencilMode.disabled,U.colorModeForRenderPass(),a.CullFaceMode.backCW,Ce,"skyboxGradient",H.skyboxGeometry.vertexBuffer,H.skyboxGeometry.indexBuffer,H.skyboxGeometry.segment)}(g,h,O,T,$)},debug:function(g,s,h){for(let y=0;y<h.length;y++)Jm(g,s,h[y])},custom:function(g,s,h,y){const w=g.context,T=h.implementation;if(!g.transform.projection.unsupportedLayers||!g.transform.projection.unsupportedLayers.includes("custom")||g.terrain&&(g.terrain.renderingToTexture||g.renderPass==="offscreen")&&h.isLayerDraped()){if(g.renderPass==="offscreen"){const P=T.prerender;if(P){if(g.setCustomLayerDefaults(),w.setColorMode(g.colorModeForRenderPass()),g.transform.projection.name==="globe"){const I=g.transform.pointMerc;P.call(T,w.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(g.transform.zoom),[I.x,I.y],g.transform.pixelsPerMeterRatio)}else P.call(T,w.gl,g.transform.customLayerMatrix());w.setDirty(),g.setBaseState()}}else if(g.renderPass==="translucent"){if(g.terrain&&g.terrain.renderingToTexture){const I=T.renderToTile;if(I){const O=y[0].canonical,$=new a.MercatorCoordinate(O.x+y[0].wrap*(1<<O.z),O.y,O.z);w.setDepthMode(a.DepthMode.disabled),w.setStencilMode(a.StencilMode.disabled),w.setColorMode(g.colorModeForRenderPass()),g.setCustomLayerDefaults(),I.call(T,w.gl,$),w.setDirty(),g.setBaseState()}return}g.setCustomLayerDefaults(),w.setColorMode(g.colorModeForRenderPass()),w.setStencilMode(a.StencilMode.disabled);const P=T.renderingMode==="3d"?new a.DepthMode(g.context.gl.LEQUAL,a.DepthMode.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,a.DepthMode.ReadOnly);if(w.setDepthMode(P),g.transform.projection.name==="globe"){const I=g.transform.pointMerc;T.render(w.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(g.transform.zoom),[I.x,I.y],g.transform.pixelsPerMeterRatio)}else T.render(w.gl,g.transform.customLayerMatrix());w.setDirty(),g.setBaseState(),w.bindFramebuffer.set(null)}}else a.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class kl{constructor(s,h,y=!1){this.context=new Xt(s,y),this.transform=h,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(s,h){const y=!!s&&!!s.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Hd(this,s));const w=this._terrain;this.transform.elevation=y?w:null,w.update(s,this.transform,h)}_updateFog(s){const h=s.fog;if(!h||this.transform.projection.name==="globe"||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,w]=h.getFovAdjustedRange(this.transform._fov);if(y>w)return void(this.transform.fogCullDistSq=null);const T=y+.78*(w-y);this.transform.fogCullDistSq=T*T}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(s,h){if(this.width=s*a.exported.devicePixelRatio,this.height=h*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._layers[y].resize()}setup(){const s=this.context,h=new a.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(a.EXTENT,0),h.emplaceBack(0,a.EXTENT),h.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=s.createVertexBuffer(h,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const y=new a.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(a.EXTENT,0),y.emplaceBack(0,a.EXTENT),y.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=s.createVertexBuffer(y,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const w=new a.StructArrayLayout2i4;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(w,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const T=new a.StructArrayLayout4i8;T.emplaceBack(0,0,0,0),T.emplaceBack(a.EXTENT,0,a.EXTENT,0),T.emplaceBack(0,a.EXTENT,0,a.EXTENT),T.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=s.createVertexBuffer(T,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const P=new a.StructArrayLayout3ui6;P.emplaceBack(0,1,2),P.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(P);const I=new a.StructArrayLayout1ui2;for(const $ of[0,1,3,2,0])I.emplaceBack($);this.debugIndexBuffer=s.createIndexBuffer(I),this.emptyTexture=new a.Texture(s,new a.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),s.gl.RGBA),this.identityMat=a.create();const O=this.context.gl;this.stencilClearMode=new a.StencilMode({func:O.ALWAYS,mask:0},0,255,O.ZERO,O.ZERO,O.ZERO),this.loadTimeStamps.push(a.window.performance.now()),this.atmosphereBuffer=new ku(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(s){return s._makeTileBoundsBuffers(this.context,this.transform.projection),s._tileBoundsBuffer?{tileBoundsBuffer:s._tileBoundsBuffer,tileBoundsIndexBuffer:s._tileBoundsIndexBuffer,tileBoundsSegments:s._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const s=this.context,h=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(s,h.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,yu(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(s,h,y){if(!h||this.currentStencilSource===h.id||!s.isTileClipped()||!y||y.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(const O of y)if(this._tileClippingMaskIDs[O.key]===void 0){I=!0;break}if(!I)return}this.currentStencilSource=h.id;const w=this.context,T=w.gl;this.nextStencilID+y.length>256&&this.clearStencil(),w.setColorMode(a.ColorMode.disabled),w.setDepthMode(a.DepthMode.disabled);const P=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of y){const O=h.getTile(I),$=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:U,tileBoundsIndexBuffer:H,tileBoundsSegments:oe}=this.getTileBoundsBuffers(O);P.draw(w,T.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:T.ALWAYS,mask:0},$,255,T.KEEP,T.KEEP,T.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,yu(I.projMatrix),"$clipping",U,H,oe)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,h=this.context.gl;return new a.StencilMode({func:h.NOTEQUAL,mask:255},s,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(s){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(s);const h=this.context.gl;return new a.StencilMode({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(s){const h=this.context.gl,y=s.sort((P,I)=>I.overscaledZ-P.overscaledZ),w=y[y.length-1].overscaledZ,T=y[0].overscaledZ-w+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const P={};for(let I=0;I<T;I++)P[I+w]=new a.StencilMode({func:h.GEQUAL,mask:255},I+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=T,[P,y]}return[{[w]:a.StencilMode.disabled},y]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new a.ColorMode([s.CONSTANT_COLOR,s.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(s,h,y){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new a.DepthMode(y||this.context.gl.LEQUAL,h,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(s,h){this.style=s,this.options=h,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const y=this.style.order,w=this.style._sourceCaches;for(const $ in w){const U=w[$];U.used&&U.prepare(this.context)}const T={},P={},I={};for(const $ in w){const U=w[$];T[$]=U.getVisibleCoordinates(),P[$]=T[$].slice().reverse(),I[$]=U.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let $=0;$<y.length;$++)if(this.style._layers[y[$]].is3D()){this.opaquePassCutoff=$;break}if(this.terrain&&(this.terrain.updateTileBinding(I),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.GlobeSharedBuffers(this.context)),!a.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const $ of y){const U=this.style._layers[$],H=s._getLayerSourceCache(U);if(!U.hasOffscreenPass()||U.isHidden(this.transform.zoom))continue;const oe=H?P[H.id]:void 0;(U.type==="custom"||U.isSky()||oe&&oe.length)&&this.renderLayer(this,H,U,oe)}this.depthRangeFor3D=[0,1-(s.order.length+2)*this.numSublayers*this.depthEpsilon];const O=this.terrain;if(O&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&O.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:h.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const $=this.style._layers[y[this.currentLayer]],U=s._getLayerSourceCache($);if($.isSky())continue;const H=U?P[U.id]:void 0;this._renderTileClippingMasks($,U,H),this.renderLayer(this,U,$,H)}if(this.style.fog&&this.transform.projection.supportsFog&&function($,U){const H=$.context,oe=H.gl,de=$.transform,me=new a.DepthMode(oe.LEQUAL,a.DepthMode.ReadOnly,[0,1]),fe=$.useProgram("globeAtmosphere",null,de.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ye=a.globeToMercatorTransition(de.zoom),K=U.properties.get("color").toArray01(),ue=U.properties.get("high-color").toArray01(),Ee=U.properties.get("space-color").toArray01PremultipliedAlpha(),Ce=a.identity$1([]);a.rotateY$1(Ce,Ce,-a.degToRad(de._center.lng)),a.rotateX$1(Ce,Ce,a.degToRad(de._center.lat)),a.rotateZ$1(Ce,Ce,de.angle),a.rotateX$1(Ce,Ce,-de._pitch);const Fe=a.fromQuat(new Float32Array(16),Ce),$e=a.mapValue(U.properties.get("star-intensity"),0,1,0,.25),Ne=5e-4,Je=a.mapValue(U.properties.get("horizon-blend"),0,1,Ne,.25),Ye=a.globeUseCustomAntiAliasing($,H,de)&&Je===Ne?de.worldSize/(2*Math.PI*1.025)-1:de.globeRadius,ut=$.frameCounter/1e3%1,Kt=a.length(de.globeCenterInViewSpace),st=Math.sqrt(Math.pow(Kt,2)-Math.pow(Ye,2)),Mt=Math.acos(st/Kt),gt=((at,St,Ht,Ft,Yt,$n,mr,kn,Zn,zr,Or,jn,Jr,ti)=>({u_frustum_tl:at,u_frustum_tr:St,u_frustum_br:Ht,u_frustum_bl:Ft,u_horizon:Yt,u_transition:$n,u_fadeout_range:mr,u_color:kn,u_high_color:Zn,u_space_color:zr,u_star_intensity:Or,u_star_size:5*a.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:jn,u_horizon_angle:Jr,u_rotation_matrix:ti}))(de.frustumCorners.TL,de.frustumCorners.TR,de.frustumCorners.BR,de.frustumCorners.BL,de.frustumCorners.horizon,ye,Je,K,ue,Ee,$e,ut,Mt,Fe);$.prepareDrawProgram(H,fe);const Zt=$.atmosphereBuffer;Zt&&fe.draw(H,oe.TRIANGLES,me,a.StencilMode.disabled,a.ColorMode.alphaBlended,a.CullFaceMode.backCW,gt,"skybox",Zt.vertexBuffer,Zt.indexBuffer,Zt.segments)}(this,this.style.fog),this.renderPass="sky",(a.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const $=this.style._layers[y[this.currentLayer]],U=s._getLayerSourceCache($);$.isSky()&&this.renderLayer(this,U,$,U?P[U.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<y.length;){const $=this.style._layers[y[this.currentLayer]],U=s._getLayerSourceCache($);if($.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped($)){if($.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const H=U?($.type==="symbol"?I:P)[U.id]:void 0;this._renderTileClippingMasks($,U,U?T[U.id]:void 0),this.renderLayer(this,U,$,H),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let $=null;a.values(this.style._layers).forEach(U=>{const H=s._getLayerSourceCache(U);H&&!U.isHidden(this.transform.zoom)&&(!$||$.getSource().maxzoom<H.getSource().maxzoom)&&($=H)}),$&&this.options.showTileBoundaries&&il.debug(this,$,$.getVisibleCoordinates())}this.options.showPadding&&function($){const U=$.transform.padding;Sl($,$.transform.height-(U.top||0),3,Cl),Sl($,U.bottom||0,3,yp),pc($,U.left||0,3,vp),pc($,$.transform.width-(U.right||0),3,cf);const H=$.transform.centerPoint;(function(oe,de,me,fe){ma(oe,de-1,me-10,2,20,fe),ma(oe,de-10,me-1,20,2,fe)})($,H.x,$.transform.height-H.y,Ym)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}renderLayer(s,h,y,w){y.isHidden(this.transform.zoom)||(y.type==="background"||y.type==="sky"||y.type==="custom"||w&&w.length)&&(this.id=y.id,this.gpuTimingStart(y),(!s.transform.projection.unsupportedLayers||!s.transform.projection.unsupportedLayers.includes(y.type)||s.terrain&&y.type==="custom")&&il[y.type](s,h,y,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(s){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;let y=this.gpuTimers[s.id];y||(y=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:h.createQueryEXT()}),y.calls++,h.beginQueryEXT(h.TIME_ELAPSED_EXT,y.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const s=this.context.extTimerQuery,h=s.createQueryEXT();this.deferredRenderGpuTimeQueries.push(h),s.beginQueryEXT(s.TIME_ELAPSED_EXT,h)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const s=this.context.extTimerQuery;s.endQueryEXT(s.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery;s.endQueryEXT(s.TIME_ELAPSED_EXT)}collectGpuTimers(){const s=this.gpuTimers;return this.gpuTimers={},s}collectDeferredRenderGpuQueries(){const s=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],s}queryGpuTimers(s){const h={};for(const y in s){const w=s[y],T=this.context.extTimerQuery,P=T.getQueryObjectEXT(w.query,T.QUERY_RESULT_EXT)/1e6;T.deleteQueryEXT(w.query),h[y]=P}return h}queryGpuTimeDeferredRender(s){if(!this.options.gpuTimingDeferredRender)return 0;const h=this.context.extTimerQuery;let y=0;for(const w of s)y+=h.getQueryObjectEXT(w,h.QUERY_RESULT_EXT)/1e6,h.deleteQueryEXT(w);return y}translatePosMatrix(s,h,y,w,T){if(!y[0]&&!y[1])return s;const P=T?w==="map"?this.transform.angle:0:w==="viewport"?-this.transform.angle:0;if(P){const $=Math.sin(P),U=Math.cos(P);y=[y[0]*U-y[1]*$,y[0]*$+y[1]*U]}const I=[T?y[0]:sn(h,y[0],this.transform.zoom),T?y[1]:sn(h,y[1],this.transform.zoom),0],O=new Float32Array(16);return a.translate(O,s,I),O}saveTileTexture(s){const h=this._tileTextures[s.size[0]];h?h.push(s):this._tileTextures[s.size[0]]=[s]}getTileTexture(s){const h=this._tileTextures[s];return h&&h.length>0?h.pop():null}isPatternMissing(s){return s===null||s!==void 0&&!this.imageManager.getPattern(s.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const s=this.terrain&&this.terrain.renderingToTexture,h=this.terrain&&this.terrain.exaggeration()===0,y=this.style&&this.style.fog,w=[];return this.terrainRenderModeElevated()&&w.push("TERRAIN"),this.transform.projection.name==="globe"&&w.push("GLOBE"),h&&w.push("ZERO_EXAGGERATION"),y&&!s&&y.getOpacity(this.transform.pitch)!==0&&w.push("FOG"),s&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}useProgram(s,h,y){this.cache=this.cache||{};const w=y||[],T=this.currentGlobalDefines().concat(w),P=qr.cacheKey(_u[s],s,T,h);return this.cache[P]||(this.cache[P]=new qr(this.context,s,_u[s],h,Tu[s],T)),this.cache[P]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(s,h,y){if(this.terrain&&this.terrain.renderingToTexture)return;const w=this.style.fog;if(w){const T=w.getOpacity(this.transform.pitch),P=((I,O,$,U,H,oe,de,me,fe,ye,K)=>{const ue=I.transform,Ee=O.properties.get("color").toArray01();Ee[3]=U;const Ce=I.frameCounter/1e3%1;return{u_fog_matrix:$?ue.calculateFogTileMatrix($):I.identityMat,u_fog_range:O.getFovAdjustedRange(ue._fov),u_fog_color:Ee,u_fog_horizon_blend:O.properties.get("horizon-blend"),u_fog_temporal_offset:Ce,u_frustum_tl:H,u_frustum_tr:oe,u_frustum_br:de,u_frustum_bl:me,u_globe_pos:fe,u_globe_radius:ye,u_viewport:K,u_globe_transition:a.globeToMercatorTransition(ue.zoom),u_is_globe:+(ue.projection.name==="globe")}})(this,w,y,T,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.exported.devicePixelRatio,this.transform.height*a.exported.devicePixelRatio]);h.setFogUniformValues(s,P)}}setTileLoadedFlag(s){this.tileLoaded=s}saveCanvasCopy(){const s=this.canvasCopy();s&&(this.frameCopies.push(s),this.tileLoaded=!1)}canvasCopy(){const s=this.context.gl,h=s.createTexture();return s.bindTexture(s.TEXTURE_2D,h),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,0,0,s.drawingBufferWidth,s.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const s=this.style&&this.style.fog;return!!s&&s.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const s=this._backgroundTiles,h=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const w of y)h[w.key]=s[w.key]||new a.Tile(w,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}}class Mu{constructor(s=0,h=0,y=0,w=0){if(isNaN(s)||s<0||isNaN(h)||h<0||isNaN(y)||y<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=h,this.left=y,this.right=w}interpolate(s,h,y){return h.top!=null&&s.top!=null&&(this.top=a.number(s.top,h.top,y)),h.bottom!=null&&s.bottom!=null&&(this.bottom=a.number(s.bottom,h.bottom,y)),h.left!=null&&s.left!=null&&(this.left=a.number(s.left,h.left,y)),h.right!=null&&s.right!=null&&(this.right=a.number(s.right,h.right,y)),this}getCenter(s,h){const y=a.clamp((this.left+s-this.right)/2,0,s),w=a.clamp((this.top+h-this.bottom)/2,0,h);return new a.Point(y,w)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new Mu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Au(g,s){const h=a.getColumn(g,3);a.fromQuat(g,s),a.setColumn(g,3,h)}function Kr(g,s){const h=a.identity$1([]);return a.rotateZ$1(h,h,-s),a.rotateX$1(h,h,-g),h}function gc(g,s){const h=[g[0],g[1],0],y=[s[0],s[1],0];if(a.length(h)>=1e-15){const P=a.normalize([],h);a.scale$2(y,P,a.dot(y,P)),s[0]=y[0],s[1]=y[1]}const w=a.cross([],s,g);if(a.len(w)<1e-15)return null;const T=Math.atan2(-w[1],w[0]);return Kr(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),T)}class Ra{constructor(s,h){this.position=s,this.orientation=h}get position(){return this._position}set position(s){if(s){const h=s instanceof a.MercatorCoordinate?s:new a.MercatorCoordinate(s[0],s[1],s[2]);this._renderWorldCopies&&(h.x=a.wrap(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(s,h){if(this.orientation=null,!this.position)return;const y=this.position,w=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(s)):0,T=a.MercatorCoordinate.fromLngLat(s,w),P=[T.x-y.x,T.y-y.y,T.z-y.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=gc(P,h)}setPitchBearing(s,h){this.orientation=Kr(a.degToRad(s),a.degToRad(-h))}}class _c{constructor(s,h){this._transform=a.identity([]),this.orientation=h,this.position=s}get mercatorPosition(){const s=this.position;return new a.MercatorCoordinate(s[0],s[1],s[2])}get position(){const s=a.getColumn(this._transform,3);return[s[0],s[1],s[2]]}set position(s){var h;s&&a.setColumn(this._transform,3,[(h=s)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(s){this._orientation=s||a.identity$1([]),s&&Au(this._transform,this._orientation)}getPitchBearing(){const s=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(s[0]*s[0]+s[1]*s[1]),-s[2])}}setPitchBearing(s,h){this._orientation=Kr(s,h),Au(this._transform,this._orientation)}forward(){const s=a.getColumn(this._transform,2);return[-s[0],-s[1],-s[2]]}up(){const s=a.getColumn(this._transform,1);return[-s[0],-s[1],-s[2]]}right(){const s=a.getColumn(this._transform,0);return[s[0],s[1],s[2]]}getCameraToWorld(s,h){const y=new Float64Array(16);return a.invert(y,this.getWorldToCamera(s,h)),y}getWorldToCameraPosition(s,h,y){const w=this.position;a.scale$2(w,w,-s);const T=new Float64Array(16);return a.fromScaling(T,[y,y,y]),a.translate(T,T,w),T[10]*=h,T}getWorldToCamera(s,h){const y=new Float64Array(16),w=new Float64Array(4),T=this.position;return a.conjugate(w,this._orientation),a.scale$2(T,T,-s),a.fromQuat(y,w),a.translate(y,y,T),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=h,y[9]*=h,y[10]*=h,y[11]*=h,y}getCameraToClipPerspective(s,h,y,w){const T=new Float64Array(16);return a.perspective(T,s,h,y,w),T}getDistanceToElevation(s,h=!1){const y=s===0?0:a.mercatorZfromAltitude(s,h?a.latFromMercatorY(this.position[1]):this.position[1]),w=this.forward();return(y-this.position[2])/w[2]}clone(){return new _c([...this.position],[...this.orientation])}}function ol(g,s){const h=Lh(g.projection,g.zoom,g.width,g.height),y=function(T,P,I,O,$){const U=new a.LngLat(I.lng-180*vs,I.lat),H=new a.LngLat(I.lng+180*vs,I.lat),oe=T.project(U.lng,U.lat),de=T.project(H.lng,H.lat),me=-Math.atan2(de.y-oe.y,de.x-oe.x),fe=a.MercatorCoordinate.fromLngLat(I);fe.y=a.clamp(fe.y,-1+vs,1-vs);const ye=fe.toLngLat(),K=T.project(ye.lng,ye.lat),ue=a.MercatorCoordinate.fromLngLat(ye);ue.x+=vs;const Ee=ue.toLngLat(),Ce=T.project(Ee.lng,Ee.lat),Fe=Pu(Ce.x-K.x,Ce.y-K.y,me),$e=a.MercatorCoordinate.fromLngLat(ye);$e.y+=vs;const Ne=$e.toLngLat(),Je=T.project(Ne.lng,Ne.lat),Ye=Pu(Je.x-K.x,Je.y-K.y,me),ut=Math.abs(Fe.x)/Math.abs(Ye.y),Kt=a.identity([]);a.rotateZ(Kt,Kt,-me*(1-($?0:O)));const st=a.identity([]);return a.scale(st,st,[1,1-(1-ut)*O,1]),st[4]=-Ye.x/Ye.y*O,a.rotateZ(st,st,me),a.multiply(st,Kt,st),st}(g.projection,0,g.center,h,s),w=xp(g);return a.scale(y,y,[w,w,1]),y}function xp(g){const s=g.projection,h=Lh(g.projection,g.zoom,g.width,g.height),y=wp(s,g.center),w=wp(s,a.LngLat.convert(s.center));return Math.pow(2,y*h+(1-h)*w)}function Lh(g,s,h,y,w=1/0){const T=g.range;if(!T)return 0;const P=Math.min(w,Math.max(h,y)),I=Math.log(P/1024)/Math.LN2;return a.smoothstep(T[0]+I,T[1]+I,s)}const vs=1/4e4;function wp(g,s){const h=a.clamp(s.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),y=new a.LngLat(s.lng-180*vs,h),w=new a.LngLat(s.lng+180*vs,h),T=g.project(y.lng,h),P=g.project(w.lng,h),I=a.MercatorCoordinate.fromLngLat(y),O=a.MercatorCoordinate.fromLngLat(w),$=P.x-T.x,U=P.y-T.y,H=O.x-I.x,oe=O.y-I.y,de=Math.sqrt((H*H+oe*oe)/($*$+U*U));return Math.log(de)/Math.LN2}function Pu(g,s,h){const y=Math.cos(h),w=Math.sin(h);return{x:g*y-s*w,y:g*w+s*y}}class Ml{constructor(s,h,y,w,T,P,I){this.tileSize=512,this._renderWorldCopies=T===void 0||T,this._minZoom=s||0,this._maxZoom=h||22,this._minPitch=y??0,this._maxPitch=w??60,this.setProjection(P),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Mu,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new _c,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const s=new Ml(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return s._elevation=this._elevation,s._centerAltitude=this._centerAltitude,s._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,s.tileSize=this.tileSize,s.mercatorFromTransition=this.mercatorFromTransition,s.width=this.width,s.height=this.height,s.cameraElevationReference=this.cameraElevationReference,s._center=this._center,s._setZoom(this.zoom),s._seaLevelZoom=this._seaLevelZoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._nearZ=this._nearZ,s._farZ=this._farZ,s._averageElevation=this._averageElevation,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._camera=this._camera.clone(),s._calcMatrices(),s.freezeTileCoverage=this.freezeTileCoverage,s.frustumCorners=this.frustumCorners,s}get elevation(){return this._elevation}set elevation(s){this._elevation!==s&&(this._elevation=s,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(s,h=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||y)&&this._updateCameraOnTerrain(),(s||y)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(s){this.projectionOptions=s||{name:"mercator"};const h=this.projection?this.getProjection():void 0;this.projection=a.getProjection(this.projectionOptions);const y=!M(h,this.getProjection());return y&&this._calcMatrices(),this.mercatorFromTransition=!1,y}setMercatorFromTransition(){const s=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.getProjection({name:"mercator"});const h=s!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get cameraWorldSize(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.Point(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(s){this.rotation=s}get rotation(){return-this.angle/Math.PI*180}set rotation(s){const h=-s*Math.PI/180;var y;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(y=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y),function(w,T,P){var I=T[0],O=T[1],$=T[2],U=T[3],H=Math.sin(P),oe=Math.cos(P);w[0]=I*oe+$*H,w[1]=O*oe+U*H,w[2]=I*-H+$*oe,w[3]=O*-H+U*oe}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const h=a.clamp(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const s=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/s)}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=a.degToRad(s),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(s){this._averageElevation=s,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(s){const h=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(s){this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const s=this._elevation;this._centerAltitude=s.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=s.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const s=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let w=0,T=0;for(let P=0;P<h.length;P++){const I=new a.Point(h[P][0]*this.width,y+h[P][1]*(this.height-y)),O=s.pointCoordinate(I);if(!O)continue;const $=1/Math.hypot(O[0]-this._camera.position[0],O[1]-this._camera.position[1]);w+=O[3]*$,T+=$}return T===0?NaN:w/T}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const s=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*h,w=this._mercatorZfromZoom(s),T=this._mercatorZfromZoom(this._maxZoom),P=Math.max(w-y,T);this._setZoom(this._zoomFromMercatorZ(P))}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}computeZoomRelativeTo(s){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,s.toAltitude()));let y;y=s.z<this._camera.position[2]?[h.x,h.y,h.z]:[s.x,s.y,s.z];const w=a.length(a.sub([],this._camera.position,y));return a.clamp(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(s){if(!this.height||!s.position&&!s.orientation)return;this._updateCameraState();let h=!1;if(s.orientation&&!a.exactEquals(s.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(s.orientation)),s.position){const y=[s.position.x,s.position.y,s.position.z];a.exactEquals$1(y,this._camera.position)||(this._setCameraPosition(y),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const s=this._camera.position,h=new Ra;return h.position=new a.MercatorCoordinate(s[0],s[1],s[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(s){if(!a.length$1(s))return!1;a.normalize$1(s,s);const h=a.transformQuat([],[0,0,-1],s),y=a.transformQuat([],[0,-1,0],s);if(y[2]<0)return!1;const w=gc(h,y);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(s){const h=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;s[2]=a.clamp(s[2],w/y,w/h),this._camera.position=s}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,h,y){this._unmodified=!1,this._edgeInsets.interpolate(s,h,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const h=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(s){const h=[new a.UnwrappedTileID(0,s)];if(this.renderWorldCopies){const y=this.pointCoordinate(new a.Point(0,0)),w=this.pointCoordinate(new a.Point(this.width,0)),T=this.pointCoordinate(new a.Point(this.width,this.height)),P=this.pointCoordinate(new a.Point(0,this.height)),I=Math.floor(Math.min(y.x,w.x,T.x,P.x)),O=Math.floor(Math.max(y.x,w.x,T.x,P.x)),$=1;for(let U=I-$;U<=O+$;U++)U!==0&&h.push(new a.UnwrappedTileID(U,s))}return h}coveringTiles(s){let h=this.coveringZoomLevel(s);const y=h,w=this.elevation&&!s.isTerrainDEM,T=this.projection.name==="mercator";if(s.minzoom!==void 0&&h<s.minzoom)return[];s.maxzoom!==void 0&&h>s.maxzoom&&(h=s.maxzoom);const P=this.locationCoordinate(this.center),I=this.center.lat,O=1<<h,$=[O*P.x,O*P.y,0],U=this.projection.name==="globe",H=!U,oe=a.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,H),de=U?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),me=O*a.mercatorZfromAltitude(1,this.center.lat),fe=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),ye=[O*de.x,O*de.y,fe*(H?1:me)],K=this.cameraToCenterDistance/s.tileSize*(s.roundZoom?1:.502),ue=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?h:0,Ee=s.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Ce=s.isTerrainDEM?-Ee:this._elevation?this._elevation.getMinElevationBelowMSL():0,Fe=this.projection.isReprojectedInTileSpace?xp(this):1,$e=at=>{const Ht=new a.MercatorCoordinate(at.x+25e-6,at.y,at.z),Ft=new a.MercatorCoordinate(at.x,at.y+25e-6,at.z),Yt=at.toLngLat(),$n=Ht.toLngLat(),mr=Ft.toLngLat(),kn=this.locationCoordinate(Yt),Zn=this.locationCoordinate($n),zr=this.locationCoordinate(mr),Or=Math.hypot(Zn.x-kn.x,Zn.y-kn.y),jn=Math.hypot(zr.x-kn.x,zr.y-kn.y);return Math.sqrt(Or*jn)*Fe/25e-6},Ne=at=>{const St=Ee,Ht=Ce;return{aabb:a.tileAABB(this,O,0,0,0,at,Ht,St,this.projection),zoom:0,x:0,y:0,minZ:Ht,maxZ:St,wrap:at,fullyVisible:!1}},Je=[];let Ye=[];const ut=h,Kt=s.reparseOverscaled?y:h,st=at=>at*at,Mt=st((fe-this._centerAltitude)*me),gt=at=>{if(!this._elevation||!at.tileID||!T)return;const St=this._elevation.getMinMaxForTile(at.tileID),Ht=at.aabb;St?(Ht.min[2]=St.min,Ht.max[2]=St.max,Ht.center[2]=(Ht.min[2]+Ht.max[2])/2):(at.shouldSplit=Zt(at),at.shouldSplit||(Ht.min[2]=Ht.max[2]=Ht.center[2]=this._centerAltitude))},Zt=at=>{if(at.zoom<ue)return!0;if(at.zoom===ut)return!1;if(at.shouldSplit!=null)return at.shouldSplit;const St=at.aabb.distanceX(ye),Ht=at.aabb.distanceY(ye);let Ft=Mt,Yt=1;if(U){Ft=st(at.aabb.distanceZ(ye));const kn=Math.pow(2,at.zoom),Zn=a.latFromMercatorY((at.y+1)/kn),zr=a.latFromMercatorY(at.y/kn),Or=Math.min(Math.max(I,Zn),zr),jn=a.circumferenceAtLatitude(Or)/a.circumferenceAtLatitude(I);if(Yt=Or===I?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,jn/this._mercatorScaleRatio),this.zoom<=a.GLOBE_ZOOM_THRESHOLD_MIN&&at.zoom===ut-1&&jn>=.9)return!0}else if(w&&(Ft=st(at.aabb.distanceZ(ye)*me)),this.projection.isReprojectedInTileSpace&&y<=5){const kn=Math.pow(2,at.zoom),Zn=$e(new a.MercatorCoordinate((at.x+.5)/kn,(at.y+.5)/kn));Yt=Zn>.85?1:Zn}const $n=St*St+Ht*Ht+Ft,mr=st((1<<ut-at.zoom)*K*Yt*((kn,Zn)=>{if(Zn*st(.707)<kn)return 1;const zr=Math.sqrt(Zn/kn);return zr/(1.4144271570014144+(Math.pow(1.1,zr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Ft,Mt),$n));return $n<mr};if(this.renderWorldCopies)for(let at=1;at<=3;at++)Je.push(Ne(-at)),Je.push(Ne(at));for(Je.push(Ne(0));Je.length>0;){const at=Je.pop(),St=at.x,Ht=at.y;let Ft=at.fullyVisible;if(!Ft){const Yt=at.aabb.intersects(oe);if(Yt===0)continue;Ft=Yt===2}if(at.zoom!==ut&&Zt(at))for(let Yt=0;Yt<4;Yt++){const $n=(St<<1)+Yt%2,mr=(Ht<<1)+(Yt>>1),kn={aabb:T?at.aabb.quadrant(Yt):a.tileAABB(this,O,at.zoom+1,$n,mr,at.wrap,at.minZ,at.maxZ,this.projection),zoom:at.zoom+1,x:$n,y:mr,wrap:at.wrap,fullyVisible:Ft,tileID:void 0,shouldSplit:void 0,minZ:at.minZ,maxZ:at.maxZ};w&&!U&&(kn.tileID=new a.OverscaledTileID(at.zoom+1===ut?Kt:at.zoom+1,at.wrap,at.zoom+1,$n,mr),gt(kn)),Je.push(kn)}else{const Yt=at.zoom===ut?Kt:at.zoom;if(s.minzoom&&s.minzoom>Yt)continue;const $n=$[0]-(.5+St+(at.wrap<<at.zoom))*(1<<h-at.zoom),mr=$[1]-.5-Ht,kn=at.tileID?at.tileID:new a.OverscaledTileID(Yt,at.wrap,at.zoom,St,Ht);Ye.push({tileID:kn,distanceSq:$n*$n+mr*mr})}}if(this.fogCullDistSq){const at=this.fogCullDistSq,St=this.horizonLineFromTop();Ye=Ye.filter(Ht=>{const Ft=[0,0,0,1],Yt=[a.EXTENT,a.EXTENT,0,1],$n=this.calculateFogTileMatrix(Ht.tileID.toUnwrapped());a.transformMat4$1(Ft,Ft,$n),a.transformMat4$1(Yt,Yt,$n);const mr=a.getAABBPointSquareDist(Ft,Yt);if(mr===0)return!0;let kn=!1;const Zn=this._elevation;if(Zn&&mr>at&&St!==0){const zr=this.calculateProjMatrix(Ht.tileID.toUnwrapped());let Or;s.isTerrainDEM||(Or=Zn.getMinMaxForTile(Ht.tileID)),Or||(Or={min:Ce,max:Ee});const jn=a.furthestTileCorner(this.rotation),Jr=[jn[0]*a.EXTENT,jn[1]*a.EXTENT,Or.max];a.transformMat4(Jr,Jr,zr),kn=(1-Jr[1])*this.height*.5<St}return mr<at||kn})}return Ye.sort((at,St)=>at.distanceSq-St.distanceSq).map(at=>at.tileID)}resize(s,h){this.width=s,this.height=h,this.pixelsToGLUnits=[2/s,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const h=a.clamp(s.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),y=this.projection.project(s.lng,h);return new a.Point(y.x*this.worldSize,y.y*this.worldSize)}unproject(s){return this.projection.unproject(s.x/this.worldSize,s.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(s,h){let y,w;const T=this.centerPoint;if(this.projection.name==="globe"){const I=this.worldSize;y=(h.x-T.x)/I,w=(h.y-T.y)/I}else{const I=this.pointCoordinate(h),O=this.pointCoordinate(T);y=I.x-O.x,w=I.y-O.y}const P=this.locationCoordinate(s);this.setLocation(new a.MercatorCoordinate(P.x-y,P.y-w))}setLocation(s){this.center=this.coordinateLocation(s),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(s){return this.projection.locationPoint(this,s)}locationPoint3D(s){return this.projection.locationPoint(this,s,!0)}pointLocation(s){return this.coordinateLocation(this.pointCoordinate(s))}pointLocation3D(s){return this.coordinateLocation(this.pointCoordinate3D(s))}locationCoordinate(s,h){const y=h?a.mercatorZfromAltitude(h,s.lat):void 0,w=this.projection.project(s.lng,s.lat);return new a.MercatorCoordinate(w.x,w.y,y)}coordinateLocation(s){return this.projection.unproject(s.x,s.y)}pointRayIntersection(s,h){const y=h??this._centerAltitude,w=[s.x,s.y,0,1],T=[s.x,s.y,1,1];a.transformMat4$1(w,w,this.pixelMatrixInverse),a.transformMat4$1(T,T,this.pixelMatrixInverse);const P=T[3];a.scale$1(w,w,1/w[3]),a.scale$1(T,T,1/P);const I=w[2],O=T[2];return{p0:w,p1:T,t:I===O?0:(y-I)/(O-I)}}screenPointToMercatorRay(s){const h=[s.x,s.y,0,1],y=[s.x,s.y,1,1];return a.transformMat4$1(h,h,this.pixelMatrixInverse),a.transformMat4$1(y,y,this.pixelMatrixInverse),a.scale$1(h,h,1/h[3]),a.scale$1(y,y,1/y[3]),h[2]=a.mercatorZfromAltitude(h[2],this._center.lat)*this.worldSize,y[2]=a.mercatorZfromAltitude(y[2],this._center.lat)*this.worldSize,a.scale$1(h,h,1/this.worldSize),a.scale$1(y,y,1/this.worldSize),new a.Ray([h[0],h[1],h[2]],a.normalize([],a.sub([],y,h)))}rayIntersectionCoordinate(s){const{p0:h,p1:y,t:w}=s,T=a.mercatorZfromAltitude(h[2],this._center.lat),P=a.mercatorZfromAltitude(y[2],this._center.lat);return new a.MercatorCoordinate(a.number(h[0],y[0],w)/this.worldSize,a.number(h[1],y[1],w)/this.worldSize,a.number(T,P,w))}pointCoordinate(s,h=this._centerAltitude){return this.projection.pointCoordinate(this,s.x,s.y,h)}pointCoordinate3D(s){if(!this.elevation)return this.pointCoordinate(s);let h=this.projection.pointCoordinate3D(this,s.x,s.y);if(h)return new a.MercatorCoordinate(h[0],h[1],h[2]);let y=0,w=this.horizonLineFromTop();if(s.y>w)return this.pointCoordinate(s);const T=.02*w,P=s.clone();for(let I=0;I<10&&w-y>T;I++){P.y=a.number(y,w,.66);const O=this.projection.pointCoordinate3D(this,P.x,P.y);O?(w=P.y,h=O):y=P.y}return h?new a.MercatorCoordinate(h[0],h[1],h[2]):this.pointCoordinate(s)}isPointAboveHorizon(s){return this.projection.isPointAboveHorizon(this,s)}isPointOnSurface(s){if(s.y<0||s.y>this.height||s.x<0||s.x>this.width)return!1;if(this.elevation||this.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(s);const h=this.pointCoordinate(s);return h.y>=0&&h.y<=1}_coordinatePoint(s,h){const y=h&&this.elevation?this.elevation.getAtPointOrZero(s,this._centerAltitude):this._centerAltitude,w=[s.x*this.worldSize,s.y*this.worldSize,y+s.toAltitude(),1];return a.transformMat4$1(w,w,this.pixelMatrix),w[3]>0?new a.Point(w[0]/w[3],w[1]/w[3]):new a.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:s,left:h}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,T=this.pointLocation3D(new a.Point(h,s)),P=this.pointLocation3D(new a.Point(w,s)),I=this.pointLocation3D(new a.Point(w,y)),O=this.pointLocation3D(new a.Point(h,y));let $=Math.min(T.lng,P.lng,I.lng,O.lng),U=Math.max(T.lng,P.lng,I.lng,O.lng),H=Math.min(T.lat,P.lat,I.lat,O.lat),oe=Math.max(T.lat,P.lat,I.lat,O.lat);const de=Math.pow(2,-this.zoom)/16*270,me=this.projection.name==="globe"?1:4,fe=(ye,K,ue,Ee,Ce)=>{const Fe=(ye+ue)/2,$e=(K+Ee)/2,Ne=new a.Point(Fe,$e),{lng:Je,lat:Ye}=this.pointLocation3D(Ne),ut=Math.max(0,$-Je,H-Ye,Je-U,Ye-oe);$=Math.min($,Je),U=Math.max(U,Je),H=Math.min(H,Ye),oe=Math.max(oe,Ye),(Ce<me||ut>de)&&(fe(ye,K,Fe,$e,Ce+1),fe(Fe,$e,ue,Ee,Ce+1))};if(fe(h,s,w,s,1),fe(w,s,w,y,1),fe(w,y,h,y,1),fe(h,y,h,s,1),this.projection.name==="globe"){const[ye,K]=a.polesInViewport(this);ye?(oe=90,U=180,$=-180):K&&(H=-90,U=180,$=-180)}return new a.LngLatBounds(new a.LngLat($,H),new a.LngLat(U,oe))}_getBoundsRectangular(s,h){const{top:y,left:w}=this._edgeInsets,T=this.height-this._edgeInsets.bottom,P=this.width-this._edgeInsets.right,I=new a.Point(w,y),O=new a.Point(P,y),$=new a.Point(P,T),U=new a.Point(w,T);let H=this.pointCoordinate(I,s),oe=this.pointCoordinate(O,s);const de=this.pointCoordinate($,h),me=this.pointCoordinate(U,h),fe=(ye,K)=>(K.y-ye.y)/(K.x-ye.x);return H.y>1&&oe.y>=0?H=new a.MercatorCoordinate((1-me.y)/fe(me,H)+me.x,1):H.y<0&&oe.y<=1&&(H=new a.MercatorCoordinate(-me.y/fe(me,H)+me.x,0)),oe.y>1&&H.y>=0?oe=new a.MercatorCoordinate((1-de.y)/fe(de,oe)+de.x,1):oe.y<0&&H.y<=1&&(oe=new a.MercatorCoordinate(-de.y/fe(de,oe)+de.x,0)),new a.LngLatBounds().extend(this.coordinateLocation(H)).extend(this.coordinateLocation(oe)).extend(this.coordinateLocation(me)).extend(this.coordinateLocation(de))}_getBoundsRectangularTerrain(){const s=this.elevation;if(!s.visibleDemTiles.length||s.isUsingMockSource())return this._getBoundsRectangular(0,0);const h=s.visibleDemTiles.reduce((y,w)=>{if(w.dem){const T=w.dem.tree;y.min=Math.min(y.min,T.minimums[0]),y.max=Math.max(y.max,T.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*s.exaggeration(),h.max*s.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(s=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,y=this.height/2-h*(1-this._horizonShift);return s?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(s){this.maxBounds=s,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,s&&(this.minLat=s.getSouth(),this.maxLat=s.getNorth(),this.minLng=s.getWest(),this.maxLng=s.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(s,h){return this.projection.createTileMatrix(this,h,s)}calculateDistanceTileData(s){const h=s.key,y=this._distanceTileDataCache;if(y[h])return y[h];const w=s.canonical,T=1/this.height,P=this.cameraWorldSize,I=P/this.zoomScale(w.z),O=(w.x+Math.pow(2,w.z)*s.wrap)*I,$=w.y*I,U=this.point;U.x*=P/this.worldSize,U.y*=P/this.worldSize;const H=this.angle,oe=Math.sin(-H),de=-Math.cos(-H);return y[h]={bearing:[oe,de],center:[(U.x-O)*T,(U.y-$)*T],scale:I/a.EXTENT*T},y[h]}calculateFogTileMatrix(s){const h=s.key,y=this._fogTileMatrixCache;if(y[h])return y[h];const w=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,s);return a.multiply(w,this.worldToFogMatrix,w),y[h]=new Float32Array(w),y[h]}calculateProjMatrix(s,h=!1){const y=s.key,w=h?this._alignedProjMatrixCache:this._projMatrixCache;if(w[y])return w[y];const T=this.calculatePosMatrix(s,this.worldSize);return a.multiply(T,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:h?this.alignedProjMatrix:this.projMatrix,T),w[y]=new Float32Array(T),w[y]}calculatePixelsToTileUnitsMatrix(s){const h=s.tileID.key,y=this._pixelsToTileUnitsCache;if(y[h])return y[h];const w=function(T,P){const{scale:I}=T.tileTransform,O=I*a.EXTENT/(T.tileSize*Math.pow(2,P.zoom-T.tileID.overscaledZ+T.tileID.canonical.z));return $=new Float32Array(4),oe=(U=P.inverseAdjustmentMatrix)[1],de=U[2],me=U[3],ye=(H=[O,O])[1],$[0]=U[0]*(fe=H[0]),$[1]=oe*fe,$[2]=de*ye,$[3]=me*ye,$;var $,U,H,oe,de,me,fe,ye}(s,this);return y[h]=w,y[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const s=1/this.worldSize,h=a.fromScaling([],[s,s,s]);return a.multiply(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const s=this._elevation;this._updateCameraState();const h=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(h),w=this._camera.forward(),T=a.mercatorZfromAltitude(1,this._center.lat);y[2]/=T,w[2]/=T,a.normalize(w,w);const P=s.raycast(y,w,s.exaggeration());if(P){const I=a.scaleAndAdd([],y,w,P),O=new a.MercatorCoordinate(I[0],I[1],a.mercatorZfromAltitude(I[2],a.latFromMercatorY(I[1]))),$=(O.z+a.length([O.x-y[0],O.y-y[1],O.z-y[2]*T]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ($),this._centerAltitude=O.toAltitude(),this._center=this.coordinateLocation(O),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(s=!1){if(!this._elevation)return;const h=this._elevation,y=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(y),T=h.getAtPointOrZero(new a.MercatorCoordinate(...w)),P=this.pixelsPerMeter/this.worldSize*T,I=this._minimumHeightOverTerrain(),O=w[2]-P;if(O<=I)if(O<0||s){const $=this.locationCoordinate(this._center,this._centerAltitude),U=[w[0],w[1],$.z-w[2]],H=a.length(U);U[2]-=(I-O)/this._pixelsPerMercatorPixel;const oe=a.length(U);if(oe===0)return;a.scale$2(U,U,H/oe*this._pixelsPerMercatorPixel),this._camera.position=[w[0],w[1],$.z*this._pixelsPerMercatorPixel-U[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const s=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||s){const oe=this.center;return oe.lat=a.clamp(oe.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!s)&&(oe.lng=a.clamp(oe.lng,this.minLng,this.maxLng)),this.center=oe,void(this._constraining=!1)}const h=this._unmodified,{x:y,y:w}=this.point;let T=0,P=y,I=w;const O=this.width/2,$=this.height/2,U=this.worldMinY*this.scale,H=this.worldMaxY*this.scale;if(w-$<U&&(I=U+$),w+$>H&&(I=H-$),H-U<this.height&&(T=Math.max(T,this.height/(H-U)),I=(H+U)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const oe=this.worldMinX*this.scale,de=this.worldMaxX*this.scale,me=this.worldSize/2-(oe+de)/2;P=(y+me+this.worldSize)%this.worldSize-me,P-O<oe&&(P=oe+O),P+O>de&&(P=de-O),de-oe<this.width&&(T=Math.max(T,this.width/(de-oe)),P=(de+oe)/2)}P===y&&I===w||(this.center=this.unproject(new a.Point(P,I))),T&&(this.zoom+=this.scaleZoom(T)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let s=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(s=Math.max(s,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),s}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,h=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.mercatorZfromAltitude(1,this.center.lat)/a.mercatorZfromAltitude(1,a.GLOBE_SCALE_MATCH_LATITUDE));const y=Lh(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,y),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w=this.projection.zAxisUnit==="meters"?h:1,T=this._camera.getWorldToCamera(this.worldSize,w),P=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);P[8]=2*-s.x/this.width,P[9]=2*s.y/this.height;let I=a.mul([],P,T);if(this.projection.isReprojectedInTileSpace){const $e=this.locationCoordinate(this.center),Ne=a.identity([]);a.translate(Ne,Ne,[$e.x*this.worldSize,$e.y*this.worldSize,0]),a.multiply(Ne,Ne,ol(this)),a.translate(Ne,Ne,[-$e.x*this.worldSize,-$e.y*this.worldSize,0]),a.multiply(I,I,Ne),this.inverseAdjustmentMatrix=function(Je){const Ye=ol(Je,!0);return ge([],[Ye[0],Ye[1],Ye[4],Ye[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale([],I,[this.worldSize,this.worldSize,this.worldSize/w,1]),this.projMatrix=I,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const O=a.invert([],P);this.frustumCorners=a.FrustumCorners.fromInvProjectionMatrix(O,this.horizonLineFromTop(),this.height);const $=new Float32Array(16);a.identity($),a.scale($,$,[1,-1,1]),a.rotateX($,$,this._pitch),a.rotateZ($,$,this.angle);const U=a.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),H=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;U[8]=2*-s.x/this.width,U[9]=2*(s.y+H)/this.height,this.skyboxMatrix=a.multiply($,U,$);const oe=this.point,de=oe.x,me=oe.y,fe=this.width%2/2,ye=this.height%2/2,K=Math.cos(this.angle),ue=Math.sin(this.angle),Ee=de-Math.round(de)+K*fe+ue*ye,Ce=me-Math.round(me)+K*ye+ue*fe,Fe=new Float64Array(I);if(a.translate(Fe,Fe,[Ee>.5?Ee-1:Ee,Ce>.5?Ce-1:Ce,0]),this.alignedProjMatrix=Fe,I=a.create(),a.scale(I,I,[this.width/2,-this.height/2,1]),a.translate(I,I,[1,-1,0]),this.labelPlaneMatrix=I,I=a.create(),a.scale(I,I,[1,-1,1]),a.translate(I,I,[-1,-1,0]),a.scale(I,I,[2/this.width,2/this.height,1]),this.glCoordMatrix=I,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},I=a.invert(new Float64Array(16),this.pixelMatrix),!I)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=I,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.calculateGlobeMatrix(this);const $e=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.transformMat4($e,$e,T),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=I;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const s=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,y=this._camera.position,w=1/this.height/this._pixelsPerMercatorPixel,T=[s,s,h];a.scale$2(T,T,w),a.scale$2(y,y,-1),a.multiply$2(y,y,T);const P=a.create();a.translate(P,P,y),a.scale(P,P,T),this.mercatorFogMatrix=P,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(s,h,w)}_computeCameraPosition(s){const h=(s=s||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),w=this.point,T=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-s/this.worldSize*this._centerAltitude;return[w.x/this.worldSize-y[0]*T,w.y/this.worldSize-y[1]*T,s/this.worldSize*this._centerAltitude-y[2]*T]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(s){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],w=s[2];let T=1;this.projection.wrap&&(this.center=this.center.wrap()),w>0&&(T=Math.min((h-y)/w,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,s,T),this._updateStateFromCamera()}_updateStateFromCamera(){const s=this._camera.position,h=this._camera.forward(),{pitch:y,bearing:w}=this._camera.getPitchBearing(),T=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,P=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),I=Math.max((s[2]-T)/Math.cos(y),P),O=this._zoomFromMercatorZ(I);a.scaleAndAdd(s,s,h,I),this._pitch=a.clamp(y,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(w,-Math.PI,Math.PI),this._setZoom(a.clamp(O,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.MercatorCoordinate(s[0],s[1],s[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(s){return Math.pow(2,s)*this.tileSize}_mercatorZfromZoom(s){return this.cameraToCenterDistance/this._worldSizeFromZoom(s)}_minimumHeightOverTerrain(){const s=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(s)}_zoomFromMercatorZ(s){return this.scaleZoom(this.cameraToCenterDistance/(s*this.tileSize))}zoomFromMercatorZAdjusted(s){let h=0,y=a.GLOBE_ZOOM_THRESHOLD_MAX,w=0,T=1/0;for(;y-h>1e-6&&y>h;){const P=h+.5*(y-h),I=this.tileSize*Math.pow(2,P),O=this.getCameraToCenterDistance(this.projection,P,I),$=this.scaleZoom(O/(s*this.tileSize)),U=Math.abs(P-$);U<T&&(T=U,w=P),P<$?h=P:y=P}return w}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(s,h){const y=Math.min(s.x,h.x),w=Math.max(s.x,h.x),T=Math.min(s.y,h.y),P=Math.max(s.y,h.y);if(T<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const I=[new a.Point(y,T),new a.Point(w,P),new a.Point(y,P),new a.Point(w,T)],O=this.renderWorldCopies?-3:0,$=this.renderWorldCopies?4:1;for(const U of I){const H=this.pointRayIntersection(U);if(H.t<0)return!0;const oe=this.rayIntersectionCoordinate(H);if(oe.x<O||oe.y<0||oe.x>$||oe.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.Point(0,0),new a.Point(this.width,this.height))}zoomDeltaToMovement(s,h){const y=a.length(a.sub([],this._camera.position,s)),w=this._zoomFromMercatorZ(y)+h;return y-this._mercatorZfromZoom(w)}getCameraPoint(){if(this.projection.name==="globe"){const s=function([h,y,w],T){const P=[h,y,w,1];a.transformMat4$1(P,P,T);const I=P[3]=Math.max(P[3],1e-6);return P[0]/=I,P[1]/=I,P[2]/=I,P}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.Point(s[0],s[1])}{const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,s))}}getCameraToCenterDistance(s,h=this.zoom,y=this.worldSize){const w=Lh(s,h,this.width,this.height,1024),T=s.pixelSpaceConversion(this.center.lat,y,w);return .5/Math.tan(.5*this._fov)*this.height*T}getWorldToCameraMatrix(){const s=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.multiply(s,s,this.globeMatrix),s}}function pi(g,s){let h=!1,y=null;const w=()=>{y=null,h&&(g(),y=setTimeout(w,s),h=!1)};return()=>(h=!0,y||w(),y)}class Iu{constructor(s){this._hashName=s&&encodeURIComponent(s),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=pi(this._updateHashUnthrottled.bind(this),300)}addTo(s){return this._map=s,a.window.addEventListener("hashchange",this._onHashChange,!1),s.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),a.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const s=this._map;if(!s)return"";const h=sl(s);if(this._hashName){const y=this._hashName;let w=!1;const T=a.window.location.hash.slice(1).split("&").map(P=>{const I=P.split("=")[0];return I===y?(w=!0,`${I}=${h}`):P}).filter(P=>P);return w||T.push(`${y}=${h}`),`#${T.join("&")}`}return`#${h}`}_getCurrentHash(){const s=a.window.location.hash.replace("#","");if(this._hashName){let h;return s.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(h=y)}),(h&&h[1]||"").split("/")}return s.split("/")}_onHashChange(){const s=this._map;if(!s)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some(y=>isNaN(y))){const y=s.dragRotate.isEnabled()&&s.touchZoomRotate.isEnabled()?+(h[3]||0):s.getBearing();return s.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:y,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){const s=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,s)}}function sl(g,s){const h=g.getCenter(),y=Math.round(100*g.getZoom())/100,w=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,w),P=Math.round(h.lng*T)/T,I=Math.round(h.lat*T)/T,O=g.getBearing(),$=g.getPitch();let U=s?`/${P}/${I}/${y}`:`${y}/${I}/${P}`;return(O||$)&&(U+="/"+Math.round(10*O)/10),$&&(U+=`/${Math.round($)}`),U}const Oa={linearity:.3,easing:a.bezier(0,0,.3,1)},Lu=a.extend({deceleration:2500,maxSpeed:1400},Oa),yc=a.extend({deceleration:20,maxSpeed:1400},Oa),fn=a.extend({deceleration:1e3,maxSpeed:360},Oa),ss=a.extend({deceleration:1e3,maxSpeed:90},Oa);class Al{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,h=a.exported.now();for(;s.length>0&&h-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const h={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)h.zoom+=T.zoomDelta||0,h.bearing+=T.bearingDelta||0,h.pitch+=T.pitchDelta||0,T.panDelta&&h.pan._add(T.panDelta),T.around&&(h.around=T.around),T.pinchAround&&(h.pinchAround=T.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(h.pan.mag()){const T=Ru(h.pan.mag(),y,a.extend({},Lu,s||{}));w.offset=h.pan.mult(T.amount/h.pan.mag()),w.center=this._map.transform.center,vc(w,T)}if(h.zoom){const T=Ru(h.zoom,y,yc);w.zoom=this._map.transform.zoom+T.amount,vc(w,T)}if(h.bearing){const T=Ru(h.bearing,y,fn);w.bearing=this._map.transform.bearing+a.clamp(T.amount,-179,179),vc(w,T)}if(h.pitch){const T=Ru(h.pitch,y,ss);w.pitch=this._map.transform.pitch+T.amount,vc(w,T)}if(w.zoom||w.bearing){const T=h.pinchAround===void 0?h.around:h.pinchAround;w.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),w.noMoveStart=!0,w}}function vc(g,s){(!g.duration||g.duration<s.duration)&&(g.duration=s.duration,g.easing=s.easing)}function Ru(g,s,h){const{maxSpeed:y,linearity:w,deceleration:T}=h,P=a.clamp(g*w/(s/1e3),-y,y),I=Math.abs(P)/(T*w);return{easing:h.easing,duration:1e3*I,amount:P*(I/2)}}class Co extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,h,y,w={}){const T=Ve(h.getCanvasContainer(),y),P=h.unproject(T);super(s,a.extend({point:T,lngLat:P,originalEvent:y},w)),this._defaultPrevented=!1,this.target=h}}class xc extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,h,y){const w=s==="touchend"?y.changedTouches:y.touches,T=Ke(h.getCanvasContainer(),w),P=T.map(O=>h.unproject(O)),I=T.reduce((O,$,U,H)=>O.add($.div(H.length)),new a.Point(0,0));super(s,{points:T,point:I,lngLats:P,lngLat:h.unproject(I),originalEvent:y}),this._defaultPrevented=!1}}class Pl extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,h,y){super(s,{originalEvent:y}),this._defaultPrevented=!1}}class wc{constructor(s,h){this._map=s,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(s){return this._firePreventable(new Pl(s.type,this._map,s))}mousedown(s,h){return this._mousedownPos=h,this._firePreventable(new Co(s.type,this._map,s))}mouseup(s){this._map.fire(new Co(s.type,this._map,s))}preclick(s){const h=a.extend({},s);h.type="preclick",this._map.fire(new Co(h.type,this._map,h))}click(s,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(s),this._map.fire(new Co(s.type,this._map,s)))}dblclick(s){return this._firePreventable(new Co(s.type,this._map,s))}mouseover(s){this._map.fire(new Co(s.type,this._map,s))}mouseout(s){this._map.fire(new Co(s.type,this._map,s))}touchstart(s){return this._firePreventable(new xc(s.type,this._map,s))}touchmove(s){this._map.fire(new xc(s.type,this._map,s))}touchend(s){this._map.fire(new xc(s.type,this._map,s))}touchcancel(s){this._map.fire(new xc(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bc{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(s){this._map.fire(new Co(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Co("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new Co(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Rh{constructor(s,h){this._map=s,this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,h){this.isEnabled()&&s.shiftKey&&s.button===0&&(Se(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(s,h){if(!this._active)return;const y=h,w=this._startPos,T=this._lastPos;if(!w||!T||T.equals(y)||!this._box&&y.dist(w)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=Z("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));const P=Math.min(w.x,y.x),I=Math.max(w.x,y.x),O=Math.min(w.y,y.y),$=Math.max(w.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${P}px,${O}px)`,this._box.style.width=I-P+"px",this._box.style.height=$-O+"px")})}mouseupWindow(s,h){if(!this._active)return;const y=this._startPos,w=h;if(y&&s.button===0){if(this.reset(),Me(),y.x!==w.x||y.y!==w.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:s})),{cameraAnimation:T=>T.fitScreenCoordinates(y,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",s)}}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),_e(),delete this._startPos,delete this._lastPos}_fireEvent(s,h){return this._map.fire(new a.Event(s,{originalEvent:h}))}}function Ec(g,s){const h={};for(let y=0;y<g.length;y++)h[g[y].identifier]=s[y];return h}class al{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(s,h,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=s.timeStamp),y.length===this.numTouches&&(this.centroid=function(w){const T=new a.Point(0,0);for(const P of w)T._add(P);return T.div(w.length)}(h),this.touches=Ec(y,h)))}touchmove(s,h,y){if(this.aborted||!this.centroid)return;const w=Ec(y,h);for(const T in this.touches){const P=w[T];(!P||P.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(s,h,y){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class hf{constructor(s){this.singleTap=new al(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(s,h,y){this.singleTap.touchstart(s,h,y)}touchmove(s,h,y){this.singleTap.touchmove(s,h,y)}touchend(s,h,y){const w=this.singleTap.touchend(s,h,y);if(w){const T=s.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(w)<30;if(T&&P||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class bp{constructor(){this._zoomIn=new hf({numTouches:1,numTaps:2}),this._zoomOut=new hf({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,h,y){this._zoomIn.touchstart(s,h,y),this._zoomOut.touchstart(s,h,y)}touchmove(s,h,y){this._zoomIn.touchmove(s,h,y),this._zoomOut.touchmove(s,h,y)}touchend(s,h,y){const w=this._zoomIn.touchend(s,h,y),T=this._zoomOut.touchend(s,h,y);return w?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()+1,around:P.unproject(w)},{originalEvent:s})}):T?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()-1,around:P.unproject(T)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Ep={0:1,2:2};class Tc{constructor(s){this.reset(),this._clickTolerance=s.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(s,h){return!1}_move(s,h){return{}}mousedown(s,h){if(this._lastPoint)return;const y=et(s);this._correctButton(s,y)&&(this._lastPoint=h,this._eventButton=y)}mousemoveWindow(s,h){const y=this._lastPoint;if(y){if(s.preventDefault(),this._eventButton!=null&&function(w,T){const P=Ep[T];return w.buttons===void 0||(w.buttons&P)!==P}(s,this._eventButton))this.reset();else if(this._moved||!(h.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(y,h)}}mouseupWindow(s){this._lastPoint&&et(s)===this._eventButton&&(this._moved&&Me(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ou extends Tc{mousedown(s,h){super.mousedown(s,h),this._lastPoint&&(this._active=!0)}_correctButton(s,h){return h===0&&!s.ctrlKey}_move(s,h){return{around:h,panDelta:h.sub(s)}}}class ga extends Tc{_correctButton(s,h){return h===0&&s.ctrlKey||h===2}_move(s,h){const y=.8*(h.x-s.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(s){s.preventDefault()}}class Oh extends Tc{_correctButton(s,h){return h===0&&s.ctrlKey||h===2}_move(s,h){const y=-.5*(h.y-s.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(s){s.preventDefault()}}class Da{constructor(s,h){this._map=s,this._el=s.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)}touchstart(s,h,y){return this._calculateTransform(s,h,y)}touchmove(s,h,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(y.length===1&&!a.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return s.cancelable&&s.preventDefault(),this._calculateTransform(s,h,y)}}touchend(s,h,y){this._calculateTransform(s,h,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,h,y){y.length>0&&(this._active=!0);const w=Ec(y,h),T=new a.Point(0,0),P=new a.Point(0,0);let I=0;for(const $ in w){const U=w[$],H=this._touches[$];H&&(T._add(U),P._add(U.sub(H)),I++,w[$]=U)}if(this._touches=w,I<this._minTouches||!P.mag())return;const O=P.div(I);return this._sum._add(O),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(I),panDelta:O}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Z("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class as{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(s){}_move(s,h,y){return{}}touchstart(s,h,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([h[0],h[1]]))}touchmove(s,h,y){const w=this._firstTwoTouches;if(!w)return;s.preventDefault();const[T,P]=w,I=za(y,h,T),O=za(y,h,P);if(!I||!O)return;const $=this._aroundCenter?null:I.add(O).div(2);return this._move([I,O],$,s)}touchend(s,h,y){if(!this._firstTwoTouches)return;const[w,T]=this._firstTwoTouches,P=za(y,h,w),I=za(y,h,T);P&&I||(this._active&&Me(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function za(g,s,h){for(let y=0;y<g.length;y++)if(g[y].identifier===h)return s[y]}function Ks(g,s){return Math.log(g/s)/Math.LN2}class Dh extends as{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,h){const y=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(Ks(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ks(this._distance,y),pinchAround:h}}}function df(g,s){return 180*g.angleWith(s)/Math.PI}class Tp extends as{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,h){const y=this._vector;if(this._vector=s[0].sub(s[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:df(this._vector,y),pinchAround:h}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const h=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const w=df(s,y);return Math.abs(w)<h}}function ls(g){return Math.abs(g.y)>Math.abs(g.x)}class Cc extends as{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(s){this._lastPoints=s,ls(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,h,y){const w=this._lastPoints;if(!w)return;const T=s[0].sub(w[0]),P=s[1].sub(w[1]);return this._map._cooperativeGestures&&!a.isFullscreen()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(T,P,y.timeStamp),!this._valid)?void 0:(this._lastPoints=s,this._active=!0,{pitchDelta:(T.y+P.y)/2*-.5})}gestureBeginsVertically(s,h,y){if(this._valid!==void 0)return this._valid;const w=s.mag()>=2,T=h.mag()>=2;if(!w&&!T)return;if(!w||!T)return this._firstMove==null&&(this._firstMove=y),y-this._firstMove<100&&void 0;const P=s.y>0==h.y>0;return ls(s)&&ls(h)&&P}}const Il={panStep:100,bearingStep:15,pitchStep:10};class zh{constructor(){const s=Il;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let h=0,y=0,w=0,T=0,P=0;switch(s.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:s.shiftKey?y=-1:(s.preventDefault(),T=-1);break;case 39:s.shiftKey?y=1:(s.preventDefault(),T=1);break;case 38:s.shiftKey?w=1:(s.preventDefault(),P=-1);break;case 40:s.shiftKey?w=-1:(s.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(y=0,w=0),{cameraAnimation:I=>{const O=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:Bh,zoom:h?Math.round(O)+h*(s.shiftKey?2:1):O,bearing:I.getBearing()+y*this._bearingStep,pitch:I.getPitch()+w*this._pitchStep,offset:[-T*this._panStep,-P*this._panStep],center:I.getCenter()},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Bh(g){return g*(2-g)}const ll=4.000244140625;class Ba{constructor(s,h){this._map=s,this._el=s.getCanvasContainer(),this._handler=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(s.ctrlKey||s.metaKey||this.isZooming()||a.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=s.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const y=a.exported.now(),w=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,h!==0&&h%ll==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(w*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),s.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=s,this._delta-=h,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=Ve(this._el,s);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._map.transform;this._type==="wheel"&&s.projection.wrap&&(s._center.lng>=180||s._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const h=()=>s._terrainEnabled()&&this._aroundCoord?s.computeZoomRelativeTo(this._aroundCoord):s.zoom;if(this._delta!==0){const O=this._type==="wheel"&&Math.abs(this._delta)>ll?this._wheelZoomRate:this._defaultZoomRate;let $=2/(1+Math.exp(-Math.abs(this._delta*O)));this._delta<0&&$!==0&&($=1/$);const U=h(),H=Math.pow(2,U),oe=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):H;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(oe*$))),this._type==="wheel"&&(this._startZoom=U,this._easing=this._smoothOutEasing(200)),this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:h(),w=this._startZoom,T=this._easing;let P,I=!1;if(this._type==="wheel"&&w&&T){const O=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),$=T(O);P=a.number(w,y,$),O<1?this._frameId||(this._frameId=!0):I=!0}else P=y,I=!0;return this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!I,zoomDelta:P-h(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let h=a.ease;if(this._prevEase){const y=this._prevEase,w=(a.exported.now()-y.start)/y.duration,T=y.easing(w+.01)-y.easing(w),P=.27/Math.sqrt(T*T+1e-4)*.01,I=Math.sqrt(.0729-P*P);h=a.bezier(P,I,.25,1)}return this._prevEase={start:a.exported.now(),duration:s,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Z("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Pi{constructor(s,h){this._clickZoom=s,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ur{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(s,h){return s.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(s.shiftKey?-1:1),around:y.unproject(h)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cl{constructor(){this._tap=new hf({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(s,h,y){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=h[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(s,h,y))}touchmove(s,h,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const w=h[0],T=w.y-this._swipePoint.y;return this._swipePoint=w,s.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(s,h,y)}touchend(s,h,y){this._tapTime?this._swipePoint&&y.length===0&&this.reset():this._tap.touchend(s,h,y)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Po{constructor(s,h,y){this._el=s,this._mousePan=h,this._touchPan=y}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class cs{constructor(s,h,y){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=h,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ll{constructor(s,h,y,w){this._el=s,this._touchZoom=h,this._touchRotate=y,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Io=g=>g.zoom||g.drag||g.pitch||g.rotate;class Ho extends a.Event{}class jh{constructor(){this.constants=[1,1,.01],this.radius=0}setup(s,h){const y=a.sub([],h,s);this.radius=a.length(y[2]<0?a.div([],y,this.constants):[y[0],y[1],0])}projectRay(s){a.div(s,s,this.constants),a.normalize(s,s),a.mul$1(s,s,this.constants);const h=a.scale$2([],s,this.radius);if(h[2]>0){const y=a.scale$2([],[0,0,1],a.dot(h,[0,0,1])),w=a.scale$2([],a.normalize([],[h[0],h[1],0]),this.radius),T=a.add([],h,a.scale$2([],a.sub([],a.add([],w,y),h),2));h[0]=T[0],h[1]=T[1]}return h}}function zs(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class Xs{constructor(s,h){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Al(s),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new jh,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),a.bindAll(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[w,T,P]of this._listeners)w.addEventListener(T,w===a.window.document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[s,h,y]of this._listeners)s.removeEventListener(h,s===a.window.document?this.handleWindowEvent:this.handleEvent,y)}_addDefaultHandlers(s){const h=this._map,y=h.getCanvasContainer();this._add("mapEvent",new wc(h,s));const w=h.boxZoom=new Rh(h,s);this._add("boxZoom",w);const T=new bp,P=new Ur;h.doubleClickZoom=new Pi(P,T),this._add("tapZoom",T),this._add("clickZoom",P);const I=new cl;this._add("tapDragZoom",I);const O=h.touchPitch=new Cc(h);this._add("touchPitch",O);const $=new ga(s),U=new Oh(s);h.dragRotate=new cs(s,$,U),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",U,["mouseRotate"]);const H=new Ou(s),oe=new Da(h,s);h.dragPan=new Po(y,H,oe),this._add("mousePan",H),this._add("touchPan",oe,["touchZoom","touchRotate"]);const de=new Tp,me=new Dh;h.touchZoomRotate=new Ll(y,me,de,I),this._add("touchRotate",de,["touchPan","touchZoom"]),this._add("touchZoom",me,["touchPan","touchRotate"]),this._add("blockableMapEvent",new bc(h));const fe=h.scrollZoom=new Ba(h,this);this._add("scrollZoom",fe,["mousePan"]);const ye=h.keyboard=new zh;this._add("keyboard",ye);for(const K of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[K]&&h[K].enable(s[K])}_add(s,h,y){this._handlers.push({handlerName:s,handler:h,allowed:y}),this._handlersById[s]=h}stop(s){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Io(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(s,h,y){for(const w in s)if(w!==y&&(!h||h.indexOf(w)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){const h=[];for(const y of s)this._el.contains(y.target)&&h.push(y);return h}handleEvent(s,h){this._updatingCamera=!0;const y=s.type==="renderFrame",w=y?void 0:s,T={needsRenderFrame:!1},P={},I={},O=s.touches?this._getMapTouches(s.touches):void 0,$=O?Ke(this._el,O):y?void 0:Ve(this._el,s);for(const{handlerName:oe,handler:de,allowed:me}of this._handlers){if(!de.isEnabled())continue;let fe;this._blockedByActive(I,me,oe)?de.reset():de[h||s.type]&&(fe=de[h||s.type](s,$,O),this.mergeHandlerResult(T,P,fe,oe,w),fe&&fe.needsRenderFrame&&this._triggerRenderFrame()),(fe||de.isActive())&&(I[oe]=de)}const U={};for(const oe in this._previousActiveHandlers)I[oe]||(U[oe]=w);this._previousActiveHandlers=I,(Object.keys(U).length||zs(T))&&(this._changes.push([T,P,U]),this._triggerRenderFrame()),(Object.keys(I).length||zs(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:H}=T;H&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],H(this._map))}mergeHandlerResult(s,h,y,w,T){if(!y)return;a.extend(s,y);const P={handlerName:w,originalEvent:y.originalEvent||T};y.zoomDelta!==void 0&&(h.zoom=P),y.panDelta!==void 0&&(h.drag=P),y.pitchDelta!==void 0&&(h.pitch=P),y.bearingDelta!==void 0&&(h.rotate=P)}_applyChanges(){const s={},h={},y={};for(const[w,T,P]of this._changes)w.panDelta&&(s.panDelta=(s.panDelta||new a.Point(0,0))._add(w.panDelta)),w.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+w.pitchDelta),w.around!==void 0&&(s.around=w.around),w.aroundCoord!==void 0&&(s.aroundCoord=w.aroundCoord),w.pinchAround!==void 0&&(s.pinchAround=w.pinchAround),w.noInertia&&(s.noInertia=w.noInertia),a.extend(h,T),a.extend(y,P);this._updateMapTransform(s,h,y),this._changes=[]}_updateMapTransform(s,h,y){const w=this._map,T=w.transform,P=ue=>[ue.x,ue.y,ue.z];if((ue=>{const Ee=this._eventsInProgress.drag;return Ee&&!this._handlersById[Ee.handlerName].isActive()})()&&!zs(s)){const ue=T.zoom;T.cameraElevationReference="sea",T.recenterOnTerrain(),T.cameraElevationReference="ground",ue!==T.zoom&&this._map._update(!0)}if(T._isCameraConstrained&&w._stop(!0),!zs(s))return void this._fireEvents(h,y,!0);let{panDelta:I,zoomDelta:O,bearingDelta:$,pitchDelta:U,around:H,aroundCoord:oe,pinchAround:de}=s;T._isCameraConstrained&&(O>0&&(O=0),T._isCameraConstrained=!1),de!==void 0&&(H=de),(O||(ue=>h[ue]&&!this._eventsInProgress[ue])("drag"))&&H&&(this._dragOrigin=P(T.pointCoordinate3D(H)),this._trackingEllipsoid.setup(T._camera.position,this._dragOrigin)),T.cameraElevationReference="sea",w._stop(!0),H=H||w.transform.centerPoint,$&&(T.bearing+=$),U&&(T.pitch+=U),T._updateCameraState();const me=[0,0,0];if(I)if(T.projection.name==="mercator"){const ue=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(H).dir),Ee=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(H.sub(I)).dir);me[0]=Ee[0]-ue[0],me[1]=Ee[1]-ue[1]}else{const ue=T.pointCoordinate(H);if(T.projection.name==="globe"){I=I.rotate(-T.angle);const Ee=T._pixelsPerMercatorPixel/T.worldSize;me[0]=-I.x*a.mercatorScale(a.latFromMercatorY(ue.y))*Ee,me[1]=-I.y*a.mercatorScale(T.center.lat)*Ee}else{const Ee=T.pointCoordinate(H.sub(I));ue&&Ee&&(me[0]=Ee.x-ue.x,me[1]=Ee.y-ue.y)}}const fe=T.zoom,ye=[0,0,0];if(O){const ue=P(oe||T.pointCoordinate3D(H)),Ee={dir:a.normalize([],a.sub([],ue,T._camera.position))};if(Ee.dir[2]<0){const Ce=T.zoomDeltaToMovement(ue,O);a.scale$2(ye,Ee.dir,Ce)}}const K=a.add(me,me,ye);T._translateCameraConstrained(K),O&&Math.abs(T.zoom-fe)>1e-4&&T.recenterOnTerrain(),T.cameraElevationReference="ground",this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(h,y,!0)}_fireEvents(s,h,y){const w=Io(this._eventsInProgress),T=Io(s),P={};for(const U in s){const{originalEvent:H}=s[U];this._eventsInProgress[U]||(P[`${U}start`]=H),this._eventsInProgress[U]=s[U]}!w&&T&&this._fireEvent("movestart",T.originalEvent);for(const U in P)this._fireEvent(U,P[U]);T&&this._fireEvent("move",T.originalEvent);for(const U in s){const{originalEvent:H}=s[U];this._fireEvent(U,H)}const I={};let O;for(const U in this._eventsInProgress){const{handlerName:H,originalEvent:oe}=this._eventsInProgress[U];this._handlersById[H].isActive()||(delete this._eventsInProgress[U],O=h[H]||oe,I[`${U}end`]=O)}for(const U in I)this._fireEvent(U,I[U]);const $=Io(this._eventsInProgress);if(y&&(w||T)&&!$){this._updatingCamera=!0;const U=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),H=oe=>oe!==0&&-this._bearingSnap<oe&&oe<this._bearingSnap;U?(H(U.bearing||this._map.getBearing())&&(U.bearing=0),this._map.easeTo(U,{originalEvent:O})):(this._map.fire(new a.Event("moveend",{originalEvent:O})),H(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,h){this._map.fire(new a.Event(s,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{this._frameId=void 0,this.handleEvent(new Ho("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const _a="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Du extends a.Evented{constructor(s,h){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=h.bearingSnap,this._respectPrefersReducedMotion=h.respectPrefersReducedMotion!==!1,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(s,h){return this.jumpTo({center:s},h)}panBy(s,h,y){return s=a.Point.convert(s).mult(-1),this.panTo(this.transform.center,a.extend({offset:s},h),y)}panTo(s,h,y){return this.easeTo(a.extend({center:s},h),y)}getZoom(){return this.transform.zoom}setZoom(s,h){return this.jumpTo({zoom:s},h),this}zoomTo(s,h,y){return this.easeTo(a.extend({zoom:s},h),y)}zoomIn(s,h){return this.zoomTo(this.getZoom()+1,s,h),this}zoomOut(s,h){return this.zoomTo(this.getZoom()-1,s,h),this}getBearing(){return this.transform.bearing}setBearing(s,h){return this.jumpTo({bearing:s},h),this}getPadding(){return this.transform.padding}setPadding(s,h){return this.jumpTo({padding:s},h),this}rotateTo(s,h,y){return this.easeTo(a.extend({bearing:s},h),y)}resetNorth(s,h){return this.rotateTo(0,a.extend({duration:1e3},s),h),this}resetNorthPitch(s,h){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},s),h),this}snapToNorth(s,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,h):this}getPitch(){return this.transform.pitch}setPitch(s,h){return this.jumpTo({pitch:s},h),this}cameraForBounds(s,h){s=a.LngLatBounds.convert(s);const y=h&&h.bearing||0,w=h&&h.pitch||0,T=s.getNorthWest(),P=s.getSouthEast();return this._cameraForBounds(this.transform,T,P,y,w,h)}_extendCameraOptions(s){const h={top:0,bottom:0,right:0,left:0};if(typeof(s=a.extend({padding:h,offset:[0,0],maxZoom:this.transform.maxZoom},s)).padding=="number"){const y=s.padding;s.padding={top:y,bottom:y,right:y,left:y}}return s.padding=a.extend(h,s.padding),s}_minimumAABBFrustumDistance(s,h){const y=h.max[0]-h.min[0],w=h.max[1]-h.min[1];return y/w>s.aspect?y/(2*Math.tan(.5*s.fovX)*s.aspect):w/(2*Math.tan(.5*s.fovY)*s.aspect)}_cameraForBoundsOnGlobe(s,h,y,w,T,P){const I=s.clone(),O=this._extendCameraOptions(P);I.bearing=w,I.pitch=T;const $=a.LngLat.convert(h),U=a.LngLat.convert(y),H=.5*($.lat+U.lat),oe=.5*($.lng+U.lng),de=a.latLngToECEF(H,oe),me=a.normalize([],de),fe=a.normalize([],a.cross([],me,[0,1,0])),ye=a.cross([],fe,me),K=[fe[0],fe[1],fe[2],0,ye[0],ye[1],ye[2],0,me[0],me[1],me[2],0,0,0,0,1],ue=[de,a.latLngToECEF($.lat,$.lng),a.latLngToECEF(U.lat,$.lng),a.latLngToECEF(U.lat,U.lng),a.latLngToECEF($.lat,U.lng),a.latLngToECEF(H,$.lng),a.latLngToECEF(H,U.lng),a.latLngToECEF($.lat,oe),a.latLngToECEF(U.lat,oe)];let Ee=a.Aabb.fromPoints(ue.map(Ft=>[a.dot(fe,Ft),a.dot(ye,Ft),a.dot(me,Ft)]));const Ce=a.transformMat4([],Ee.center,K);a.squaredLength(Ce)===0&&a.set(Ce,0,0,1),a.normalize(Ce,Ce),a.scale$2(Ce,Ce,a.GLOBE_RADIUS),I.center=a.ecefToLatLng(Ce);const Fe=I.getWorldToCameraMatrix(),$e=a.invert(new Float64Array(16),Fe);Ee=a.Aabb.applyTransform(Ee,a.multiply([],Fe,K)),a.transformMat4(Ce,Ce,Fe);const Ne=.5*(Ee.max[2]-Ee.min[2]),Je=this._minimumAABBFrustumDistance(I,Ee),Ye=a.scale$2([],[0,0,1],Ne),ut=a.add(Ye,Ce,Ye),Kt=Je+(I.pitch===0?0:a.distance(Ce,ut)),st=I.globeCenterInViewSpace,Mt=a.sub([],Ce,[st[0],st[1],st[2]]);a.normalize(Mt,Mt),a.scale$2(Mt,Mt,Kt);const gt=a.add([],Ce,Mt);a.transformMat4(gt,gt,$e);const Zt=a.earthRadius/a.GLOBE_RADIUS,at=a.length(gt),St=a.mercatorZfromAltitude(Math.max(at*Zt-a.earthRadius,Number.EPSILON),0),Ht=Math.min(I.zoomFromMercatorZAdjusted(St),O.maxZoom);return Ht>.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"mercator"}),I.zoom=Ht,this._cameraForBounds(I,h,y,w,T,P)):{center:I.center,zoom:Ht,bearing:w,pitch:T}}queryTerrainElevation(s,h){const y=this.transform.elevation;return y?(h=a.extend({},{exaggerated:!0},h),y.getAtPoint(a.MercatorCoordinate.fromLngLat(s),null,h.exaggerated)):null}_cameraForBounds(s,h,y,w,T,P){if(s.projection.name==="globe")return this._cameraForBoundsOnGlobe(s,h,y,w,T,P);const I=s.clone(),O=this._extendCameraOptions(P),$=I.padding;I.bearing=w,I.pitch=T;const U=a.LngLat.convert(h),H=a.LngLat.convert(y),oe=new a.LngLat(U.lng,H.lat),de=new a.LngLat(H.lng,U.lat),me=I.project(U),fe=I.project(H),ye=this.queryTerrainElevation(U),K=this.queryTerrainElevation(H),ue=this.queryTerrainElevation(oe),Ee=this.queryTerrainElevation(de),Ce=[[me.x,me.y,Math.min(ye||0,K||0,ue||0,Ee||0)],[fe.x,fe.y,Math.max(ye||0,K||0,ue||0,Ee||0)]];let Fe=a.Aabb.fromPoints(Ce);const $e=I.getWorldToCameraMatrix(),Ne=a.invert(new Float64Array(16),$e);Fe=a.Aabb.applyTransform(Fe,$e);const Je=a.sub([],Fe.max,Fe.min),Ye=$.left||0,ut=$.right||0,Kt=$.bottom||0,st=$.top||0,{left:Mt,right:gt,top:Zt,bottom:at}=O.padding,St=.5*(Ye+ut),Ht=.5*(st+Kt),Ft=Math.min(I.scaleZoom(I.scale*Math.min((I.width-(Ye+ut+Mt+gt))/Je[0],(I.height-(Kt+st+at+Zt))/Je[1])),O.maxZoom),Yt=I.scale/I.zoomScale(Ft);Fe=new a.Aabb([Fe.min[0]-(Mt+St)*Yt,Fe.min[1]-(at+Ht)*Yt,Fe.min[2]],[Fe.max[0]+(gt+St)*Yt,Fe.max[1]+(Zt+Ht)*Yt,Fe.max[2]]);const $n=.5*Je[2],mr=this._minimumAABBFrustumDistance(I,Fe),kn=[0,0,1,0];a.transformMat4$1(kn,kn,$e),a.normalize$2(kn,kn);const Zn=a.scale$2([],kn,mr+$n),zr=a.add([],Fe.center,Zn),Or=(typeof O.offset.x=="number"&&typeof O.offset.y=="number"?new a.Point(O.offset.x,O.offset.y):a.Point.convert(O.offset)).rotate(-a.degToRad(w));Fe.center[0]-=Or.x*Yt,Fe.center[1]+=Or.y*Yt,a.transformMat4(Fe.center,Fe.center,Ne),a.transformMat4(zr,zr,Ne);const jn=[Fe.center[0],Fe.center[1],zr[2]*I.pixelsPerMeter];a.scale$2(jn,jn,1/I.worldSize);const Jr=a.lngFromMercatorX(jn[0]),ti=a.latFromMercatorY(jn[1]),oi=Math.min(I._zoomFromMercatorZ(jn[2]),O.maxZoom),di=new a.LngLat(Jr,ti);return I.mercatorFromTransition&&oi<.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"globe"}),I.zoom=oi,this._cameraForBounds(I,h,y,w,T,P)):{center:di,zoom:oi,bearing:w,pitch:T}}fitBounds(s,h,y){const w=this.cameraForBounds(s,h);return this._fitInternal(w,h,y)}fitScreenCoordinates(s,h,y,w,T){const P=a.Point.convert(s),I=a.Point.convert(h),O=new a.Point(Math.min(P.x,I.x),Math.min(P.y,I.y)),$=new a.Point(Math.max(P.x,I.x),Math.max(P.y,I.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(P,I))return this;const U=this.transform.pointLocation3D(O),H=this.transform.pointLocation3D($),oe=this.transform.pointLocation3D(new a.Point(O.x,$.y)),de=this.transform.pointLocation3D(new a.Point($.x,O.y)),me=[Math.min(U.lng,H.lng,oe.lng,de.lng),Math.min(U.lat,H.lat,oe.lat,de.lat)],fe=[Math.max(U.lng,H.lng,oe.lng,de.lng),Math.max(U.lat,H.lat,oe.lat,de.lat)],ye=w&&w.pitch?w.pitch:this.getPitch(),K=this._cameraForBounds(this.transform,me,fe,y,ye,w);return this._fitInternal(K,w,T)}_fitInternal(s,h,y){return s?(delete(h=a.extend(s,h)).padding,h.linear?this.easeTo(h,y):this.flyTo(h,y)):this}jumpTo(s,h){this.stop();const y=s.preloadOnly?this.transform.clone():this.transform;let w=!1,T=!1,P=!1;return"zoom"in s&&y.zoom!==+s.zoom&&(w=!0,y.zoom=+s.zoom),s.center!==void 0&&(y.center=a.LngLat.convert(s.center)),"bearing"in s&&y.bearing!==+s.bearing&&(T=!0,y.bearing=+s.bearing),"pitch"in s&&y.pitch!==+s.pitch&&(P=!0,y.pitch=+s.pitch),s.padding==null||y.isPaddingEqual(s.padding)||(y.padding=s.padding),s.preloadOnly?(this._preloadTiles(y),this):(this.fire(new a.Event("movestart",h)).fire(new a.Event("move",h)),w&&this.fire(new a.Event("zoomstart",h)).fire(new a.Event("zoom",h)).fire(new a.Event("zoomend",h)),T&&this.fire(new a.Event("rotatestart",h)).fire(new a.Event("rotate",h)).fire(new a.Event("rotateend",h)),P&&this.fire(new a.Event("pitchstart",h)).fire(new a.Event("pitch",h)).fire(new a.Event("pitchend",h)),this.fire(new a.Event("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.warnOnce(_a),this.transform.getFreeCameraOptions()}setFreeCameraOptions(s,h){const y=this.transform;if(!y.projection.supportsFreeCamera)return a.warnOnce(_a),this;this.stop();const w=y.zoom,T=y.pitch,P=y.bearing;y.setFreeCameraOptions(s);const I=w!==y.zoom,O=T!==y.pitch,$=P!==y.bearing;return this.fire(new a.Event("movestart",h)).fire(new a.Event("move",h)),I&&this.fire(new a.Event("zoomstart",h)).fire(new a.Event("zoom",h)).fire(new a.Event("zoomend",h)),$&&this.fire(new a.Event("rotatestart",h)).fire(new a.Event("rotate",h)).fire(new a.Event("rotateend",h)),O&&this.fire(new a.Event("pitchstart",h)).fire(new a.Event("pitch",h)).fire(new a.Event("pitchend",h)),this.fire(new a.Event("moveend",h)),this}easeTo(s,h){this._stop(!1,s.easeId),((s=a.extend({offset:[0,0],duration:500,easing:a.ease},s)).animate===!1||this._prefersReducedMotion(s))&&(s.duration=0);const y=this.transform,w=this.getZoom(),T=this.getBearing(),P=this.getPitch(),I=this.getPadding(),O="zoom"in s?+s.zoom:w,$="bearing"in s?this._normalizeBearing(s.bearing,T):T,U="pitch"in s?+s.pitch:P,H="padding"in s?s.padding:y.padding,oe=a.Point.convert(s.offset);let de,me,fe;if(y.projection.name==="globe"){const Ye=a.MercatorCoordinate.fromLngLat(y.center),ut=oe.rotate(-y.angle);Ye.x+=ut.x/y.worldSize,Ye.y+=ut.y/y.worldSize;const Kt=Ye.toLngLat(),st=a.LngLat.convert(s.center||Kt);this._normalizeCenter(st),de=y.centerPoint.add(ut),me=new a.Point(Ye.x,Ye.y).mult(y.worldSize),fe=new a.Point(a.mercatorXfromLng(st.lng),a.mercatorYfromLat(st.lat)).mult(y.worldSize).sub(me)}else{de=y.centerPoint.add(oe);const Ye=y.pointLocation(de),ut=a.LngLat.convert(s.center||Ye);this._normalizeCenter(ut),me=y.project(Ye),fe=y.project(ut).sub(me)}const ye=y.zoomScale(O-w);let K,ue;s.around&&(K=a.LngLat.convert(s.around),ue=y.locationPoint(K));const Ee=this._zooming||O!==w,Ce=this._rotating||T!==$,Fe=this._pitching||U!==P,$e=!y.isPaddingEqual(H),Ne=Ye=>ut=>{if(Ee&&(Ye.zoom=a.number(w,O,ut)),Ce&&(Ye.bearing=a.number(T,$,ut)),Fe&&(Ye.pitch=a.number(P,U,ut)),$e&&(Ye.interpolatePadding(I,H,ut),de=Ye.centerPoint.add(oe)),K)Ye.setLocationAtPoint(K,ue);else{const Kt=Ye.zoomScale(Ye.zoom-w),st=O>w?Math.min(2,ye):Math.max(.5,ye),Mt=Math.pow(st,1-ut),gt=Ye.unproject(me.add(fe.mult(ut*Mt)).mult(Kt));Ye.setLocationAtPoint(Ye.renderWorldCopies?gt.wrap():gt,de)}return s.preloadOnly||this._fireMoveEvents(h),Ye};if(s.preloadOnly){const Ye=this._emulate(Ne,s.duration,y);return this._preloadTiles(Ye),this}const Je={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ee,this._rotating=Ce,this._pitching=Fe,this._padding=$e,this._easeId=s.easeId,this._prepareEase(h,s.noMoveStart,Je),this._ease(Ne(y),Ye=>{y.recenterOnTerrain(),this._afterEase(h,Ye)},s),this}_prepareEase(s,h,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",h||y.moving||this.fire(new a.Event("movestart",s)),this._zooming&&!y.zooming&&this.fire(new a.Event("zoomstart",s)),this._rotating&&!y.rotating&&this.fire(new a.Event("rotatestart",s)),this._pitching&&!y.pitching&&this.fire(new a.Event("pitchstart",s))}_fireMoveEvents(s){this.fire(new a.Event("move",s)),this._zooming&&this.fire(new a.Event("zoom",s)),this._rotating&&this.fire(new a.Event("rotate",s)),this._pitching&&this.fire(new a.Event("pitch",s))}_afterEase(s,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,w=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new a.Event("zoomend",s)),w&&this.fire(new a.Event("rotateend",s)),T&&this.fire(new a.Event("pitchend",s)),this.fire(new a.Event("moveend",s))}flyTo(s,h){if(this._prefersReducedMotion(s)){const Ft=a.pick(s,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ft,h)}this.stop(),s=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},s);const y=this.transform,w=this.getZoom(),T=this.getBearing(),P=this.getPitch(),I=this.getPadding(),O="zoom"in s?a.clamp(+s.zoom,y.minZoom,y.maxZoom):w,$="bearing"in s?this._normalizeBearing(s.bearing,T):T,U="pitch"in s?+s.pitch:P,H="padding"in s?s.padding:y.padding,oe=y.zoomScale(O-w),de=a.Point.convert(s.offset);let me=y.centerPoint.add(de);const fe=y.pointLocation(me),ye=a.LngLat.convert(s.center||fe);this._normalizeCenter(ye);const K=y.project(fe),ue=y.project(ye).sub(K);let Ee=s.curve;const Ce=Math.max(y.width,y.height),Fe=Ce/oe,$e=ue.mag();if("minZoom"in s){const Ft=a.clamp(Math.min(s.minZoom,w,O),y.minZoom,y.maxZoom),Yt=Ce/y.zoomScale(Ft-w);Ee=Math.sqrt(Yt/$e*2)}const Ne=Ee*Ee;function Je(Ft){const Yt=(Fe*Fe-Ce*Ce+(Ft?-1:1)*Ne*Ne*$e*$e)/(2*(Ft?Fe:Ce)*Ne*$e);return Math.log(Math.sqrt(Yt*Yt+1)-Yt)}function Ye(Ft){return(Math.exp(Ft)-Math.exp(-Ft))/2}function ut(Ft){return(Math.exp(Ft)+Math.exp(-Ft))/2}const Kt=Je(0);let st=function(Ft){return ut(Kt)/ut(Kt+Ee*Ft)},Mt=function(Ft){return Ce*((ut(Kt)*(Ye(Yt=Kt+Ee*Ft)/ut(Yt))-Ye(Kt))/Ne)/$e;var Yt},gt=(Je(1)-Kt)/Ee;if(Math.abs($e)<1e-6||!isFinite(gt)){if(Math.abs(Ce-Fe)<1e-6)return this.easeTo(s,h);const Ft=Fe<Ce?-1:1;gt=Math.abs(Math.log(Fe/Ce))/Ee,Mt=function(){return 0},st=function(Yt){return Math.exp(Ft*Ee*Yt)}}s.duration="duration"in s?+s.duration:1e3*gt/("screenSpeed"in s?+s.screenSpeed/Ee:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0);const Zt=T!==$,at=U!==P,St=!y.isPaddingEqual(H),Ht=Ft=>Yt=>{const $n=Yt*gt,mr=1/st($n);Ft.zoom=Yt===1?O:w+Ft.scaleZoom(mr),Zt&&(Ft.bearing=a.number(T,$,Yt)),at&&(Ft.pitch=a.number(P,U,Yt)),St&&(Ft.interpolatePadding(I,H,Yt),me=Ft.centerPoint.add(de));const kn=Yt===1?ye:Ft.unproject(K.add(ue.mult(Mt($n))).mult(mr));return Ft.setLocationAtPoint(Ft.renderWorldCopies?kn.wrap():kn,me),Ft._updateCameraOnTerrain(),s.preloadOnly||this._fireMoveEvents(h),Ft};if(s.preloadOnly){const Ft=this._emulate(Ht,s.duration,y);return this._preloadTiles(Ft),this}return this._zooming=!0,this._rotating=Zt,this._pitching=at,this._padding=St,this._prepareEase(h,!1),this._ease(Ht(y),()=>this._afterEase(h),s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(s,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,h)}if(!s){const y=this.handlers;y&&y.stop(!1)}return this}_ease(s,h,y){y.animate===!1||y.duration===0?(s(1),h()):(this._easeStart=a.exported.now(),this._easeOptions=y,this._onEaseFrame=s,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const s=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,h){s=a.wrap(s,-180,180);const y=Math.abs(s-h);return Math.abs(s-360-h)<y&&(s-=360),Math.abs(s+360-h)<y&&(s+=360),s}_normalizeCenter(s){const h=this.transform;if(!h.renderWorldCopies||h.maxBounds)return;const y=s.lng-h.center.lng;s.lng+=y>180?-360:y<-180?360:0}_prefersReducedMotion(s){return this._respectPrefersReducedMotion&&a.exported.prefersReducedMotion&&!(s&&s.essential)}_emulate(s,h,y){const w=Math.ceil(15*h/1e3),T=[],P=s(y.clone());for(let I=0;I<=w;I++){const O=P(I/w);T.push(O.clone())}return T}}class gn{constructor(s={}){this.options=s,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){const h=this.options&&this.options.compact;return this._map=s,this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Z("button","mapboxgl-ctrl-attrib-button",this._container),Z("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Z("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),h===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(s,h){const y=this._map._getUIString(`AttributionControl.${h}`);s.setAttribute("aria-label",y),s.removeAttribute("title"),s.firstElementChild&&s.firstElementChild.setAttribute("title",y)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(s){const y=h.reduce((w,T,P)=>(T.value&&(w+=`${T.key}=${T.value}${P<h.length-1?"&":""}`),w),"?");s.href=`${a.config.FEEDBACK_URL}/${y}#${sl(this._map,!0)}`,s.rel="noopener nofollow",this._setElementTitle(s,"MapFeedback")}}_updateData(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let s=[];if(this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const h=this._map.style._sourceCaches;for(const w in h){const T=h[w];if(T.used){const P=T.getSource();P.attribution&&s.indexOf(P.attribution)<0&&s.push(P.attribution)}}s.sort((w,T)=>w.length-T.length),s=s.filter((w,T)=>{for(let P=T+1;P<s.length;P++)if(s[P].indexOf(w)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=[...this.options.customAttribution,...s]:s.unshift(this.options.customAttribution));const y=s.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,s.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Sc{constructor(){a.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(s){this._map=s,this._container=Z("div","mapboxgl-ctrl");const h=Z("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const s=this._map.style._sourceCaches;if(Object.entries(s).length===0)return!0;for(const h in s){const y=s[h].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const s=this._container.children;if(s.length){const h=s[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class zu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const h=++this._id;return this._queue.push({callback:s,id:h,cancelled:!1}),h}remove(s){const h=this._currentlyRunning,y=h?this._queue.concat(h):this._queue;for(const w of y)if(w.id===s)return void(w.cancelled=!0)}run(s=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const y of h)if(!y.cancelled&&(y.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Rl(g,s,h){if(g=new a.LngLat(g.lng,g.lat),s){const y=new a.LngLat(g.lng-360,g.lat),w=new a.LngLat(g.lng+360,g.lat),T=360*Math.ceil(Math.abs(g.lng-h.center.lng)/360),P=h.locationPoint(g).distSqr(s),I=s.x<0||s.y<0||s.x>h.width||s.y>h.height;h.locationPoint(y).distSqr(s)<P&&(I||Math.abs(y.lng-h.center.lng)<T)?g=y:h.locationPoint(w).distSqr(s)<P&&(I||Math.abs(w.lng-h.center.lng)<T)&&(g=w)}for(;Math.abs(g.lng-h.center.lng)>180;){const y=h.locationPoint(g);if(y.x>=0&&y.y>=0&&y.x<=h.width&&y.y<=h.height)break;g.lng>h.center.lng?g.lng-=360:g.lng+=360}return g}const Ol={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class un extends a.Evented{constructor(s,h){if(super(),(s instanceof a.window.HTMLElement||h)&&(s=a.extend({element:s},h)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&s.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=s&&s.occludedOpacity||.2,s&&s.element)this._element=s.element,this._offset=a.Point.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=Z("div");const w=41,T=27,P=Y("svg",{display:"block",height:w*this._scale+"px",width:T*this._scale+"px",viewBox:`0 0 ${T} ${w}`},this._element),I=Y("radialGradient",{id:"shadowGradient"},Y("defs",{},P));Y("stop",{offset:"10%","stop-opacity":.4},I),Y("stop",{offset:"100%","stop-opacity":.05},I),Y("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},P),Y("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},P),Y("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},P),Y("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},P),this._offset=a.Point.convert(s&&s.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",w=>{w.preventDefault()}),this._element.addEventListener("mousedown",w=>{w.preventDefault()});const y=this._element.classList;for(const w in Ol)y.remove(`mapboxgl-marker-anchor-${w}`);y.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(s){return s===this._map||(this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._updateMoving),s.on("moveend",this._update),s.on("remove",this._clearFadeTimer),s._addMarker(this),this.setDraggable(this._draggable),this._update(),s.on("click",this._onMapClick)),this}remove(){const s=this._map;return s&&(s.off("click",this._onMapClick),s.off("move",this._updateMoving),s.off("moveend",this._update),s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler),s.off("mouseup",this._onUp),s.off("touchend",this._onUp),s.off("mousemove",this._onMove),s.off("touchmove",this._onMove),s.off("remove",this._clearFadeTimer),s._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=a.LngLat.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(38.1-13.5+w)],"bottom-right":[-w,-1*(38.1-13.5+w)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,s._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(s){const h=s.code,y=s.charCode||s.keyCode;h!=="Space"&&h!=="Enter"&&y!==32&&y!==13||this.togglePopup()}_onMapClick(s){const h=s.originalEvent.target,y=this._element;this._popup&&(h===y||y.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?(s.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(s.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const s=this._map,h=this._pos;if(!s||!h)return!1;const y=s.unproject(h),w=s.getFreeCameraOptions();if(!w.position)return!1;const T=w.position.toLngLat();return T.distanceTo(y)<.9*T.distanceTo(this._lngLat)}_evaluateOpacity(){const s=this._map;if(!s)return;const h=this._pos;if(!h||h.x<0||h.x>s.transform.width||h.y<0||h.y>s.transform.height)return void this._clearFadeTimer();const y=s.unproject(h);let w;s._showingGlobe()&&a.isLngLatBehindGlobe(s.transform,this._lngLat)?w=0:(w=1-s._queryFogOpacity(y),s.transform._terrainEnabled()&&s.getTerrain()&&this._behindTerrain()&&(w*=this._occludedOpacity)),this._element.style.opacity=`${w}`,this._element.style.pointerEvents=w>0?"auto":"none",this._popup&&this._popup._setOpacity(w),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const s=this._pos;if(!s||!this._map)return;const h=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${s.x}px,${s.y}px)
            ${Ol[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${h.x}px,${h.y}px)
        `}_calculateXYTransform(){const s=this._pos,h=this._map,y=this.getPitchAlignment();if(!h||!s||y!=="map")return"";if(!h._showingGlobe()){const O=h.getPitch();return O?`rotateX(${O}deg)`:""}const w=a.radToDeg(a.globeTiltAtLngLat(h.transform,this._lngLat)),T=s.sub(a.globeCenterToScreenPoint(h.transform)),P=Math.abs(T.x)+Math.abs(T.y);if(P===0)return"";const I=w/P;return`rotateX(${-T.y*I}deg) rotateY(${T.x*I}deg)`}_calculateZTransform(){const s=this._pos,h=this._map;if(!h||!s)return"";let y=0;const w=this.getRotationAlignment();if(w==="map")if(h._showingGlobe()){const T=h.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),P=h.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(T);y=a.radToDeg(Math.atan2(P.y,P.x))-90}else y=-h.getBearing();else if(w==="horizon"){const T=a.smoothstep(4,6,h.getZoom()),P=a.globeCenterToScreenPoint(h.transform);P.y+=T*h.transform.height;const I=s.sub(P),O=a.radToDeg(Math.atan2(I.y,I.x));y=(O>90?O-270:O+90)*(1-T)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(s){a.window.cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=Rl(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat),s===!0?this._updateFrameId=a.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),h._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(s){return this._offset=a.Point.convert(s),this._update(),this}_onMove(s){const h=this._map;if(!h)return;const y=this._pointerdownPos,w=this._positionDelta;if(y&&w){if(!this._isDragging){const T=this._clickTolerance||h._clickTolerance;if(s.point.dist(y)<T)return;this._isDragging=!0}this._pos=s.point.sub(w),this._lngLat=h.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const s=this._map;s&&(s.off("mousemove",this._onMove),s.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(s){const h=this._map,y=this._pos;h&&y&&this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(y),this._pointerdownPos=s.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(s){this._draggable=!!s;const h=this._map;return h&&(s?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(s){return this._occludedOpacity=s||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const ul={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},kc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Bu(g=new a.Point(0,0),s="bottom"){if(typeof g=="number"){const h=Math.round(Math.sqrt(.5*Math.pow(g,2)));switch(s){case"top":return new a.Point(0,g);case"top-left":return new a.Point(h,h);case"top-right":return new a.Point(-h,h);case"bottom":return new a.Point(0,-g);case"bottom-left":return new a.Point(h,-h);case"bottom-right":return new a.Point(-h,-h);case"left":return new a.Point(g,0);case"right":return new a.Point(-g,0)}return new a.Point(0,0)}return g instanceof a.Point||Array.isArray(g)?a.Point.convert(g):a.Point.convert(g[s]||[0,0])}class Mc{constructor(s){this.jumpTo(s)}getValue(s){if(s<=this._startTime)return this._start;if(s>=this._endTime)return this._end;const h=a.easeCubicInOut((s-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(s){return s>=this._startTime&&s<=this._endTime}jumpTo(s){this._startTime=-1/0,this._endTime=-1/0,this._start=s,this._end=s}easeTo(s,h,y){this._start=this.getValue(h),this._end=s,this._startTime=h,this._endTime=h+y}}const xs={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},ws={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},Dl={showCompass:!0,showZoom:!0,visualizePitch:!1};class ja{constructor(s,h,y=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new ga({clickTolerance:s.dragRotate._mouseRotate._clickTolerance}),this.map=s,y&&(this.mousePitch=new Oh({clickTolerance:s.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(s,h){this.mouseRotate.mousedown(s,h),this.mousePitch&&this.mousePitch.mousedown(s,h),Se()}move(s,h){const y=this.map,w=this.mouseRotate.mousemoveWindow(s,h),T=w&&w.bearingDelta;if(T&&y.setBearing(y.getBearing()+T),this.mousePitch){const P=this.mousePitch.mousemoveWindow(s,h),I=P&&P.pitchDelta;I&&y.setPitch(y.getPitch()+I)}}off(){const s=this.element;s.removeEventListener("mousedown",this.mousedown),s.removeEventListener("touchstart",this.touchstart,{passive:!1}),s.removeEventListener("touchmove",this.touchmove),s.removeEventListener("touchend",this.touchend),s.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){_e(),a.window.removeEventListener("mousemove",this.mousemove),a.window.removeEventListener("mouseup",this.mouseup)}mousedown(s){this.down(a.extend({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),Ve(this.element,s)),a.window.addEventListener("mousemove",this.mousemove),a.window.addEventListener("mouseup",this.mouseup)}mousemove(s){this.move(s,Ve(this.element,s))}mouseup(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()}touchstart(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ke(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>s.preventDefault()},this._startPos))}touchmove(s){s.targetTouches.length!==1?this.reset():(this._lastPos=Ke(this.element,s.targetTouches)[0],this.move({preventDefault:()=>s.preventDefault()},this._lastPos))}touchend(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Ys={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Na={maxWidth:100,unit:"metric"},Nh={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},hl={version:a.version,supported:R,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends Du{constructor(g){if(a.LivePerformanceUtils.mark(a.PerformanceMarkers.create),(g=a.extend({},ws,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(g.antialias&&a.isSafariWithAntialiasingBug(a.window)&&(g.antialias=!1,a.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ml(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies),g),this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._useWebGL2=g.useWebGL2,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._collectResourceTiming=g.collectResourceTiming,this._optimizeForTerrain=g.optimizeForTerrain,this._language=this._parseLanguage(g.language),this._worldview=g.worldview,this._renderTaskQueue=new zu,this._domRenderTaskQueue=new zu,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.uniqueId(),this._locale=a.extend({},xs,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._performanceMetricsCollection=g.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Mc(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new a.RequestManager(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,typeof g.container=="string"){if(this._container=a.window.document.getElementById(g.container),!this._container)throw new Error(`Container '${g.container}' not found.`)}else{if(!(g.container instanceof a.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&a.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Xs(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,g.style&&this.setStyle(g.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),this._hash=g.hash&&new Iu(typeof g.hash=="string"&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,a.extend({},g.fitBoundsOptions,{duration:0})))),this.resize(),g.attributionControl&&this.addControl(new gn({customAttribution:g.customAttribution})),this._logoControl=new Sc,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new a.Event(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new a.Event(`${s.dataType}dataloading`,s))})}_getMapId(){return this._mapId}addControl(g,s){if(s===void 0&&(s=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=g.onAdd(this);this._controls.push(g);const y=this._controlPositions[s];return s.indexOf("bottom")!==-1?y.insertBefore(h,y.firstChild):y.appendChild(h),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(g);return s>-1&&this._controls.splice(s,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const s=!this._moving;return s&&this.fire(new a.Event("movestart",g)).fire(new a.Event("move",g)),this.fire(new a.Event("resize",g)),s&&this.fire(new a.Event("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(a.LngLatBounds.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(g){return g==="auto"?a.window.navigator.language:Array.isArray(g)?g.length===0?void 0:g.map(s=>s==="auto"?a.window.navigator.language:s):g}setLanguage(g){const s=this._parseLanguage(g);if(!this.style||s===this._language)return this;this._language=s,this.style._reloadSources();for(const h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(g){return this.style&&g!==this._worldview?(this._worldview=g,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(g){return this._lazyInitEmptyStyle(),g?typeof g=="string"&&(g={name:g}):g=null,this._useExplicitProjection=!!g,this._prioritizeAndUpdateProjection(g,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const g=this.transform,s=g.projection.name;let h;s==="globe"&&g.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?(g.setMercatorFromTransition(),h=!0):s==="mercator"&&g.zoom<a.GLOBE_ZOOM_THRESHOLD_MAX&&(g.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(g,s){return this._updateProjection(g||s||{name:"mercator"})}_updateProjection(g){let s;if(s=g.name==="globe"&&this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(g),this.style.applyProjectionUpdate(),s){this.painter.clearBackgroundTiles();for(const h in this.style._sourceCaches)this.style._sourceCaches[h].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(g){return this.transform.locationPoint3D(a.LngLat.convert(g))}unproject(g){return this.transform.pointLocation3D(a.Point.convert(g))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(g,s,h){if(g==="mouseenter"||g==="mouseover"){let y=!1;const w=P=>{const I=s.filter($=>this.getLayer($)),O=I.length?this.queryRenderedFeatures(P.point,{layers:I}):[];O.length?y||(y=!0,h.call(this,new Co(g,this,P.originalEvent,{features:O}))):y=!1},T=()=>{y=!1};return{layers:new Set(s),listener:h,delegates:{mousemove:w,mouseout:T}}}if(g==="mouseleave"||g==="mouseout"){let y=!1;const w=P=>{const I=s.filter(O=>this.getLayer(O));(I.length?this.queryRenderedFeatures(P.point,{layers:I}):[]).length?y=!0:y&&(y=!1,h.call(this,new Co(g,this,P.originalEvent)))},T=P=>{y&&(y=!1,h.call(this,new Co(g,this,P.originalEvent)))};return{layers:new Set(s),listener:h,delegates:{mousemove:w,mouseout:T}}}{const y=w=>{const T=s.filter(I=>this.getLayer(I)),P=T.length?this.queryRenderedFeatures(w.point,{layers:T}):[];P.length&&(w.features=P,h.call(this,w),delete w.features)};return{layers:new Set(s),listener:h,delegates:{[g]:y}}}}on(g,s,h){if(h===void 0)return super.on(g,s);Array.isArray(s)||(s=[s]);const y=this._createDelegatedListener(g,s,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(y);for(const w in y.delegates)this.on(w,y.delegates[w]);return this}once(g,s,h){if(h===void 0)return super.once(g,s);Array.isArray(s)||(s=[s]);const y=this._createDelegatedListener(g,s,h);for(const w in y.delegates)this.once(w,y.delegates[w]);return this}off(g,s,h){if(h===void 0)return super.off(g,s);s=new Set(Array.isArray(s)?s:[s]);const y=(T,P)=>{if(T.size!==P.size)return!1;for(const I of T)if(!P.has(I))return!1;return!0},w=this._delegatedListeners?this._delegatedListeners[g]:void 0;return w&&(T=>{for(let P=0;P<T.length;P++){const I=T[P];if(I.listener===h&&y(I.layers,s)){for(const O in I.delegates)this.off(O,I.delegates[O]);return T.splice(P,1),this}}})(w),this}queryRenderedFeatures(g,s){return this.style?(s!==void 0||g===void 0||g instanceof a.Point||Array.isArray(g)||(s=g,g=void 0),this.style.queryRenderedFeatures(g=g||[[0,0],[this.transform.width,this.transform.height]],s=s||{},this.transform)):[]}querySourceFeatures(g,s){return this.style.querySourceFeatures(g,s)}isPointOnSurface(g){const{name:s}=this.transform.projection;return s!=="globe"&&s!=="mercator"&&a.warnOnce(`${s} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.Point.convert(g))}setStyle(g,s){return(s=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},s)).diff!==!1&&s.localIdeographFontFamily===this._localIdeographFontFamily&&s.localFontFamily===this._localFontFamily&&this.style&&g?(this._diffStyle(g,s),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._localFontFamily=s.localFontFamily,this._updateStyle(g,s))}_getUIString(g){const s=this._locale[g];if(s==null)throw new Error(`Missing UI string '${g}'`);return s}_updateStyle(g,s){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),g&&(this.style=new Ls(this,s||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g):this.style.loadJSON(g)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ls(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,s){if(typeof g=="string"){const h=this._requestManager.normalizeStyleURL(g),y=this._requestManager.transformRequest(h,a.ResourceType.Style);a.getJSON(y,(w,T)=>{w?this.fire(new a.ErrorEvent(w)):T&&this._updateDiff(T,s)})}else typeof g=="object"&&this._updateDiff(g,s)}_updateDiff(g,s){try{this.style.setState(g)&&this._update(!0)}catch(h){a.warnOnce(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(g,s)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.warnOnce("There is no style added to the map."),!1)}addSource(g,s){return this._lazyInitEmptyStyle(),this.style.addSource(g,s),this._update(!0)}isSourceLoaded(g){return!!this.style&&this.style._isSourceCacheLoaded(g)}areTilesLoaded(){const g=this.style&&this.style._sourceCaches;for(const s in g){const h=g[s]._tiles;for(const y in h){const w=h[y];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}addSourceType(g,s,h){this._lazyInitEmptyStyle(),this.style.addSourceType(g,s,h)}removeSource(g){return this.style.removeSource(g),this._updateTerrain(),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,s,{pixelRatio:h=1,sdf:y=!1,stretchX:w,stretchY:T,content:P}={}){if(this._lazyInitEmptyStyle(),s instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&s instanceof a.window.ImageBitmap){const{width:I,height:O,data:$}=a.exported.getImageData(s);this.style.addImage(g,{data:new a.RGBAImage({width:I,height:O},$),pixelRatio:h,stretchX:w,stretchY:T,content:P,sdf:y,version:0})}else if(s.width===void 0||s.height===void 0)this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:O}=s,$=s;this.style.addImage(g,{data:new a.RGBAImage({width:I,height:O},new Uint8Array($.data)),pixelRatio:h,stretchX:w,stretchY:T,content:P,sdf:y,version:0,userImage:$}),$.onAdd&&$.onAdd(this,g)}}updateImage(g,s){const h=this.style.getImage(g);if(!h)return void this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=s instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&s instanceof a.window.ImageBitmap?a.exported.getImageData(s):s,{width:w,height:T}=y;w!==void 0&&T!==void 0?w===h.data.width&&T===h.data.height?(h.data.replace(y.data,!(s instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&s instanceof a.window.ImageBitmap)),this.style.updateImage(g,h)):this.fire(new a.ErrorEvent(new Error(`The width and height of the updated image (${w}, ${T})
                must be that same as the previous version of the image
                (${h.data.width}, ${h.data.height})`))):this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g,s){a.getImage(this._requestManager.transformRequest(g,a.ResourceType.Image),(h,y)=>{s(h,y instanceof a.window.HTMLImageElement?a.exported.getImageData(y):y)})}listImages(){return this.style.listImages()}addLayer(g,s){return this._lazyInitEmptyStyle(),this.style.addLayer(g,s),this._update(!0)}moveLayer(g,s){return this.style.moveLayer(g,s),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}setLayerZoomRange(g,s,h){return this.style.setLayerZoomRange(g,s,h),this._update(!0)}setFilter(g,s,h={}){return this.style.setFilter(g,s,h),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,s,h,y={}){return this.style.setPaintProperty(g,s,h,y),this._update(!0)}getPaintProperty(g,s){return this.style.getPaintProperty(g,s)}setLayoutProperty(g,s,h,y={}){return this.style.setLayoutProperty(g,s,h,y),this._update(!0)}getLayoutProperty(g,s){return this.style.getLayoutProperty(g,s)}setLight(g,s={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,s),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(g),this.transform):0}setFeatureState(g,s){return this.style.setFeatureState(g,s),this._update()}removeFeatureState(g,s){return this.style.removeFeatureState(g,s),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,s=this._container.getBoundingClientRect().height||300;let h,y,w,T=this._container;for(;T&&(!y||!w);){const P=a.window.getComputedStyle(T).transform;P&&P!=="none"&&(h=P.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&h[0]!=="0"&&h[0]!=="1"&&(y=h[0]),h[3]&&h[3]!=="0"&&h[3]!=="1"&&(w=h[3])),T=T.parentElement}this._containerWidth=y?Math.abs(g/y):g,this._containerHeight=w?Math.abs(s/w):s}_detectMissingCSS(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=Z("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const s=this._canvasContainer=Z("div","mapboxgl-canvas-container",g);this._interactive&&s.classList.add("mapboxgl-interactive"),this._canvas=Z("canvas","mapboxgl-canvas",s),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=Z("div","mapboxgl-control-container",g),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{y[w]=Z("div",`mapboxgl-ctrl-${w}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,s){const h=a.exported.devicePixelRatio||1;this._canvas.width=h*Math.ceil(g),this._canvas.height=h*Math.ceil(s),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${s}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const s=this._markers.indexOf(g);s!==-1&&this._markers.splice(s,1)}_addPopup(g){this._popups.push(g)}_removePopup(g){const s=this._popups.indexOf(g);s!==-1&&this._popups.splice(s,1)}_setupPainter(){const g=a.extend({},R.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),s=this._useWebGL2&&this._canvas.getContext("webgl2",g),h=s||this._canvas.getContext("webgl",g)||this._canvas.getContext("experimental-webgl",g);h?(this._useWebGL2&&!s&&a.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),a.storeAuthState(h,!0),this.painter=new kl(h,this.transform,!!s),this.on("data",y=>{y.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.exported$1.testSupport(h)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let s;const h=this.painter.context.extTimerQuery,y=a.exported.now();if(this.listens("gpu-timing-frame")&&(s=h.createQueryEXT(),h.beginQueryEXT(h.TIME_ELAPSED_EXT,s)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],a.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],a.window.performance.now())),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjectionTransition();const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,O=this.transform.pitch,$=a.exported.now(),U=new a.EvaluationParameters(I,{now:$,fadeDuration:w,pitch:O,transition:this.style.getTransition()});this.style.update(U)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let T=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),T=this._updateAverageElevation(y),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):T=this._updateAverageElevation(y),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),s){const I=a.exported.now()-y;h.endQueryEXT(h.TIME_ELAPSED_EXT,s),setTimeout(()=>{const O=h.getQueryObjectEXT(s,h.QUERY_RESULT_EXT)/1e6;h.deleteQueryEXT(s),this.fire(new a.Event("gpu-timing-frame",{cpuTime:I,gpuTime:O})),a.window.performance.mark("frame-gpu",{startTime:y,detail:{gpuTime:O}})},50)}if(this.listens("gpu-timing-layer")){const I=this.painter.collectGpuTimers();setTimeout(()=>{const O=this.painter.queryGpuTimers(I);this.fire(new a.Event("gpu-timing-layer",{layerTimes:O}))},50)}if(this.listens("gpu-timing-deferred-render")){const I=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const O=this.painter.queryGpuTimeDeferredRender(I);this.fire(new a.Event("gpu-timing-deferred-render",{gpuTime:O}))},50)}const P=this._sourcesDirty||this._styleDirty||this._placementDirty||T;if(P||this._repaint)this.triggerRepaint();else{const I=!this.isMoving()&&this.loaded();if(I&&(T=this._updateAverageElevation(y,!0)),T)this.triggerRepaint();else if(this._triggerFrame(!1),I&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const O=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:O})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||P||(this._fullyLoaded=!0,a.LivePerformanceUtils.mark(a.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&a.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(g){for(const s of this._markers)g&&!this.getRenderWorldCopies()&&(s._lngLat=s._lngLat.wrap()),s._update();for(const s of this._popups)!g||this.getRenderWorldCopies()||s._trackPointer||(s._lngLat=s._lngLat.wrap()),s._update()}_updateAverageElevation(g,s=!1){const h=y=>(this.transform.averageElevation=y,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&h(0);if((s||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const y=this.transform.averageElevation;let w=this.transform.sampleAverageElevation(),T=!1;this.transform.elevation&&(T=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=g;const P=Math.abs(y-w);if(P>1){if(this._isInitialLoad||T)return this._averageElevation.jumpTo(w),h(w);this._averageElevation.easeTo(w,g,300)}else if(P>1e-4)return this._averageElevation.jumpTo(w),h(w)}return!!this._averageElevation.isEasing(g)&&h(this._averageElevation.getValue(g))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,g=>{if(g&&(g.message===a.AUTH_ERR_MSG||g.status===401)){const s=this.painter.context.gl;a.storeAuthState(s,!1),this._logoControl instanceof Sc&&this._logoControl._updateLogo(),s&&s.clear(s.DEPTH_BUFFER_BIT|s.COLOR_BUFFER_BIT|s.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const g=this._isDragging();this.painter.updateTerrain(this.style,g)}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),s=this.painter.getCanvasCopiesAndTimestamps();s.timeStamps.push(performance.now());const h=this.painter.context.gl,y=h.createFramebuffer();function w(T){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,T,0);const P=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,P),P}return h.bindFramebuffer(h.FRAMEBUFFER,y),this._canvasPixelComparison(w(g),s.canvasCopies.map(w),s.timeStamps)}_canvasPixelComparison(g,s,h){let y=h[1]-h[0];const w=g.length/4;for(let T=0;T<s.length;T++){const P=s[T];let I=0;for(let O=0;O<P.length;O+=4)P[O]===g[O]&&P[O+1]===g[O+1]&&P[O+2]===g[O+2]&&P[O+3]===g[O+3]&&(I+=1);y+=(h[T+2]-h[T+1])*(1-I/w)}return y}remove(){this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1),a.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=a.exported.frame(s=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(s)}))}_preloadTiles(g){const s=this.style?Object.values(this.style._sourceCaches):[];return a.asyncAll(s,(h,y)=>h._preloadTiles(g,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}_onVisibilityChange(){a.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(g){this._showTileAABBs!==g&&(this._showTileAABBs=g,g&&this._update())}_setCacheLimits(g,s){a.setCacheLimits(g,s)}get version(){return a.version}},NavigationControl:class{constructor(g){this.options=a.extend({},Dl,g),this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",s=>{this._map&&this._map.zoomIn({},{originalEvent:s})}),Z("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",s=>{this._map&&this._map.zoomOut({},{originalEvent:s})}),Z("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",s=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:s}):h.resetNorth({},{originalEvent:s}))}),this._compassIcon=Z("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const g=this._map;if(!g)return;const s=g.getZoom(),h=s===g.getMaxZoom(),y=s===g.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const g=this._map;if(!g)return;const s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(g.transform.pitch*(Math.PI/180)),.5)}) rotateX(${g.transform.pitch}deg) rotateZ(${g.transform.angle*(180/Math.PI)}deg)`:`rotate(${g.transform.angle*(180/Math.PI)}deg)`;g._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=s)})}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),g.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&g.on("pitch",this._rotateCompassArrow),g.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ja(g,this._compass,this.options.visualizePitch)),this._container}onRemove(){const g=this._map;g&&(this._container.remove(),this.options.showZoom&&g.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&g.off("pitch",this._rotateCompassArrow),g.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(g,s){const h=Z("button",g,this._container);return h.type="button",h.addEventListener("click",s),h}_setButtonTitle(g,s){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${s}`);g.setAttribute("aria-label",h),g.firstElementChild&&g.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends a.Evented{constructor(g){super(),this.options=a.extend({geolocation:a.window.navigator.geolocation},Ys,g),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=pi(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(g){return this._map=g,this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(g){const s=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,g(h)};this._supportsGeolocation!==void 0?g(this._supportsGeolocation):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(h=>s(h.state!=="denied")).catch(()=>s()):s()}_isOutOfMapMaxBounds(g){const s=this._map.getMaxBounds(),h=g.coords;return!!s&&(h.longitude<s.getWest()||h.longitude>s.getEast()||h.latitude<s.getSouth()||h.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(g),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(g),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",g)),this._finish()}}_updateCamera(g){const s=new a.LngLat(g.coords.longitude,g.coords.latitude),h=g.coords.accuracy,y=this._map.getBearing(),w=a.extend({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(h),w,{geolocateSource:!0})}_updateMarker(g){if(g){const s=new a.LngLat(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map.transform,s=a.mercatorZfromAltitude(1,g._center.lat)*g.worldSize,h=Math.ceil(2*this._accuracy*s);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(g.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(g.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=Z("button","mapboxgl-ctrl-geolocate",this._container),Z("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",g===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Z("div","mapboxgl-user-location"),this._dotElement.appendChild(Z("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Z("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new un({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Z("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new un({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:g.absolute===!0&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(g={maximumAge:6e5,timeout:0},this._noTimeout=!0):(g=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};a.window.DeviceMotionEvent!==void 0&&typeof a.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(s=>{s==="granted"&&g()}).catch(console.error):g()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientation),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:gn,ScaleControl:class{constructor(g){this.options=a.extend({},Na,g),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),a.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const g=this.options.maxWidth||100,s=this._map,h=s._containerHeight/2,y=s._containerWidth/2-g/2,w=s.unproject([y,h]),T=s.unproject([y+g,h]),P=w.distanceTo(T);if(this.options.unit==="imperial"){const I=3.2808*P;I>5280?this._setScale(g,I/5280,"mile"):this._setScale(g,I,"foot")}else this.options.unit==="nautical"?this._setScale(g,P/1852,"nautical-mile"):P>=1e3?this._setScale(g,P/1e3,"kilometer"):this._setScale(g,P,"meter")}_setScale(g,s,h){this._map._requestDomTask(()=>{const y=function(T){const P=Math.pow(10,`${Math.floor(T)}`.length-1);let I=T/P;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(O){const $=Math.pow(10,Math.ceil(-Math.log(O)/Math.LN10));return Math.round(O*$)/$}(I),P*I}(s),w=y/s;this._container.innerHTML=this._isNumberFormatSupported&&h!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:h}).format(y):`${y}&nbsp;${Nh[h]}`,this._container.style.width=g*w+"px"})}onAdd(g){return this._map=g,this._language=g.getLanguage(),this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(g){this._language=g,this._update()}setUnit(g){this.options.unit=g,this._update()}},FullscreenControl:class{constructor(g){this._fullscreen=!1,g&&g.container&&(g.container instanceof a.window.HTMLElement?this._container=g.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=Z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=Z("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Z("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(g){super(),this.options=a.extend(Object.create(ul),g),a.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&g.on("preclick",this._onClose),this.options.closeOnMove&&g.on("move",this._onClose),g.on("remove",this.remove),this._update(),g._addPopup(this),this._focusFirstElement(),this._trackPointer?(g.on("mousemove",this._onMouseEvent),g.on("mouseup",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")):g.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const g=this._map;return g&&(g.off("move",this._update),g.off("move",this._onClose),g.off("preclick",this._onClose),g.off("click",this._onClose),g.off("remove",this.remove),g.off("mousemove",this._onMouseEvent),g.off("mouseup",this._onMouseEvent),g.off("drag",this._onMouseEvent),g._canvasContainer&&g._canvasContainer.classList.remove("mapboxgl-track-pointer"),g._removePopup(this),this._map=void 0),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(g){this._lngLat=a.LngLat.convert(g),this._pos=null,this._trackPointer=!1,this._update();const s=this._map;return s&&(s.on("move",this._update),s.off("mousemove",this._onMouseEvent),s._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const g=this._map;return g&&(g.off("move",this._update),g.on("mousemove",this._onMouseEvent),g.on("drag",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(a.window.document.createTextNode(g))}setHTML(g){const s=a.window.document.createDocumentFragment(),h=a.window.document.createElement("body");let y;for(h.innerHTML=g;y=h.firstChild,y;)s.appendChild(y);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){let s=this._content;if(s)for(;s.hasChildNodes();)s.firstChild&&s.removeChild(s.firstChild);else s=this._content=Z("div","mapboxgl-popup-content",this._container||void 0);if(s.appendChild(g),this.options.closeButton){const h=this._closeButton=Z("button","mapboxgl-popup-close-button",s);h.type="button",h.setAttribute("aria-label","Close popup"),h.setAttribute("aria-hidden","true"),h.innerHTML="&#215;",h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let s;return this._classList.delete(g)?s=!1:(this._classList.add(g),s=!0),this._updateClassList(),s}_onMouseEvent(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const s=this._map,h=this._container,y=this._pos;if(!s||!h||!y)return"bottom";const w=h.offsetWidth,T=h.offsetHeight,P=y.x<w/2,I=y.x>s.transform.width-w/2;if(y.y+g<T)return P?"top-left":I?"top-right":"top";if(y.y>s.transform.height-T){if(P)return"bottom-left";if(I)return"bottom-right"}return P?"left":I?"right":"bottom"}_updateClassList(){const g=this._container;if(!g)return;const s=[...this._classList];s.push("mapboxgl-popup"),this._anchor&&s.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&s.push("mapboxgl-popup-track-pointer"),g.className=s.join(" ")}_update(g){const s=this._map,h=this._content;if(!s||!this._lngLat&&!this._trackPointer||!h)return;let y=this._container;if(y||(y=this._container=Z("div","mapboxgl-popup",s.getContainer()),this._tip=Z("div","mapboxgl-popup-tip",y),y.appendChild(h)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),s.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Rl(this._lngLat,this._pos,s.transform)),!this._trackPointer||g){const w=this._pos=this._trackPointer&&g?g:s.project(this._lngLat),T=Bu(this.options.offset),P=this._anchor=this._getAnchor(T.y),I=Bu(this.options.offset,P),O=w.add(I).round();s._requestDomTask(()=>{this._container&&P&&(this._container.style.transform=`${Ol[P]} translate(${O.x}px,${O.y}px)`)})}if(!this._marker&&s._showingGlobe()){const w=a.isLngLatBehindGlobe(s.transform,this._lngLat)?0:1;this._setOpacity(w)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(kc);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._container&&(this._container.style.opacity=`${g}`),this._content&&(this._content.style.pointerEvents=g?"auto":"none")}},Marker:un,Style:Ls,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:Ra,Evented:a.Evented,config:a.config,prewarm:function(){Cn().acquire(Ln)},clearPrewarmedResources:function(){const g=or;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(Ln),or=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(g){a.config.ACCESS_TOKEN=g},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(g){a.config.API_URL=g},get workerCount(){return ln.workerCount},set workerCount(g){ln.workerCount=g},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){a.config.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){a.clearTileCache(g)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return hl});var C=m;return C})}(T_)),T_.exports}var uB=cB();const lu=cu(uB);var hB=1e-7;function Vx(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function v6(n,t){if(n===t)return!0;if(Vx(n)&&Vx(t)){if(n.length!==t.length)return!1;for(var r=0;r<n.length;++r)if(!v6(n[r],t[r]))return!1;return!0}return Math.abs(n-t)<=hB}function s_(n,t,r){return Math.max(t,Math.min(r,n))}function ty(n,t,r){return Vx(n)?n.map(function(l,d){return ty(l,t[d],r)}):r*t+(1-r)*n}function Jl(n,t){if(!n)throw new Error(t||"react-map-gl: assertion failed.")}function q4(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);t&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(n,d).enumerable})),r.push.apply(r,l)}return r}function G4(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q4(Object(r),!0).forEach(function(l){Vn(n,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):q4(Object(r)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(r,l))})}return n}var Kf={minZoom:0,maxZoom:24,minPitch:0,maxPitch:85},Yv={pitch:0,bearing:0,altitude:1.5},Z4=5,dB=1.2,Im=function(){function n(t){var r=t.width,l=t.height,d=t.latitude,m=t.longitude,x=t.zoom,C=t.bearing,a=C===void 0?Yv.bearing:C,M=t.pitch,R=M===void 0?Yv.pitch:M,j=t.altitude,F=j===void 0?Yv.altitude:j,Z=t.maxZoom,Y=Z===void 0?Kf.maxZoom:Z,ne=t.minZoom,se=ne===void 0?Kf.minZoom:ne,xe=t.maxPitch,Se=xe===void 0?Kf.maxPitch:xe,_e=t.minPitch,Ie=_e===void 0?Kf.minPitch:_e,Me=t.transitionDuration,Ve=t.transitionEasing,Ke=t.transitionInterpolator,et=t.transitionInterruption,qe=t.startPanLngLat,ge=t.startZoomLngLat,We=t.startRotatePos,Ue=t.startBearing,lt=t.startPitch,ht=t.startZoom;Od(this,n),Jl(Number.isFinite(r),"`width` must be supplied"),Jl(Number.isFinite(l),"`height` must be supplied"),Jl(Number.isFinite(m),"`longitude` must be supplied"),Jl(Number.isFinite(d),"`latitude` must be supplied"),Jl(Number.isFinite(x),"`zoom` must be supplied"),this._viewportProps=this._applyConstraints({width:r,height:l,latitude:d,longitude:m,zoom:x,bearing:a,pitch:R,altitude:F,maxZoom:Y,minZoom:se,maxPitch:Se,minPitch:Ie,transitionDuration:Me,transitionEasing:Ve,transitionInterpolator:Ke,transitionInterruption:et}),this._state={startPanLngLat:qe,startZoomLngLat:ge,startRotatePos:We,startBearing:Ue,startPitch:lt,startZoom:ht}}return Dd(n,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getState",value:function(){return this._state}},{key:"panStart",value:function(r){var l=r.pos;return this._getUpdatedMapState({startPanLngLat:this._unproject(l)})}},{key:"pan",value:function(r){var l=r.pos,d=r.startPos,m=this._state.startPanLngLat||this._unproject(d);if(!m)return this;var x=this._calculateNewLngLat({startPanLngLat:m,pos:l}),C=Go(x,2),a=C[0],M=C[1];return this._getUpdatedMapState({longitude:a,latitude:M})}},{key:"panEnd",value:function(){return this._getUpdatedMapState({startPanLngLat:null})}},{key:"rotateStart",value:function(r){var l=r.pos;return this._getUpdatedMapState({startRotatePos:l,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(r){var l=r.pos,d=r.deltaAngleX,m=d===void 0?0:d,x=r.deltaAngleY,C=x===void 0?0:x,a=this._state,M=a.startRotatePos,R=a.startBearing,j=a.startPitch;if(!Number.isFinite(R)||!Number.isFinite(j))return this;var F;return l?F=this._calculateNewPitchAndBearing(G4(G4({},this._getRotationParams(l,M)),{},{startBearing:R,startPitch:j})):F={bearing:R+m,pitch:j+C},this._getUpdatedMapState(F)}},{key:"rotateEnd",value:function(){return this._getUpdatedMapState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(r){var l=r.pos;return this._getUpdatedMapState({startZoomLngLat:this._unproject(l),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(r){var l=r.pos,d=r.startPos,m=r.scale;Jl(m>0,"`scale` must be a positive number");var x=this._state,C=x.startZoom,a=x.startZoomLngLat;Number.isFinite(C)||(C=this._viewportProps.zoom,a=this._unproject(d)||this._unproject(l)),Jl(a,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var M=this._calculateNewZoom({scale:m,startZoom:C||0}),R=new ru(Object.assign({},this._viewportProps,{zoom:M})),j=R.getMapCenterByLngLatPosition({lngLat:a,pos:l}),F=Go(j,2),Z=F[0],Y=F[1];return this._getUpdatedMapState({zoom:M,longitude:Z,latitude:Y})}},{key:"zoomEnd",value:function(){return this._getUpdatedMapState({startZoomLngLat:null,startZoom:null})}},{key:"_getUpdatedMapState",value:function(r){return new n(Object.assign({},this._viewportProps,this._state,r))}},{key:"_applyConstraints",value:function(r){var l=r.maxZoom,d=r.minZoom,m=r.zoom;r.zoom=s_(m,d,l);var x=r.maxPitch,C=r.minPitch,a=r.pitch;return r.pitch=s_(a,C,x),Object.assign(r,Oz(r)),r}},{key:"_unproject",value:function(r){var l=new ru(this._viewportProps);return r&&l.unproject(r)}},{key:"_calculateNewLngLat",value:function(r){var l=r.startPanLngLat,d=r.pos,m=new ru(this._viewportProps);return m.getMapCenterByLngLatPosition({lngLat:l,pos:d})}},{key:"_calculateNewZoom",value:function(r){var l=r.scale,d=r.startZoom,m=this._viewportProps,x=m.maxZoom,C=m.minZoom,a=d+Math.log2(l);return s_(a,C,x)}},{key:"_calculateNewPitchAndBearing",value:function(r){var l=r.deltaScaleX,d=r.deltaScaleY,m=r.startBearing,x=r.startPitch;d=s_(d,-1,1);var C=this._viewportProps,a=C.minPitch,M=C.maxPitch,R=m+180*l,j=x;return d>0?j=x+d*(M-x):d<0&&(j=x-d*(a-x)),{pitch:j,bearing:R}}},{key:"_getRotationParams",value:function(r,l){var d=r[0]-l[0],m=r[1]-l[1],x=r[1],C=l[1],a=this._viewportProps,M=a.width,R=a.height,j=d/M,F=0;return m>0?Math.abs(R-C)>Z4&&(F=m/(C-R)*dB):m<0&&C>Z4&&(F=1-x/C),F=Math.min(1,Math.max(-1,F)),{deltaScaleX:j,deltaScaleY:F}}}]),n}();function fB(n){return n[0].toLowerCase()+n.slice(1)}function pB(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kf;for(var r in t){var l=r.slice(0,3),d=fB(r.slice(3));if(l==="min"&&n[d]<t[r]||l==="max"&&n[d]>t[r])return!1}return!0}function H4(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);t&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(n,d).enumerable})),r.push.apply(r,l)}return r}function K4(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H4(Object(r),!0).forEach(function(l){Vn(n,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):H4(Object(r)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(r,l))})}return n}var Gm=He.createContext({viewport:null,map:null,container:null,onViewportChange:null,onViewStateChange:null,eventManager:null}),nb=Gm.Provider;function mB(n){var t=n.value,r=n.children,l=He.useState(null),d=Go(l,2),m=d[0],x=d[1],C=He.useContext(Gm);return t=K4(K4({setMap:x},C),{},{map:C&&C.map||m},t),He.createElement(nb,{value:t},r)}Gm.Provider=mB;var Wx=typeof window<"u"?He.useLayoutEffect:He.useEffect;function My(n,t){var r=t.longitude,l=t.latitude;return n&&n.queryTerrainElevation&&n.queryTerrainElevation([r,l])||0}function X4(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);t&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(n,d).enumerable})),r.push.apply(r,l)}return r}function Yl(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X4(Object(r),!0).forEach(function(l){Vn(n,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):X4(Object(r)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(r,l))})}return n}var gB="https://visgl.github.io/react-map-gl/docs/get-started/mapbox-tokens",x6="A valid API access token is required to use Mapbox data";function _B(){}function w6(n){var t=n.map,r=n.props,l=n.width,d=n.height,m=Yl(Yl(Yl({},r),r.viewState),{},{width:l,height:d});return m.position=[0,0,My(t,m)],new ru(m)}var yB=401,Y4={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},vB=Object.assign({},cp.propTypes,{width:pt.oneOfType([pt.number,pt.string]),height:pt.oneOfType([pt.number,pt.string]),onResize:pt.func,disableTokenWarning:pt.bool,visible:pt.bool,className:pt.string,style:pt.object,visibilityConstraints:pt.object}),xB=Object.assign({},cp.defaultProps,{disableTokenWarning:!1,visible:!0,onResize:_B,className:"",style:null,visibilityConstraints:Kf});function wB(){var n={position:"absolute",left:0,top:0};return He.createElement("div",{key:"warning",id:"no-token-warning",style:n},He.createElement("h3",{key:"header"},x6),He.createElement("div",{key:"text"},"For information on setting up your basemap, read"),He.createElement("a",{key:"link",href:gB},"Note on Map Tokens"))}function bB(n){return{getMap:function(){return n.current&&n.current.getMap()},queryRenderedFeatures:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=n.current&&n.current.getMap();return d&&d.queryRenderedFeatures(r,l)}}}var zd=He.forwardRef(function(n,t){var r=He.useState(!0),l=Go(r,2),d=l[0],m=l[1],x=He.useState({width:0,height:0}),C=Go(x,2),a=C[0],M=C[1],R=He.useRef(null),j=He.useRef(null),F=He.useRef(null),Z=He.useRef(null),Y=He.useContext(Gm);Wx(function(){if(zd.supported()){var ge=new cp(Yl(Yl(Yl({},n),a),{},{mapboxgl:lu,container:j.current,onError:function(lt){var ht=lt.error&&lt.error.status||lt.status;ht===yB&&d&&(console.error(x6),m(!1)),n.onError(lt)}}));R.current=ge,Y&&Y.setMap&&Y.setMap(ge.getMap());var We=new tB(function(Ue){if(Ue[0].contentRect){var lt=Ue[0].contentRect,ht=lt.width,Wt=lt.height;M({width:ht,height:Wt}),n.onResize({width:ht,height:Wt})}});return We.observe(F.current),function(){ge.finalize(),R.current=null,We.disconnect()}}},[]),Wx(function(){R.current&&R.current.setProps(Yl(Yl({},n),a))});var ne=R.current&&R.current.getMap();He.useImperativeHandle(t,function(){return bB(R)},[]);var se=He.useCallback(function(ge){var We=ge.target;We===Z.current&&We.scrollTo(0,0)},[]),xe=ne&&He.createElement(nb,{value:Yl(Yl({},Y),{},{viewport:Y.viewport||w6(Yl({map:ne,props:n},a)),map:ne,container:Y.container||F.current})},He.createElement("div",{key:"map-overlays",className:"overlays",ref:Z,style:Y4,onScroll:se},n.children)),Se=n.className,_e=n.width,Ie=n.height,Me=n.style,Ve=n.visibilityConstraints,Ke=Object.assign({position:"relative"},Me,{width:_e,height:Ie}),et=n.visible&&pB(n.viewState||n,Ve),qe=Object.assign({},Y4,{visibility:et?"inherit":"hidden"});return He.createElement("div",{key:"map-container",ref:F,style:Ke},He.createElement("div",{key:"map-mapbox",ref:j,style:qe,className:Se}),xe,!d&&!n.disableTokenWarning&&He.createElement(wB,null))});zd.supported=function(){return lu&&lu.supported()};zd.propTypes=vB;zd.defaultProps=xB;function EB(n,t){var r;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(r=TB(n))||t){r&&(n=r);var l=0,d=function(){};return{s:d,n:function(){return l>=n.length?{done:!0}:{done:!1,value:n[l++]}},e:function(M){throw M},f:d}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,x=!1,C;return{s:function(){r=n[Symbol.iterator]()},n:function(){var M=r.next();return m=M.done,M},e:function(M){x=!0,C=M},f:function(){try{!m&&r.return!=null&&r.return()}finally{if(x)throw C}}}}function TB(n,t){if(n){if(typeof n=="string")return J4(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return J4(n,t)}}function J4(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,l=new Array(t);r<t;r++)l[r]=n[r];return l}var b6=function(){function n(){Od(this,n),Vn(this,"propNames",[])}return Dd(n,[{key:"arePropsEqual",value:function(r,l){var d=EB(this.propNames||[]),m;try{for(d.s();!(m=d.n()).done;){var x=m.value;if(!v6(r[x],l[x]))return!1}}catch(C){d.e(C)}finally{d.f()}return!0}},{key:"initializeProps",value:function(r,l){return{start:r,end:l}}},{key:"interpolateProps",value:function(r,l,d){Jl(!1,"interpolateProps is not implemented")}},{key:"getDuration",value:function(r,l){return l.transitionDuration}}]),n}();function nh(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function qx(n,t){return qx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,l){return r.__proto__=l,r},qx(n,t)}function rb(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),t&&qx(n,t)}function ib(n,t){if(t&&(zm(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nh(n)}function Pd(n){return Pd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pd(n)}var CB={longitude:1,bearing:1};function ny(n){return Number.isFinite(n)||Array.isArray(n)}function SB(n){return n in CB}function Gx(n,t,r){return SB(n)&&Math.abs(r-t)>180&&(r=r<0?r+360:r-360),r}function Jv(n,t){var r;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(r=kB(n))||t){r&&(n=r);var l=0,d=function(){};return{s:d,n:function(){return l>=n.length?{done:!0}:{done:!1,value:n[l++]}},e:function(M){throw M},f:d}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,x=!1,C;return{s:function(){r=n[Symbol.iterator]()},n:function(){var M=r.next();return m=M.done,M},e:function(M){x=!0,C=M},f:function(){try{!m&&r.return!=null&&r.return()}finally{if(x)throw C}}}}function kB(n,t){if(n){if(typeof n=="string")return Q4(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Q4(n,t)}}function Q4(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,l=new Array(t);r<t;r++)l[r]=n[r];return l}function MB(n){var t=AB();return function(){var l=Pd(n),d;if(t){var m=Pd(this).constructor;d=Reflect.construct(l,arguments,m)}else d=l.apply(this,arguments);return ib(this,d)}}function AB(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var PB=["longitude","latitude","zoom","bearing","pitch"],IB=["latitude","longitude","zoom","width","height"],eE=["bearing","pitch"],LB={speed:1.2,curve:1.414};(function(n){rb(r,n);var t=MB(r);function r(){var l,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Od(this,r),l=t.call(this),Vn(nh(l),"propNames",PB),l.props=Object.assign({},LB,d),l}return Dd(r,[{key:"initializeProps",value:function(d,m){var x={},C={},a=Jv(IB),M;try{for(a.s();!(M=a.n()).done;){var R=M.value,j=d[R],F=m[R];Jl(ny(j)&&ny(F),"".concat(R," must be supplied for transition")),x[R]=j,C[R]=Gx(R,j,F)}}catch(Se){a.e(Se)}finally{a.f()}var Z=Jv(eE),Y;try{for(Z.s();!(Y=Z.n()).done;){var ne=Y.value,se=d[ne]||0,xe=m[ne]||0;x[ne]=se,C[ne]=Gx(ne,se,xe)}}catch(Se){Z.e(Se)}finally{Z.f()}return{start:x,end:C}}},{key:"interpolateProps",value:function(d,m,x){var C=zz(d,m,x,this.props),a=Jv(eE),M;try{for(a.s();!(M=a.n()).done;){var R=M.value;C[R]=ty(d[R],m[R],x)}}catch(j){a.e(j)}finally{a.f()}return C}},{key:"getDuration",value:function(d,m){var x=m.transitionDuration;return x==="auto"&&(x=Bz(d,m,this.props)),x}}]),r})(b6);function tE(n,t){var r;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(r=RB(n))||t){r&&(n=r);var l=0,d=function(){};return{s:d,n:function(){return l>=n.length?{done:!0}:{done:!1,value:n[l++]}},e:function(M){throw M},f:d}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,x=!1,C;return{s:function(){r=n[Symbol.iterator]()},n:function(){var M=r.next();return m=M.done,M},e:function(M){x=!0,C=M},f:function(){try{!m&&r.return!=null&&r.return()}finally{if(x)throw C}}}}function RB(n,t){if(n){if(typeof n=="string")return nE(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nE(n,t)}}function nE(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,l=new Array(t);r<t;r++)l[r]=n[r];return l}function OB(n){var t=DB();return function(){var l=Pd(n),d;if(t){var m=Pd(this).constructor;d=Reflect.construct(l,arguments,m)}else d=l.apply(this,arguments);return ib(this,d)}}function DB(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var zB=["longitude","latitude","zoom","bearing","pitch"],g0=function(n){rb(r,n);var t=OB(r);function r(){var l,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Od(this,r),l=t.call(this),Array.isArray(d)&&(d={transitionProps:d}),l.propNames=d.transitionProps||zB,d.around&&(l.around=d.around),l}return Dd(r,[{key:"initializeProps",value:function(d,m){var x={},C={};if(this.around){x.around=this.around;var a=new ru(d).unproject(this.around);Object.assign(C,m,{around:new ru(m).project(a),aroundLngLat:a})}var M=tE(this.propNames),R;try{for(M.s();!(R=M.n()).done;){var j=R.value,F=d[j],Z=m[j];Jl(ny(F)&&ny(Z),"".concat(j," must be supplied for transition")),x[j]=F,C[j]=Gx(j,F,Z)}}catch(Y){M.e(Y)}finally{M.f()}return{start:x,end:C}}},{key:"interpolateProps",value:function(d,m,x){var C={},a=tE(this.propNames),M;try{for(a.s();!(M=a.n()).done;){var R=M.value;C[R]=ty(d[R],m[R],x)}}catch(ne){a.e(ne)}finally{a.f()}if(m.around){var j=new ru(Object.assign({},m,C)).getMapCenterByLngLatPosition({lngLat:m.aroundLngLat,pos:ty(d.around,m.around,x)}),F=Go(j,2),Z=F[0],Y=F[1];C.longitude=Z,C.latitude=Y}return C}}]),r}(b6),_0=function(){};function BB(n,t){var r=n(t);return function(l){return 1/(1-r)*(n(l*(1-t)+t)-r)}}var y0={BREAK:1,SNAP_TO_END:2,IGNORE:3,UPDATE:4},jB={transitionDuration:0,transitionEasing:function(t){return t},transitionInterpolator:new g0,transitionInterruption:y0.BREAK,onTransitionStart:_0,onTransitionInterrupt:_0,onTransitionEnd:_0},ob=function(){function n(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Od(this,n),Vn(this,"_animationFrame",null),Vn(this,"_onTransitionFrame",function(){t._animationFrame=requestAnimationFrame(t._onTransitionFrame),t._updateViewport()}),this.props=null,this.onViewportChange=r.onViewportChange||_0,this.onStateChange=r.onStateChange||_0,this.time=r.getTime||Date.now}return Dd(n,[{key:"getViewportInTransition",value:function(){return this._animationFrame?this.state.propsInTransition:null}},{key:"processViewportChange",value:function(r){var l=this.props;if(this.props=r,!l||this._shouldIgnoreViewportChange(l,r))return!1;if(this._isTransitionEnabled(r)){var d=Object.assign({},l),m=Object.assign({},r);if(this._isTransitionInProgress()&&(l.onTransitionInterrupt(),this.state.interruption===y0.SNAP_TO_END?Object.assign(d,this.state.endProps):Object.assign(d,this.state.propsInTransition),this.state.interruption===y0.UPDATE)){var x=this.time(),C=(x-this.state.startTime)/this.state.duration;m.transitionDuration=this.state.duration-(x-this.state.startTime),m.transitionEasing=BB(this.state.easing,C),m.transitionInterpolator=d.transitionInterpolator}return m.onTransitionStart(),this._triggerTransition(d,m),!0}return this._isTransitionInProgress()&&(l.onTransitionInterrupt(),this._endTransition()),!1}},{key:"_isTransitionInProgress",value:function(){return!!this._animationFrame}},{key:"_isTransitionEnabled",value:function(r){var l=r.transitionDuration,d=r.transitionInterpolator;return(l>0||l==="auto")&&!!d}},{key:"_isUpdateDueToCurrentTransition",value:function(r){return this.state.propsInTransition?this.state.interpolator.arePropsEqual(r,this.state.propsInTransition):!1}},{key:"_shouldIgnoreViewportChange",value:function(r,l){return r?this._isTransitionInProgress()?this.state.interruption===y0.IGNORE||this._isUpdateDueToCurrentTransition(l):this._isTransitionEnabled(l)?l.transitionInterpolator.arePropsEqual(r,l):!0:!0}},{key:"_triggerTransition",value:function(r,l){Jl(this._isTransitionEnabled(l)),this._animationFrame&&cancelAnimationFrame(this._animationFrame);var d=l.transitionInterpolator,m=d.getDuration?d.getDuration(r,l):l.transitionDuration;if(m!==0){var x=l.transitionInterpolator.initializeProps(r,l),C={inTransition:!0,isZooming:r.zoom!==l.zoom,isPanning:r.longitude!==l.longitude||r.latitude!==l.latitude,isRotating:r.bearing!==l.bearing||r.pitch!==l.pitch};this.state={duration:m,easing:l.transitionEasing,interpolator:l.transitionInterpolator,interruption:l.transitionInterruption,startTime:this.time(),startProps:x.start,endProps:x.end,animation:null,propsInTransition:{}},this._onTransitionFrame(),this.onStateChange(C)}}},{key:"_endTransition",value:function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=null),this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1})}},{key:"_updateViewport",value:function(){var r=this.time(),l=this.state,d=l.startTime,m=l.duration,x=l.easing,C=l.interpolator,a=l.startProps,M=l.endProps,R=!1,j=(r-d)/m;j>=1&&(j=1,R=!0),j=x(j);var F=C.interpolateProps(a,M,j),Z=new Im(Object.assign({},this.props,F));this.state.propsInTransition=Z.getViewportProps(),this.onViewportChange(this.state.propsInTransition,this.props),R&&(this._endTransition(),this.props.onTransitionEnd())}}]),n}();Vn(ob,"defaultProps",jB);var Qv={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */var rE;function NB(){return rE||(rE=1,function(n){(function(t,r,l,d){var m=["","webkit","Moz","MS","ms","o"],x=r.createElement("div"),C="function",a=Math.round,M=Math.abs,R=Date.now;function j(ie,ae,Le){return setTimeout(_e(ie,Le),ae)}function F(ie,ae,Le){return Array.isArray(ie)?(Z(ie,Le[ae],Le),!0):!1}function Z(ie,ae,Le){var tt;if(ie)if(ie.forEach)ie.forEach(ae,Le);else if(ie.length!==d)for(tt=0;tt<ie.length;)ae.call(Le,ie[tt],tt,ie),tt++;else for(tt in ie)ie.hasOwnProperty(tt)&&ae.call(Le,ie[tt],tt,ie)}function Y(ie,ae,Le){var tt="DEPRECATED METHOD: "+ae+`
`+Le+` AT 
`;return function(){var zt=new Error("get-stack-trace"),an=zt&&zt.stack?zt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Qn=t.console&&(t.console.warn||t.console.log);return Qn&&Qn.call(t.console,tt,an),ie.apply(this,arguments)}}var ne;typeof Object.assign!="function"?ne=function(ae){if(ae===d||ae===null)throw new TypeError("Cannot convert undefined or null to object");for(var Le=Object(ae),tt=1;tt<arguments.length;tt++){var zt=arguments[tt];if(zt!==d&&zt!==null)for(var an in zt)zt.hasOwnProperty(an)&&(Le[an]=zt[an])}return Le}:ne=Object.assign;var se=Y(function(ae,Le,tt){for(var zt=Object.keys(Le),an=0;an<zt.length;)(!tt||tt&&ae[zt[an]]===d)&&(ae[zt[an]]=Le[zt[an]]),an++;return ae},"extend","Use `assign`."),xe=Y(function(ae,Le){return se(ae,Le,!0)},"merge","Use `assign`.");function Se(ie,ae,Le){var tt=ae.prototype,zt;zt=ie.prototype=Object.create(tt),zt.constructor=ie,zt._super=tt,Le&&ne(zt,Le)}function _e(ie,ae){return function(){return ie.apply(ae,arguments)}}function Ie(ie,ae){return typeof ie==C?ie.apply(ae&&ae[0]||d,ae):ie}function Me(ie,ae){return ie===d?ae:ie}function Ve(ie,ae,Le){Z(ge(ae),function(tt){ie.addEventListener(tt,Le,!1)})}function Ke(ie,ae,Le){Z(ge(ae),function(tt){ie.removeEventListener(tt,Le,!1)})}function et(ie,ae){for(;ie;){if(ie==ae)return!0;ie=ie.parentNode}return!1}function qe(ie,ae){return ie.indexOf(ae)>-1}function ge(ie){return ie.trim().split(/\s+/g)}function We(ie,ae,Le){if(ie.indexOf&&!Le)return ie.indexOf(ae);for(var tt=0;tt<ie.length;){if(Le&&ie[tt][Le]==ae||!Le&&ie[tt]===ae)return tt;tt++}return-1}function Ue(ie){return Array.prototype.slice.call(ie,0)}function lt(ie,ae,Le){for(var tt=[],zt=[],an=0;an<ie.length;){var Qn=ie[an][ae];We(zt,Qn)<0&&tt.push(ie[an]),zt[an]=Qn,an++}return tt=tt.sort(function(Vr,ro){return Vr[ae]>ro[ae]}),tt}function ht(ie,ae){for(var Le,tt,zt=ae[0].toUpperCase()+ae.slice(1),an=0;an<m.length;){if(Le=m[an],tt=Le?Le+zt:ae,tt in ie)return tt;an++}return d}var Wt=1;function In(){return Wt++}function Sn(ie){var ae=ie.ownerDocument||ie;return ae.defaultView||ae.parentWindow||t}var qt=/mobile|tablet|ip(ad|hone|od)|android/i,Bt="ontouchstart"in t,je=ht(t,"PointerEvent")!==d,At=Bt&&qt.test(navigator.userAgent),sn="touch",zn="pen",vn="mouse",Mn="kinect",Yn=25,ir=1,mt=2,bt=4,xt=8,Nt=1,wt=2,hn=4,An=8,Fn=16,Nn=wt|hn,xr=An|Fn,nr=Nn|xr,Zr=["x","y"],Br=["clientX","clientY"];function ui(ie,ae){var Le=this;this.manager=ie,this.callback=ae,this.element=ie.element,this.target=ie.options.inputTarget,this.domHandler=function(tt){Ie(ie.options.enable,[ie])&&Le.handler(tt)},this.init()}ui.prototype={handler:function(){},init:function(){this.evEl&&Ve(this.element,this.evEl,this.domHandler),this.evTarget&&Ve(this.target,this.evTarget,this.domHandler),this.evWin&&Ve(Sn(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Ke(this.element,this.evEl,this.domHandler),this.evTarget&&Ke(this.target,this.evTarget,this.domHandler),this.evWin&&Ke(Sn(this.element),this.evWin,this.domHandler)}};function gi(ie){var ae,Le=ie.options.inputClass;return Le?ae=Le:je?ae=ke:At?ae=Gt:Bt?ae=Q:ae=go,new ae(ie,Xi)}function Xi(ie,ae,Le){var tt=Le.pointers.length,zt=Le.changedPointers.length,an=ae&ir&&tt-zt===0,Qn=ae&(bt|xt)&&tt-zt===0;Le.isFirst=!!an,Le.isFinal=!!Qn,an&&(ie.session={}),Le.eventType=ae,Ri(ie,Le),ie.emit("hammer.input",Le),ie.recognize(Le),ie.session.prevInput=Le}function Ri(ie,ae){var Le=ie.session,tt=ae.pointers,zt=tt.length;Le.firstInput||(Le.firstInput=cr(ae)),zt>1&&!Le.firstMultiple?Le.firstMultiple=cr(ae):zt===1&&(Le.firstMultiple=!1);var an=Le.firstInput,Qn=Le.firstMultiple,Fr=Qn?Qn.center:an.center,Vr=ae.center=Cr(tt);ae.timeStamp=R(),ae.deltaTime=ae.timeStamp-an.timeStamp,ae.angle=rr(Fr,Vr),ae.distance=wr(Fr,Vr),dr(Le,ae),ae.offsetDirection=Di(ae.deltaX,ae.deltaY);var ro=Oi(ae.deltaTime,ae.deltaX,ae.deltaY);ae.overallVelocityX=ro.x,ae.overallVelocityY=ro.y,ae.overallVelocity=M(ro.x)>M(ro.y)?ro.x:ro.y,ae.scale=Qn?ao(Qn.pointers,tt):1,ae.rotation=Qn?Fi(Qn.pointers,tt):0,ae.maxPointers=Le.prevInput?ae.pointers.length>Le.prevInput.maxPointers?ae.pointers.length:Le.prevInput.maxPointers:ae.pointers.length,Nr(Le,ae);var Wi=ie.element;et(ae.srcEvent.target,Wi)&&(Wi=ae.srcEvent.target),ae.target=Wi}function dr(ie,ae){var Le=ae.center,tt=ie.offsetDelta||{},zt=ie.prevDelta||{},an=ie.prevInput||{};(ae.eventType===ir||an.eventType===bt)&&(zt=ie.prevDelta={x:an.deltaX||0,y:an.deltaY||0},tt=ie.offsetDelta={x:Le.x,y:Le.y}),ae.deltaX=zt.x+(Le.x-tt.x),ae.deltaY=zt.y+(Le.y-tt.y)}function Nr(ie,ae){var Le=ie.lastInterval||ae,tt=ae.timeStamp-Le.timeStamp,zt,an,Qn,Fr;if(ae.eventType!=xt&&(tt>Yn||Le.velocity===d)){var Vr=ae.deltaX-Le.deltaX,ro=ae.deltaY-Le.deltaY,Wi=Oi(tt,Vr,ro);an=Wi.x,Qn=Wi.y,zt=M(Wi.x)>M(Wi.y)?Wi.x:Wi.y,Fr=Di(Vr,ro),ie.lastInterval=ae}else zt=Le.velocity,an=Le.velocityX,Qn=Le.velocityY,Fr=Le.direction;ae.velocity=zt,ae.velocityX=an,ae.velocityY=Qn,ae.direction=Fr}function cr(ie){for(var ae=[],Le=0;Le<ie.pointers.length;)ae[Le]={clientX:a(ie.pointers[Le].clientX),clientY:a(ie.pointers[Le].clientY)},Le++;return{timeStamp:R(),pointers:ae,center:Cr(ae),deltaX:ie.deltaX,deltaY:ie.deltaY}}function Cr(ie){var ae=ie.length;if(ae===1)return{x:a(ie[0].clientX),y:a(ie[0].clientY)};for(var Le=0,tt=0,zt=0;zt<ae;)Le+=ie[zt].clientX,tt+=ie[zt].clientY,zt++;return{x:a(Le/ae),y:a(tt/ae)}}function Oi(ie,ae,Le){return{x:ae/ie||0,y:Le/ie||0}}function Di(ie,ae){return ie===ae?Nt:M(ie)>=M(ae)?ie<0?wt:hn:ae<0?An:Fn}function wr(ie,ae,Le){Le||(Le=Zr);var tt=ae[Le[0]]-ie[Le[0]],zt=ae[Le[1]]-ie[Le[1]];return Math.sqrt(tt*tt+zt*zt)}function rr(ie,ae,Le){Le||(Le=Zr);var tt=ae[Le[0]]-ie[Le[0]],zt=ae[Le[1]]-ie[Le[1]];return Math.atan2(zt,tt)*180/Math.PI}function Fi(ie,ae){return rr(ae[1],ae[0],Br)+rr(ie[1],ie[0],Br)}function ao(ie,ae){return wr(ae[0],ae[1],Br)/wr(ie[0],ie[1],Br)}var lo={mousedown:ir,mousemove:mt,mouseup:bt},Ao="mousedown",Fo="mousemove mouseup";function go(){this.evEl=Ao,this.evWin=Fo,this.pressed=!1,ui.apply(this,arguments)}Se(go,ui,{handler:function(ae){var Le=lo[ae.type];Le&ir&&ae.button===0&&(this.pressed=!0),Le&mt&&ae.which!==1&&(Le=bt),this.pressed&&(Le&bt&&(this.pressed=!1),this.callback(this.manager,Le,{pointers:[ae],changedPointers:[ae],pointerType:vn,srcEvent:ae}))}});var rs={pointerdown:ir,pointermove:mt,pointerup:bt,pointercancel:xt,pointerout:xt},Ae={2:sn,3:zn,4:vn,5:Mn},J="pointerdown",te="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(J="MSPointerDown",te="MSPointerMove MSPointerUp MSPointerCancel");function ke(){this.evEl=J,this.evWin=te,ui.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Se(ke,ui,{handler:function(ae){var Le=this.store,tt=!1,zt=ae.type.toLowerCase().replace("ms",""),an=rs[zt],Qn=Ae[ae.pointerType]||ae.pointerType,Fr=Qn==sn,Vr=We(Le,ae.pointerId,"pointerId");an&ir&&(ae.button===0||Fr)?Vr<0&&(Le.push(ae),Vr=Le.length-1):an&(bt|xt)&&(tt=!0),!(Vr<0)&&(Le[Vr]=ae,this.callback(this.manager,an,{pointers:Le,changedPointers:[ae],pointerType:Qn,srcEvent:ae}),tt&&Le.splice(Vr,1))}});var Oe={touchstart:ir,touchmove:mt,touchend:bt,touchcancel:xt},Ge="touchstart",rt="touchstart touchmove touchend touchcancel";function it(){this.evTarget=Ge,this.evWin=rt,this.started=!1,ui.apply(this,arguments)}Se(it,ui,{handler:function(ae){var Le=Oe[ae.type];if(Le===ir&&(this.started=!0),!!this.started){var tt=Ze.call(this,ae,Le);Le&(bt|xt)&&tt[0].length-tt[1].length===0&&(this.started=!1),this.callback(this.manager,Le,{pointers:tt[0],changedPointers:tt[1],pointerType:sn,srcEvent:ae})}}});function Ze(ie,ae){var Le=Ue(ie.touches),tt=Ue(ie.changedTouches);return ae&(bt|xt)&&(Le=lt(Le.concat(tt),"identifier")),[Le,tt]}var dt={touchstart:ir,touchmove:mt,touchend:bt,touchcancel:xt},Xt="touchstart touchmove touchend touchcancel";function Gt(){this.evTarget=Xt,this.targetIds={},ui.apply(this,arguments)}Se(Gt,ui,{handler:function(ae){var Le=dt[ae.type],tt=$t.call(this,ae,Le);tt&&this.callback(this.manager,Le,{pointers:tt[0],changedPointers:tt[1],pointerType:sn,srcEvent:ae})}});function $t(ie,ae){var Le=Ue(ie.touches),tt=this.targetIds;if(ae&(ir|mt)&&Le.length===1)return tt[Le[0].identifier]=!0,[Le,Le];var zt,an,Qn=Ue(ie.changedTouches),Fr=[],Vr=this.target;if(an=Le.filter(function(ro){return et(ro.target,Vr)}),ae===ir)for(zt=0;zt<an.length;)tt[an[zt].identifier]=!0,zt++;for(zt=0;zt<Qn.length;)tt[Qn[zt].identifier]&&Fr.push(Qn[zt]),ae&(bt|xt)&&delete tt[Qn[zt].identifier],zt++;if(Fr.length)return[lt(an.concat(Fr),"identifier"),Fr]}var G=2500,ee=25;function Q(){ui.apply(this,arguments);var ie=_e(this.handler,this);this.touch=new Gt(this.manager,ie),this.mouse=new go(this.manager,ie),this.primaryTouch=null,this.lastTouches=[]}Se(Q,ui,{handler:function(ae,Le,tt){var zt=tt.pointerType==sn,an=tt.pointerType==vn;if(!(an&&tt.sourceCapabilities&&tt.sourceCapabilities.firesTouchEvents)){if(zt)B.call(this,Le,tt);else if(an&&Qe.call(this,tt))return;this.callback(ae,Le,tt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function B(ie,ae){ie&ir?(this.primaryTouch=ae.changedPointers[0].identifier,ce.call(this,ae)):ie&(bt|xt)&&ce.call(this,ae)}function ce(ie){var ae=ie.changedPointers[0];if(ae.identifier===this.primaryTouch){var Le={x:ae.clientX,y:ae.clientY};this.lastTouches.push(Le);var tt=this.lastTouches,zt=function(){var an=tt.indexOf(Le);an>-1&&tt.splice(an,1)};setTimeout(zt,G)}}function Qe(ie){for(var ae=ie.srcEvent.clientX,Le=ie.srcEvent.clientY,tt=0;tt<this.lastTouches.length;tt++){var zt=this.lastTouches[tt],an=Math.abs(ae-zt.x),Qn=Math.abs(Le-zt.y);if(an<=ee&&Qn<=ee)return!0}return!1}var ot=ht(x.style,"touchAction"),Lt=ot!==d,Ut="compute",Ln="auto",ln="manipulation",or="none",Cn="pan-x",ur="pan-y",hr=fr();function bn(ie,ae){this.manager=ie,this.set(ae)}bn.prototype={set:function(ie){ie==Ut&&(ie=this.compute()),Lt&&this.manager.element.style&&hr[ie]&&(this.manager.element.style[ot]=ie),this.actions=ie.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ie=[];return Z(this.manager.recognizers,function(ae){Ie(ae.options.enable,[ae])&&(ie=ie.concat(ae.getTouchAction()))}),Sr(ie.join(" "))},preventDefaults:function(ie){var ae=ie.srcEvent,Le=ie.offsetDirection;if(this.manager.session.prevented){ae.preventDefault();return}var tt=this.actions,zt=qe(tt,or)&&!hr[or],an=qe(tt,ur)&&!hr[ur],Qn=qe(tt,Cn)&&!hr[Cn];if(zt){var Fr=ie.pointers.length===1,Vr=ie.distance<2,ro=ie.deltaTime<250;if(Fr&&Vr&&ro)return}if(!(Qn&&an)&&(zt||an&&Le&Nn||Qn&&Le&xr))return this.preventSrc(ae)},preventSrc:function(ie){this.manager.session.prevented=!0,ie.preventDefault()}};function Sr(ie){if(qe(ie,or))return or;var ae=qe(ie,Cn),Le=qe(ie,ur);return ae&&Le?or:ae||Le?ae?Cn:ur:qe(ie,ln)?ln:Ln}function fr(){if(!Lt)return!1;var ie={},ae=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Le){ie[Le]=ae?t.CSS.supports("touch-action",Le):!0}),ie}var On=1,Gn=2,yn=4,Pn=8,mn=Pn,Dn=16,En=32;function cn(ie){this.options=ne({},this.defaults,ie||{}),this.id=In(),this.manager=null,this.options.enable=Me(this.options.enable,!0),this.state=On,this.simultaneous={},this.requireFail=[]}cn.prototype={defaults:{},set:function(ie){return ne(this.options,ie),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ie){if(F(ie,"recognizeWith",this))return this;var ae=this.simultaneous;return ie=Dt(ie,this),ae[ie.id]||(ae[ie.id]=ie,ie.recognizeWith(this)),this},dropRecognizeWith:function(ie){return F(ie,"dropRecognizeWith",this)?this:(ie=Dt(ie,this),delete this.simultaneous[ie.id],this)},requireFailure:function(ie){if(F(ie,"requireFailure",this))return this;var ae=this.requireFail;return ie=Dt(ie,this),We(ae,ie)===-1&&(ae.push(ie),ie.requireFailure(this)),this},dropRequireFailure:function(ie){if(F(ie,"dropRequireFailure",this))return this;ie=Dt(ie,this);var ae=We(this.requireFail,ie);return ae>-1&&this.requireFail.splice(ae,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ie){return!!this.simultaneous[ie.id]},emit:function(ie){var ae=this,Le=this.state;function tt(zt){ae.manager.emit(zt,ie)}Le<Pn&&tt(ae.options.event+yt(Le)),tt(ae.options.event),ie.additionalEvent&&tt(ie.additionalEvent),Le>=Pn&&tt(ae.options.event+yt(Le))},tryEmit:function(ie){if(this.canEmit())return this.emit(ie);this.state=En},canEmit:function(){for(var ie=0;ie<this.requireFail.length;){if(!(this.requireFail[ie].state&(En|On)))return!1;ie++}return!0},recognize:function(ie){var ae=ne({},ie);if(!Ie(this.options.enable,[this,ae])){this.reset(),this.state=En;return}this.state&(mn|Dn|En)&&(this.state=On),this.state=this.process(ae),this.state&(Gn|yn|Pn|Dn)&&this.tryEmit(ae)},process:function(ie){},getTouchAction:function(){},reset:function(){}};function yt(ie){return ie&Dn?"cancel":ie&Pn?"end":ie&yn?"move":ie&Gn?"start":""}function Te(ie){return ie==Fn?"down":ie==An?"up":ie==wt?"left":ie==hn?"right":""}function Dt(ie,ae){var Le=ae.manager;return Le?Le.get(ie):ie}function Tt(){cn.apply(this,arguments)}Se(Tt,cn,{defaults:{pointers:1},attrTest:function(ie){var ae=this.options.pointers;return ae===0||ie.pointers.length===ae},process:function(ie){var ae=this.state,Le=ie.eventType,tt=ae&(Gn|yn),zt=this.attrTest(ie);return tt&&(Le&xt||!zt)?ae|Dn:tt||zt?Le&bt?ae|Pn:ae&Gn?ae|yn:Gn:En}});function It(){Tt.apply(this,arguments),this.pX=null,this.pY=null}Se(It,Tt,{defaults:{event:"pan",threshold:10,pointers:1,direction:nr},getTouchAction:function(){var ie=this.options.direction,ae=[];return ie&Nn&&ae.push(ur),ie&xr&&ae.push(Cn),ae},directionTest:function(ie){var ae=this.options,Le=!0,tt=ie.distance,zt=ie.direction,an=ie.deltaX,Qn=ie.deltaY;return zt&ae.direction||(ae.direction&Nn?(zt=an===0?Nt:an<0?wt:hn,Le=an!=this.pX,tt=Math.abs(ie.deltaX)):(zt=Qn===0?Nt:Qn<0?An:Fn,Le=Qn!=this.pY,tt=Math.abs(ie.deltaY))),ie.direction=zt,Le&&tt>ae.threshold&&zt&ae.direction},attrTest:function(ie){return Tt.prototype.attrTest.call(this,ie)&&(this.state&Gn||!(this.state&Gn)&&this.directionTest(ie))},emit:function(ie){this.pX=ie.deltaX,this.pY=ie.deltaY;var ae=Te(ie.direction);ae&&(ie.additionalEvent=this.options.event+ae),this._super.emit.call(this,ie)}});function tn(){Tt.apply(this,arguments)}Se(tn,Tt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[or]},attrTest:function(ie){return this._super.attrTest.call(this,ie)&&(Math.abs(ie.scale-1)>this.options.threshold||this.state&Gn)},emit:function(ie){if(ie.scale!==1){var ae=ie.scale<1?"in":"out";ie.additionalEvent=this.options.event+ae}this._super.emit.call(this,ie)}});function Bn(){cn.apply(this,arguments),this._timer=null,this._input=null}Se(Bn,cn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ln]},process:function(ie){var ae=this.options,Le=ie.pointers.length===ae.pointers,tt=ie.distance<ae.threshold,zt=ie.deltaTime>ae.time;if(this._input=ie,!tt||!Le||ie.eventType&(bt|xt)&&!zt)this.reset();else if(ie.eventType&ir)this.reset(),this._timer=j(function(){this.state=mn,this.tryEmit()},ae.time,this);else if(ie.eventType&bt)return mn;return En},reset:function(){clearTimeout(this._timer)},emit:function(ie){this.state===mn&&(ie&&ie.eventType&bt?this.manager.emit(this.options.event+"up",ie):(this._input.timeStamp=R(),this.manager.emit(this.options.event,this._input)))}});function pr(){Tt.apply(this,arguments)}Se(pr,Tt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[or]},attrTest:function(ie){return this._super.attrTest.call(this,ie)&&(Math.abs(ie.rotation)>this.options.threshold||this.state&Gn)}});function _r(){Tt.apply(this,arguments)}Se(_r,Tt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Nn|xr,pointers:1},getTouchAction:function(){return It.prototype.getTouchAction.call(this)},attrTest:function(ie){var ae=this.options.direction,Le;return ae&(Nn|xr)?Le=ie.overallVelocity:ae&Nn?Le=ie.overallVelocityX:ae&xr&&(Le=ie.overallVelocityY),this._super.attrTest.call(this,ie)&&ae&ie.offsetDirection&&ie.distance>this.options.threshold&&ie.maxPointers==this.options.pointers&&M(Le)>this.options.velocity&&ie.eventType&bt},emit:function(ie){var ae=Te(ie.offsetDirection);ae&&this.manager.emit(this.options.event+ae,ie),this.manager.emit(this.options.event,ie)}});function sr(){cn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Se(sr,cn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ln]},process:function(ie){var ae=this.options,Le=ie.pointers.length===ae.pointers,tt=ie.distance<ae.threshold,zt=ie.deltaTime<ae.time;if(this.reset(),ie.eventType&ir&&this.count===0)return this.failTimeout();if(tt&&zt&&Le){if(ie.eventType!=bt)return this.failTimeout();var an=this.pTime?ie.timeStamp-this.pTime<ae.interval:!0,Qn=!this.pCenter||wr(this.pCenter,ie.center)<ae.posThreshold;this.pTime=ie.timeStamp,this.pCenter=ie.center,!Qn||!an?this.count=1:this.count+=1,this._input=ie;var Fr=this.count%ae.taps;if(Fr===0)return this.hasRequireFailures()?(this._timer=j(function(){this.state=mn,this.tryEmit()},ae.interval,this),Gn):mn}return En},failTimeout:function(){return this._timer=j(function(){this.state=En},this.options.interval,this),En},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==mn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function pe(ie,ae){return ae=ae||{},ae.recognizers=Me(ae.recognizers,pe.defaults.preset),new yr(ie,ae)}pe.VERSION="2.0.7",pe.defaults={domEvents:!1,touchAction:Ut,enable:!0,inputTarget:null,inputClass:null,preset:[[pr,{enable:!1}],[tn,{enable:!1},["rotate"]],[_r,{direction:Nn}],[It,{direction:Nn},["swipe"]],[sr],[sr,{event:"doubletap",taps:2},["tap"]],[Bn]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var wn=1,Tn=2;function yr(ie,ae){this.options=ne({},pe.defaults,ae||{}),this.options.inputTarget=this.options.inputTarget||ie,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ie,this.input=gi(this),this.touchAction=new bn(this,this.options.touchAction),ar(this,!0),Z(this.options.recognizers,function(Le){var tt=this.add(new Le[0](Le[1]));Le[2]&&tt.recognizeWith(Le[2]),Le[3]&&tt.requireFailure(Le[3])},this)}yr.prototype={set:function(ie){return ne(this.options,ie),ie.touchAction&&this.touchAction.update(),ie.inputTarget&&(this.input.destroy(),this.input.target=ie.inputTarget,this.input.init()),this},stop:function(ie){this.session.stopped=ie?Tn:wn},recognize:function(ie){var ae=this.session;if(!ae.stopped){this.touchAction.preventDefaults(ie);var Le,tt=this.recognizers,zt=ae.curRecognizer;(!zt||zt&&zt.state&mn)&&(zt=ae.curRecognizer=null);for(var an=0;an<tt.length;)Le=tt[an],ae.stopped!==Tn&&(!zt||Le==zt||Le.canRecognizeWith(zt))?Le.recognize(ie):Le.reset(),!zt&&Le.state&(Gn|yn|Pn)&&(zt=ae.curRecognizer=Le),an++}},get:function(ie){if(ie instanceof cn)return ie;for(var ae=this.recognizers,Le=0;Le<ae.length;Le++)if(ae[Le].options.event==ie)return ae[Le];return null},add:function(ie){if(F(ie,"add",this))return this;var ae=this.get(ie.options.event);return ae&&this.remove(ae),this.recognizers.push(ie),ie.manager=this,this.touchAction.update(),ie},remove:function(ie){if(F(ie,"remove",this))return this;if(ie=this.get(ie),ie){var ae=this.recognizers,Le=We(ae,ie);Le!==-1&&(ae.splice(Le,1),this.touchAction.update())}return this},on:function(ie,ae){if(ie!==d&&ae!==d){var Le=this.handlers;return Z(ge(ie),function(tt){Le[tt]=Le[tt]||[],Le[tt].push(ae)}),this}},off:function(ie,ae){if(ie!==d){var Le=this.handlers;return Z(ge(ie),function(tt){ae?Le[tt]&&Le[tt].splice(We(Le[tt],ae),1):delete Le[tt]}),this}},emit:function(ie,ae){this.options.domEvents&&xn(ie,ae);var Le=this.handlers[ie]&&this.handlers[ie].slice();if(!(!Le||!Le.length)){ae.type=ie,ae.preventDefault=function(){ae.srcEvent.preventDefault()};for(var tt=0;tt<Le.length;)Le[tt](ae),tt++}},destroy:function(){this.element&&ar(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function ar(ie,ae){var Le=ie.element;if(Le.style){var tt;Z(ie.options.cssProps,function(zt,an){tt=ht(Le.style,an),ae?(ie.oldCssProps[tt]=Le.style[tt],Le.style[tt]=zt):Le.style[tt]=ie.oldCssProps[tt]||""}),ae||(ie.oldCssProps={})}}function xn(ie,ae){var Le=r.createEvent("Event");Le.initEvent(ie,!0,!0),Le.gesture=ae,ae.target.dispatchEvent(Le)}ne(pe,{INPUT_START:ir,INPUT_MOVE:mt,INPUT_END:bt,INPUT_CANCEL:xt,STATE_POSSIBLE:On,STATE_BEGAN:Gn,STATE_CHANGED:yn,STATE_ENDED:Pn,STATE_RECOGNIZED:mn,STATE_CANCELLED:Dn,STATE_FAILED:En,DIRECTION_NONE:Nt,DIRECTION_LEFT:wt,DIRECTION_RIGHT:hn,DIRECTION_UP:An,DIRECTION_DOWN:Fn,DIRECTION_HORIZONTAL:Nn,DIRECTION_VERTICAL:xr,DIRECTION_ALL:nr,Manager:yr,Input:ui,TouchAction:bn,TouchInput:Gt,MouseInput:go,PointerEventInput:ke,TouchMouseInput:Q,SingleTouchInput:it,Recognizer:cn,AttrRecognizer:Tt,Tap:sr,Pan:It,Swipe:_r,Pinch:tn,Rotate:pr,Press:Bn,on:Ve,off:Ke,each:Z,merge:xe,extend:se,assign:ne,inherit:Se,bindFn:_e,prefixed:ht});var Er=typeof t<"u"?t:typeof self<"u"?self:{};Er.Hammer=pe,n.exports?n.exports=pe:t[l]=pe})(window,document,"Hammer")}(Qv)),Qv.exports}var i1=NB();const FB=cu(i1),Hc=hT({__proto__:null,default:FB},[i1]),E6=1,T6=2,Zx=4,UB={mousedown:E6,mousemove:T6,mouseup:Zx};function $B(n,t){for(let r=0;r<n.length;r++)if(t(n[r]))return!0;return!1}function VB(n){const t=n.prototype.handler;n.prototype.handler=function(l){const d=this.store;l.button>0&&l.type==="pointerdown"&&($B(d,m=>m.pointerId===l.pointerId)||d.push(l)),t.call(this,l)}}function WB(n){n.prototype.handler=function(r){let l=UB[r.type];l&E6&&r.button>=0&&(this.pressed=!0),l&T6&&r.buttons===0&&(l=Zx),this.pressed&&(l&Zx&&(this.pressed=!1),this.callback(this.manager,l,{pointers:[r],changedPointers:[r],pointerType:"mouse",srcEvent:r}))}}VB(i1.PointerEventInput);WB(i1.MouseInput);const qB=i1.Manager;class Ay{constructor(t,r,l){this.element=t,this.callback=r,this.options={enable:!0,...l}}}const GB=Hc?[[Hc.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Hc.Rotate,{enable:!1}],[Hc.Pinch,{enable:!1}],[Hc.Swipe,{enable:!1}],[Hc.Pan,{threshold:0,enable:!1}],[Hc.Press,{enable:!1}],[Hc.Tap,{event:"doubletap",taps:2,enable:!1}],[Hc.Tap,{event:"anytap",enable:!1}],[Hc.Tap,{enable:!1}]]:null,iE={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},ZB={doubletap:["tap"]},HB={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},sb={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},KB={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},oE={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},XB=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Mm=typeof window<"u"?window:global;let Hx=!1;try{const n={get passive(){return Hx=!0,!0}};Mm.addEventListener("test",null,n),Mm.removeEventListener("test",null)}catch{Hx=!1}const YB=XB.indexOf("firefox")!==-1,{WHEEL_EVENTS:JB}=sb,sE="wheel",aE=4.000244140625,QB=40,ej=.25;class tj extends Ay{constructor(t,r,l){super(t,r,l),this.handleEvent=d=>{if(!this.options.enable)return;let m=d.deltaY;Mm.WheelEvent&&(YB&&d.deltaMode===Mm.WheelEvent.DOM_DELTA_PIXEL&&(m/=Mm.devicePixelRatio),d.deltaMode===Mm.WheelEvent.DOM_DELTA_LINE&&(m*=QB)),m!==0&&m%aE===0&&(m=Math.floor(m/aE)),d.shiftKey&&m&&(m=m*ej),this.callback({type:sE,center:{x:d.clientX,y:d.clientY},delta:-m,srcEvent:d,pointerType:"mouse",target:d.target})},this.events=(this.options.events||[]).concat(JB),this.events.forEach(d=>t.addEventListener(d,this.handleEvent,Hx?{passive:!1}:!1))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,r){t===sE&&(this.options.enable=r)}}const{MOUSE_EVENTS:nj}=sb,lE="pointermove",cE="pointerover",uE="pointerout",hE="pointerenter",dE="pointerleave";class rj extends Ay{constructor(t,r,l){super(t,r,l),this.handleEvent=m=>{this.handleOverEvent(m),this.handleOutEvent(m),this.handleEnterEvent(m),this.handleLeaveEvent(m),this.handleMoveEvent(m)},this.pressed=!1;const{enable:d}=this.options;this.enableMoveEvent=d,this.enableLeaveEvent=d,this.enableEnterEvent=d,this.enableOutEvent=d,this.enableOverEvent=d,this.events=(this.options.events||[]).concat(nj),this.events.forEach(m=>t.addEventListener(m,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,r){t===lE&&(this.enableMoveEvent=r),t===cE&&(this.enableOverEvent=r),t===uE&&(this.enableOutEvent=r),t===hE&&(this.enableEnterEvent=r),t===dE&&(this.enableLeaveEvent=r)}handleOverEvent(t){this.enableOverEvent&&t.type==="mouseover"&&this._emit(cE,t)}handleOutEvent(t){this.enableOutEvent&&t.type==="mouseout"&&this._emit(uE,t)}handleEnterEvent(t){this.enableEnterEvent&&t.type==="mouseenter"&&this._emit(hE,t)}handleLeaveEvent(t){this.enableLeaveEvent&&t.type==="mouseleave"&&this._emit(dE,t)}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":t.buttons===0&&(this.pressed=!1),this.pressed||this._emit(lE,t);break;case"mouseup":this.pressed=!1;break}}_emit(t,r){this.callback({type:t,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})}}const{KEY_EVENTS:ij}=sb,fE="keydown",pE="keyup";class oj extends Ay{constructor(t,r,l){super(t,r,l),this.handleEvent=d=>{const m=d.target||d.srcElement;m.tagName==="INPUT"&&m.type==="text"||m.tagName==="TEXTAREA"||(this.enableDownEvent&&d.type==="keydown"&&this.callback({type:fE,srcEvent:d,key:d.key,target:d.target}),this.enableUpEvent&&d.type==="keyup"&&this.callback({type:pE,srcEvent:d,key:d.key,target:d.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(ij),t.tabIndex=this.options.tabIndex||0,t.style.outline="none",this.events.forEach(d=>t.addEventListener(d,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,r){t===fE&&(this.enableDownEvent=r),t===pE&&(this.enableUpEvent=r)}}const mE="contextmenu";class sj extends Ay{constructor(t,r,l){super(t,r,l),this.handleEvent=d=>{this.options.enable&&this.callback({type:mE,center:{x:d.clientX,y:d.clientY},srcEvent:d,pointerType:"mouse",target:d.target})},t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,r){t===mE&&(this.options.enable=r)}}const gE=1,Kx=2,_E=4,aj={pointerdown:gE,pointermove:Kx,pointerup:_E,mousedown:gE,mousemove:Kx,mouseup:_E},lj=0,cj=1,uj=2,hj=1,dj=2,fj=4;function pj(n){const t=aj[n.srcEvent.type];if(!t)return null;const{buttons:r,button:l}=n.srcEvent;let d=!1,m=!1,x=!1;return t===Kx?(d=!!(r&hj),m=!!(r&fj),x=!!(r&dj)):(d=l===lj,m=l===cj,x=l===uj),{leftButton:d,middleButton:m,rightButton:x}}function mj(n,t){const r=n.center;if(!r)return null;const l=t.getBoundingClientRect(),d=l.width/t.offsetWidth||1,m=l.height/t.offsetHeight||1,x={x:(r.x-l.left-t.clientLeft)/d,y:(r.y-l.top-t.clientTop)/m};return{center:r,offsetCenter:x}}const ex={srcElement:"root",priority:0};class gj{constructor(t){this.handleEvent=r=>{if(this.isEmpty())return;const l=this._normalizeEvent(r);let d=r.srcEvent.target;for(;d&&d!==l.rootElement;){if(this._emit(l,d),l.handled)return;d=d.parentNode}this._emit(l,"root")},this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(t,r,l,d=!1,m=!1){const{handlers:x,handlersByElement:C}=this;let a=ex;typeof l=="string"||l&&l.addEventListener?a={...ex,srcElement:l}:l&&(a={...ex,...l});let M=C.get(a.srcElement);M||(M=[],C.set(a.srcElement,M));const R={type:t,handler:r,srcElement:a.srcElement,priority:a.priority};d&&(R.once=!0),m&&(R.passive=!0),x.push(R),this._active=this._active||!R.passive;let j=M.length-1;for(;j>=0&&!(M[j].priority>=R.priority);)j--;M.splice(j+1,0,R)}remove(t,r){const{handlers:l,handlersByElement:d}=this;for(let m=l.length-1;m>=0;m--){const x=l[m];if(x.type===t&&x.handler===r){l.splice(m,1);const C=d.get(x.srcElement);C.splice(C.indexOf(x),1),C.length===0&&d.delete(x.srcElement)}}this._active=l.some(m=>!m.passive)}_emit(t,r){const l=this.handlersByElement.get(r);if(l){let d=!1;const m=()=>{t.handled=!0},x=()=>{t.handled=!0,d=!0},C=[];for(let a=0;a<l.length;a++){const{type:M,handler:R,once:j}=l[a];if(R({...t,type:M,stopPropagation:m,stopImmediatePropagation:x}),j&&C.push(l[a]),d)break}for(let a=0;a<C.length;a++){const{type:M,handler:R}=C[a];this.remove(M,R)}}}_normalizeEvent(t){const r=this.eventManager.getElement();return{...t,...pj(t),...mj(t,r),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:r}}}const _j={events:null,recognizers:null,recognizerOptions:{},Manager:qB,touchAction:"none",tabIndex:0};class yj{constructor(t=null,r){this._onBasicInput=d=>{const{srcEvent:m}=d,x=HB[m.type];x&&this.manager.emit(x,d)},this._onOtherEvent=d=>{this.manager.emit(d.type,d)},this.options={..._j,...r},this.events=new Map,this.setElement(t);const{events:l}=this.options;l&&this.on(l)}getElement(){return this.element}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:r}=this,l=r.Manager;this.manager=new l(t,{touchAction:r.touchAction,recognizers:r.recognizers||GB}).on("hammer.input",this._onBasicInput),r.recognizers||Object.keys(iE).forEach(d=>{const m=this.manager.get(d);m&&iE[d].forEach(x=>{m.recognizeWith(x)})});for(const d in r.recognizerOptions){const m=this.manager.get(d);if(m){const x=r.recognizerOptions[d];delete x.enable,m.set(x)}}this.wheelInput=new tj(t,this._onOtherEvent,{enable:!1}),this.moveInput=new rj(t,this._onOtherEvent,{enable:!1}),this.keyInput=new oj(t,this._onOtherEvent,{enable:!1,tabIndex:r.tabIndex}),this.contextmenuInput=new sj(t,this._onOtherEvent,{enable:!1});for(const[d,m]of this.events)m.isEmpty()||(this._toggleRecognizer(m.recognizerName,!0),this.manager.on(d,m.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,r,l){this._addEventHandler(t,r,l,!1)}once(t,r,l){this._addEventHandler(t,r,l,!0)}watch(t,r,l){this._addEventHandler(t,r,l,!1,!0)}off(t,r){this._removeEventHandler(t,r)}_toggleRecognizer(t,r){const{manager:l}=this;if(!l)return;const d=l.get(t);if(d&&d.options.enable!==r){d.set({enable:r});const m=ZB[t];m&&!this.options.recognizers&&m.forEach(x=>{const C=l.get(x);r?(C.requireFailure(t),d.dropRequireFailure(x)):C.dropRequireFailure(t)})}this.wheelInput.enableEventType(t,r),this.moveInput.enableEventType(t,r),this.keyInput.enableEventType(t,r),this.contextmenuInput.enableEventType(t,r)}_addEventHandler(t,r,l,d,m){if(typeof t!="string"){l=r;for(const R in t)this._addEventHandler(R,t[R],l,d,m);return}const{manager:x,events:C}=this,a=oE[t]||t;let M=C.get(a);M||(M=new gj(this),C.set(a,M),M.recognizerName=KB[a]||a,x&&x.on(a,M.handleEvent)),M.add(t,r,l,d,m),M.isEmpty()||this._toggleRecognizer(M.recognizerName,!0)}_removeEventHandler(t,r){if(typeof t!="string"){for(const x in t)this._removeEventHandler(x,t[x]);return}const{events:l}=this,d=oE[t]||t,m=l.get(d);if(m&&(m.remove(t,r),m.isEmpty())){const{recognizerName:x}=m;let C=!1;for(const a of l.values())if(a.recognizerName===x&&!a.isEmpty()){C=!0;break}C||this._toggleRecognizer(x,!1)}}}function yE(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);t&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(n,d).enumerable})),r.push.apply(r,l)}return r}function aa(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yE(Object(r),!0).forEach(function(l){Vn(n,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):yE(Object(r)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(r,l))})}return n}var Ff={transitionDuration:0},rh={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new g0,transitionInterruption:y0.BREAK},a_=300,l_=function(t){return 1-(1-t)*(1-t)},lm={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},C6=function(){function n(){var t=this;Od(this,n),Vn(this,"events",[]),Vn(this,"scrollZoom",!0),Vn(this,"dragPan",!0),Vn(this,"dragRotate",!0),Vn(this,"doubleClickZoom",!0),Vn(this,"touchZoom",!0),Vn(this,"touchRotate",!1),Vn(this,"keyboard",!0),Vn(this,"_interactionState",{isDragging:!1}),Vn(this,"_events",{}),Vn(this,"_setInteractionState",function(r){Object.assign(t._interactionState,r),t.onStateChange&&t.onStateChange(t._interactionState)}),Vn(this,"_onTransition",function(r,l){t.onViewportChange(r,t._interactionState,l)}),this.handleEvent=this.handleEvent.bind(this),this._transitionManager=new ob({onViewportChange:this._onTransition,onStateChange:this._setInteractionState})}return Dd(n,[{key:"handleEvent",value:function(r){this.mapState=this.getMapState();var l=this._eventStartBlocked;switch(r.type){case"panstart":return l?!1:this._onPanStart(r);case"panmove":return this._onPan(r);case"panend":return this._onPanEnd(r);case"pinchstart":return l?!1:this._onPinchStart(r);case"pinchmove":return this._onPinch(r);case"pinchend":return this._onPinchEnd(r);case"tripanstart":return l?!1:this._onTriplePanStart(r);case"tripanmove":return this._onTriplePan(r);case"tripanend":return this._onTriplePanEnd(r);case"doubletap":return this._onDoubleTap(r);case"wheel":return this._onWheel(r);case"keydown":return this._onKeyDown(r);default:return!1}}},{key:"getCenter",value:function(r){var l=r.offsetCenter,d=l.x,m=l.y;return[d,m]}},{key:"isFunctionKeyPressed",value:function(r){var l=r.srcEvent;return!!(l.metaKey||l.altKey||l.ctrlKey||l.shiftKey)}},{key:"blockEvents",value:function(r){var l=this,d=setTimeout(function(){l._eventStartBlocked===d&&(l._eventStartBlocked=null)},r);this._eventStartBlocked=d}},{key:"updateViewport",value:function(r,l,d){var m=this.mapState instanceof Im?this.mapState.getViewportProps():this.mapState,x=aa(aa({},r.getViewportProps()),l),C=Object.keys(x).some(function(a){return m[a]!==x[a]});this._state=r.getState(),this._setInteractionState(d),C&&this.onViewportChange(x,this._interactionState,m)}},{key:"getMapState",value:function(r){return new Im(aa(aa(aa({},this.mapStateProps),this._state),r))}},{key:"isDragging",value:function(){return this._interactionState.isDragging}},{key:"setOptions",value:function(r){var l=r.onViewportChange,d=r.onStateChange,m=r.eventManager,x=m===void 0?this.eventManager:m,C=r.isInteractive,a=C===void 0?!0:C,M=r.scrollZoom,R=M===void 0?this.scrollZoom:M,j=r.dragPan,F=j===void 0?this.dragPan:j,Z=r.dragRotate,Y=Z===void 0?this.dragRotate:Z,ne=r.doubleClickZoom,se=ne===void 0?this.doubleClickZoom:ne,xe=r.touchZoom,Se=xe===void 0?this.touchZoom:xe,_e=r.touchRotate,Ie=_e===void 0?this.touchRotate:_e,Me=r.keyboard,Ve=Me===void 0?this.keyboard:Me;this.onViewportChange=l,this.onStateChange=d;var Ke=this.mapStateProps||{},et=Ke.height!==r.height||Ke.width!==r.width;this.mapStateProps=r,et&&(this.mapState=Ke,this.updateViewport(new Im(r))),this._transitionManager.processViewportChange(r),this.eventManager!==x&&(this.eventManager=x,this._events={},this.toggleEvents(this.events,!0)),this.toggleEvents(lm.WHEEL,a&&!!R),this.toggleEvents(lm.PAN,a&&!!(F||Y)),this.toggleEvents(lm.PINCH,a&&!!(Se||Ie)),this.toggleEvents(lm.TRIPLE_PAN,a&&!!Ie),this.toggleEvents(lm.DOUBLE_TAP,a&&!!se),this.toggleEvents(lm.KEYBOARD,a&&!!Ve),this.scrollZoom=R,this.dragPan=F,this.dragRotate=Y,this.doubleClickZoom=se,this.touchZoom=Se,this.touchRotate=Ie,this.keyboard=Ve}},{key:"toggleEvents",value:function(r,l){var d=this;this.eventManager&&r.forEach(function(m){d._events[m]!==l&&(d._events[m]=l,l?d.eventManager.on(m,d.handleEvent):d.eventManager.off(m,d.handleEvent))})}},{key:"_onPanStart",value:function(r){var l=this.getCenter(r);this._panRotate=this.isFunctionKeyPressed(r)||r.rightButton;var d=this._panRotate?this.mapState.rotateStart({pos:l}):this.mapState.panStart({pos:l});return this.updateViewport(d,Ff,{isDragging:!0}),!0}},{key:"_onPan",value:function(r){return this.isDragging()?this._panRotate?this._onPanRotate(r):this._onPanMove(r):!1}},{key:"_onPanEnd",value:function(r){return this.isDragging()?this._panRotate?this._onPanRotateEnd(r):this._onPanMoveEnd(r):!1}},{key:"_onPanMove",value:function(r){if(!this.dragPan)return!1;var l=this.getCenter(r),d=this.mapState.pan({pos:l});return this.updateViewport(d,Ff,{isPanning:!0}),!0}},{key:"_onPanMoveEnd",value:function(r){if(this.dragPan){var l=this.dragPan.inertia,d=l===void 0?a_:l;if(d&&r.velocity){var m=this.getCenter(r),x=[m[0]+r.velocityX*d/2,m[1]+r.velocityY*d/2],C=this.mapState.pan({pos:x}).panEnd();return this.updateViewport(C,aa(aa({},rh),{},{transitionDuration:d,transitionEasing:l_}),{isDragging:!1,isPanning:!0}),!0}}var a=this.mapState.panEnd();return this.updateViewport(a,null,{isDragging:!1,isPanning:!1}),!0}},{key:"_onPanRotate",value:function(r){if(!this.dragRotate)return!1;var l=this.getCenter(r),d=this.mapState.rotate({pos:l});return this.updateViewport(d,Ff,{isRotating:!0}),!0}},{key:"_onPanRotateEnd",value:function(r){if(this.dragRotate){var l=this.dragRotate.inertia,d=l===void 0?a_:l;if(d&&r.velocity){var m=this.getCenter(r),x=[m[0]+r.velocityX*d/2,m[1]+r.velocityY*d/2],C=this.mapState.rotate({pos:x}).rotateEnd();return this.updateViewport(C,aa(aa({},rh),{},{transitionDuration:d,transitionEasing:l_}),{isDragging:!1,isRotating:!0}),!0}}var a=this.mapState.panEnd();return this.updateViewport(a,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onWheel",value:function(r){if(!this.scrollZoom)return!1;var l=this.scrollZoom,d=l.speed,m=d===void 0?.01:d,x=l.smooth,C=x===void 0?!1:x;r.preventDefault();var a=this.getCenter(r),M=r.delta,R=2/(1+Math.exp(-Math.abs(M*m)));M<0&&R!==0&&(R=1/R);var j=this.mapState.zoom({pos:a,scale:R});return j.getViewportProps().zoom===this.mapStateProps.zoom?!1:(this.updateViewport(j,aa(aa({},rh),{},{transitionInterpolator:new g0({around:a}),transitionDuration:C?250:1}),{isPanning:!0,isZooming:!0}),!0)}},{key:"_onPinchStart",value:function(r){var l=this.getCenter(r),d=this.mapState.zoomStart({pos:l}).rotateStart({pos:l});return this._startPinchRotation=r.rotation,this._lastPinchEvent=r,this.updateViewport(d,Ff,{isDragging:!0}),!0}},{key:"_onPinch",value:function(r){if(!this.isDragging()||!this.touchZoom&&!this.touchRotate)return!1;var l=this.mapState;if(this.touchZoom){var d=r.scale,m=this.getCenter(r);l=l.zoom({pos:m,scale:d})}if(this.touchRotate){var x=r.rotation;l=l.rotate({deltaAngleX:this._startPinchRotation-x})}return this.updateViewport(l,Ff,{isDragging:!0,isPanning:!!this.touchZoom,isZooming:!!this.touchZoom,isRotating:!!this.touchRotate}),this._lastPinchEvent=r,!0}},{key:"_onPinchEnd",value:function(r){if(!this.isDragging())return!1;if(this.touchZoom){var l=this.touchZoom.inertia,d=l===void 0?a_:l,m=this._lastPinchEvent;if(d&&m&&r.scale!==m.scale){var x=this.getCenter(r),C=this.mapState.rotateEnd(),a=Math.log2(r.scale),M=(a-Math.log2(m.scale))/(r.deltaTime-m.deltaTime),R=Math.pow(2,a+M*d/2);return C=C.zoom({pos:x,scale:R}).zoomEnd(),this.updateViewport(C,aa(aa({},rh),{},{transitionInterpolator:new g0({around:x}),transitionDuration:d,transitionEasing:l_}),{isDragging:!1,isPanning:!!this.touchZoom,isZooming:!!this.touchZoom,isRotating:!1}),this.blockEvents(d),!0}}var j=this.mapState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(j,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1}),this._startPinchRotation=null,this._lastPinchEvent=null,!0}},{key:"_onTriplePanStart",value:function(r){var l=this.getCenter(r),d=this.mapState.rotateStart({pos:l});return this.updateViewport(d,Ff,{isDragging:!0}),!0}},{key:"_onTriplePan",value:function(r){if(!this.isDragging()||!this.touchRotate)return!1;var l=this.getCenter(r);l[0]-=r.deltaX;var d=this.mapState.rotate({pos:l});return this.updateViewport(d,Ff,{isRotating:!0}),!0}},{key:"_onTriplePanEnd",value:function(r){if(!this.isDragging())return!1;if(this.touchRotate){var l=this.touchRotate.inertia,d=l===void 0?a_:l;if(d&&r.velocityY){var m=this.getCenter(r),x=[m[0],m[1]+=r.velocityY*d/2],C=this.mapState.rotate({pos:x});return this.updateViewport(C,aa(aa({},rh),{},{transitionDuration:d,transitionEasing:l_}),{isDragging:!1,isRotating:!0}),this.blockEvents(d),!1}}var a=this.mapState.rotateEnd();return this.updateViewport(a,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onDoubleTap",value:function(r){if(!this.doubleClickZoom)return!1;var l=this.getCenter(r),d=this.isFunctionKeyPressed(r),m=this.mapState.zoom({pos:l,scale:d?.5:2});return this.updateViewport(m,Object.assign({},rh,{transitionInterpolator:new g0({around:l})}),{isZooming:!0}),!0}},{key:"_onKeyDown",value:function(r){if(!this.keyboard)return!1;var l=this.isFunctionKeyPressed(r),d=this.keyboard,m=d.zoomSpeed,x=m===void 0?2:m,C=d.moveSpeed,a=C===void 0?100:C,M=d.rotateSpeedX,R=M===void 0?15:M,j=d.rotateSpeedY,F=j===void 0?10:j,Z=this.mapStateProps,Y;switch(r.srcEvent.keyCode){case 189:l?Y=this.getMapState({zoom:Z.zoom-Math.log2(x)-1}):Y=this.getMapState({zoom:Z.zoom-Math.log2(x)});break;case 187:l?Y=this.getMapState({zoom:Z.zoom+Math.log2(x)+1}):Y=this.getMapState({zoom:Z.zoom+Math.log2(x)});break;case 37:l?Y=this.getMapState({bearing:Z.bearing-R}):Y=this.mapState.pan({pos:[a,0],startPos:[0,0]});break;case 39:l?Y=this.getMapState({bearing:Z.bearing+R}):Y=this.mapState.pan({pos:[-a,0],startPos:[0,0]});break;case 38:l?Y=this.getMapState({pitch:Z.pitch+F}):Y=this.mapState.pan({pos:[0,a],startPos:[0,0]});break;case 40:l?Y=this.getMapState({pitch:Z.pitch-F}):Y=this.mapState.pan({pos:[0,-a],startPos:[0,0]});break;default:return!1}return this.updateViewport(Y,rh)}}]),n}();function vE(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);t&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(n,d).enumerable})),r.push.apply(r,l)}return r}function eh(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vE(Object(r),!0).forEach(function(l){Vn(n,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):vE(Object(r)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(r,l))})}return n}var vj=Object.assign({},zd.propTypes,{maxZoom:pt.number,minZoom:pt.number,maxPitch:pt.number,minPitch:pt.number,onViewStateChange:pt.func,onViewportChange:pt.func,onInteractionStateChange:pt.func,transitionDuration:pt.oneOfType([pt.number,pt.string]),transitionInterpolator:pt.object,transitionInterruption:pt.number,transitionEasing:pt.func,onTransitionStart:pt.func,onTransitionInterrupt:pt.func,onTransitionEnd:pt.func,scrollZoom:pt.oneOfType([pt.bool,pt.object]),dragPan:pt.oneOfType([pt.bool,pt.object]),dragRotate:pt.oneOfType([pt.bool,pt.object]),doubleClickZoom:pt.bool,touchZoom:pt.oneOfType([pt.bool,pt.object]),touchRotate:pt.oneOfType([pt.bool,pt.object]),keyboard:pt.oneOfType([pt.bool,pt.object]),onHover:pt.func,onClick:pt.func,onDblClick:pt.func,onContextMenu:pt.func,onMouseDown:pt.func,onMouseMove:pt.func,onMouseUp:pt.func,onTouchStart:pt.func,onTouchMove:pt.func,onTouchEnd:pt.func,onMouseEnter:pt.func,onMouseLeave:pt.func,onMouseOut:pt.func,onWheel:pt.func,touchAction:pt.string,eventRecognizerOptions:pt.object,clickRadius:pt.number,interactiveLayerIds:pt.array,getCursor:pt.func,controller:pt.instanceOf(C6)}),xj=function(t){var r=t.isDragging,l=t.isHovering;return r?"grabbing":l?"pointer":"grab"},wj=Object.assign({},zd.defaultProps,Kf,ob.defaultProps,{onViewStateChange:null,onViewportChange:null,onClick:null,onNativeClick:null,onHover:null,onContextMenu:function(t){return t.preventDefault()},scrollZoom:!0,dragPan:!0,dragRotate:!0,doubleClickZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!0,touchAction:"none",eventRecognizerOptions:{},clickRadius:0,getCursor:xj});function ab(n){if(n.lngLat||!n.offsetCenter)return n;var t=n.offsetCenter,r=t.x,l=t.y;if(!Number.isFinite(r)||!Number.isFinite(l))return n;var d=[r,l];if(n.point=d,this.map){var m=this.map.unproject(d);n.lngLat=[m.lng,m.lat]}return n}function S6(n){var t=this.map;if(!t||!n)return null;var r={},l=this.props.clickRadius;this.props.interactiveLayerIds&&(r.layers=this.props.interactiveLayerIds);try{return t.queryRenderedFeatures(l?[[n[0]-l,n[1]+l],[n[0]+l,n[1]-l]]:n,r)}catch{return null}}function uh(n,t){var r=this.props[n];r&&r(ab.call(this,t))}function bj(n){uh.call(this,n.pointerType==="touch"?"onTouchStart":"onMouseDown",n)}function Ej(n){uh.call(this,n.pointerType==="touch"?"onTouchEnd":"onMouseUp",n)}function Tj(n){if(uh.call(this,n.pointerType==="touch"?"onTouchMove":"onMouseMove",n),!this.state.isDragging){var t=this.props,r=t.onHover,l=t.interactiveLayerIds,d;n=ab.call(this,n),(l||r)&&(d=S6.call(this,n.point));var m=!!(l&&d&&d.length>0),x=m&&!this.state.isHovering,C=!m&&this.state.isHovering;(r||x)&&(n.features=d,r&&r(n)),x&&uh.call(this,"onMouseEnter",n),C&&uh.call(this,"onMouseLeave",n),(x||C)&&this.setState({isHovering:m})}}function xE(n){var t=this.props,r=t.onClick,l=t.onNativeClick,d=t.onDblClick,m=t.doubleClickZoom,x=[],C=d||m;switch(n.type){case"anyclick":x.push(l),C||x.push(r);break;case"click":C&&x.push(r);break}x=x.filter(Boolean),x.length&&(n=ab.call(this,n),n.features=S6.call(this,n.point),x.forEach(function(a){return a(n)}))}function Cj(n){return{getMap:n.current&&n.current.getMap,queryRenderedFeatures:n.current&&n.current.queryRenderedFeatures}}var Py=He.forwardRef(function(n,t){var r=He.useContext(Gm),l=He.useMemo(function(){return n.controller||new C6},[]),d=He.useMemo(function(){return new yj(null,{touchAction:n.touchAction,recognizerOptions:n.eventRecognizerOptions})},[]),m=He.useRef(null),x=He.useRef(null),C=He.useRef({width:0,height:0,state:{isHovering:!1,isDragging:!1}}),a=C.current;a.props=n,a.map=x.current&&x.current.getMap(),a.setState=function(Ve){a.state=eh(eh({},a.state),Ve),m.current.style.cursor=n.getCursor(a.state)};var M=!0,R,j,F=function(Ke,et,qe){if(M){R=[Ke,et,qe];return}var ge=a.props,We=ge.onViewStateChange,Ue=ge.onViewportChange;Object.defineProperty(Ke,"position",{get:function(){return[0,0,My(a.map,Ke)]}}),We&&We({viewState:Ke,interactionState:et,oldViewState:qe}),Ue&&Ue(Ke,et,qe)};He.useImperativeHandle(t,function(){return Cj(x)},[]);var Z=He.useMemo(function(){return eh(eh({},r),{},{eventManager:d,container:r.container||m.current})},[r,m.current]);Z.onViewportChange=F,Z.viewport=r.viewport||w6(a),a.viewport=Z.viewport;var Y=function(Ke){var et=Ke.isDragging,qe=et===void 0?!1:et;if(qe!==a.state.isDragging&&a.setState({isDragging:qe}),M){j=Ke;return}var ge=a.props.onInteractionStateChange;ge&&ge(Ke)},ne=function(){a.width&&a.height&&l.setOptions(eh(eh(eh({},a.props),a.props.viewState),{},{isInteractive:!!(a.props.onViewStateChange||a.props.onViewportChange),onViewportChange:F,onStateChange:Y,eventManager:d,width:a.width,height:a.height}))},se=function(Ke){var et=Ke.width,qe=Ke.height;a.width=et,a.height=qe,ne(),a.props.onResize({width:et,height:qe})};He.useEffect(function(){return d.setElement(m.current),d.on({pointerdown:bj.bind(a),pointermove:Tj.bind(a),pointerup:Ej.bind(a),pointerleave:uh.bind(a,"onMouseOut"),click:xE.bind(a),anyclick:xE.bind(a),dblclick:uh.bind(a,"onDblClick"),wheel:uh.bind(a,"onWheel"),contextmenu:uh.bind(a,"onContextMenu")}),function(){d.destroy()}},[]),Wx(function(){R&&F.apply(void 0,XD(R)),j&&Y(j)}),ne();var xe=n.width,Se=n.height,_e=n.style,Ie=n.getCursor,Me=He.useMemo(function(){return eh(eh({position:"relative"},_e),{},{width:xe,height:Se,cursor:Ie(a.state)})},[_e,xe,Se,Ie,a.state]);return(!R||!a._child)&&(a._child=He.createElement(nb,{value:Z},He.createElement("div",{key:"event-canvas",ref:m,style:Me},He.createElement(zd,Y_({},n,{width:"100%",height:"100%",style:null,onResize:se,ref:x}))))),M=!1,a._child});Py.supported=zd.supported;Py.propTypes=vj;Py.defaultProps=wj;pt.string.isRequired;var Sj=["fill","line","symbol","circle","fill-extrusion","raster","background","heatmap","hillshade","sky"];pt.oneOf(Sj).isRequired;var Bd={captureScroll:!1,captureDrag:!0,captureClick:!0,captureDoubleClick:!0,capturePointerMove:!1},ic={captureScroll:pt.bool,captureDrag:pt.bool,captureClick:pt.bool,captureDoubleClick:pt.bool,capturePointerMove:pt.bool};function kj(n){var t=n.containerRef.current,r=n.context.eventManager;if(!(!t||!r)){var l={wheel:function(m){var x=n.props;x.captureScroll&&m.stopPropagation(),x.onScroll&&x.onScroll(m,n)},panstart:function(m){var x=n.props;x.captureDrag&&m.stopPropagation(),x.onDragStart&&x.onDragStart(m,n)},anyclick:function(m){var x=n.props;x.captureClick&&m.stopPropagation(),x.onNativeClick&&x.onNativeClick(m,n)},click:function(m){var x=n.props;x.captureClick&&m.stopPropagation(),x.onClick&&x.onClick(m,n)},dblclick:function(m){var x=n.props;x.captureDoubleClick&&m.stopPropagation(),x.onDoubleClick&&x.onDoubleClick(m,n)},pointermove:function(m){var x=n.props;x.capturePointerMove&&m.stopPropagation(),x.onPointerMove&&x.onPointerMove(m,n)}};return r.watch(l,t),function(){r.off(l)}}}function jd(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=He.useContext(Gm),r=He.useRef(null),l=He.useRef({props:n,state:{},context:t,containerRef:r}),d=l.current;return d.props=n,d.context=t,He.useEffect(function(){return kj(d)},[t.eventManager]),d}function Mj(n){var t=Aj();return function(){var l=Pd(n),d;if(t){var m=Pd(this).constructor;d=Reflect.construct(l,arguments,m)}else d=l.apply(this,arguments);return ib(this,d)}}function Aj(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Pj(n){var t=n.instance,r=jd(n),l=r.context,d=r.containerRef;return t._context=l,t._containerRef=d,t._render()}var k6=function(n){rb(r,n);var t=Mj(r);function r(){var l;Od(this,r);for(var d=arguments.length,m=new Array(d),x=0;x<d;x++)m[x]=arguments[x];return l=t.call.apply(t,[this].concat(m)),Vn(nh(l),"_context",{}),Vn(nh(l),"_containerRef",He.createRef()),Vn(nh(l),"_onScroll",function(C){}),Vn(nh(l),"_onDragStart",function(C){}),Vn(nh(l),"_onDblClick",function(C){}),Vn(nh(l),"_onClick",function(C){}),Vn(nh(l),"_onPointerMove",function(C){}),l}return Dd(r,[{key:"_render",value:function(){throw new Error("_render() not implemented")}},{key:"render",value:function(){return He.createElement(Pj,Y_({instance:this},this.props,{onScroll:this._onScroll,onDragStart:this._onDragStart,onDblClick:this._onDblClick,onClick:this._onClick,onPointerMove:this._onPointerMove}))}}]),r}(He.PureComponent);Vn(k6,"propTypes",ic);Vn(k6,"defaultProps",Bd);function wE(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);t&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(n,d).enumerable})),r.push.apply(r,l)}return r}function bE(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wE(Object(r),!0).forEach(function(l){Vn(n,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):wE(Object(r)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(r,l))})}return n}var Ij=Object.assign({},ic,{draggable:pt.bool,onDrag:pt.func,onDragEnd:pt.func,onDragStart:pt.func,offsetLeft:pt.number,offsetTop:pt.number}),Lj=Object.assign({},Bd,{draggable:!1,offsetLeft:0,offsetTop:0});function M6(n){var t=n.offsetCenter,r=t.x,l=t.y;return[r,l]}function Rj(n,t){var r=n.center,l=r.x,d=r.y;if(t){var m=t.getBoundingClientRect();return[m.left-l,m.top-d]}return null}function lb(n,t,r,l){var d=n[0]+t[0]-r.offsetLeft,m=n[1]+t[1]-r.offsetTop;return l.viewport.unproject([d,m])}function Oj(n,t){var r=t.props,l=t.callbacks,d=t.state,m=t.context,x=t.containerRef,C=r.draggable;if(C){n.stopPropagation();var a=M6(n),M=Rj(n,x.current);if(d.setDragPos(a),d.setDragOffset(M),l.onDragStart&&M){var R=Object.assign({},n);R.lngLat=lb(a,M,r,m),l.onDragStart(R)}}}function Dj(n,t){var r=t.props,l=t.callbacks,d=t.state,m=t.context;n.stopPropagation();var x=M6(n);d.setDragPos(x);var C=d.dragOffset;if(l.onDrag&&C){var a=Object.assign({},n);a.lngLat=lb(x,C,r,m),l.onDrag(a)}}function zj(n,t){var r=t.props,l=t.callbacks,d=t.state,m=t.context;n.stopPropagation();var x=d.dragPos,C=d.dragOffset;if(d.setDragPos(null),d.setDragOffset(null),l.onDragEnd&&x&&C){var a=Object.assign({},n);a.lngLat=lb(x,C,r,m),l.onDragEnd(a)}}function Bj(n,t){var r=t.state;n.stopPropagation(),r.setDragPos(null),r.setDragOffset(null)}function jj(n){var t=n.context.eventManager;if(!(!t||!n.state.dragPos)){var r={panmove:function(d){return Dj(d,n)},panend:function(d){return zj(d,n)},pancancel:function(d){return Bj(d,n)}};return t.watch(r),function(){t.off(r)}}}function Nj(n){var t=He.useState(null),r=Go(t,2),l=r[0],d=r[1],m=He.useState(null),x=Go(m,2),C=x[0],a=x[1],M=jd(bE(bE({},n),{},{onDragStart:Oj}));return M.callbacks=n,M.state.dragPos=l,M.state.setDragPos=d,M.state.dragOffset=C,M.state.setDragOffset=a,He.useEffect(function(){return jj(M)},[M.context.eventManager,!!l]),M}var EE=typeof window<"u"&&window.devicePixelRatio||1,j0=function(t){return Math.round(t*EE)/EE},TE=function(t,r){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"x";if(t===null)return r;var d=l==="x"?t.offsetWidth:t.offsetHeight;return j0(r/100*d)/d*100};function CE(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);t&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(n,d).enumerable})),r.push.apply(r,l)}return r}function Fj(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CE(Object(r),!0).forEach(function(l){Vn(n,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):CE(Object(r)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(r,l))})}return n}var Uj=Object.assign({},Ij,{className:pt.string,longitude:pt.number.isRequired,latitude:pt.number.isRequired,style:pt.object}),$j=Object.assign({},Lj,{className:""});function Vj(n){var t=n.props,r=n.state,l=n.context,d=t.longitude,m=t.latitude,x=t.offsetLeft,C=t.offsetTop,a=r.dragPos,M=r.dragOffset,R=l.viewport,j=l.map;if(a&&M)return[a[0]+M[0],a[1]+M[1]];var F=My(j,{longitude:d,latitude:m}),Z=R.project([d,m,F]),Y=Go(Z,2),ne=Y[0],se=Y[1];return ne+=x,se+=C,[ne,se]}function cb(n){var t=Nj(n),r=t.state,l=t.containerRef,d=n.children,m=n.className,x=n.draggable,C=n.style,a=r.dragPos,M=Vj(t),R=Go(M,2),j=R[0],F=R[1],Z="translate(".concat(j0(j),"px, ").concat(j0(F),"px)"),Y=x?a?"grabbing":"grab":"auto",ne=He.useMemo(function(){var xe=Fj({position:"absolute",left:0,top:0,transform:Z,cursor:Y},C);return He.createElement("div",{className:"mapboxgl-marker ".concat(m),ref:t.containerRef,style:xe},d)},[d,m]),se=l.current;return se&&(se.style.transform=Z,se.style.cursor=Y),ne}cb.defaultProps=$j;cb.propTypes=Uj;const tx=He.memo(cb);var N0={top:{x:.5,y:0},"top-left":{x:0,y:0},"top-right":{x:1,y:0},bottom:{x:.5,y:1},"bottom-left":{x:0,y:1},"bottom-right":{x:1,y:1},left:{x:0,y:.5},right:{x:1,y:.5}},Wj=Object.keys(N0);function qj(n){var t=n.x,r=n.y,l=n.width,d=n.height,m=n.selfWidth,x=n.selfHeight,C=n.anchor,a=n.padding,M=a===void 0?0:a,R=N0[C],j=R.x,F=R.y,Z=r-F*x,Y=Z+x,ne=Math.max(0,M-Z)+Math.max(0,Y-d+M);if(ne>0){var se=F,xe=ne;for(F=0;F<=1;F+=.5)Z=r-F*x,Y=Z+x,ne=Math.max(0,M-Z)+Math.max(0,Y-d+M),ne<xe&&(xe=ne,se=F);F=se}var Se=.5;F===.5&&(j=Math.floor(j),Se=1);var _e=t-j*m,Ie=_e+m,Me=Math.max(0,M-_e)+Math.max(0,Ie-l+M);if(Me>0){var Ve=j,Ke=Me;for(j=0;j<=1;j+=Se)_e=t-j*m,Ie=_e+m,Me=Math.max(0,M-_e)+Math.max(0,Ie-l+M),Me<Ke&&(Ke=Me,Ve=j);j=Ve}return Wj.find(function(et){var qe=N0[et];return qe.x===j&&qe.y===F})||C}var Gj=Object.assign({},ic,{className:pt.string,longitude:pt.number.isRequired,latitude:pt.number.isRequired,altitude:pt.number,offsetLeft:pt.number,offsetTop:pt.number,tipSize:pt.number,closeButton:pt.bool,closeOnClick:pt.bool,anchor:pt.oneOf(Object.keys(N0)),dynamicPosition:pt.bool,sortByDepth:pt.bool,onClose:pt.func}),Zj=Object.assign({},Bd,{className:"",offsetLeft:0,offsetTop:0,tipSize:10,anchor:"bottom",dynamicPosition:!0,sortByDepth:!1,closeButton:!0,closeOnClick:!0,onClose:function(){}});function Hj(n,t,r,l){var d=Go(l,2),m=d[0],x=d[1],C=n.anchor,a=n.dynamicPosition,M=n.tipSize;return r&&a?qj({x:m,y:x,anchor:C,padding:M,width:t.width,height:t.height,selfWidth:r.clientWidth,selfHeight:r.clientHeight}):C}function Kj(n,t,r,l,d){var m=Go(l,3),x=m[0],C=m[1],a=m[2],M=n.offsetLeft,R=n.offsetTop,j=n.sortByDepth,F=N0[d],Z=x+M,Y=C+R,ne=TE(r,-F.x*100),se=TE(r,-F.y*100,"y"),xe={position:"absolute",transform:`
      translate(`.concat(ne,"%, ").concat(se,`%)
      translate(`).concat(j0(Z),"px, ").concat(j0(Y),`px)
    `),display:void 0,zIndex:void 0};return j&&(a>1||a<-1||x<0||x>t.width||C<0||C>t.height?xe.display="none":xe.zIndex=Math.floor((1-a)/2*1e5)),xe}function ub(n){var t=He.useRef(null),r=jd(n),l=r.context,d=r.containerRef,m=He.useState(!1),x=Go(m,2),C=x[1];He.useEffect(function(){C(!0)},[t.current]),He.useEffect(function(){if(l.eventManager&&n.closeOnClick){var Me=function(){return r.props.onClose()};return l.eventManager.on("anyclick",Me),function(){l.eventManager.off("anyclick",Me)}}},[l.eventManager,n.closeOnClick]);var a=l.viewport,M=l.map,R=n.className,j=n.longitude,F=n.latitude,Z=n.tipSize,Y=n.closeButton,ne=n.children,se=n.altitude;se===void 0&&(se=My(M,{longitude:j,latitude:F}));var xe=a.project([j,F,se]),Se=Hj(n,a,t.current,xe),_e=Kj(n,a,d.current,xe,Se),Ie=He.useCallback(function(Me){r.props.onClose();var Ve=r.context.eventManager;Ve&&Ve.once("click",function(Ke){return Ke.stopPropagation()},Me.target)},[]);return He.createElement("div",{className:"mapboxgl-popup mapboxgl-popup-anchor-".concat(Se," ").concat(R),style:_e,ref:d},He.createElement("div",{key:"tip",className:"mapboxgl-popup-tip",style:{borderWidth:Z}}),He.createElement("div",{key:"content",ref:t,className:"mapboxgl-popup-content"},Y&&He.createElement("button",{key:"close-button",className:"mapboxgl-popup-close-button",type:"button",onClick:Ie},"×"),ne))}ub.propTypes=Gj;ub.defaultProps=Zj;He.memo(ub);function SE(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);t&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(n,d).enumerable})),r.push.apply(r,l)}return r}function Xj(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SE(Object(r),!0).forEach(function(l){Vn(n,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):SE(Object(r)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(r,l))})}return n}var Yj=Object.assign({},ic,{toggleLabel:pt.string,className:pt.string,style:pt.object,compact:pt.bool,customAttribution:pt.oneOfType([pt.string,pt.arrayOf(pt.string)])}),Jj=Object.assign({},Bd,{className:"",toggleLabel:"Toggle Attribution"});function Qj(n,t,r,l){var d=new lu.AttributionControl(n);return d._map=t,d._container=r,d._innerContainer=l,d._updateAttributions(),d._updateEditLink(),t.on("styledata",d._updateData),t.on("sourcedata",d._updateData),d}function eN(n){n._map.off("styledata",n._updateData),n._map.off("sourcedata",n._updateData)}function hb(n){var t=jd(n),r=t.context,l=t.containerRef,d=He.useRef(null),m=He.useState(!1),x=Go(m,2),C=x[0],a=x[1];He.useEffect(function(){var F;return r.map&&(F=Qj({customAttribution:n.customAttribution},r.map,l.current,d.current)),function(){return F&&eN(F)}},[r.map]);var M=n.compact===void 0?r.viewport.width<=640:n.compact;He.useEffect(function(){!M&&C&&a(!1)},[M]);var R=He.useCallback(function(){return a(function(F){return!F})},[]),j=He.useMemo(function(){return Xj({position:"absolute"},n.style)},[n.style]);return He.createElement("div",{style:j,className:n.className},He.createElement("div",{ref:l,"aria-pressed":C,className:"mapboxgl-ctrl mapboxgl-ctrl-attrib ".concat(M?"mapboxgl-compact":""," ").concat(C?"mapboxgl-compact-show":"")},He.createElement("button",{type:"button",className:"mapboxgl-ctrl-attrib-button",title:n.toggleLabel,onClick:R}),He.createElement("div",{ref:d,className:"mapboxgl-ctrl-attrib-inner",role:"list"})))}hb.propTypes=Yj;hb.defaultProps=Jj;He.memo(hb);function kE(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);t&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(n,d).enumerable})),r.push.apply(r,l)}return r}function tN(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kE(Object(r),!0).forEach(function(l){Vn(n,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):kE(Object(r)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(r,l))})}return n}var nN=Object.assign({},ic,{className:pt.string,style:pt.object,container:pt.object,label:pt.string}),rN=Object.assign({},Bd,{className:"",container:null,label:"Toggle fullscreen"});function db(n){var t=jd(n),r=t.context,l=t.containerRef,d=He.useState(!1),m=Go(d,2),x=m[0],C=m[1],a=He.useState(!1),M=Go(a,2),R=M[0],j=M[1],F=He.useState(null),Z=Go(F,2),Y=Z[0],ne=Z[1];He.useEffect(function(){var Me=new lu.FullscreenControl;ne(Me),j(Me._checkFullscreenSupport());var Ve=function(){var et=!Me._fullscreen;Me._fullscreen=et,C(et)};return lh.addEventListener(Me._fullscreenchange,Ve),function(){lh.removeEventListener(Me._fullscreenchange,Ve)}},[]);var se=function(){Y&&(Y._container=n.container||r.container,Y._onClickFullscreen())},xe=He.useMemo(function(){return tN({position:"absolute"},n.style)},[n.style]);if(!R)return null;var Se=n.className,_e=n.label,Ie=x?"shrink":"fullscreen";return He.createElement("div",{style:xe,className:Se},He.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:l},He.createElement("button",{key:Ie,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(Ie),type:"button",title:_e,onClick:se},He.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}db.propTypes=nN;db.defaultProps=rN;He.memo(db);var cm;function iN(){return cm!==void 0?Promise.resolve(cm):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(function(n){return cm=n.state!=="denied",cm}):(cm=!!window.navigator.geolocation,Promise.resolve(cm))}function ME(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);t&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(n,d).enumerable})),r.push.apply(r,l)}return r}function oN(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ME(Object(r),!0).forEach(function(l){Vn(n,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):ME(Object(r)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(r,l))})}return n}var AE=function(){},sN=Object.assign({},ic,{className:pt.string,style:pt.object,label:pt.string,disabledLabel:pt.string,auto:pt.bool,positionOptions:pt.object,fitBoundsOptions:pt.object,trackUserLocation:pt.bool,showUserLocation:pt.bool,showAccuracyCircle:pt.bool,showUserHeading:pt.bool,onViewStateChange:pt.func,onViewportChange:pt.func,onGeolocate:pt.func}),aN=Object.assign({},Bd,{className:"",label:"Find My Location",disabledLabel:"Location Not Available",auto:!1,positionOptions:{enableHighAccuracy:!1,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0,showUserHeading:!1,showAccuracyCircle:!0,onGeolocate:function(){}});function lN(n){var t=new lu.LngLat(n.coords.longitude,n.coords.latitude),r=n.coords.accuracy,l=t.toBounds(r);return[[l._ne.lng,l._ne.lat],[l._sw.lng,l._sw.lat]]}function cN(n,t,r){var l=new lu.GeolocateControl(t);l._container=lh.createElement("div"),l._map={on:function(){},_getUIString:function(){return""}},l._setupUI(!0),l._map=n.map,l._geolocateButton=r;var d=n.eventManager;return l.options.trackUserLocation&&d&&d.on("panstart",function(){l._watchState==="ACTIVE_LOCK"&&(l._watchState="BACKGROUND",r.classList.add("mapboxgl-ctrl-geolocate-background"),r.classList.remove("mapboxgl-ctrl-geolocate-active"))}),l.on("geolocate",t.onGeolocate),l}function uN(n,t){var r=t.context,l=t.props,d=lN(n),m=r.viewport.fitBounds(d,l.fitBoundsOptions),x=m.longitude,C=m.latitude,a=m.zoom,M=Object.assign({},r.viewport,{longitude:x,latitude:C,zoom:a}),R=new Im(M),j=Object.assign({},R.getViewportProps(),rh),F=l.onViewportChange||r.onViewportChange||AE,Z=l.onViewStateChange||r.onViewStateChange||AE;Z({viewState:j}),F(j)}function fb(n){var t=jd(n),r=t.context,l=t.containerRef,d=He.useRef(null),m=He.useState(null),x=Go(m,2),C=x[0],a=x[1],M=He.useState(!1),R=Go(M,2),j=R[0],F=R[1];He.useEffect(function(){var _e;return r.map&&iN().then(function(Ie){F(Ie),d.current&&(_e=cN(r,n,d.current),_e._updateCamera=function(Me){return uN(Me,t)},a(_e))}),function(){_e&&_e._clearWatch()}},[r.map]);var Z=He.useCallback(function(){C&&(C.options=t.props,C.trigger())},[C]);He.useEffect(function(){n.auto&&Z()},[C,n.auto]),He.useEffect(function(){C&&C._onZoom()},[r.viewport.zoom]);var Y=n.className,ne=n.label,se=n.disabledLabel,xe=n.trackUserLocation,Se=He.useMemo(function(){return oN({position:"absolute"},n.style)},[n.style]);return He.createElement("div",{style:Se,className:Y},He.createElement("div",{key:"geolocate-control",className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:l},He.createElement("button",{key:"geolocate",className:"mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",ref:d,disabled:!j,"aria-pressed":!xe,type:"button",title:j?ne:se,"aria-label":j?ne:se,onClick:Z},He.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}fb.propTypes=sN;fb.defaultProps=aN;He.memo(fb);function hN(n,t){for(var r=(n||"").split(".").map(Number),l=t.split(".").map(Number),d=0;d<3;d++){var m=r[d]||0,x=l[d]||0;if(m<x)return-1;if(m>x)return 1}return 0}function PE(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);t&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(n,d).enumerable})),r.push.apply(r,l)}return r}function dN(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PE(Object(r),!0).forEach(function(l){Vn(n,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):PE(Object(r)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(r,l))})}return n}var IE=function(){},fN=Object.assign({},ic,{className:pt.string,style:pt.object,onViewStateChange:pt.func,onViewportChange:pt.func,showCompass:pt.bool,showZoom:pt.bool,zoomInLabel:pt.string,zoomOutLabel:pt.string,compassLabel:pt.string}),pN=Object.assign({},Bd,{className:"",showCompass:!0,showZoom:!0,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",compassLabel:"Reset North"}),mN=1,Xx=2;function gN(n){return hN(n,"1.6.0")>=0?Xx:mN}function nx(n,t,r){var l=n.viewport,d=new Im(Object.assign({},l,r)),m=Object.assign({},d.getViewportProps(),rh),x=t.onViewportChange||n.onViewportChange||IE,C=t.onViewStateChange||n.onViewStateChange||IE;C({viewState:m}),x(m)}function rx(n,t,r,l){return He.createElement("button",{key:n,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(n),type:"button",title:t,onClick:r},l||He.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}function _N(n){var t=He.useMemo(function(){return n.map?gN(n.map.version):Xx},[n.map]),r=n.viewport.bearing,l={transform:"rotate(".concat(-r,"deg)")};return t===Xx?He.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true",style:l}):He.createElement("span",{className:"mapboxgl-ctrl-compass-arrow",style:l})}function pb(n){var t=jd(n),r=t.context,l=t.containerRef,d=function(){nx(r,n,{zoom:r.viewport.zoom+1})},m=function(){nx(r,n,{zoom:r.viewport.zoom-1})},x=function(){nx(r,n,{bearing:0,pitch:0})},C=n.className,a=n.showCompass,M=n.showZoom,R=n.zoomInLabel,j=n.zoomOutLabel,F=n.compassLabel,Z=He.useMemo(function(){return dN({position:"absolute"},n.style)},[n.style]);return He.createElement("div",{style:Z,className:C},He.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:l},M&&rx("zoom-in",R,d),M&&rx("zoom-out",j,m),a&&rx("compass",F,x,_N(r))))}pb.propTypes=fN;pb.defaultProps=pN;He.memo(pb);function LE(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);t&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(n,d).enumerable})),r.push.apply(r,l)}return r}function yN(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LE(Object(r),!0).forEach(function(l){Vn(n,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):LE(Object(r)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(r,l))})}return n}var vN=Object.assign({},ic,{className:pt.string,style:pt.object,maxWidth:pt.number,unit:pt.oneOf(["imperial","metric","nautical"])}),xN=Object.assign({},Bd,{className:"",maxWidth:100,unit:"metric"});function mb(n){var t=jd(n),r=t.context,l=t.containerRef,d=He.useState(null),m=Go(d,2),x=m[0],C=m[1];He.useEffect(function(){if(r.map){var M=new lu.ScaleControl;M._map=r.map,M._container=l.current,C(M)}},[r.map]),x&&(x.options=n,x._onMove&&x._onMove());var a=He.useMemo(function(){return yN({position:"absolute"},n.style)},[n.style]);return He.createElement("div",{style:a,className:n.className},He.createElement("div",{ref:l,className:"mapboxgl-ctrl mapboxgl-ctrl-scale"}))}mb.propTypes=vN;mb.defaultProps=xN;He.memo(mb);Object.assign({},ic,{redraw:pt.func.isRequired});Object.assign({},ic,{redraw:pt.func.isRequired,style:pt.object});Object.assign({},ic,{redraw:pt.func.isRequired,style:pt.object});lu&&lu.setRTLTextPlugin;const RE=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],ix=1,Zg=8;class gb{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,l]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const d=l>>4;if(d!==ix)throw new Error(`Got v${d} data when expected v${ix}.`);const m=RE[l&15];if(!m)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(t,2,1),[C]=new Uint32Array(t,4,1);return new gb(C,x,m,t)}constructor(t,r=64,l=Float64Array,d){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=l,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const m=RE.indexOf(this.ArrayType),x=t*2*this.ArrayType.BYTES_PER_ELEMENT,C=t*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-C%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${l}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,Zg,t),this.coords=new this.ArrayType(this.data,Zg+C+a,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(Zg+x+C+a),this.ids=new this.IndexArrayType(this.data,Zg,t),this.coords=new this.ArrayType(this.data,Zg+C+a,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(ix<<4)+m]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=t,this.coords[this._pos++]=r,l}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Yx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,l,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:x,nodeSize:C}=this,a=[0,m.length-1,0],M=[];for(;a.length;){const R=a.pop()||0,j=a.pop()||0,F=a.pop()||0;if(j-F<=C){for(let se=F;se<=j;se++){const xe=x[2*se],Se=x[2*se+1];xe>=t&&xe<=l&&Se>=r&&Se<=d&&M.push(m[se])}continue}const Z=F+j>>1,Y=x[2*Z],ne=x[2*Z+1];Y>=t&&Y<=l&&ne>=r&&ne<=d&&M.push(m[Z]),(R===0?t<=Y:r<=ne)&&(a.push(F),a.push(Z-1),a.push(1-R)),(R===0?l>=Y:d>=ne)&&(a.push(Z+1),a.push(j),a.push(1-R))}return M}within(t,r,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:m,nodeSize:x}=this,C=[0,d.length-1,0],a=[],M=l*l;for(;C.length;){const R=C.pop()||0,j=C.pop()||0,F=C.pop()||0;if(j-F<=x){for(let se=F;se<=j;se++)OE(m[2*se],m[2*se+1],t,r)<=M&&a.push(d[se]);continue}const Z=F+j>>1,Y=m[2*Z],ne=m[2*Z+1];OE(Y,ne,t,r)<=M&&a.push(d[Z]),(R===0?t-l<=Y:r-l<=ne)&&(C.push(F),C.push(Z-1),C.push(1-R)),(R===0?t+l>=Y:r+l>=ne)&&(C.push(Z+1),C.push(j),C.push(1-R))}return a}}function Yx(n,t,r,l,d,m){if(d-l<=r)return;const x=l+d>>1;A6(n,t,x,l,d,m),Yx(n,t,r,l,x-1,1-m),Yx(n,t,r,x+1,d,1-m)}function A6(n,t,r,l,d,m){for(;d>l;){if(d-l>600){const M=d-l+1,R=r-l+1,j=Math.log(M),F=.5*Math.exp(2*j/3),Z=.5*Math.sqrt(j*F*(M-F)/M)*(R-M/2<0?-1:1),Y=Math.max(l,Math.floor(r-R*F/M+Z)),ne=Math.min(d,Math.floor(r+(M-R)*F/M+Z));A6(n,t,r,Y,ne,m)}const x=t[2*r+m];let C=l,a=d;for(Hg(n,t,l,r),t[2*d+m]>x&&Hg(n,t,l,d);C<a;){for(Hg(n,t,C,a),C++,a--;t[2*C+m]<x;)C++;for(;t[2*a+m]>x;)a--}t[2*l+m]===x?Hg(n,t,l,a):(a++,Hg(n,t,a,d)),a<=r&&(l=a+1),r<=a&&(d=a-1)}}function Hg(n,t,r,l){ox(n,r,l),ox(t,2*r,2*l),ox(t,2*r+1,2*l+1)}function ox(n,t,r){const l=n[t];n[t]=n[r],n[r]=l}function OE(n,t,r,l){const d=n-r,m=t-l;return d*d+m*m}const wN={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:n=>n},DE=Math.fround||(n=>t=>(n[0]=+t,n[0]))(new Float32Array(1)),Uf=2,dd=3,sx=4,cd=5,P6=6;class bN{constructor(t){this.options=Object.assign(Object.create(wN),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:r,minZoom:l,maxZoom:d}=this.options;r&&console.time("total time");const m=`prepare ${t.length} points`;r&&console.time(m),this.points=t;const x=[];for(let a=0;a<t.length;a++){const M=t[a];if(!M.geometry)continue;const[R,j]=M.geometry.coordinates,F=DE(c_(R)),Z=DE(u_(j));x.push(F,Z,1/0,a,-1,1),this.options.reduce&&x.push(0)}let C=this.trees[d+1]=this._createTree(x);r&&console.timeEnd(m);for(let a=d;a>=l;a--){const M=+Date.now();C=this.trees[a]=this._createTree(this._cluster(C,a)),r&&console.log("z%d: %d clusters in %dms",a,C.numItems,+Date.now()-M)}return r&&console.timeEnd("total time"),this}getClusters(t,r){let l=((t[0]+180)%360+360)%360-180;const d=Math.max(-90,Math.min(90,t[1]));let m=t[2]===180?180:((t[2]+180)%360+360)%360-180;const x=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)l=-180,m=180;else if(l>m){const j=this.getClusters([l,d,180,x],r),F=this.getClusters([-180,d,m,x],r);return j.concat(F)}const C=this.trees[this._limitZoom(r)],a=C.range(c_(l),u_(x),c_(m),u_(d)),M=C.data,R=[];for(const j of a){const F=this.stride*j;R.push(M[F+cd]>1?zE(M,F,this.clusterProps):this.points[M[F+dd]])}return R}getChildren(t){const r=this._getOriginId(t),l=this._getOriginZoom(t),d="No cluster with the specified id.",m=this.trees[l];if(!m)throw new Error(d);const x=m.data;if(r*this.stride>=x.length)throw new Error(d);const C=this.options.radius/(this.options.extent*Math.pow(2,l-1)),a=x[r*this.stride],M=x[r*this.stride+1],R=m.within(a,M,C),j=[];for(const F of R){const Z=F*this.stride;x[Z+sx]===t&&j.push(x[Z+cd]>1?zE(x,Z,this.clusterProps):this.points[x[Z+dd]])}if(j.length===0)throw new Error(d);return j}getLeaves(t,r,l){r=r||10,l=l||0;const d=[];return this._appendLeaves(d,t,r,l,0),d}getTile(t,r,l){const d=this.trees[this._limitZoom(t)],m=Math.pow(2,t),{extent:x,radius:C}=this.options,a=C/x,M=(l-a)/m,R=(l+1+a)/m,j={features:[]};return this._addTileFeatures(d.range((r-a)/m,M,(r+1+a)/m,R),d.data,r,l,m,j),r===0&&this._addTileFeatures(d.range(1-a/m,M,1,R),d.data,m,l,m,j),r===m-1&&this._addTileFeatures(d.range(0,M,a/m,R),d.data,-1,l,m,j),j.features.length?j:null}getClusterExpansionZoom(t){let r=this._getOriginZoom(t)-1;for(;r<=this.options.maxZoom;){const l=this.getChildren(t);if(r++,l.length!==1)break;t=l[0].properties.cluster_id}return r}_appendLeaves(t,r,l,d,m){const x=this.getChildren(r);for(const C of x){const a=C.properties;if(a&&a.cluster?m+a.point_count<=d?m+=a.point_count:m=this._appendLeaves(t,a.cluster_id,l,d,m):m<d?m++:t.push(C),t.length===l)break}return m}_createTree(t){const r=new gb(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let l=0;l<t.length;l+=this.stride)r.add(t[l],t[l+1]);return r.finish(),r.data=t,r}_addTileFeatures(t,r,l,d,m,x){for(const C of t){const a=C*this.stride,M=r[a+cd]>1;let R,j,F;if(M)R=I6(r,a,this.clusterProps),j=r[a],F=r[a+1];else{const ne=this.points[r[a+dd]];R=ne.properties;const[se,xe]=ne.geometry.coordinates;j=c_(se),F=u_(xe)}const Z={type:1,geometry:[[Math.round(this.options.extent*(j*m-l)),Math.round(this.options.extent*(F*m-d))]],tags:R};let Y;M||this.options.generateId?Y=r[a+dd]:Y=this.points[r[a+dd]].id,Y!==void 0&&(Z.id=Y),x.features.push(Z)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,r){const{radius:l,extent:d,reduce:m,minPoints:x}=this.options,C=l/(d*Math.pow(2,r)),a=t.data,M=[],R=this.stride;for(let j=0;j<a.length;j+=R){if(a[j+Uf]<=r)continue;a[j+Uf]=r;const F=a[j],Z=a[j+1],Y=t.within(a[j],a[j+1],C),ne=a[j+cd];let se=ne;for(const xe of Y){const Se=xe*R;a[Se+Uf]>r&&(se+=a[Se+cd])}if(se>ne&&se>=x){let xe=F*ne,Se=Z*ne,_e,Ie=-1;const Me=((j/R|0)<<5)+(r+1)+this.points.length;for(const Ve of Y){const Ke=Ve*R;if(a[Ke+Uf]<=r)continue;a[Ke+Uf]=r;const et=a[Ke+cd];xe+=a[Ke]*et,Se+=a[Ke+1]*et,a[Ke+sx]=Me,m&&(_e||(_e=this._map(a,j,!0),Ie=this.clusterProps.length,this.clusterProps.push(_e)),m(_e,this._map(a,Ke)))}a[j+sx]=Me,M.push(xe/se,Se/se,1/0,Me,-1,se),m&&M.push(Ie)}else{for(let xe=0;xe<R;xe++)M.push(a[j+xe]);if(se>1)for(const xe of Y){const Se=xe*R;if(!(a[Se+Uf]<=r)){a[Se+Uf]=r;for(let _e=0;_e<R;_e++)M.push(a[Se+_e])}}}}return M}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,r,l){if(t[r+cd]>1){const x=this.clusterProps[t[r+P6]];return l?Object.assign({},x):x}const d=this.points[t[r+dd]].properties,m=this.options.map(d);return l&&m===d?Object.assign({},m):m}}function zE(n,t,r){return{type:"Feature",id:n[t+dd],properties:I6(n,t,r),geometry:{type:"Point",coordinates:[EN(n[t]),TN(n[t+1])]}}}function I6(n,t,r){const l=n[t+cd],d=l>=1e4?`${Math.round(l/1e3)}k`:l>=1e3?`${Math.round(l/100)/10}k`:l,m=n[t+P6],x=m===-1?{}:Object.assign({},r[m]);return Object.assign(x,{cluster:!0,cluster_id:n[t+dd],point_count:l,point_count_abbreviated:d})}function c_(n){return n/360+.5}function u_(n){const t=Math.sin(n*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function EN(n){return(n-.5)*360}function TN(n){const t=(180-n*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}const CN="modulepreload",SN=function(n){return"/mini-app/"+n},BE={},Zm=function(t,r,l){let d=Promise.resolve();if(r&&r.length>0){let a=function(M){return Promise.all(M.map(R=>Promise.resolve(R).then(j=>({status:"fulfilled",value:j}),j=>({status:"rejected",reason:j}))))};document.getElementsByTagName("link");const x=document.querySelector("meta[property=csp-nonce]"),C=x?.nonce||x?.getAttribute("nonce");d=a(r.map(M=>{if(M=SN(M),M in BE)return;BE[M]=!0;const R=M.endsWith(".css"),j=R?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${M}"]${j}`))return;const F=document.createElement("link");if(F.rel=R?"stylesheet":CN,R||(F.as="script"),F.crossOrigin="",F.href=M,C&&F.setAttribute("nonce",C),document.head.appendChild(F),R)return new Promise((Z,Y)=>{F.addEventListener("load",Z),F.addEventListener("error",()=>Y(new Error(`Unable to preload CSS for ${M}`)))})}))}function m(x){const C=new Event("vite:preloadError",{cancelable:!0});if(C.payload=x,window.dispatchEvent(C),!C.defaultPrevented)throw x}return d.then(x=>{for(const C of x||[])C.status==="rejected"&&m(C.reason);return t().catch(m)})},kN=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...r)=>Zm(async()=>{const{default:l}=await Promise.resolve().then(()=>Hm);return{default:l}},void 0).then(({default:l})=>l(...r)):t=fetch,(...r)=>t(...r)};class _b extends Error{constructor(t,r="FunctionsError",l){super(t),this.name=r,this.context=l}}class MN extends _b{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class jE extends _b{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class NE extends _b{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Jx;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Jx||(Jx={}));var AN=function(n,t,r,l){function d(m){return m instanceof r?m:new r(function(x){x(m)})}return new(r||(r=Promise))(function(m,x){function C(R){try{M(l.next(R))}catch(j){x(j)}}function a(R){try{M(l.throw(R))}catch(j){x(j)}}function M(R){R.done?m(R.value):d(R.value).then(C,a)}M((l=l.apply(n,t||[])).next())})};class PN{constructor(t,{headers:r={},customFetch:l,region:d=Jx.Any}={}){this.url=t,this.headers=r,this.region=d,this.fetch=kN(l)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var l;return AN(this,void 0,void 0,function*(){try{const{headers:d,method:m,body:x}=r;let C={},{region:a}=r;a||(a=this.region);const M=new URL(`${this.url}/${t}`);a&&a!=="any"&&(C["x-region"]=a,M.searchParams.set("forceFunctionRegion",a));let R;x&&(d&&!Object.prototype.hasOwnProperty.call(d,"Content-Type")||!d)&&(typeof Blob<"u"&&x instanceof Blob||x instanceof ArrayBuffer?(C["Content-Type"]="application/octet-stream",R=x):typeof x=="string"?(C["Content-Type"]="text/plain",R=x):typeof FormData<"u"&&x instanceof FormData?R=x:(C["Content-Type"]="application/json",R=JSON.stringify(x)));const j=yield this.fetch(M.toString(),{method:m||"POST",headers:Object.assign(Object.assign(Object.assign({},C),this.headers),d),body:R}).catch(ne=>{throw new MN(ne)}),F=j.headers.get("x-relay-error");if(F&&F==="true")throw new jE(j);if(!j.ok)throw new NE(j);let Z=((l=j.headers.get("Content-Type"))!==null&&l!==void 0?l:"text/plain").split(";")[0].trim(),Y;return Z==="application/json"?Y=yield j.json():Z==="application/octet-stream"?Y=yield j.blob():Z==="text/event-stream"?Y=j:Z==="multipart/form-data"?Y=yield j.formData():Y=yield j.text(),{data:Y,error:null,response:j}}catch(d){return{data:null,error:d,response:d instanceof NE||d instanceof jE?d.context:void 0}}})}}var fs={},um={},hm={},dm={},fm={},pm={},IN=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Nm=IN();const LN=Nm.fetch,L6=Nm.fetch.bind(Nm),R6=Nm.Headers,RN=Nm.Request,ON=Nm.Response,Hm=Object.freeze(Object.defineProperty({__proto__:null,Headers:R6,Request:RN,Response:ON,default:L6,fetch:LN},Symbol.toStringTag,{value:"Module"})),DN=dT(Hm);var h_={},FE;function O6(){if(FE)return h_;FE=1,Object.defineProperty(h_,"__esModule",{value:!0});class n extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return h_.default=n,h_}var UE;function D6(){if(UE)return pm;UE=1;var n=pm&&pm.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(pm,"__esModule",{value:!0});const t=n(DN),r=n(O6());class l{constructor(m){this.shouldThrowOnError=!1,this.method=m.method,this.url=m.url,this.headers=m.headers,this.schema=m.schema,this.body=m.body,this.shouldThrowOnError=m.shouldThrowOnError,this.signal=m.signal,this.isMaybeSingle=m.isMaybeSingle,m.fetch?this.fetch=m.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(m,x){return this.headers=Object.assign({},this.headers),this.headers[m]=x,this}then(m,x){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const C=this.fetch;let a=C(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async M=>{var R,j,F;let Z=null,Y=null,ne=null,se=M.status,xe=M.statusText;if(M.ok){if(this.method!=="HEAD"){const Me=await M.text();Me===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?Y=Me:Y=JSON.parse(Me))}const _e=(R=this.headers.Prefer)===null||R===void 0?void 0:R.match(/count=(exact|planned|estimated)/),Ie=(j=M.headers.get("content-range"))===null||j===void 0?void 0:j.split("/");_e&&Ie&&Ie.length>1&&(ne=parseInt(Ie[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(Y)&&(Y.length>1?(Z={code:"PGRST116",details:`Results contain ${Y.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},Y=null,ne=null,se=406,xe="Not Acceptable"):Y.length===1?Y=Y[0]:Y=null)}else{const _e=await M.text();try{Z=JSON.parse(_e),Array.isArray(Z)&&M.status===404&&(Y=[],Z=null,se=200,xe="OK")}catch{M.status===404&&_e===""?(se=204,xe="No Content"):Z={message:_e}}if(Z&&this.isMaybeSingle&&(!((F=Z?.details)===null||F===void 0)&&F.includes("0 rows"))&&(Z=null,se=200,xe="OK"),Z&&this.shouldThrowOnError)throw new r.default(Z)}return{error:Z,data:Y,count:ne,status:se,statusText:xe}});return this.shouldThrowOnError||(a=a.catch(M=>{var R,j,F;return{error:{message:`${(R=M?.name)!==null&&R!==void 0?R:"FetchError"}: ${M?.message}`,details:`${(j=M?.stack)!==null&&j!==void 0?j:""}`,hint:"",code:`${(F=M?.code)!==null&&F!==void 0?F:""}`},data:null,count:null,status:0,statusText:""}})),a.then(m,x)}returns(){return this}overrideTypes(){return this}}return pm.default=l,pm}var $E;function z6(){if($E)return fm;$E=1;var n=fm&&fm.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(fm,"__esModule",{value:!0});const t=n(D6());class r extends t.default{select(d){let m=!1;const x=(d??"*").split("").map(C=>/\s/.test(C)&&!m?"":(C==='"'&&(m=!m),C)).join("");return this.url.searchParams.set("select",x),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(d,{ascending:m=!0,nullsFirst:x,foreignTable:C,referencedTable:a=C}={}){const M=a?`${a}.order`:"order",R=this.url.searchParams.get(M);return this.url.searchParams.set(M,`${R?`${R},`:""}${d}.${m?"asc":"desc"}${x===void 0?"":x?".nullsfirst":".nullslast"}`),this}limit(d,{foreignTable:m,referencedTable:x=m}={}){const C=typeof x>"u"?"limit":`${x}.limit`;return this.url.searchParams.set(C,`${d}`),this}range(d,m,{foreignTable:x,referencedTable:C=x}={}){const a=typeof C>"u"?"offset":`${C}.offset`,M=typeof C>"u"?"limit":`${C}.limit`;return this.url.searchParams.set(a,`${d}`),this.url.searchParams.set(M,`${m-d+1}`),this}abortSignal(d){return this.signal=d,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:d=!1,verbose:m=!1,settings:x=!1,buffers:C=!1,wal:a=!1,format:M="text"}={}){var R;const j=[d?"analyze":null,m?"verbose":null,x?"settings":null,C?"buffers":null,a?"wal":null].filter(Boolean).join("|"),F=(R=this.headers.Accept)!==null&&R!==void 0?R:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${M}; for="${F}"; options=${j};`,M==="json"?this:this}rollback(){var d;return((d=this.headers.Prefer)!==null&&d!==void 0?d:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return fm.default=r,fm}var VE;function yb(){if(VE)return dm;VE=1;var n=dm&&dm.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(dm,"__esModule",{value:!0});const t=n(z6());class r extends t.default{eq(d,m){return this.url.searchParams.append(d,`eq.${m}`),this}neq(d,m){return this.url.searchParams.append(d,`neq.${m}`),this}gt(d,m){return this.url.searchParams.append(d,`gt.${m}`),this}gte(d,m){return this.url.searchParams.append(d,`gte.${m}`),this}lt(d,m){return this.url.searchParams.append(d,`lt.${m}`),this}lte(d,m){return this.url.searchParams.append(d,`lte.${m}`),this}like(d,m){return this.url.searchParams.append(d,`like.${m}`),this}likeAllOf(d,m){return this.url.searchParams.append(d,`like(all).{${m.join(",")}}`),this}likeAnyOf(d,m){return this.url.searchParams.append(d,`like(any).{${m.join(",")}}`),this}ilike(d,m){return this.url.searchParams.append(d,`ilike.${m}`),this}ilikeAllOf(d,m){return this.url.searchParams.append(d,`ilike(all).{${m.join(",")}}`),this}ilikeAnyOf(d,m){return this.url.searchParams.append(d,`ilike(any).{${m.join(",")}}`),this}is(d,m){return this.url.searchParams.append(d,`is.${m}`),this}in(d,m){const x=Array.from(new Set(m)).map(C=>typeof C=="string"&&new RegExp("[,()]").test(C)?`"${C}"`:`${C}`).join(",");return this.url.searchParams.append(d,`in.(${x})`),this}contains(d,m){return typeof m=="string"?this.url.searchParams.append(d,`cs.${m}`):Array.isArray(m)?this.url.searchParams.append(d,`cs.{${m.join(",")}}`):this.url.searchParams.append(d,`cs.${JSON.stringify(m)}`),this}containedBy(d,m){return typeof m=="string"?this.url.searchParams.append(d,`cd.${m}`):Array.isArray(m)?this.url.searchParams.append(d,`cd.{${m.join(",")}}`):this.url.searchParams.append(d,`cd.${JSON.stringify(m)}`),this}rangeGt(d,m){return this.url.searchParams.append(d,`sr.${m}`),this}rangeGte(d,m){return this.url.searchParams.append(d,`nxl.${m}`),this}rangeLt(d,m){return this.url.searchParams.append(d,`sl.${m}`),this}rangeLte(d,m){return this.url.searchParams.append(d,`nxr.${m}`),this}rangeAdjacent(d,m){return this.url.searchParams.append(d,`adj.${m}`),this}overlaps(d,m){return typeof m=="string"?this.url.searchParams.append(d,`ov.${m}`):this.url.searchParams.append(d,`ov.{${m.join(",")}}`),this}textSearch(d,m,{config:x,type:C}={}){let a="";C==="plain"?a="pl":C==="phrase"?a="ph":C==="websearch"&&(a="w");const M=x===void 0?"":`(${x})`;return this.url.searchParams.append(d,`${a}fts${M}.${m}`),this}match(d){return Object.entries(d).forEach(([m,x])=>{this.url.searchParams.append(m,`eq.${x}`)}),this}not(d,m,x){return this.url.searchParams.append(d,`not.${m}.${x}`),this}or(d,{foreignTable:m,referencedTable:x=m}={}){const C=x?`${x}.or`:"or";return this.url.searchParams.append(C,`(${d})`),this}filter(d,m,x){return this.url.searchParams.append(d,`${m}.${x}`),this}}return dm.default=r,dm}var WE;function B6(){if(WE)return hm;WE=1;var n=hm&&hm.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(hm,"__esModule",{value:!0});const t=n(yb());class r{constructor(d,{headers:m={},schema:x,fetch:C}){this.url=d,this.headers=m,this.schema=x,this.fetch=C}select(d,{head:m=!1,count:x}={}){const C=m?"HEAD":"GET";let a=!1;const M=(d??"*").split("").map(R=>/\s/.test(R)&&!a?"":(R==='"'&&(a=!a),R)).join("");return this.url.searchParams.set("select",M),x&&(this.headers.Prefer=`count=${x}`),new t.default({method:C,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(d,{count:m,defaultToNull:x=!0}={}){const C="POST",a=[];if(this.headers.Prefer&&a.push(this.headers.Prefer),m&&a.push(`count=${m}`),x||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(d)){const M=d.reduce((R,j)=>R.concat(Object.keys(j)),[]);if(M.length>0){const R=[...new Set(M)].map(j=>`"${j}"`);this.url.searchParams.set("columns",R.join(","))}}return new t.default({method:C,url:this.url,headers:this.headers,schema:this.schema,body:d,fetch:this.fetch,allowEmpty:!1})}upsert(d,{onConflict:m,ignoreDuplicates:x=!1,count:C,defaultToNull:a=!0}={}){const M="POST",R=[`resolution=${x?"ignore":"merge"}-duplicates`];if(m!==void 0&&this.url.searchParams.set("on_conflict",m),this.headers.Prefer&&R.push(this.headers.Prefer),C&&R.push(`count=${C}`),a||R.push("missing=default"),this.headers.Prefer=R.join(","),Array.isArray(d)){const j=d.reduce((F,Z)=>F.concat(Object.keys(Z)),[]);if(j.length>0){const F=[...new Set(j)].map(Z=>`"${Z}"`);this.url.searchParams.set("columns",F.join(","))}}return new t.default({method:M,url:this.url,headers:this.headers,schema:this.schema,body:d,fetch:this.fetch,allowEmpty:!1})}update(d,{count:m}={}){const x="PATCH",C=[];return this.headers.Prefer&&C.push(this.headers.Prefer),m&&C.push(`count=${m}`),this.headers.Prefer=C.join(","),new t.default({method:x,url:this.url,headers:this.headers,schema:this.schema,body:d,fetch:this.fetch,allowEmpty:!1})}delete({count:d}={}){const m="DELETE",x=[];return d&&x.push(`count=${d}`),this.headers.Prefer&&x.unshift(this.headers.Prefer),this.headers.Prefer=x.join(","),new t.default({method:m,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return hm.default=r,hm}var Kg={},Xg={},qE;function zN(){return qE||(qE=1,Object.defineProperty(Xg,"__esModule",{value:!0}),Xg.version=void 0,Xg.version="0.0.0-automated"),Xg}var GE;function BN(){if(GE)return Kg;GE=1,Object.defineProperty(Kg,"__esModule",{value:!0}),Kg.DEFAULT_HEADERS=void 0;const n=zN();return Kg.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`},Kg}var ZE;function jN(){if(ZE)return um;ZE=1;var n=um&&um.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(um,"__esModule",{value:!0});const t=n(B6()),r=n(yb()),l=BN();class d{constructor(x,{headers:C={},schema:a,fetch:M}={}){this.url=x,this.headers=Object.assign(Object.assign({},l.DEFAULT_HEADERS),C),this.schemaName=a,this.fetch=M}from(x){const C=new URL(`${this.url}/${x}`);return new t.default(C,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(x){return new d(this.url,{headers:this.headers,schema:x,fetch:this.fetch})}rpc(x,C={},{head:a=!1,get:M=!1,count:R}={}){let j;const F=new URL(`${this.url}/rpc/${x}`);let Z;a||M?(j=a?"HEAD":"GET",Object.entries(C).filter(([ne,se])=>se!==void 0).map(([ne,se])=>[ne,Array.isArray(se)?`{${se.join(",")}}`:`${se}`]).forEach(([ne,se])=>{F.searchParams.append(ne,se)})):(j="POST",Z=C);const Y=Object.assign({},this.headers);return R&&(Y.Prefer=`count=${R}`),new r.default({method:j,url:F,headers:Y,schema:this.schemaName,body:Z,fetch:this.fetch,allowEmpty:!1})}}return um.default=d,um}var HE;function NN(){if(HE)return fs;HE=1;var n=fs&&fs.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};Object.defineProperty(fs,"__esModule",{value:!0}),fs.PostgrestError=fs.PostgrestBuilder=fs.PostgrestTransformBuilder=fs.PostgrestFilterBuilder=fs.PostgrestQueryBuilder=fs.PostgrestClient=void 0;const t=n(jN());fs.PostgrestClient=t.default;const r=n(B6());fs.PostgrestQueryBuilder=r.default;const l=n(yb());fs.PostgrestFilterBuilder=l.default;const d=n(z6());fs.PostgrestTransformBuilder=d.default;const m=n(D6());fs.PostgrestBuilder=m.default;const x=n(O6());return fs.PostgrestError=x.default,fs.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:l.default,PostgrestTransformBuilder:d.default,PostgrestBuilder:m.default,PostgrestError:x.default},fs}var FN=NN();const UN=cu(FN),{PostgrestClient:$N,PostgrestQueryBuilder:NU,PostgrestFilterBuilder:FU,PostgrestTransformBuilder:UU,PostgrestBuilder:$U,PostgrestError:VU}=UN;function VN(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const WN=VN(),qN="2.11.15",GN=`realtime-js/${qN}`,ZN="1.0.0",j6=1e4,HN=1e3;var v0;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(v0||(v0={}));var Vs;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Vs||(Vs={}));var Ql;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Ql||(Ql={}));var Qx;(function(n){n.websocket="websocket"})(Qx||(Qx={}));var Gf;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Gf||(Gf={}));class KN{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),l=new TextDecoder;return this._decodeBroadcast(t,r,l)}_decodeBroadcast(t,r,l){const d=r.getUint8(1),m=r.getUint8(2);let x=this.HEADER_LENGTH+2;const C=l.decode(t.slice(x,x+d));x=x+d;const a=l.decode(t.slice(x,x+m));x=x+m;const M=JSON.parse(l.decode(t.slice(x,t.byteLength)));return{ref:null,topic:C,event:a,payload:M}}}class N6{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var no;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(no||(no={}));const KE=(n,t,r={})=>{var l;const d=(l=r.skipTypes)!==null&&l!==void 0?l:[];return Object.keys(t).reduce((m,x)=>(m[x]=XN(x,n,t,d),m),{})},XN=(n,t,r,l)=>{const d=t.find(C=>C.name===n),m=d?.type,x=r[n];return m&&!l.includes(m)?F6(m,x):ew(x)},F6=(n,t)=>{if(n.charAt(0)==="_"){const r=n.slice(1,n.length);return eF(t,r)}switch(n){case no.bool:return YN(t);case no.float4:case no.float8:case no.int2:case no.int4:case no.int8:case no.numeric:case no.oid:return JN(t);case no.json:case no.jsonb:return QN(t);case no.timestamp:return tF(t);case no.abstime:case no.date:case no.daterange:case no.int4range:case no.int8range:case no.money:case no.reltime:case no.text:case no.time:case no.timestamptz:case no.timetz:case no.tsrange:case no.tstzrange:return ew(t);default:return ew(t)}},ew=n=>n,YN=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},JN=n=>{if(typeof n=="string"){const t=parseFloat(n);if(!Number.isNaN(t))return t}return n},QN=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(t){return console.log(`JSON parse error: ${t}`),n}return n},eF=(n,t)=>{if(typeof n!="string")return n;const r=n.length-1,l=n[r];if(n[0]==="{"&&l==="}"){let m;const x=n.slice(1,r);try{m=JSON.parse("["+x+"]")}catch{m=x?x.split(","):[]}return m.map(C=>F6(t,C))}return n},tF=n=>typeof n=="string"?n.replace(" ","T"):n,U6=n=>{let t=n;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class ax{constructor(t,r,l={},d=j6){this.channel=t,this.event=r,this.payload=l,this.timeout=d,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var l;return this._hasReceived(t)&&r((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(l=>l.status===t).forEach(l=>l.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var XE;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(XE||(XE={}));class x0{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},d=>{const{onJoin:m,onLeave:x,onSync:C}=this.caller;this.joinRef=this.channel._joinRef(),this.state=x0.syncState(this.state,d,m,x),this.pendingDiffs.forEach(a=>{this.state=x0.syncDiff(this.state,a,m,x)}),this.pendingDiffs=[],C()}),this.channel._on(l.diff,{},d=>{const{onJoin:m,onLeave:x,onSync:C}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(d):(this.state=x0.syncDiff(this.state,d,m,x),C())}),this.onJoin((d,m,x)=>{this.channel._trigger("presence",{event:"join",key:d,currentPresences:m,newPresences:x})}),this.onLeave((d,m,x)=>{this.channel._trigger("presence",{event:"leave",key:d,currentPresences:m,leftPresences:x})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,l,d){const m=this.cloneDeep(t),x=this.transformState(r),C={},a={};return this.map(m,(M,R)=>{x[M]||(a[M]=R)}),this.map(x,(M,R)=>{const j=m[M];if(j){const F=R.map(se=>se.presence_ref),Z=j.map(se=>se.presence_ref),Y=R.filter(se=>Z.indexOf(se.presence_ref)<0),ne=j.filter(se=>F.indexOf(se.presence_ref)<0);Y.length>0&&(C[M]=Y),ne.length>0&&(a[M]=ne)}else C[M]=R}),this.syncDiff(m,{joins:C,leaves:a},l,d)}static syncDiff(t,r,l,d){const{joins:m,leaves:x}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return l||(l=()=>{}),d||(d=()=>{}),this.map(m,(C,a)=>{var M;const R=(M=t[C])!==null&&M!==void 0?M:[];if(t[C]=this.cloneDeep(a),R.length>0){const j=t[C].map(Z=>Z.presence_ref),F=R.filter(Z=>j.indexOf(Z.presence_ref)<0);t[C].unshift(...F)}l(C,R,a)}),this.map(x,(C,a)=>{let M=t[C];if(!M)return;const R=a.map(j=>j.presence_ref);M=M.filter(j=>R.indexOf(j.presence_ref)<0),t[C]=M,d(C,M,a),M.length===0&&delete t[C]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(l=>r(l,t[l]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,l)=>{const d=t[l];return"metas"in d?r[l]=d.metas.map(m=>(m.presence_ref=m.phx_ref,delete m.phx_ref,delete m.phx_ref_prev,m)):r[l]=d,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var YE;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(YE||(YE={}));var JE;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(JE||(JE={}));var ih;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(ih||(ih={}));class vb{constructor(t,r={config:{}},l){this.topic=t,this.params=r,this.socket=l,this.bindings={},this.state=Vs.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new ax(this,Ql.join,this.params,this.timeout),this.rejoinTimer=new N6(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Vs.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(d=>d.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Vs.closed,this.socket._remove(this)}),this._onError(d=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,d),this.state=Vs.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Vs.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ql.reply,{},(d,m)=>{this._trigger(this._replyEventName(m),d)}),this.presence=new x0(this),this.broadcastEndpointURL=U6(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var l,d;if(this.socket.isConnected()||this.socket.connect(),this.state==Vs.closed){const{config:{broadcast:m,presence:x,private:C}}=this.params;this._onError(R=>t?.(ih.CHANNEL_ERROR,R)),this._onClose(()=>t?.(ih.CLOSED));const a={},M={broadcast:m,presence:x,postgres_changes:(d=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(R=>R.filter))!==null&&d!==void 0?d:[],private:C};this.socket.accessTokenValue&&(a.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:M},a)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:R})=>{var j;if(this.socket.setAuth(),R===void 0){t?.(ih.SUBSCRIBED);return}else{const F=this.bindings.postgres_changes,Z=(j=F?.length)!==null&&j!==void 0?j:0,Y=[];for(let ne=0;ne<Z;ne++){const se=F[ne],{filter:{event:xe,schema:Se,table:_e,filter:Ie}}=se,Me=R&&R[ne];if(Me&&Me.event===xe&&Me.schema===Se&&Me.table===_e&&Me.filter===Ie)Y.push(Object.assign(Object.assign({},se),{id:Me.id}));else{this.unsubscribe(),this.state=Vs.errored,t?.(ih.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=Y,t&&t(ih.SUBSCRIBED);return}}).receive("error",R=>{this.state=Vs.errored,t?.(ih.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(R).join(", ")||"error")))}).receive("timeout",()=>{t?.(ih.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,l){return this._on(t,r,l)}async send(t,r={}){var l,d;if(!this._canPush()&&t.type==="broadcast"){const{event:m,payload:x}=t,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:m,payload:x,private:this.private}]})};try{const M=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(l=r.timeout)!==null&&l!==void 0?l:this.timeout);return await((d=M.body)===null||d===void 0?void 0:d.cancel()),M.ok?"ok":"error"}catch(M){return M.name==="AbortError"?"timed out":"error"}}else return new Promise(m=>{var x,C,a;const M=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((a=(C=(x=this.params)===null||x===void 0?void 0:x.config)===null||C===void 0?void 0:C.broadcast)===null||a===void 0)&&a.ack)&&m("ok"),M.receive("ok",()=>m("ok")),M.receive("error",()=>m("error")),M.receive("timeout",()=>m("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Vs.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ql.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(d=>{l=new ax(this,Ql.leave,{},t),l.receive("ok",()=>{r(),d("ok")}).receive("timeout",()=>{r(),d("timed out")}).receive("error",()=>{d("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,r,l){const d=new AbortController,m=setTimeout(()=>d.abort(),l),x=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:d.signal}));return clearTimeout(m),x}_push(t,r,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let d=new ax(this,t,r,l);return this._canPush()?d.send():(d.startTimeout(),this.pushBuffer.push(d)),d}_onMessage(t,r,l){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,l){var d,m;const x=t.toLocaleLowerCase(),{close:C,error:a,leave:M,join:R}=Ql;if(l&&[C,a,M,R].indexOf(x)>=0&&l!==this._joinRef())return;let F=this._onMessage(x,r,l);if(r&&!F)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(x)?(d=this.bindings.postgres_changes)===null||d===void 0||d.filter(Z=>{var Y,ne,se;return((Y=Z.filter)===null||Y===void 0?void 0:Y.event)==="*"||((se=(ne=Z.filter)===null||ne===void 0?void 0:ne.event)===null||se===void 0?void 0:se.toLocaleLowerCase())===x}).map(Z=>Z.callback(F,l)):(m=this.bindings[x])===null||m===void 0||m.filter(Z=>{var Y,ne,se,xe,Se,_e;if(["broadcast","presence","postgres_changes"].includes(x))if("id"in Z){const Ie=Z.id,Me=(Y=Z.filter)===null||Y===void 0?void 0:Y.event;return Ie&&((ne=r.ids)===null||ne===void 0?void 0:ne.includes(Ie))&&(Me==="*"||Me?.toLocaleLowerCase()===((se=r.data)===null||se===void 0?void 0:se.type.toLocaleLowerCase()))}else{const Ie=(Se=(xe=Z?.filter)===null||xe===void 0?void 0:xe.event)===null||Se===void 0?void 0:Se.toLocaleLowerCase();return Ie==="*"||Ie===((_e=r?.event)===null||_e===void 0?void 0:_e.toLocaleLowerCase())}else return Z.type.toLocaleLowerCase()===x}).map(Z=>{if(typeof F=="object"&&"ids"in F){const Y=F.data,{schema:ne,table:se,commit_timestamp:xe,type:Se,errors:_e}=Y;F=Object.assign(Object.assign({},{schema:ne,table:se,commit_timestamp:xe,eventType:Se,new:{},old:{},errors:_e}),this._getPayloadRecords(Y))}Z.callback(F,l)})}_isClosed(){return this.state===Vs.closed}_isJoined(){return this.state===Vs.joined}_isJoining(){return this.state===Vs.joining}_isLeaving(){return this.state===Vs.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,l){const d=t.toLocaleLowerCase(),m={type:d,filter:r,callback:l};return this.bindings[d]?this.bindings[d].push(m):this.bindings[d]=[m],this}_off(t,r){const l=t.toLocaleLowerCase();return this.bindings[l]=this.bindings[l].filter(d=>{var m;return!(((m=d.type)===null||m===void 0?void 0:m.toLocaleLowerCase())===l&&vb.isEqual(d.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const l in t)if(t[l]!==r[l])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ql.close,{},t)}_onError(t){this._on(Ql.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Vs.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=KE(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=KE(t.columns,t.old_record)),r}}const QE=()=>{},nF=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class rF{constructor(t,r){var l;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=j6,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=QE,this.ref=0,this.logger=QE,this.conn=null,this.sendBuffer=[],this.serializer=new KN,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=m=>{let x;return m?x=m:typeof fetch>"u"?x=(...C)=>Zm(async()=>{const{default:a}=await Promise.resolve().then(()=>Hm);return{default:a}},void 0).then(({default:a})=>a(...C)):x=fetch,(...C)=>x(...C)},this.endPoint=`${t}/${Qx.websocket}`,this.httpEndpoint=U6(t),r?.transport?this.transport=r.transport:this.transport=null,r?.params&&(this.params=r.params),r?.timeout&&(this.timeout=r.timeout),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const d=(l=r?.params)===null||l===void 0?void 0:l.apikey;if(d&&(this.accessTokenValue=d,this.apiKey=d),this.reconnectAfterMs=r?.reconnectAfterMs?r.reconnectAfterMs:m=>[1e3,2e3,5e3,1e4][m-1]||1e4,this.encode=r?.encode?r.encode:(m,x)=>x(JSON.stringify(m)),this.decode=r?.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new N6(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r?.fetch),r?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=r?.worker||!1,this.workerUrl=r?.workerUrl}this.accessToken=r?.accessToken||null}connect(){if(!this.conn){if(this.transport||(this.transport=WN),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ZN}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(l=>l.teardown()))}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,l){this.logger(t,r,l)}connectionState(){switch(this.conn&&this.conn.readyState){case v0.connecting:return Gf.Connecting;case v0.open:return Gf.Open;case v0.closing:return Gf.Closing;default:return Gf.Closed}}isConnected(){return this.connectionState()===Gf.Open}channel(t,r={config:{}}){const l=`realtime:${t}`,d=this.getChannels().find(m=>m.topic===l);if(d)return d;{const m=new vb(`realtime:${t}`,r,this);return this.channels.push(m),m}}push(t){const{topic:r,event:l,payload:d,ref:m}=t,x=()=>{this.encode(t,C=>{var a;(a=this.conn)===null||a===void 0||a.send(C)})};this.log("push",`${r} ${l} (${m})`,d),this.isConnected()?x():this.sendBuffer.push(x)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(l=>{const d={access_token:r,version:GN};r&&l.updateJoinPayload(d),l.joinedOnce&&l._isJoined()&&l._push(Ql.access_token,{access_token:r})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(HN,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(l=>l.topic===t&&(l._isJoined()||l._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:l,event:d,payload:m,ref:x}=r;l==="phoenix"&&d==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),x&&x===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${m.status||""} ${l} ${d} ${x&&"("+x+")"||""}`,m),Array.from(this.channels).filter(C=>C._isMember(l)).forEach(C=>C._trigger(d,m,x)),this.stateChangeCallbacks.message.forEach(C=>C(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ql.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const l=t.match(/\?/)?"&":"?",d=new URLSearchParams(r);return`${t}${l}${d}`}_workerObjectUrl(t){let r;if(t)r=t;else{const l=new Blob([nF],{type:"application/javascript"});r=URL.createObjectURL(l)}return r}}class xb extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ps(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class iF extends xb{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class tw extends xb{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var oF=function(n,t,r,l){function d(m){return m instanceof r?m:new r(function(x){x(m)})}return new(r||(r=Promise))(function(m,x){function C(R){try{M(l.next(R))}catch(j){x(j)}}function a(R){try{M(l.throw(R))}catch(j){x(j)}}function M(R){R.done?m(R.value):d(R.value).then(C,a)}M((l=l.apply(n,t||[])).next())})};const $6=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...r)=>Zm(async()=>{const{default:l}=await Promise.resolve().then(()=>Hm);return{default:l}},void 0).then(({default:l})=>l(...r)):t=fetch,(...r)=>t(...r)},sF=()=>oF(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Zm(()=>Promise.resolve().then(()=>Hm),void 0)).Response:Response}),nw=n=>{if(Array.isArray(n))return n.map(r=>nw(r));if(typeof n=="function"||n!==Object(n))return n;const t={};return Object.entries(n).forEach(([r,l])=>{const d=r.replace(/([-_][a-z])/gi,m=>m.toUpperCase().replace(/[-_]/g,""));t[d]=nw(l)}),t};var up=function(n,t,r,l){function d(m){return m instanceof r?m:new r(function(x){x(m)})}return new(r||(r=Promise))(function(m,x){function C(R){try{M(l.next(R))}catch(j){x(j)}}function a(R){try{M(l.throw(R))}catch(j){x(j)}}function M(R){R.done?m(R.value):d(R.value).then(C,a)}M((l=l.apply(n,t||[])).next())})};const lx=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),aF=(n,t,r)=>up(void 0,void 0,void 0,function*(){const l=yield sF();n instanceof l&&!r?.noResolveJson?n.json().then(d=>{t(new iF(lx(d),n.status||500))}).catch(d=>{t(new tw(lx(d),d))}):t(new tw(lx(n),n))}),lF=(n,t,r,l)=>{const d={method:n,headers:t?.headers||{}};return n==="GET"?d:(d.headers=Object.assign({"Content-Type":"application/json"},t?.headers),l&&(d.body=JSON.stringify(l)),Object.assign(Object.assign({},d),r))};function o1(n,t,r,l,d,m){return up(this,void 0,void 0,function*(){return new Promise((x,C)=>{n(r,lF(t,l,d,m)).then(a=>{if(!a.ok)throw a;return l?.noResolveJson?a:a.json()}).then(a=>x(a)).catch(a=>aF(a,C,l))})})}function ry(n,t,r,l){return up(this,void 0,void 0,function*(){return o1(n,"GET",t,r,l)})}function fd(n,t,r,l,d){return up(this,void 0,void 0,function*(){return o1(n,"POST",t,l,d,r)})}function cF(n,t,r,l,d){return up(this,void 0,void 0,function*(){return o1(n,"PUT",t,l,d,r)})}function uF(n,t,r,l){return up(this,void 0,void 0,function*(){return o1(n,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),l)})}function V6(n,t,r,l,d){return up(this,void 0,void 0,function*(){return o1(n,"DELETE",t,l,d,r)})}var Ma=function(n,t,r,l){function d(m){return m instanceof r?m:new r(function(x){x(m)})}return new(r||(r=Promise))(function(m,x){function C(R){try{M(l.next(R))}catch(j){x(j)}}function a(R){try{M(l.throw(R))}catch(j){x(j)}}function M(R){R.done?m(R.value):d(R.value).then(C,a)}M((l=l.apply(n,t||[])).next())})};const hF={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},eT={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class dF{constructor(t,r={},l,d){this.url=t,this.headers=r,this.bucketId=l,this.fetch=$6(d)}uploadOrUpdate(t,r,l,d){return Ma(this,void 0,void 0,function*(){try{let m;const x=Object.assign(Object.assign({},eT),d);let C=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(x.upsert)});const a=x.metadata;typeof Blob<"u"&&l instanceof Blob?(m=new FormData,m.append("cacheControl",x.cacheControl),a&&m.append("metadata",this.encodeMetadata(a)),m.append("",l)):typeof FormData<"u"&&l instanceof FormData?(m=l,m.append("cacheControl",x.cacheControl),a&&m.append("metadata",this.encodeMetadata(a))):(m=l,C["cache-control"]=`max-age=${x.cacheControl}`,C["content-type"]=x.contentType,a&&(C["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),d?.headers&&(C=Object.assign(Object.assign({},C),d.headers));const M=this._removeEmptyFolders(r),R=this._getFinalPath(M),j=yield this.fetch(`${this.url}/object/${R}`,Object.assign({method:t,body:m,headers:C},x?.duplex?{duplex:x.duplex}:{})),F=yield j.json();return j.ok?{data:{path:M,id:F.Id,fullPath:F.Key},error:null}:{data:null,error:F}}catch(m){if(ps(m))return{data:null,error:m};throw m}})}upload(t,r,l){return Ma(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,l)})}uploadToSignedUrl(t,r,l,d){return Ma(this,void 0,void 0,function*(){const m=this._removeEmptyFolders(t),x=this._getFinalPath(m),C=new URL(this.url+`/object/upload/sign/${x}`);C.searchParams.set("token",r);try{let a;const M=Object.assign({upsert:eT.upsert},d),R=Object.assign(Object.assign({},this.headers),{"x-upsert":String(M.upsert)});typeof Blob<"u"&&l instanceof Blob?(a=new FormData,a.append("cacheControl",M.cacheControl),a.append("",l)):typeof FormData<"u"&&l instanceof FormData?(a=l,a.append("cacheControl",M.cacheControl)):(a=l,R["cache-control"]=`max-age=${M.cacheControl}`,R["content-type"]=M.contentType);const j=yield this.fetch(C.toString(),{method:"PUT",body:a,headers:R}),F=yield j.json();return j.ok?{data:{path:m,fullPath:F.Key},error:null}:{data:null,error:F}}catch(a){if(ps(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(t,r){return Ma(this,void 0,void 0,function*(){try{let l=this._getFinalPath(t);const d=Object.assign({},this.headers);r?.upsert&&(d["x-upsert"]="true");const m=yield fd(this.fetch,`${this.url}/object/upload/sign/${l}`,{},{headers:d}),x=new URL(this.url+m.url),C=x.searchParams.get("token");if(!C)throw new xb("No token returned by API");return{data:{signedUrl:x.toString(),path:t,token:C},error:null}}catch(l){if(ps(l))return{data:null,error:l};throw l}})}update(t,r,l){return Ma(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,l)})}move(t,r,l){return Ma(this,void 0,void 0,function*(){try{return{data:yield fd(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:l?.destinationBucket},{headers:this.headers}),error:null}}catch(d){if(ps(d))return{data:null,error:d};throw d}})}copy(t,r,l){return Ma(this,void 0,void 0,function*(){try{return{data:{path:(yield fd(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:l?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(d){if(ps(d))return{data:null,error:d};throw d}})}createSignedUrl(t,r,l){return Ma(this,void 0,void 0,function*(){try{let d=this._getFinalPath(t),m=yield fd(this.fetch,`${this.url}/object/sign/${d}`,Object.assign({expiresIn:r},l?.transform?{transform:l.transform}:{}),{headers:this.headers});const x=l?.download?`&download=${l.download===!0?"":l.download}`:"";return m={signedUrl:encodeURI(`${this.url}${m.signedURL}${x}`)},{data:m,error:null}}catch(d){if(ps(d))return{data:null,error:d};throw d}})}createSignedUrls(t,r,l){return Ma(this,void 0,void 0,function*(){try{const d=yield fd(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),m=l?.download?`&download=${l.download===!0?"":l.download}`:"";return{data:d.map(x=>Object.assign(Object.assign({},x),{signedUrl:x.signedURL?encodeURI(`${this.url}${x.signedURL}${m}`):null})),error:null}}catch(d){if(ps(d))return{data:null,error:d};throw d}})}download(t,r){return Ma(this,void 0,void 0,function*(){const d=typeof r?.transform<"u"?"render/image/authenticated":"object",m=this.transformOptsToQueryString(r?.transform||{}),x=m?`?${m}`:"";try{const C=this._getFinalPath(t);return{data:yield(yield ry(this.fetch,`${this.url}/${d}/${C}${x}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(C){if(ps(C))return{data:null,error:C};throw C}})}info(t){return Ma(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const l=yield ry(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:nw(l),error:null}}catch(l){if(ps(l))return{data:null,error:l};throw l}})}exists(t){return Ma(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield uF(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(l){if(ps(l)&&l instanceof tw){const d=l.originalError;if([400,404].includes(d?.status))return{data:!1,error:l}}throw l}})}getPublicUrl(t,r){const l=this._getFinalPath(t),d=[],m=r?.download?`download=${r.download===!0?"":r.download}`:"";m!==""&&d.push(m);const C=typeof r?.transform<"u"?"render/image":"object",a=this.transformOptsToQueryString(r?.transform||{});a!==""&&d.push(a);let M=d.join("&");return M!==""&&(M=`?${M}`),{data:{publicUrl:encodeURI(`${this.url}/${C}/public/${l}${M}`)}}}remove(t){return Ma(this,void 0,void 0,function*(){try{return{data:yield V6(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(ps(r))return{data:null,error:r};throw r}})}list(t,r,l){return Ma(this,void 0,void 0,function*(){try{const d=Object.assign(Object.assign(Object.assign({},hF),r),{prefix:t||""});return{data:yield fd(this.fetch,`${this.url}/object/list/${this.bucketId}`,d,{headers:this.headers},l),error:null}}catch(d){if(ps(d))return{data:null,error:d};throw d}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const fF="2.7.1",pF={"X-Client-Info":`storage-js/${fF}`};var mm=function(n,t,r,l){function d(m){return m instanceof r?m:new r(function(x){x(m)})}return new(r||(r=Promise))(function(m,x){function C(R){try{M(l.next(R))}catch(j){x(j)}}function a(R){try{M(l.throw(R))}catch(j){x(j)}}function M(R){R.done?m(R.value):d(R.value).then(C,a)}M((l=l.apply(n,t||[])).next())})};class mF{constructor(t,r={},l){this.url=t,this.headers=Object.assign(Object.assign({},pF),r),this.fetch=$6(l)}listBuckets(){return mm(this,void 0,void 0,function*(){try{return{data:yield ry(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(ps(t))return{data:null,error:t};throw t}})}getBucket(t){return mm(this,void 0,void 0,function*(){try{return{data:yield ry(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(ps(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return mm(this,void 0,void 0,function*(){try{return{data:yield fd(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(ps(l))return{data:null,error:l};throw l}})}updateBucket(t,r){return mm(this,void 0,void 0,function*(){try{return{data:yield cF(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(ps(l))return{data:null,error:l};throw l}})}emptyBucket(t){return mm(this,void 0,void 0,function*(){try{return{data:yield fd(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(ps(r))return{data:null,error:r};throw r}})}deleteBucket(t){return mm(this,void 0,void 0,function*(){try{return{data:yield V6(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(ps(r))return{data:null,error:r};throw r}})}}class gF extends mF{constructor(t,r={},l){super(t,r,l)}from(t){return new dF(this.url,this.headers,t,this.fetch)}}const _F="2.52.0";let i0="";typeof Deno<"u"?i0="deno":typeof document<"u"?i0="web":typeof navigator<"u"&&navigator.product==="ReactNative"?i0="react-native":i0="node";const yF={"X-Client-Info":`supabase-js-${i0}/${_F}`},vF={headers:yF},xF={schema:"public"},wF={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},bF={};var EF=function(n,t,r,l){function d(m){return m instanceof r?m:new r(function(x){x(m)})}return new(r||(r=Promise))(function(m,x){function C(R){try{M(l.next(R))}catch(j){x(j)}}function a(R){try{M(l.throw(R))}catch(j){x(j)}}function M(R){R.done?m(R.value):d(R.value).then(C,a)}M((l=l.apply(n,t||[])).next())})};const TF=n=>{let t;return n?t=n:typeof fetch>"u"?t=L6:t=fetch,(...r)=>t(...r)},CF=()=>typeof Headers>"u"?R6:Headers,SF=(n,t,r)=>{const l=TF(r),d=CF();return(m,x)=>EF(void 0,void 0,void 0,function*(){var C;const a=(C=yield t())!==null&&C!==void 0?C:n;let M=new d(x?.headers);return M.has("apikey")||M.set("apikey",n),M.has("Authorization")||M.set("Authorization",`Bearer ${a}`),l(m,Object.assign(Object.assign({},x),{headers:M}))})};var kF=function(n,t,r,l){function d(m){return m instanceof r?m:new r(function(x){x(m)})}return new(r||(r=Promise))(function(m,x){function C(R){try{M(l.next(R))}catch(j){x(j)}}function a(R){try{M(l.throw(R))}catch(j){x(j)}}function M(R){R.done?m(R.value):d(R.value).then(C,a)}M((l=l.apply(n,t||[])).next())})};function MF(n){return n.endsWith("/")?n:n+"/"}function AF(n,t){var r,l;const{db:d,auth:m,realtime:x,global:C}=n,{db:a,auth:M,realtime:R,global:j}=t,F={db:Object.assign(Object.assign({},a),d),auth:Object.assign(Object.assign({},M),m),realtime:Object.assign(Object.assign({},R),x),global:Object.assign(Object.assign(Object.assign({},j),C),{headers:Object.assign(Object.assign({},(r=j?.headers)!==null&&r!==void 0?r:{}),(l=C?.headers)!==null&&l!==void 0?l:{})}),accessToken:()=>kF(this,void 0,void 0,function*(){return""})};return n.accessToken?F.accessToken=n.accessToken:delete F.accessToken,F}const W6="2.71.1",xm=30*1e3,rw=3,cx=rw*xm,PF="http://localhost:9999",IF="supabase.auth.token",LF={"X-Client-Info":`gotrue-js/${W6}`},iw="X-Supabase-Api-Version",q6={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},RF=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,OF=10*60*1e3;class wb extends Error{constructor(t,r,l){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=l}}function Gr(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class DF extends wb{constructor(t,r,l){super(t,r,l),this.name="AuthApiError",this.status=r,this.code=l}}function zF(n){return Gr(n)&&n.name==="AuthApiError"}class G6 extends wb{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Nd extends wb{constructor(t,r,l,d){super(t,l,d),this.name=r,this.status=l}}class ud extends Nd{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function BF(n){return Gr(n)&&n.name==="AuthSessionMissingError"}class d_ extends Nd{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class f_ extends Nd{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class p_ extends Nd{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function jF(n){return Gr(n)&&n.name==="AuthImplicitGrantRedirectError"}class tT extends Nd{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ow extends Nd{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function ux(n){return Gr(n)&&n.name==="AuthRetryableFetchError"}class nT extends Nd{constructor(t,r,l){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=l}}class sw extends Nd{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const iy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),rT=` 	
\r=`.split(""),NF=(()=>{const n=new Array(128);for(let t=0;t<n.length;t+=1)n[t]=-1;for(let t=0;t<rT.length;t+=1)n[rT[t].charCodeAt(0)]=-2;for(let t=0;t<iy.length;t+=1)n[iy[t].charCodeAt(0)]=t;return n})();function iT(n,t,r){if(n!==null)for(t.queue=t.queue<<8|n,t.queuedBits+=8;t.queuedBits>=6;){const l=t.queue>>t.queuedBits-6&63;r(iy[l]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const l=t.queue>>t.queuedBits-6&63;r(iy[l]),t.queuedBits-=6}}function Z6(n,t,r){const l=NF[n];if(l>-1)for(t.queue=t.queue<<6|l,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function oT(n){const t=[],r=x=>{t.push(String.fromCodePoint(x))},l={utf8seq:0,codepoint:0},d={queue:0,queuedBits:0},m=x=>{$F(x,l,r)};for(let x=0;x<n.length;x+=1)Z6(n.charCodeAt(x),d,m);return t.join("")}function FF(n,t){if(n<=127){t(n);return}else if(n<=2047){t(192|n>>6),t(128|n&63);return}else if(n<=65535){t(224|n>>12),t(128|n>>6&63),t(128|n&63);return}else if(n<=1114111){t(240|n>>18),t(128|n>>12&63),t(128|n>>6&63),t(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function UF(n,t){for(let r=0;r<n.length;r+=1){let l=n.charCodeAt(r);if(l>55295&&l<=56319){const d=(l-55296)*1024&65535;l=(n.charCodeAt(r+1)-56320&65535|d)+65536,r+=1}FF(l,t)}}function $F(n,t,r){if(t.utf8seq===0){if(n<=127){r(n);return}for(let l=1;l<6;l+=1)if((n>>7-l&1)===0){t.utf8seq=l;break}if(t.utf8seq===2)t.codepoint=n&31;else if(t.utf8seq===3)t.codepoint=n&15;else if(t.utf8seq===4)t.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|n&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function VF(n){const t=[],r={queue:0,queuedBits:0},l=d=>{t.push(d)};for(let d=0;d<n.length;d+=1)Z6(n.charCodeAt(d),r,l);return new Uint8Array(t)}function WF(n){const t=[];return UF(n,r=>t.push(r)),new Uint8Array(t)}function qF(n){const t=[],r={queue:0,queuedBits:0},l=d=>{t.push(d)};return n.forEach(d=>iT(d,r,l)),iT(null,r,l),t.join("")}function GF(n){return Math.round(Date.now()/1e3)+n}function ZF(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const t=Math.random()*16|0;return(n=="x"?t:t&3|8).toString(16)})}const Xl=()=>typeof window<"u"&&typeof document<"u",$f={tested:!1,writable:!1},H6=()=>{if(!Xl())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if($f.tested)return $f.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),$f.tested=!0,$f.writable=!0}catch{$f.tested=!0,$f.writable=!1}return $f.writable};function HF(n){const t={},r=new URL(n);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((d,m)=>{t[m]=d})}catch{}return r.searchParams.forEach((l,d)=>{t[d]=l}),t}const K6=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...r)=>Zm(async()=>{const{default:l}=await Promise.resolve().then(()=>Hm);return{default:l}},void 0).then(({default:l})=>l(...r)):t=fetch,(...r)=>t(...r)},KF=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",wm=async(n,t,r)=>{await n.setItem(t,JSON.stringify(r))},Vf=async(n,t)=>{const r=await n.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ld=async(n,t)=>{await n.removeItem(t)};class Iy{constructor(){this.promise=new Iy.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Iy.promiseConstructor=Promise;function hx(n){const t=n.split(".");if(t.length!==3)throw new sw("Invalid JWT structure");for(let l=0;l<t.length;l++)if(!RF.test(t[l]))throw new sw("JWT not in base64url format");return{header:JSON.parse(oT(t[0])),payload:JSON.parse(oT(t[1])),signature:VF(t[2]),raw:{header:t[0],payload:t[1]}}}async function XF(n){return await new Promise(t=>{setTimeout(()=>t(null),n)})}function YF(n,t){return new Promise((l,d)=>{(async()=>{for(let m=0;m<1/0;m++)try{const x=await n(m);if(!t(m,null,x)){l(x);return}}catch(x){if(!t(m,x)){d(x);return}}})()})}function JF(n){return("0"+n.toString(16)).substr(-2)}function QF(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=r.length;let d="";for(let m=0;m<56;m++)d+=r.charAt(Math.floor(Math.random()*l));return d}return crypto.getRandomValues(t),Array.from(t,JF).join("")}async function eU(n){const r=new TextEncoder().encode(n),l=await crypto.subtle.digest("SHA-256",r),d=new Uint8Array(l);return Array.from(d).map(m=>String.fromCharCode(m)).join("")}async function tU(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const r=await eU(n);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function gm(n,t,r=!1){const l=QF();let d=l;r&&(d+="/PASSWORD_RECOVERY"),await wm(n,`${t}-code-verifier`,d);const m=await tU(l);return[m,l===m?"plain":"s256"]}const nU=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function rU(n){const t=n.headers.get(iw);if(!t||!t.match(nU))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function iU(n){if(!n)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(n<=t)throw new Error("JWT has expired")}function oU(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const sU=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function _m(n){if(!sU.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function dx(){const n={};return new Proxy(n,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const l=r.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function sT(n){return JSON.parse(JSON.stringify(n))}var aU=function(n,t){var r={};for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&t.indexOf(l)<0&&(r[l]=n[l]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,l=Object.getOwnPropertySymbols(n);d<l.length;d++)t.indexOf(l[d])<0&&Object.prototype.propertyIsEnumerable.call(n,l[d])&&(r[l[d]]=n[l[d]]);return r};const Wf=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),lU=[502,503,504];async function aT(n){var t;if(!KF(n))throw new ow(Wf(n),0);if(lU.includes(n.status))throw new ow(Wf(n),n.status);let r;try{r=await n.json()}catch(m){throw new G6(Wf(m),m)}let l;const d=rU(n);if(d&&d.getTime()>=q6["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?l=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(l=r.error_code),l){if(l==="weak_password")throw new nT(Wf(r),n.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(l==="session_not_found")throw new ud}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((m,x)=>m&&typeof x=="string",!0))throw new nT(Wf(r),n.status,r.weak_password.reasons);throw new DF(Wf(r),n.status||500,l)}const cU=(n,t,r,l)=>{const d={method:n,headers:t?.headers||{}};return n==="GET"?d:(d.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),d.body=JSON.stringify(l),Object.assign(Object.assign({},d),r))};async function ci(n,t,r,l){var d;const m=Object.assign({},l?.headers);m[iw]||(m[iw]=q6["2024-01-01"].name),l?.jwt&&(m.Authorization=`Bearer ${l.jwt}`);const x=(d=l?.query)!==null&&d!==void 0?d:{};l?.redirectTo&&(x.redirect_to=l.redirectTo);const C=Object.keys(x).length?"?"+new URLSearchParams(x).toString():"",a=await uU(n,t,r+C,{headers:m,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(a):{data:Object.assign({},a),error:null}}async function uU(n,t,r,l,d,m){const x=cU(t,l,d,m);let C;try{C=await n(r,Object.assign({},x))}catch(a){throw console.error(a),new ow(Wf(a),0)}if(C.ok||await aT(C),l?.noResolveJson)return C;try{return await C.json()}catch(a){await aT(a)}}function th(n){var t;let r=null;pU(n)&&(r=Object.assign({},n),n.expires_at||(r.expires_at=GF(n.expires_in)));const l=(t=n.user)!==null&&t!==void 0?t:n;return{data:{session:r,user:l},error:null}}function lT(n){const t=th(n);return!t.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((r,l)=>r&&typeof l=="string",!0)&&(t.data.weak_password=n.weak_password),t}function md(n){var t;return{data:{user:(t=n.user)!==null&&t!==void 0?t:n},error:null}}function hU(n){return{data:n,error:null}}function dU(n){const{action_link:t,email_otp:r,hashed_token:l,redirect_to:d,verification_type:m}=n,x=aU(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),C={action_link:t,email_otp:r,hashed_token:l,redirect_to:d,verification_type:m},a=Object.assign({},x);return{data:{properties:C,user:a},error:null}}function fU(n){return n}function pU(n){return n.access_token&&n.refresh_token&&n.expires_in}const fx=["global","local","others"];var mU=function(n,t){var r={};for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&t.indexOf(l)<0&&(r[l]=n[l]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,l=Object.getOwnPropertySymbols(n);d<l.length;d++)t.indexOf(l[d])<0&&Object.prototype.propertyIsEnumerable.call(n,l[d])&&(r[l[d]]=n[l[d]]);return r};class gU{constructor({url:t="",headers:r={},fetch:l}){this.url=t,this.headers=r,this.fetch=K6(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=fx[0]){if(fx.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${fx.join(", ")}`);try{return await ci(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(l){if(Gr(l))return{data:null,error:l};throw l}}async inviteUserByEmail(t,r={}){try{return await ci(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:md})}catch(l){if(Gr(l))return{data:{user:null},error:l};throw l}}async generateLink(t){try{const{options:r}=t,l=mU(t,["options"]),d=Object.assign(Object.assign({},l),r);return"newEmail"in l&&(d.new_email=l?.newEmail,delete d.newEmail),await ci(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:d,headers:this.headers,xform:dU,redirectTo:r?.redirectTo})}catch(r){if(Gr(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ci(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:md})}catch(r){if(Gr(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,l,d,m,x,C,a;try{const M={nextPage:null,lastPage:0,total:0},R=await ci(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:"",per_page:(m=(d=t?.perPage)===null||d===void 0?void 0:d.toString())!==null&&m!==void 0?m:""},xform:fU});if(R.error)throw R.error;const j=await R.json(),F=(x=R.headers.get("x-total-count"))!==null&&x!==void 0?x:0,Z=(a=(C=R.headers.get("link"))===null||C===void 0?void 0:C.split(","))!==null&&a!==void 0?a:[];return Z.length>0&&(Z.forEach(Y=>{const ne=parseInt(Y.split(";")[0].split("=")[1].substring(0,1)),se=JSON.parse(Y.split(";")[1].split("=")[1]);M[`${se}Page`]=ne}),M.total=parseInt(F)),{data:Object.assign(Object.assign({},j),M),error:null}}catch(M){if(Gr(M))return{data:{users:[]},error:M};throw M}}async getUserById(t){_m(t);try{return await ci(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:md})}catch(r){if(Gr(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){_m(t);try{return await ci(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:md})}catch(l){if(Gr(l))return{data:{user:null},error:l};throw l}}async deleteUser(t,r=!1){_m(t);try{return await ci(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:md})}catch(l){if(Gr(l))return{data:{user:null},error:l};throw l}}async _listFactors(t){_m(t.userId);try{const{data:r,error:l}=await ci(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:d=>({data:{factors:d},error:null})});return{data:r,error:l}}catch(r){if(Gr(r))return{data:null,error:r};throw r}}async _deleteFactor(t){_m(t.userId),_m(t.id);try{return{data:await ci(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Gr(r))return{data:null,error:r};throw r}}}function cT(n={}){return{getItem:t=>n[t]||null,setItem:(t,r)=>{n[t]=r},removeItem:t=>{delete n[t]}}}function _U(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ym={debug:!!(globalThis&&H6()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class X6 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class yU extends X6{}async function vU(n,t,r){ym.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,t);const l=new globalThis.AbortController;return t>0&&setTimeout(()=>{l.abort(),ym.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async d=>{if(d){ym.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,d.name);try{return await r()}finally{ym.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,d.name)}}else{if(t===0)throw ym.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new yU(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(ym.debug)try{const m=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(m,null,"  "))}catch(m){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",m)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}_U();const xU={url:PF,storageKey:IF,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:LF,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function uT(n,t,r){return await r()}const vm={};class F0{constructor(t){var r,l;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=F0.nextInstanceID,F0.nextInstanceID+=1,this.instanceID>0&&Xl()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const d=Object.assign(Object.assign({},xU),t);if(this.logDebugMessages=!!d.debug,typeof d.debug=="function"&&(this.logger=d.debug),this.persistSession=d.persistSession,this.storageKey=d.storageKey,this.autoRefreshToken=d.autoRefreshToken,this.admin=new gU({url:d.url,headers:d.headers,fetch:d.fetch}),this.url=d.url,this.headers=d.headers,this.fetch=K6(d.fetch),this.lock=d.lock||uT,this.detectSessionInUrl=d.detectSessionInUrl,this.flowType=d.flowType,this.hasCustomAuthorizationHeader=d.hasCustomAuthorizationHeader,d.lock?this.lock=d.lock:Xl()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=vU:this.lock=uT,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(d.storage?this.storage=d.storage:H6()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=cT(this.memoryStorage)),d.userStorage&&(this.userStorage=d.userStorage)):(this.memoryStorage={},this.storage=cT(this.memoryStorage)),Xl()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(m){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",m)}(l=this.broadcastChannel)===null||l===void 0||l.addEventListener("message",async m=>{this._debug("received broadcast notification from other tab or client",m),await this._notifyAllSubscribers(m.data.event,m.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=vm[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){vm[this.storageKey]=Object.assign(Object.assign({},vm[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=vm[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){vm[this.storageKey]=Object.assign(Object.assign({},vm[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${W6}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=HF(window.location.href);let l="none";if(this._isImplicitGrantCallback(r)?l="implicit":await this._isPKCECallback(r)&&(l="pkce"),Xl()&&this.detectSessionInUrl&&l!=="none"){const{data:d,error:m}=await this._getSessionFromURL(r,l);if(m){if(this._debug("#_initialize()","error detecting session from URL",m),jF(m)){const a=(t=m.details)===null||t===void 0?void 0:t.code;if(a==="identity_already_exists"||a==="identity_not_found"||a==="single_identity_not_deletable")return{error:m}}return await this._removeSession(),{error:m}}const{session:x,redirectType:C}=d;return this._debug("#_initialize()","detected session in URL",x,"redirect type",C),await this._saveSession(x),setTimeout(async()=>{C==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",x):await this._notifyAllSubscribers("SIGNED_IN",x)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Gr(r)?{error:r}:{error:new G6("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,l,d;try{const m=await ci(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(d=t?.options)===null||d===void 0?void 0:d.captchaToken}},xform:th}),{data:x,error:C}=m;if(C||!x)return{data:{user:null,session:null},error:C};const a=x.session,M=x.user;return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:M,session:a},error:null}}catch(m){if(Gr(m))return{data:{user:null,session:null},error:m};throw m}}async signUp(t){var r,l,d;try{let m;if("email"in t){const{email:R,password:j,options:F}=t;let Z=null,Y=null;this.flowType==="pkce"&&([Z,Y]=await gm(this.storage,this.storageKey)),m=await ci(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:F?.emailRedirectTo,body:{email:R,password:j,data:(r=F?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:F?.captchaToken},code_challenge:Z,code_challenge_method:Y},xform:th})}else if("phone"in t){const{phone:R,password:j,options:F}=t;m=await ci(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:R,password:j,data:(l=F?.data)!==null&&l!==void 0?l:{},channel:(d=F?.channel)!==null&&d!==void 0?d:"sms",gotrue_meta_security:{captcha_token:F?.captchaToken}},xform:th})}else throw new f_("You must provide either an email or phone number and a password");const{data:x,error:C}=m;if(C||!x)return{data:{user:null,session:null},error:C};const a=x.session,M=x.user;return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:M,session:a},error:null}}catch(m){if(Gr(m))return{data:{user:null,session:null},error:m};throw m}}async signInWithPassword(t){try{let r;if("email"in t){const{email:m,password:x,options:C}=t;r=await ci(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:m,password:x,gotrue_meta_security:{captcha_token:C?.captchaToken}},xform:lT})}else if("phone"in t){const{phone:m,password:x,options:C}=t;r=await ci(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:m,password:x,gotrue_meta_security:{captcha_token:C?.captchaToken}},xform:lT})}else throw new f_("You must provide either an email or phone number and a password");const{data:l,error:d}=r;return d?{data:{user:null,session:null},error:d}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new d_}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:d})}catch(r){if(Gr(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,l,d,m;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(d=t.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:(m=t.options)===null||m===void 0?void 0:m.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,l,d,m,x,C,a,M,R,j,F,Z;let Y,ne;if("message"in t)Y=t.message,ne=t.signature;else{const{chain:se,wallet:xe,statement:Se,options:_e}=t;let Ie;if(Xl())if(typeof xe=="object")Ie=xe;else{const Ve=window;if("solana"in Ve&&typeof Ve.solana=="object"&&("signIn"in Ve.solana&&typeof Ve.solana.signIn=="function"||"signMessage"in Ve.solana&&typeof Ve.solana.signMessage=="function"))Ie=Ve.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof xe!="object"||!_e?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");Ie=xe}const Me=new URL((r=_e?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in Ie&&Ie.signIn){const Ve=await Ie.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_e?.signInWithSolana),{version:"1",domain:Me.host,uri:Me.href}),Se?{statement:Se}:null));let Ke;if(Array.isArray(Ve)&&Ve[0]&&typeof Ve[0]=="object")Ke=Ve[0];else if(Ve&&typeof Ve=="object"&&"signedMessage"in Ve&&"signature"in Ve)Ke=Ve;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in Ke&&"signature"in Ke&&(typeof Ke.signedMessage=="string"||Ke.signedMessage instanceof Uint8Array)&&Ke.signature instanceof Uint8Array)Y=typeof Ke.signedMessage=="string"?Ke.signedMessage:new TextDecoder().decode(Ke.signedMessage),ne=Ke.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in Ie)||typeof Ie.signMessage!="function"||!("publicKey"in Ie)||typeof Ie!="object"||!Ie.publicKey||!("toBase58"in Ie.publicKey)||typeof Ie.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");Y=[`${Me.host} wants you to sign in with your Solana account:`,Ie.publicKey.toBase58(),...Se?["",Se,""]:[""],"Version: 1",`URI: ${Me.href}`,`Issued At: ${(d=(l=_e?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&d!==void 0?d:new Date().toISOString()}`,...!((m=_e?.signInWithSolana)===null||m===void 0)&&m.notBefore?[`Not Before: ${_e.signInWithSolana.notBefore}`]:[],...!((x=_e?.signInWithSolana)===null||x===void 0)&&x.expirationTime?[`Expiration Time: ${_e.signInWithSolana.expirationTime}`]:[],...!((C=_e?.signInWithSolana)===null||C===void 0)&&C.chainId?[`Chain ID: ${_e.signInWithSolana.chainId}`]:[],...!((a=_e?.signInWithSolana)===null||a===void 0)&&a.nonce?[`Nonce: ${_e.signInWithSolana.nonce}`]:[],...!((M=_e?.signInWithSolana)===null||M===void 0)&&M.requestId?[`Request ID: ${_e.signInWithSolana.requestId}`]:[],...!((j=(R=_e?.signInWithSolana)===null||R===void 0?void 0:R.resources)===null||j===void 0)&&j.length?["Resources",..._e.signInWithSolana.resources.map(Ke=>`- ${Ke}`)]:[]].join(`
`);const Ve=await Ie.signMessage(new TextEncoder().encode(Y),"utf8");if(!Ve||!(Ve instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");ne=Ve}}try{const{data:se,error:xe}=await ci(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:Y,signature:qF(ne)},!((F=t.options)===null||F===void 0)&&F.captchaToken?{gotrue_meta_security:{captcha_token:(Z=t.options)===null||Z===void 0?void 0:Z.captchaToken}}:null),xform:th});if(xe)throw xe;return!se||!se.session||!se.user?{data:{user:null,session:null},error:new d_}:(se.session&&(await this._saveSession(se.session),await this._notifyAllSubscribers("SIGNED_IN",se.session)),{data:Object.assign({},se),error:xe})}catch(se){if(Gr(se))return{data:{user:null,session:null},error:se};throw se}}async _exchangeCodeForSession(t){const r=await Vf(this.storage,`${this.storageKey}-code-verifier`),[l,d]=(r??"").split("/");try{const{data:m,error:x}=await ci(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:l},xform:th});if(await ld(this.storage,`${this.storageKey}-code-verifier`),x)throw x;return!m||!m.session||!m.user?{data:{user:null,session:null,redirectType:null},error:new d_}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:Object.assign(Object.assign({},m),{redirectType:d??null}),error:x})}catch(m){if(Gr(m))return{data:{user:null,session:null,redirectType:null},error:m};throw m}}async signInWithIdToken(t){try{const{options:r,provider:l,token:d,access_token:m,nonce:x}=t,C=await ci(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:d,access_token:m,nonce:x,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:th}),{data:a,error:M}=C;return M?{data:{user:null,session:null},error:M}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new d_}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:M})}catch(r){if(Gr(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,l,d,m,x;try{if("email"in t){const{email:C,options:a}=t;let M=null,R=null;this.flowType==="pkce"&&([M,R]=await gm(this.storage,this.storageKey));const{error:j}=await ci(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:C,data:(r=a?.data)!==null&&r!==void 0?r:{},create_user:(l=a?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:a?.captchaToken},code_challenge:M,code_challenge_method:R},redirectTo:a?.emailRedirectTo});return{data:{user:null,session:null},error:j}}if("phone"in t){const{phone:C,options:a}=t,{data:M,error:R}=await ci(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:C,data:(d=a?.data)!==null&&d!==void 0?d:{},create_user:(m=a?.shouldCreateUser)!==null&&m!==void 0?m:!0,gotrue_meta_security:{captcha_token:a?.captchaToken},channel:(x=a?.channel)!==null&&x!==void 0?x:"sms"}});return{data:{user:null,session:null,messageId:M?.message_id},error:R}}throw new f_("You must provide either an email or phone number.")}catch(C){if(Gr(C))return{data:{user:null,session:null},error:C};throw C}}async verifyOtp(t){var r,l;try{let d,m;"options"in t&&(d=(r=t.options)===null||r===void 0?void 0:r.redirectTo,m=(l=t.options)===null||l===void 0?void 0:l.captchaToken);const{data:x,error:C}=await ci(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:m}}),redirectTo:d,xform:th});if(C)throw C;if(!x)throw new Error("An error occurred on token verification.");const a=x.session,M=x.user;return a?.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:M,session:a},error:null}}catch(d){if(Gr(d))return{data:{user:null,session:null},error:d};throw d}}async signInWithSSO(t){var r,l,d;try{let m=null,x=null;return this.flowType==="pkce"&&([m,x]=await gm(this.storage,this.storageKey)),await ci(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(l=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&l!==void 0?l:void 0}),!((d=t?.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:m,code_challenge_method:x}),headers:this.headers,xform:hU})}catch(m){if(Gr(m))return{data:null,error:m};throw m}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:l}=t;if(l)throw l;if(!r)throw new ud;const{error:d}=await ci(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:d}})}catch(t){if(Gr(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:l,type:d,options:m}=t,{error:x}=await ci(this.fetch,"POST",r,{headers:this.headers,body:{email:l,type:d,gotrue_meta_security:{captcha_token:m?.captchaToken}},redirectTo:m?.emailRedirectTo});return{data:{user:null,session:null},error:x}}else if("phone"in t){const{phone:l,type:d,options:m}=t,{data:x,error:C}=await ci(this.fetch,"POST",r,{headers:this.headers,body:{phone:l,type:d,gotrue_meta_security:{captcha_token:m?.captchaToken}}});return{data:{user:null,session:null,messageId:x?.message_id},error:C}}throw new f_("You must provide either an email or phone number and a type")}catch(r){if(Gr(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),d=(async()=>(await l,await r()))();return this.pendingInLock.push((async()=>{try{await d}catch{}})()),d}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=r();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const d=[...this.pendingInLock];await Promise.all(d),this.pendingInLock.splice(0,d.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Vf(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const l=t.expires_at?t.expires_at*1e3-Date.now()<cx:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",t.expires_at),!l){if(this.userStorage){const x=await Vf(this.userStorage,this.storageKey+"-user");x?.user?t.user=x.user:t.user=dx()}if(this.storage.isServer&&t.user){let x=this.suppressGetSessionWarning;t=new Proxy(t,{get:(a,M,R)=>(!x&&M==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),x=!0,this.suppressGetSessionWarning=!0),Reflect.get(a,M,R))})}return{data:{session:t},error:null}}const{session:d,error:m}=await this._callRefreshToken(t.refresh_token);return m?{data:{session:null},error:m}:{data:{session:d},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await ci(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:md}):await this._useSession(async r=>{var l,d,m;const{data:x,error:C}=r;if(C)throw C;return!(!((l=x.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ud}:await ci(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(m=(d=x.session)===null||d===void 0?void 0:d.access_token)!==null&&m!==void 0?m:void 0,xform:md})})}catch(r){if(Gr(r))return BF(r)&&(await this._removeSession(),await ld(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async l=>{const{data:d,error:m}=l;if(m)throw m;if(!d.session)throw new ud;const x=d.session;let C=null,a=null;this.flowType==="pkce"&&t.email!=null&&([C,a]=await gm(this.storage,this.storageKey));const{data:M,error:R}=await ci(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:C,code_challenge_method:a}),jwt:x.access_token,xform:md});if(R)throw R;return x.user=M.user,await this._saveSession(x),await this._notifyAllSubscribers("USER_UPDATED",x),{data:{user:x.user},error:null}})}catch(l){if(Gr(l))return{data:{user:null},error:l};throw l}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ud;const r=Date.now()/1e3;let l=r,d=!0,m=null;const{payload:x}=hx(t.access_token);if(x.exp&&(l=x.exp,d=l<=r),d){const{session:C,error:a}=await this._callRefreshToken(t.refresh_token);if(a)return{data:{user:null,session:null},error:a};if(!C)return{data:{user:null,session:null},error:null};m=C}else{const{data:C,error:a}=await this._getUser(t.access_token);if(a)throw a;m={access_token:t.access_token,refresh_token:t.refresh_token,user:C.user,token_type:"bearer",expires_in:l-r,expires_at:l},await this._saveSession(m),await this._notifyAllSubscribers("SIGNED_IN",m)}return{data:{user:m.user,session:m},error:null}}catch(r){if(Gr(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var l;if(!t){const{data:x,error:C}=r;if(C)throw C;t=(l=x.session)!==null&&l!==void 0?l:void 0}if(!t?.refresh_token)throw new ud;const{session:d,error:m}=await this._callRefreshToken(t.refresh_token);return m?{data:{user:null,session:null},error:m}:d?{data:{user:d.user,session:d},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Gr(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Xl())throw new p_("No browser detected.");if(t.error||t.error_description||t.error_code)throw new p_(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new tT("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new p_("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new tT("No code detected.");const{data:Se,error:_e}=await this._exchangeCodeForSession(t.code);if(_e)throw _e;const Ie=new URL(window.location.href);return Ie.searchParams.delete("code"),window.history.replaceState(window.history.state,"",Ie.toString()),{data:{session:Se.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:d,access_token:m,refresh_token:x,expires_in:C,expires_at:a,token_type:M}=t;if(!m||!C||!x||!M)throw new p_("No session defined in URL");const R=Math.round(Date.now()/1e3),j=parseInt(C);let F=R+j;a&&(F=parseInt(a));const Z=F-R;Z*1e3<=xm&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${Z}s, should have been closer to ${j}s`);const Y=F-j;R-Y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",Y,F,R):R-Y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",Y,F,R);const{data:ne,error:se}=await this._getUser(m);if(se)throw se;const xe={provider_token:l,provider_refresh_token:d,access_token:m,expires_in:j,expires_at:F,refresh_token:x,token_type:M,user:ne.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:xe,redirectType:t.type},error:null}}catch(l){if(Gr(l))return{data:{session:null,redirectType:null},error:l};throw l}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Vf(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var l;const{data:d,error:m}=r;if(m)return{error:m};const x=(l=d.session)===null||l===void 0?void 0:l.access_token;if(x){const{error:C}=await this.admin.signOut(x,t);if(C&&!(zF(C)&&(C.status===404||C.status===401||C.status===403)))return{error:C}}return t!=="others"&&(await this._removeSession(),await ld(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=ZF(),l={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,l),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:l}}}async _emitInitialSession(t){return await this._useSession(async r=>{var l,d;try{const{data:{session:m},error:x}=r;if(x)throw x;await((l=this.stateChangeEmitters.get(t))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",m)),this._debug("INITIAL_SESSION","callback id",t,"session",m)}catch(m){await((d=this.stateChangeEmitters.get(t))===null||d===void 0?void 0:d.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",m),console.error(m)}})}async resetPasswordForEmail(t,r={}){let l=null,d=null;this.flowType==="pkce"&&([l,d]=await gm(this.storage,this.storageKey,!0));try{return await ci(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:l,code_challenge_method:d,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(m){if(Gr(m))return{data:null,error:m};throw m}}async getUserIdentities(){var t;try{const{data:r,error:l}=await this.getUser();if(l)throw l;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Gr(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:l,error:d}=await this._useSession(async m=>{var x,C,a,M,R;const{data:j,error:F}=m;if(F)throw F;const Z=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(x=t.options)===null||x===void 0?void 0:x.redirectTo,scopes:(C=t.options)===null||C===void 0?void 0:C.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await ci(this.fetch,"GET",Z,{headers:this.headers,jwt:(R=(M=j.session)===null||M===void 0?void 0:M.access_token)!==null&&R!==void 0?R:void 0})});if(d)throw d;return Xl()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(l?.url),{data:{provider:t.provider,url:l?.url},error:null}}catch(l){if(Gr(l))return{data:{provider:t.provider,url:null},error:l};throw l}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var l,d;const{data:m,error:x}=r;if(x)throw x;return await ci(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(d=(l=m.session)===null||l===void 0?void 0:l.access_token)!==null&&d!==void 0?d:void 0})})}catch(r){if(Gr(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const l=Date.now();return await YF(async d=>(d>0&&await XF(200*Math.pow(2,d-1)),this._debug(r,"refreshing attempt",d),await ci(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:th})),(d,m)=>{const x=200*Math.pow(2,d);return m&&ux(m)&&Date.now()+x-l<xm})}catch(l){if(this._debug(r,"error",l),Gr(l))return{data:{session:null,user:null},error:l};throw l}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const l=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",l),Xl()&&!r.skipBrowserRedirect&&window.location.assign(l),{data:{provider:t,url:l},error:null}}async _recoverAndRefresh(){var t,r;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const d=await Vf(this.storage,this.storageKey);if(d&&this.userStorage){let x=await Vf(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!x&&(x={user:d.user},await wm(this.userStorage,this.storageKey+"-user",x)),d.user=(t=x?.user)!==null&&t!==void 0?t:dx()}else if(d&&!d.user&&!d.user){const x=await Vf(this.storage,this.storageKey+"-user");x&&x?.user?(d.user=x.user,await ld(this.storage,this.storageKey+"-user"),await wm(this.storage,this.storageKey,d)):d.user=dx()}if(this._debug(l,"session from storage",d),!this._isValidSession(d)){this._debug(l,"session is not valid"),d!==null&&await this._removeSession();return}const m=((r=d.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<cx;if(this._debug(l,`session has${m?"":" not"} expired with margin of ${cx}s`),m){if(this.autoRefreshToken&&d.refresh_token){const{error:x}=await this._callRefreshToken(d.refresh_token);x&&(console.error(x),ux(x)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",x),await this._removeSession()))}}else if(d.user&&d.user.__isUserNotAvailableProxy===!0)try{const{data:x,error:C}=await this._getUser(d.access_token);!C&&x?.user?(d.user=x.user,await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(x){console.error("Error getting user data:",x),this._debug(l,"error getting user data, skipping SIGNED_IN notification",x)}else await this._notifyAllSubscribers("SIGNED_IN",d)}catch(d){this._debug(l,"error",d),console.error(d);return}finally{this._debug(l,"end")}}async _callRefreshToken(t){var r,l;if(!t)throw new ud;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const d=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(d,"begin");try{this.refreshingDeferred=new Iy;const{data:m,error:x}=await this._refreshAccessToken(t);if(x)throw x;if(!m.session)throw new ud;await this._saveSession(m.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",m.session);const C={session:m.session,error:null};return this.refreshingDeferred.resolve(C),C}catch(m){if(this._debug(d,"error",m),Gr(m)){const x={session:null,error:m};return ux(m)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(x),x}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(m),m}finally{this.refreshingDeferred=null,this._debug(d,"end")}}async _notifyAllSubscribers(t,r,l=!0){const d=`#_notifyAllSubscribers(${t})`;this._debug(d,"begin",r,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:t,session:r});const m=[],x=Array.from(this.stateChangeEmitters.values()).map(async C=>{try{await C.callback(t,r)}catch(a){m.push(a)}});if(await Promise.all(x),m.length>0){for(let C=0;C<m.length;C+=1)console.error(m[C]);throw m[0]}}finally{this._debug(d,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),l=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&r.user&&await wm(this.userStorage,this.storageKey+"-user",{user:r.user});const d=Object.assign({},r);delete d.user;const m=sT(d);await wm(this.storage,this.storageKey,m)}else{const d=sT(r);await wm(this.storage,this.storageKey,d)}}async _removeSession(){this._debug("#_removeSession()"),await ld(this.storage,this.storageKey),await ld(this.storage,this.storageKey+"-code-verifier"),await ld(this.storage,this.storageKey+"-user"),this.userStorage&&await ld(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Xl()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),xm);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:l}}=r;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const d=Math.floor((l.expires_at*1e3-t)/xm);this._debug("#_autoRefreshTokenTick()",`access token expires in ${d} ticks, a tick lasts ${xm}ms, refresh threshold is ${rw} ticks`),d<=rw&&await this._callRefreshToken(l.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof X6)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Xl()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,l){const d=[`provider=${encodeURIComponent(r)}`];if(l?.redirectTo&&d.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&d.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[m,x]=await gm(this.storage,this.storageKey),C=new URLSearchParams({code_challenge:`${encodeURIComponent(m)}`,code_challenge_method:`${encodeURIComponent(x)}`});d.push(C.toString())}if(l?.queryParams){const m=new URLSearchParams(l.queryParams);d.push(m.toString())}return l?.skipBrowserRedirect&&d.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${t}?${d.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var l;const{data:d,error:m}=r;return m?{data:null,error:m}:await ci(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token})})}catch(r){if(Gr(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var l,d;const{data:m,error:x}=r;if(x)return{data:null,error:x};const C=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:a,error:M}=await ci(this.fetch,"POST",`${this.url}/factors`,{body:C,headers:this.headers,jwt:(l=m?.session)===null||l===void 0?void 0:l.access_token});return M?{data:null,error:M}:(t.factorType==="totp"&&(!((d=a?.totp)===null||d===void 0)&&d.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(r){if(Gr(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var l;const{data:d,error:m}=r;if(m)return{data:null,error:m};const{data:x,error:C}=await ci(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token});return C?{data:null,error:C}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+x.expires_in},x)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",x),{data:x,error:C})})}catch(r){if(Gr(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var l;const{data:d,error:m}=r;return m?{data:null,error:m}:await ci(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token})})}catch(r){if(Gr(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:l}=await this._challenge({factorId:t.factorId});return l?{data:null,error:l}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const l=t?.factors||[],d=l.filter(x=>x.factor_type==="totp"&&x.status==="verified"),m=l.filter(x=>x.factor_type==="phone"&&x.status==="verified");return{data:{all:l,totp:d,phone:m},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,l;const{data:{session:d},error:m}=t;if(m)return{data:null,error:m};if(!d)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:x}=hx(d.access_token);let C=null;x.aal&&(C=x.aal);let a=C;((l=(r=d.user.factors)===null||r===void 0?void 0:r.filter(j=>j.status==="verified"))!==null&&l!==void 0?l:[]).length>0&&(a="aal2");const R=x.amr||[];return{data:{currentLevel:C,nextLevel:a,currentAuthenticationMethods:R},error:null}}))}async fetchJwk(t,r={keys:[]}){let l=r.keys.find(C=>C.kid===t);if(l)return l;const d=Date.now();if(l=this.jwks.keys.find(C=>C.kid===t),l&&this.jwks_cached_at+OF>d)return l;const{data:m,error:x}=await ci(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(x)throw x;return!m.keys||m.keys.length===0||(this.jwks=m,this.jwks_cached_at=d,l=m.keys.find(C=>C.kid===t),!l)?null:l}async getClaims(t,r={}){try{let l=t;if(!l){const{data:Z,error:Y}=await this.getSession();if(Y||!Z.session)return{data:null,error:Y};l=Z.session.access_token}const{header:d,payload:m,signature:x,raw:{header:C,payload:a}}=hx(l);r?.allowExpired||iU(m.exp);const M=!d.alg||d.alg.startsWith("HS")||!d.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(d.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!M){const{error:Z}=await this.getUser(l);if(Z)throw Z;return{data:{claims:m,header:d,signature:x},error:null}}const R=oU(d.alg),j=await crypto.subtle.importKey("jwk",M,R,!0,["verify"]);if(!await crypto.subtle.verify(R,j,x,WF(`${C}.${a}`)))throw new sw("Invalid JWT signature");return{data:{claims:m,header:d,signature:x},error:null}}catch(l){if(Gr(l))return{data:null,error:l};throw l}}}F0.nextInstanceID=0;const wU=F0;class bU extends wU{constructor(t){super(t)}}var EU=function(n,t,r,l){function d(m){return m instanceof r?m:new r(function(x){x(m)})}return new(r||(r=Promise))(function(m,x){function C(R){try{M(l.next(R))}catch(j){x(j)}}function a(R){try{M(l.throw(R))}catch(j){x(j)}}function M(R){R.done?m(R.value):d(R.value).then(C,a)}M((l=l.apply(n,t||[])).next())})};class TU{constructor(t,r,l){var d,m,x;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const C=MF(t),a=new URL(C);this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const M=`sb-${a.hostname.split(".")[0]}-auth-token`,R={db:xF,realtime:bF,auth:Object.assign(Object.assign({},wF),{storageKey:M}),global:vF},j=AF(l??{},R);this.storageKey=(d=j.auth.storageKey)!==null&&d!==void 0?d:"",this.headers=(m=j.global.headers)!==null&&m!==void 0?m:{},j.accessToken?(this.accessToken=j.accessToken,this.auth=new Proxy({},{get:(F,Z)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(Z)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((x=j.auth)!==null&&x!==void 0?x:{},this.headers,j.global.fetch),this.fetch=SF(r,this._getAccessToken.bind(this),j.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},j.realtime)),this.rest=new $N(new URL("rest/v1",a).href,{headers:this.headers,schema:j.db.schema,fetch:this.fetch}),j.accessToken||this._listenForAuthEvents()}get functions(){return new PN(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new gF(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},l={}){return this.rest.rpc(t,r,l)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return EU(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:l}=yield this.auth.getSession();return(r=(t=l.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:l,storage:d,storageKey:m,flowType:x,lock:C,debug:a},M,R){const j={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new bU({url:this.authUrl.href,headers:Object.assign(Object.assign({},j),M),storageKey:m,autoRefreshToken:t,persistSession:r,detectSessionInUrl:l,storage:d,flowType:x,lock:C,debug:a,fetch:R,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new rF(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,l)=>{this._handleTokenChanged(r,"CLIENT",l?.access_token)})}_handleTokenChanged(t,r,l){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==l?this.changedAccessToken=l:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const CU=(n,t,r)=>new TU(n,t,r),SU="https://tkvtshoprhmgjrgvaeia.supabase.co",kU="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRrdnRzaG9wcmhtZ2pyZ3ZhZWlhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMwMDAzNTcsImV4cCI6MjA2ODU3NjM1N30.QQpxdrC5A4871_T1RirgvA-zORHF2h-UFDGcgETFcU0",MU=CU(SU,kU);function AU({showBanner:n,onCloseBanner:t,onMarkerClick:r}){const[l,d]=He.useState({longitude:30.5234,latitude:50.4501,zoom:12,width:"100%",height:"100%",dragPan:!0,dragRotate:!1,scrollZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!1,doubleClickZoom:!0}),[m,x]=He.useState(null),[C,a]=He.useState(null),M=He.useRef(),[R,j]=He.useState(!1),[F,Z]=He.useState([]),[Y,ne]=He.useState(!0);He.useEffect(()=>{(()=>{const We=navigator.userAgent||navigator.vendor||window.opera,Ue=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(We.toLowerCase());j(Ue)})()},[]),He.useEffect(()=>{se()},[]);const se=async()=>{try{ne(!0);const{data:ge,error:We}=await MU.from("locations").select("*").eq("is_active",!0);We?(console.error("Помилка завантаження локацій:",We),Z([])):Z(ge||[])}catch(ge){console.error("Помилка при завантаженні локацій:",ge),Z([])}finally{ne(!1)}};He.useEffect(()=>{if(window.Telegram&&window.Telegram.WebApp&&window.Telegram.WebApp.LocationManager){console.log("Використовуємо Telegram LocationManager API");try{window.Telegram.WebApp.LocationManager.requestLocation({onSuccess:ge=>{console.log("Telegram геолокація успішна:",ge),d(We=>({...We,longitude:ge.longitude,latitude:ge.latitude,zoom:15,transitionDuration:1e3})),x({latitude:ge.latitude,longitude:ge.longitude})},onError:ge=>{console.error("Помилка Telegram геолокації:",ge),a("Помилка Telegram геолокації: "+ge),xe()}})}catch(ge){console.error("Виняток при використанні Telegram LocationManager:",ge),xe()}}else console.log("Telegram LocationManager недоступний, використовуємо браузерний API"),xe()},[]);const xe=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(ge=>{console.log("Браузерна геолокація успішна:",ge.coords),d(We=>({...We,longitude:ge.coords.longitude,latitude:ge.coords.latitude,zoom:15,transitionDuration:1e3})),x({latitude:ge.coords.latitude,longitude:ge.coords.longitude})},ge=>{console.error("Помилка браузерної геолокації:",ge),a("Не вдалося отримати геолокацію: "+ge.message)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):(console.error("Геолокація не підтримується браузером"),a("Геолокація не підтримується вашим браузером"))},Se=F.map(ge=>({type:"Feature",properties:{id:ge.id,title:ge.title,avatar:ge.avatar,description:ge.description,address:ge.address},geometry:{type:"Point",coordinates:[ge.longitude,ge.latitude]}})),_e=new bN({radius:40,maxZoom:18});_e.load(Se);let Ie=[];if(M.current){const ge=M.current.getMap().getBounds().toArray().flat();Ie=_e.getClusters(ge,Math.round(l.zoom))}else Ie=_e.getClusters([30.5,50.4,30.6,50.5],Math.round(l.zoom));const Me=()=>d(ge=>({...ge,zoom:Math.min(ge.zoom+1,18)})),Ve=()=>d(ge=>({...ge,zoom:Math.max(ge.zoom-1,10)})),Ke=()=>{if(window.Telegram&&window.Telegram.WebApp&&window.Telegram.WebApp.LocationManager)try{window.Telegram.WebApp.LocationManager.requestLocation({onSuccess:ge=>{d(We=>({...We,longitude:ge.longitude,latitude:ge.latitude,zoom:15,transitionDuration:1e3,width:We.width,height:We.height})),x({latitude:ge.latitude,longitude:ge.longitude})},onError:ge=>{console.error("Помилка Telegram геолокації:",ge),et()}})}catch(ge){console.error("Виняток при використанні Telegram LocationManager:",ge),et()}else et()},et=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(ge=>{d(We=>({...We,longitude:ge.coords.longitude,latitude:ge.coords.latitude,zoom:15,transitionDuration:1e3,width:We.width,height:We.height})),x({latitude:ge.coords.latitude,longitude:ge.coords.longitude})},ge=>{alert("Не вдалося отримати геолокацію: "+ge.message)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):alert("Геолокація не підтримується вашим браузером")},qe=ge=>{const We=Math.min(Math.max(ge.zoom,10),18),Ue=Math.abs(ge.zoom-l.zoom)>2?300:0;d({...ge,zoom:We,transitionDuration:Ue})};return we.jsxs("div",{style:{width:"100%",height:"100%",overflow:"hidden",position:"relative",touchAction:R?"pan-x pan-y":"auto"},children:[we.jsxs(Py,{ref:M,...l,width:"100%",height:"100%",mapStyle:"mapbox://styles/mapbox/streets-v11",mapboxApiAccessToken:"pk.eyJ1IjoicnVkZW5rb3Jlc3QiLCJhIjoiY21iaTkyZGc1MDJ3bjJqc2RyMmdhcjJlMCJ9.j-zEbmEXtlw1dRL9LiXTbw",onViewportChange:qe,dragRotate:!1,touchZoom:!0,touchAction:"pan-x pan-y",minZoom:10,maxZoom:18,scrollZoom:{speed:.3,smooth:!0},children:[!Y&&Ie.map(ge=>{const[We,Ue]=ge.geometry.coordinates;return ge.properties.cluster?we.jsx(tx,{longitude:We,latitude:Ue,offsetLeft:-20,offsetTop:-20,children:we.jsx("div",{style:{width:40,height:40,borderRadius:"50%",background:"rgba(0, 120, 255, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontFamily:"'Helvetica Neue', sans-serif",fontWeight:500,fontSize:16,border:"2px solid #fff",boxShadow:"0 0 8px 2px rgba(0,120,255,0.5)"},children:ge.properties.point_count})},`cluster-${ge.id}`):we.jsx(tx,{longitude:We,latitude:Ue,offsetLeft:-24,offsetTop:-48,children:we.jsxs("div",{onClick:()=>r(ge.properties),style:{cursor:"pointer",display:"flex",alignItems:"center",gap:8},children:[we.jsx(US,{src:ge.properties.avatar,alt:ge.properties.title,size:48}),we.jsx(O0,{caps:!0,level:"1",weight:"2",style:{color:"#000"},children:ge.properties.title})]})},`marker-${ge.properties.id}`)}),m&&we.jsx(tx,{longitude:m.longitude,latitude:m.latitude,offsetLeft:-12,offsetTop:-12,children:we.jsx("div",{style:{width:18,height:18,borderRadius:"50%",background:"rgba(0, 120, 255, 1)",border:"2px solid #fff",boxShadow:"0 0 8px 2px rgba(0,120,255,0.5)"}})})]}),Y&&we.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"rgba(255, 255, 255, 0.9)",padding:20,borderRadius:12,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:we.jsx(O0,{weight:"1",children:"Завантаження локацій..."})}),n&&we.jsx("div",{style:{position:"absolute",bottom:25,right:20,zIndex:10,width:"90%",maxWidth:"90%"},children:we.jsx($S,{background:we.jsx("img",{alt:"Nasa streams",src:"https://www.nasa.gov/wp-content/uploads/2023/10/streams.jpg?resize=1536,864",style:{width:"150%"}}),header:"Двіж поряд",subheader:"Інтерактивна карта локацій Києва",onCloseIcon:t,type:"section",children:we.jsx(Hf,{mode:"white",size:"s",children:"Перейти в канал"})})}),we.jsxs("div",{style:{position:"absolute",top:80,right:12,display:"flex",flexDirection:"column",gap:8},children:[we.jsx(Hf,{shape:"circle",size:"m",onClick:Me,children:"+"}),we.jsx(Hf,{shape:"circle",size:"m",onClick:Ve,children:"-"}),we.jsx(Hf,{shape:"circle",size:"m",onClick:Ke,children:"→"})]})]})}function PU(){const[n,t]=He.useState(!0),[r,l]=He.useState(!1),[d,m]=He.useState(null),[x,C]=He.useState(!1),[a,M]=He.useState(!1),R="-1001968388006",j="https://t.me/+8Bui7KD5WrJiZjli",F="https://mini-app-backend-production-826a.up.railway.app",Z=xe=>{m(xe),l(!0)},Y=async()=>{try{M(!0);const xe=window.Telegram?.WebApp,Se=xe?.initDataUnsafe?.user;if(!Se)return console.error("Не вдалося отримати дані користувача"),!1;const _e=await fetch(`${F}/api/check-subscription`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:Se.id,channel:R,initData:xe.initData||""})});if(!_e.ok){const Me=await _e.json();return console.error("Помилка API:",Me),!1}return(await _e.json()).isSubscribed}catch(xe){return console.error("Помилка перевірки підписки:",xe),!1}finally{M(!1)}},ne=async xe=>{xe.preventDefault(),await Y()?window.open(d.link||"https://nohello.net/en/","_blank"):C(!0)},se=()=>{window.open(j,"_blank"),C(!1),setTimeout(()=>{Y().then(xe=>{xe&&window.open(d?.link||"https://nohello.net/en/","_blank")})},3e3)};return we.jsx(GD,{back:!1,children:we.jsxs("div",{style:{height:"100vh",background:"#181818",padding:0,position:"relative"},children:[we.jsx(AU,{showBanner:n,onCloseBanner:()=>t(!1),onMarkerClick:Z}),r&&d&&we.jsx("div",{style:{position:"absolute",left:0,right:0,bottom:0,zIndex:9999,display:"flex",justifyContent:"center",pointerEvents:"none",background:"transparent"},children:we.jsx("div",{style:{width:"100%",maxWidth:"100%",pointerEvents:"auto"},children:we.jsx($S,{before:we.jsx(Yw,{size:48,src:d.avatar}),callout:d.address||"Київ",background:we.jsx("img",{alt:"Location background",src:d.avatar,style:{width:"100%",height:"100%",opacity:.5,objectFit:"cover"}}),header:d.title,subheader:d.description||"Опис локації",type:"section",onCloseIcon:()=>l(!1),children:we.jsx(Hf,{mode:"white",size:"s",onClick:ne,loading:a,children:"Детальніше"})})})}),x&&we.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:20},children:we.jsxs("div",{style:{backgroundColor:"white",borderRadius:16,padding:24,maxWidth:340,width:"100%",boxShadow:"0 4px 24px rgba(0, 0, 0, 0.15)"},children:[we.jsx(FS,{weight:"2",style:{marginBottom:12,textAlign:"center"},children:"Підпишіться на канал"}),we.jsx(Xw,{style:{marginBottom:20,textAlign:"center",color:"#666"},children:"Щоб отримати доступ до детальної інформації, підпишіться на наш Telegram канал"}),we.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[we.jsx(Hf,{size:"l",stretched:!0,onClick:se,children:"Підписатися на канал"}),we.jsx(Hf,{mode:"bezeled",size:"l",stretched:!0,onClick:()=>C(!1),children:"Закрити"})]})]})})]})})}const IU=[{path:"/",Component:PU,title:"Карта"}];function LU(){const n=j2(),t=N2(gx.isDark);return we.jsx(JO,{appearance:t?"dark":"light",platform:["macos","ios"].includes(n.platform)?"ios":"base",children:we.jsx(qD,{children:we.jsxs($D,{children:[IU.map(r=>we.jsx(Ox,{path:r.path,element:we.jsx(r.Component,{})},r.path)),we.jsx(Ox,{path:"*",element:we.jsx(FD,{to:"/"})})]})})})}class RU extends He.Component{state={};static getDerivedStateFromError=t=>({error:t});componentDidCatch(t){this.setState({error:t})}render(){const{state:{error:t},props:{fallback:r,children:l}}=this;return"error"in this.state?typeof r=="function"?we.jsx(r,{error:t}):r:l}}function OU(n){return new URL(n.replace(/^\/+/,""),window.location.origin+"/mini-app").toString()}function DU({error:n}){return we.jsxs("div",{children:[we.jsx("p",{children:"An unhandled error occurred:"}),we.jsx("blockquote",{children:we.jsx("code",{children:n instanceof Error?n.message:typeof n=="string"?n:JSON.stringify(n)})})]})}function zU(){return we.jsx(RU,{fallback:DU,children:we.jsx(JR,{manifestUrl:OU("tonconnect-manifest.json"),children:we.jsx(LU,{})})})}function BU(n){ST.set(n),B2(),a0.isSupported()&&a0.mount(),gx.mount(),u5.mount(),t2.restore(),h5.mount().catch(t=>{console.error("Something went wrong mounting the viewport",t)}),h5.bindCssVars(),gx.bindCssVars(),u5.bindCssVars(),n&&Zm(()=>import("./eruda-BLnJf19H.js").then(t=>t.e),[]).then(t=>t.default.init()).catch(console.error)}BU(Um().startParam==="debug"||!1);Tk.createRoot(document.getElementById("root")).render(we.jsx(He.StrictMode,{children:we.jsx(zU,{})}));export{cu as g};
